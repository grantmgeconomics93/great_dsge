(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    426283,      10959]
NotebookOptionsPosition[    408056,      10719]
NotebookOutlinePosition[    408505,      10736]
CellTagsIndexPosition[    408462,      10733]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"First", ",", 
    RowBox[{"set", " ", "the", " ", "known", " ", "parameters"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"r", "=", 
     RowBox[{
      RowBox[{"1", "/", "0.9943"}], "-", "1"}]}], ";"}], "  ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Policy", " ", "rate", " ", "from", " ", "1"}], "+", "r"}], "=", 
     RowBox[{"1", "/", "\[Beta]P"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"\[Kappa]Kb", "=", "10"}], ";"}], "          ", 
   RowBox[{"(*", 
    RowBox[{"Calibrated", " ", "value", " ", "for", " ", "\[Kappa]Kb"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"\[Nu]b", "=", "0.09"}], ";"}], "         ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Target", " ", "capital"}], "-", "to", "-", 
     RowBox[{"loans", " ", "ratio"}]}], "*)"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Define", " ", "the", " ", "functions", " ", "for", " ", "our", " ", 
     "two", " ", "equations"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f1", "[", 
     RowBox[{"Rb_", ",", "SW_"}], "]"}], ":=", 
    RowBox[{"Rb", "-", 
     RowBox[{"(", 
      RowBox[{"r", "-", 
       RowBox[{"\[Kappa]Kb", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"0.09", "-", "\[Nu]b"}], ")"}], "^", "2"}]}]}], ")"}]}]}], "\n", 
   RowBox[{
    RowBox[{"f2", "[", 
     RowBox[{"Rb_", ",", "SW_"}], "]"}], ":=", 
    RowBox[{"SW", "+", 
     RowBox[{"\[Kappa]Kb", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.09", "-", "\[Nu]b"}], ")"}], "^", "2"}]}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Since", " ", "the", " ", "equations", " ", "are", " ", "linear"}], ",", 
     RowBox[{
      RowBox[{
      "the", " ", "Jacobian", " ", "is", " ", "the", " ", "identity", " ", 
       RowBox[{"matrix", ":", "J"}]}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "*)"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Define", " ", "a", " ", "Newton", " ", "step", " ", "function"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"newtonStep", "[", 
      RowBox[{"{", 
       RowBox[{"Rb_", ",", "SW_"}], "}"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Rb", ",", "SW"}], "}"}], "-", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"f1", "[", 
         RowBox[{"Rb", ",", "SW"}], "]"}], ",", 
        RowBox[{"f2", "[", 
         RowBox[{"Rb", ",", "SW"}], "]"}]}], "}"}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Choose", " ", "an", " ", "initial", " ", "guess"}], ",", 
     RowBox[{"e", ".", "g", ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"and", " ", "iterate", " ", "until", " ", "convergence"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solution", "=", 
     RowBox[{"FixedPoint", "[", 
      RowBox[{"newtonStep", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", "solution", "\[IndentingNewLine]", "\n", "\n",
    "\[IndentingNewLine]", "\n", "\n"}]}]], "Input",
 CellChangeTimes->{{3.9424097710067005`*^9, 3.9424097735303288`*^9}, 
   3.942409986837412*^9, {3.942410224952446*^9, 3.942410250698843*^9}, 
   3.942414205266445*^9, 3.9424171668779297`*^9, 3.942419692092272*^9, 
   3.9424204177254696`*^9, 3.9424204789909916`*^9, {3.942420720045725*^9, 
   3.942420728957245*^9}, {3.9424208281063786`*^9, 3.9424208471915607`*^9}, {
   3.942420880106722*^9, 3.942420886782583*^9}, 3.9424222361942863`*^9, {
   3.942423052980547*^9, 3.9424230739505024`*^9}, 3.942423164222044*^9, 
   3.9424232036387615`*^9, {3.9424232833174133`*^9, 3.942423307845436*^9}, {
   3.942423342657379*^9, 3.942423370843012*^9}, {3.9424235561691933`*^9, 
   3.942423573217308*^9}, 3.9424237825038567`*^9, 3.942423914171425*^9, 
   3.94248768227162*^9, 3.942502868082756*^9, 3.942503100647709*^9, 
   3.942503140525156*^9, 3.9425046010225945`*^9, {3.9425052399102135`*^9, 
   3.9425052421572056`*^9}, {3.9425064032796345`*^9, 3.9425064272894344`*^9}, 
   3.94250658942535*^9, 3.9425067828417664`*^9, 3.942506854326124*^9, {
   3.9425079465509777`*^9, 3.94250799672328*^9}, 3.9425081754514484`*^9, 
   3.942510581203039*^9, {3.942511009251314*^9, 3.942511017852148*^9}, {
   3.942511221733576*^9, 3.9425112586265945`*^9}, 3.9425117108579197`*^9, 
   3.9425117602628727`*^9, {3.942511856447809*^9, 3.9425119345891457`*^9}, 
   3.9425122263945293`*^9, {3.942512955427664*^9, 3.9425129698917313`*^9}, {
   3.94251301365139*^9, 3.9425130307669353`*^9}, {3.942513108585476*^9, 
   3.942513112112303*^9}, {3.9425135466473694`*^9, 3.942513556385315*^9}, {
   3.942513868974186*^9, 3.942513921787203*^9}, {3.9425139580605755`*^9, 
   3.9425139700600357`*^9}, 3.9425140419308376`*^9, {3.942514134970972*^9, 
   3.9425141648856773`*^9}, {3.9425141998729115`*^9, 
   3.9425142444404106`*^9}, {3.9425142927988625`*^9, 3.942514303916441*^9}, {
   3.9425148598096733`*^9, 3.9425148712374344`*^9}, {3.942514910480751*^9, 
   3.942514917020756*^9}, {3.942514973867367*^9, 3.9425150148147144`*^9}, 
   3.9425161769270763`*^9, 3.9425162112263985`*^9, {3.9425166428949184`*^9, 
   3.942516672205147*^9}, {3.942517042567255*^9, 3.9425170621009064`*^9}, {
   3.9425171674338245`*^9, 3.9425171874190807`*^9}, 3.942517223580761*^9, 
   3.9425173582750072`*^9, 3.942517406842678*^9, {3.9425176475276356`*^9, 
   3.942517664750183*^9}, {3.942517718150387*^9, 3.942517744371004*^9}, {
   3.9425178154654617`*^9, 3.942517834731922*^9}, 3.942517913433714*^9, 
   3.942518014903372*^9, {3.9425881118939304`*^9, 3.942588226554573*^9}, {
   3.9425896390154*^9, 3.942589660098751*^9}, {3.9425905522714367`*^9, 
   3.942590594677908*^9}, {3.9425911684561577`*^9, 3.9425911698701305`*^9}, 
   3.942751573759756*^9, 3.942751621808159*^9, 3.9427516680874004`*^9, {
   3.9427517329189034`*^9, 3.9427517351424484`*^9}, {3.9427519255838013`*^9, 
   3.9427519869494553`*^9}, 3.9427520332742233`*^9, 3.942752333177307*^9, {
   3.942752770986908*^9, 3.9427527730965176`*^9}, {3.94275302368054*^9, 
   3.942753025683384*^9}, {3.9428474340546665`*^9, 3.9428474362622166`*^9}, {
   3.9428483214733906`*^9, 3.942848362170891*^9}, 3.9428484049196663`*^9, 
   3.942848454450346*^9, {3.9428490839405823`*^9, 3.942849160084255*^9}, {
   3.942849213918829*^9, 3.942849287185663*^9}, {3.9428493507735596`*^9, 
   3.942849353695465*^9}, 3.9428493846297016`*^9, {3.942850052822735*^9, 
   3.9428500750204296`*^9}, {3.9428501420583496`*^9, 
   3.9428501459492645`*^9}, {3.9428503972435436`*^9, 
   3.9428504100488663`*^9}, {3.942853049260662*^9, 3.9428530504676895`*^9}, {
   3.942853092458111*^9, 3.9428531192472134`*^9}, {3.942853353568598*^9, 
   3.9428533545898075`*^9}, {3.9428533987449627`*^9, 
   3.9428534229557915`*^9}, {3.9429231648091373`*^9, 3.942923166138708*^9}, {
   3.9429246809890385`*^9, 3.942924683690712*^9}, {3.9429247321913033`*^9, 
   3.942924732889475*^9}, {3.9429254250561047`*^9, 3.9429254513153687`*^9}, 
   3.9429254838702602`*^9, {3.9429255434986267`*^9, 3.942925560423479*^9}, {
   3.942925616054928*^9, 3.942925642339443*^9}, {3.9429261874701004`*^9, 
   3.9429262104446373`*^9}, {3.942926484765465*^9, 3.942926497715992*^9}, {
   3.94292658112232*^9, 3.9429265839319725`*^9}, {3.9429267900613174`*^9, 
   3.9429267947414474`*^9}, 3.9429268487589626`*^9, {3.94293422696509*^9, 
   3.9429342288360386`*^9}, {3.9429343606643944`*^9, 
   3.9429343661244335`*^9}, {3.942934751577406*^9, 3.9429347571734104`*^9}, {
   3.9429348102113075`*^9, 3.942934825030098*^9}, 3.9429349712800045`*^9, {
   3.942935395628916*^9, 3.9429354119468803`*^9}, {3.942935638691334*^9, 
   3.9429356840764217`*^9}, 3.9429360778661404`*^9, {3.9429361132493095`*^9, 
   3.9429361676882057`*^9}, {3.942936520458252*^9, 3.942936526243181*^9}, {
   3.9429461492206955`*^9, 3.9429461723246975`*^9}, {3.943008575399826*^9, 
   3.943008584860981*^9}, {3.943012952041334*^9, 3.9430129533912315`*^9}, {
   3.9430272878138313`*^9, 3.9430272905139027`*^9}, 3.943106855318901*^9, {
   3.943373167306566*^9, 3.943373172855282*^9}, {3.949506821079384*^9, 
   3.9495068659453564`*^9}, 3.949506917242092*^9, 3.9497598584248276`*^9, {
   3.949760070409359*^9, 3.9497601044920845`*^9}, 3.949760460544508*^9, 
   3.9497608916708984`*^9, {3.949762948031452*^9, 3.949763002752819*^9}, {
   3.9497631134323196`*^9, 3.9497631675*^9}, {3.9507094991912785`*^9, 
   3.9507095321089993`*^9}, 3.950710282652418*^9, {3.950710510372116*^9, 
   3.9507105122025623`*^9}, {3.950712843464369*^9, 3.9507128579766636`*^9}, {
   3.950713913005459*^9, 3.9507139310674057`*^9}, {3.9507139776571064`*^9, 
   3.9507139944381447`*^9}, {3.95071403701482*^9, 3.9507140482785473`*^9}, {
   3.95071409641852*^9, 3.9507141001790295`*^9}, {3.9507146401005306`*^9, 
   3.9507146415506935`*^9}, {3.9508035021228294`*^9, 3.9508035226560955`*^9}, 
   3.95080425959433*^9, 3.950804290621689*^9, 3.950804323346176*^9, 
   3.9508043689012775`*^9, {3.950804430530573*^9, 3.9508046526845894`*^9}, {
   3.9508047242036057`*^9, 3.9508048317617435`*^9}, {3.9508048785187645`*^9, 
   3.950804952800253*^9}, {3.9519094461128426`*^9, 3.9519094622372055`*^9}, {
   3.9524453917919216`*^9, 3.9524454073136654`*^9}, 3.952445442310402*^9, 
   3.9525203291017303`*^9, 3.952520378667185*^9, 3.95252046006929*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"f9fb2cec-0218-1946-a7a4-614cfc63c79f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.005732676254651459`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{3.9525204937215004`*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"72576288-5b27-e542-8734-fa9fc2bb7aa8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Define", " ", "the", " ", "two", " ", "equations", " ", "in", " ", 
     "terms", " ", "of", " ", "Rb"}], ",", "SW", ",", "r", ",", "kKb", ",", 
    RowBox[{"and", " ", "vb"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"eq1", "=", 
     RowBox[{"Rb", "==", 
      RowBox[{"r", "-", 
       RowBox[{"kKb", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"0.09", "-", "vb"}], ")"}], "^", "2"}]}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"eq2", "=", 
     RowBox[{"SW", "==", 
      RowBox[{
       RowBox[{"-", "kKb"}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"0.09", "-", "vb"}], ")"}], "^", "2"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Directly", " ", "substitute", " ", "numeric", " ", "values", " ", "for", 
     " ", "all", " ", "variables", " ", "into", " ", "eq1", " ", "and", " ", 
     "eq2"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq1Sub", "=", 
     RowBox[{"eq1", "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Rb", "->", "0.00573268"}], ",", 
        RowBox[{"r", "->", "0.00573268"}], ",", 
        RowBox[{"kKb", "->", "10"}], ",", 
        RowBox[{"vb", "->", "0.09"}]}], "}"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"eq2Sub", "=", 
     RowBox[{"eq2", "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"SW", "->", "0"}], ",", 
        RowBox[{"kKb", "->", "10"}], ",", 
        RowBox[{"vb", "->", "0.09"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\n", "eq1Sub", "\n", "eq2Sub", "\n", 
   "\n"}]}]], "Input",
 CellChangeTimes->{{3.9514089570346966`*^9, 3.9514089684115486`*^9}, 
   3.9514090037321396`*^9, {3.952520951735441*^9, 3.9525209582759438`*^9}, {
   3.9525210583919353`*^9, 3.952521092073431*^9}, {3.952521670163479*^9, 
   3.9525216853153706`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"6c8204b6-abb9-764b-8ef5-a85325ed64d1"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.952521013381008*^9, 3.9525210975699005`*^9, 
  3.9525216928090343`*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"fc7cbeef-2439-8b4a-b7f6-1454a9bb35c3"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.952521013381008*^9, 3.9525210975699005`*^9, 
  3.9525216928120594`*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"3f744072-e234-194c-a31c-c641b6793d6c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", "\n", "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.9424097710067005`*^9, 3.9424097735303288`*^9}, 
   3.942409986837412*^9, {3.942410224952446*^9, 3.942410250698843*^9}, 
   3.942414205266445*^9, 3.9424171668779297`*^9, 3.942419692092272*^9, 
   3.9424204177254696`*^9, 3.9424204789909916`*^9, {3.942420720045725*^9, 
   3.942420728957245*^9}, {3.9424208281063786`*^9, 3.9424208471915607`*^9}, {
   3.942420880106722*^9, 3.942420886782583*^9}, 3.9424222361942863`*^9, {
   3.942423052980547*^9, 3.9424230739505024`*^9}, 3.942423164222044*^9, 
   3.9424232036387615`*^9, {3.9424232833174133`*^9, 3.942423307845436*^9}, {
   3.942423342657379*^9, 3.942423370843012*^9}, {3.9424235561691933`*^9, 
   3.942423573217308*^9}, 3.9424237825038567`*^9, 3.942423914171425*^9, 
   3.94248768227162*^9, 3.942502868082756*^9, 3.942503100647709*^9, 
   3.942503140525156*^9, 3.9425046010225945`*^9, {3.9425052399102135`*^9, 
   3.9425052421572056`*^9}, {3.9425064032796345`*^9, 3.9425064272894344`*^9}, 
   3.94250658942535*^9, 3.9425067828417664`*^9, 3.942506854326124*^9, {
   3.9425079465509777`*^9, 3.94250799672328*^9}, 3.9425081754514484`*^9, 
   3.942510581203039*^9, {3.942511009251314*^9, 3.942511017852148*^9}, {
   3.942511221733576*^9, 3.9425112586265945`*^9}, 3.9425117108579197`*^9, 
   3.9425117602628727`*^9, {3.942511856447809*^9, 3.9425119345891457`*^9}, 
   3.9425122263945293`*^9, {3.942512955427664*^9, 3.9425129698917313`*^9}, {
   3.94251301365139*^9, 3.9425130307669353`*^9}, {3.942513108585476*^9, 
   3.942513112112303*^9}, {3.9425135466473694`*^9, 3.942513556385315*^9}, {
   3.942513868974186*^9, 3.942513921787203*^9}, {3.9425139580605755`*^9, 
   3.9425139700600357`*^9}, 3.9425140419308376`*^9, {3.942514134970972*^9, 
   3.9425141648856773`*^9}, {3.9425141998729115`*^9, 
   3.9425142444404106`*^9}, {3.9425142927988625`*^9, 3.942514303916441*^9}, {
   3.9425148598096733`*^9, 3.9425148712374344`*^9}, {3.942514910480751*^9, 
   3.942514917020756*^9}, {3.942514973867367*^9, 3.9425150148147144`*^9}, 
   3.9425161769270763`*^9, 3.9425162112263985`*^9, {3.9425166428949184`*^9, 
   3.942516672205147*^9}, {3.942517042567255*^9, 3.9425170621009064`*^9}, {
   3.9425171674338245`*^9, 3.9425171874190807`*^9}, 3.942517223580761*^9, 
   3.9425173582750072`*^9, 3.942517406842678*^9, {3.9425176475276356`*^9, 
   3.942517664750183*^9}, {3.942517718150387*^9, 3.942517744371004*^9}, {
   3.9425178154654617`*^9, 3.942517834731922*^9}, 3.942517913433714*^9, 
   3.942518014903372*^9, {3.9425881118939304`*^9, 3.942588226554573*^9}, {
   3.9425896390154*^9, 3.942589660098751*^9}, {3.9425905522714367`*^9, 
   3.942590594677908*^9}, {3.9425911684561577`*^9, 3.9425911698701305`*^9}, 
   3.942751573759756*^9, 3.942751621808159*^9, 3.9427516680874004`*^9, {
   3.9427517329189034`*^9, 3.9427517351424484`*^9}, {3.9427519255838013`*^9, 
   3.9427519869494553`*^9}, 3.9427520332742233`*^9, 3.942752333177307*^9, {
   3.942752770986908*^9, 3.9427527730965176`*^9}, {3.94275302368054*^9, 
   3.942753025683384*^9}, {3.9428474340546665`*^9, 3.9428474362622166`*^9}, {
   3.9428483214733906`*^9, 3.942848362170891*^9}, 3.9428484049196663`*^9, 
   3.942848454450346*^9, {3.9428490839405823`*^9, 3.942849160084255*^9}, {
   3.942849213918829*^9, 3.942849287185663*^9}, {3.9428493507735596`*^9, 
   3.942849353695465*^9}, 3.9428493846297016`*^9, {3.942850052822735*^9, 
   3.9428500750204296`*^9}, {3.9428501420583496`*^9, 
   3.9428501459492645`*^9}, {3.9428503972435436`*^9, 
   3.9428504100488663`*^9}, {3.942853049260662*^9, 3.9428530504676895`*^9}, {
   3.942853092458111*^9, 3.9428531192472134`*^9}, {3.942853353568598*^9, 
   3.9428533545898075`*^9}, {3.9428533987449627`*^9, 
   3.9428534229557915`*^9}, {3.9429231648091373`*^9, 3.942923166138708*^9}, {
   3.9429246809890385`*^9, 3.942924683690712*^9}, {3.9429247321913033`*^9, 
   3.942924732889475*^9}, {3.9429254250561047`*^9, 3.9429254513153687`*^9}, 
   3.9429254838702602`*^9, {3.9429255434986267`*^9, 3.942925560423479*^9}, {
   3.942925616054928*^9, 3.942925642339443*^9}, {3.9429261874701004`*^9, 
   3.9429262104446373`*^9}, {3.942926484765465*^9, 3.942926497715992*^9}, {
   3.94292658112232*^9, 3.9429265839319725`*^9}, {3.9429267900613174`*^9, 
   3.9429267947414474`*^9}, 3.9429268487589626`*^9, {3.94293422696509*^9, 
   3.9429342288360386`*^9}, {3.9429343606643944`*^9, 
   3.9429343661244335`*^9}, {3.942934751577406*^9, 3.9429347571734104`*^9}, {
   3.9429348102113075`*^9, 3.942934825030098*^9}, 3.9429349712800045`*^9, {
   3.942935395628916*^9, 3.9429354119468803`*^9}, {3.942935638691334*^9, 
   3.9429356840764217`*^9}, 3.9429360778661404`*^9, {3.9429361132493095`*^9, 
   3.9429361676882057`*^9}, {3.942936520458252*^9, 3.942936526243181*^9}, {
   3.9429461492206955`*^9, 3.9429461723246975`*^9}, {3.943008575399826*^9, 
   3.943008584860981*^9}, {3.943012952041334*^9, 3.9430129533912315`*^9}, {
   3.9430272878138313`*^9, 3.9430272905139027`*^9}, 3.943106855318901*^9, {
   3.943373167306566*^9, 3.943373172855282*^9}, {3.949506821079384*^9, 
   3.9495068659453564`*^9}, 3.949506917242092*^9, 3.9497598584248276`*^9, {
   3.949760070409359*^9, 3.9497601044920845`*^9}, 3.949760460544508*^9, 
   3.9497608916708984`*^9, {3.949762948031452*^9, 3.949763002752819*^9}, {
   3.9497631134323196`*^9, 3.9497631675*^9}, 3.9507094991912785`*^9, {
   3.9513981576279736`*^9, 3.9513981857803516`*^9}, 3.9513984913113213`*^9, 
   3.9513985344117413`*^9, {3.951409016177208*^9, 3.951409043131151*^9}, 
   3.9514766978093796`*^9},ExpressionUUID->"4b3eccfc-eaf3-934c-bb83-\
3f5e58677cb9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]P"}], ")"}], " ", "\[CurlyEpsilon]z"}], 
      "cp"], "+", "\[Lambda]P"}], "\[Equal]", "0"}], ",", "FOChp", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["lp", "\[CurlyPhi]"]}], "-", 
     RowBox[{"wt", " ", "\[Lambda]P"}]}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{"\[Lambda]P", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{"1", "+", "rt"}], "\[Pi]t"]}], ")"}]}], "\[Equal]", "0"}], ",",
    "FOCtp", ",", 
   RowBox[{
    RowBox[{"cp", "+", "Dp", "-", "tp", "-", 
     RowBox[{"lp", " ", "wt"}], "-", 
     FractionBox[
      RowBox[{"Dp", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "rt"}], ")"}]}], "\[Pi]t"]}], "\[Equal]", "0"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.9513981894924183`*^9, 3.9513985641536865`*^9},
 CellLabel->"Out[57]=",ExpressionUUID->"1d0aea1a-43b1-0e41-bbb6-acb2d3394f51"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.950111102759096*^9, 
  3.951476711635891*^9},ExpressionUUID->"89f46449-40bc-454b-bf12-\
432d0c41fab6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", "\n"}]], "Input",
 CellChangeTimes->{{3.9497611429836006`*^9, 3.949761153916502*^9}, 
   3.949761241954275*^9, {3.949761847467903*^9, 3.949761883688841*^9}, {
   3.9497632334362183`*^9, 3.94976333540119*^9}, {3.949763503609247*^9, 
   3.949763532627447*^9}, 3.949767441519554*^9, 3.9501752917394695`*^9, 
   3.9501753251536407`*^9, {3.9501754861258926`*^9, 3.9501754962075577`*^9}, {
   3.9514002744727097`*^9, 3.951400289656828*^9}, 3.9514003410597057`*^9, {
   3.9514767243560905`*^9, 
   3.9514767387191143`*^9}},ExpressionUUID->"73a5e06e-15c9-2347-9c11-\
545b67147ef3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["lp", "\[CurlyPhi]"], "+", 
     FractionBox[
      RowBox[{"wt", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Alpha]P"}], ")"}], " ", 
       "\[CurlyEpsilon]z"}], "cp"]}], "\[Equal]", "0"}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Alpha]P"}], ")"}], " ", 
      "\[CurlyEpsilon]z", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "rt", "-", "\[Pi]t"}], ")"}]}], 
     RowBox[{"cp", " ", "\[Pi]t"}]], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{"cp", "+", "Dp", "-", "tp", "-", 
     RowBox[{"lp", " ", "wt"}], "-", 
     FractionBox[
      RowBox[{"Dp", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "rt"}], ")"}]}], "\[Pi]t"]}], "\[Equal]", "0"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.9514003476549187`*^9},
 CellLabel->"Out[67]=",ExpressionUUID->"69f708d9-2fde-d048-a3ef-9909f0b57037"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.950111102795*^9, 
  3.950175230300829*^9},ExpressionUUID->"989a8f9c-9396-624a-b30a-\
0383185b187d"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.9495068013552494`*^9},ExpressionUUID->"93063096-b854-5642-83fe-\
da57c1f294a1"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.9483807487855415`*^9, {3.9487320822936993`*^9, 3.9487320835154877`*^9}, 
   3.951400696908432*^9},ExpressionUUID->"0708fca9-59ce-8847-af89-\
18fc69779938"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Patient", " ", "Households", " ", "multi", " ", "period", " ", 
    "Lagrangian"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "Parameters", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"params", "=", 
    RowBox[{"{", 
     RowBox[{
     "\[Beta]P", ",", "\[Alpha]P", ",", "\[Xi]P", ",", "\[CurlyEpsilon]P", ",",
       "\[Phi]", ",", 
      RowBox[{"qh", "[", "t", "]"}], ",", 
      RowBox[{"wP", "[", "t", "]"}], ",", 
      RowBox[{"rdt", "[", "t", "]"}], ",", 
      RowBox[{"\[Pi]t", "[", "t", "]"}], ",", 
      RowBox[{"cP", "[", "t", "]"}], ",", 
      RowBox[{"dP", "[", "t", "]"}], ",", 
      RowBox[{"hP", "[", "t", "]"}], ",", 
      RowBox[{"lP", "[", "t", "]"}], ",", 
      RowBox[{"\[Lambda]P", "[", "t", "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Utility", " ", "function", " ", "for", " ", "patient", " ", 
    "households"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uPatient", "[", 
     RowBox[{"cP_", ",", "cPLag_", ",", "hP_", ",", "lP_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Alpha]P"}], ")"}], " ", "\[Xi]P", " ", 
      RowBox[{"Log", "[", 
       RowBox[{"cP", "-", 
        RowBox[{"\[Alpha]P", " ", "cPLag"}]}], "]"}]}], "+", 
     RowBox[{"\[CurlyEpsilon]P", " ", 
      RowBox[{"Log", "[", "hP", "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"lP", "^", 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Phi]"}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", "\[Phi]"}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Budget", " ", "constraint", " ", "for", " ", "patient", " ", "households",
     " ", "in", " ", "period", " ", "t"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BCPatient", "[", "t_", "]"}], ":=", 
    RowBox[{
     RowBox[{"cP", "[", "t", "]"}], "+", 
     RowBox[{
      RowBox[{"qh", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"hP", "[", "t", "]"}], "-", 
        RowBox[{"hP", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], ")"}]}], "+", 
     RowBox[{"dP", "[", "t", "]"}], "-", 
     RowBox[{
      RowBox[{"wP", "[", "t", "]"}], " ", 
      RowBox[{"lP", "[", "t", "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"rdt", "[", 
           RowBox[{"t", "-", "1"}], "]"}]}], ")"}], "/", 
        RowBox[{"\[Pi]t", "[", "t", "]"}]}], ")"}], " ", 
      RowBox[{"dP", "[", 
       RowBox[{"t", "-", "1"}], "]"}]}], "-", 
     RowBox[{"tP", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Define", " ", "Lagrangian", " ", "for", " ", "two", " ", "periods", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"t", " ", "and", " ", "t"}], "+", "1"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LP", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"uPatient", "[", 
        RowBox[{
         RowBox[{"cP", "[", "t", "]"}], ",", 
         RowBox[{"cP", "[", 
          RowBox[{"t", "-", "1"}], "]"}], ",", 
         RowBox[{"hP", "[", "t", "]"}], ",", 
         RowBox[{"lP", "[", "t", "]"}]}], "]"}], "+", 
       RowBox[{
        RowBox[{"\[Lambda]P", "[", "t", "]"}], " ", 
        RowBox[{"BCPatient", "[", "t", "]"}]}]}], ")"}], "+", 
     RowBox[{"\[Beta]P", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"uPatient", "[", 
         RowBox[{
          RowBox[{"cP", "[", 
           RowBox[{"t", "+", "1"}], "]"}], ",", 
          RowBox[{"cP", "[", "t", "]"}], ",", 
          RowBox[{"hP", "[", 
           RowBox[{"t", "+", "1"}], "]"}], ",", 
          RowBox[{"lP", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{"\[Lambda]P", "[", 
          RowBox[{"t", "+", "1"}], "]"}], " ", 
         RowBox[{"BCPatient", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}]}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"First", "-", 
    RowBox[{
    "order", " ", "conditions", " ", "for", " ", "patient", " ", 
     "households"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"focCPt", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"LP", ",", 
       RowBox[{"cP", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "   ", 
  RowBox[{"(*", 
   RowBox[{
   "FOC", " ", "with", " ", "respect", " ", "to", " ", "consumption", " ", 
    RowBox[{"cP", "[", "t", "]"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"focHPt", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"LP", ",", 
       RowBox[{"hP", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "   ", 
  RowBox[{"(*", 
   RowBox[{"FOC", " ", "with", " ", "respect", " ", "to", " ", "housing", " ", 
    RowBox[{"hP", "[", "t", "]"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"focLPt", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"LP", ",", 
       RowBox[{"lP", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "   ", 
  RowBox[{"(*", 
   RowBox[{"FOC", " ", "with", " ", "respect", " ", "to", " ", "labor", " ", 
    RowBox[{"lP", "[", "t", "]"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"focDPt", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"LP", ",", 
       RowBox[{"dP", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "   ", 
  RowBox[{"(*", 
   RowBox[{"FOC", " ", "with", " ", "respect", " ", "to", " ", "deposits", " ", 
    RowBox[{"dP", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"Debugging", ":", 
    RowBox[{
    "Display", " ", "the", " ", "FOCs", " ", "before", " ", "solving"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DebugFOCs", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FOC wrt cP[t]\>\"", "->", "focCPt"}], ",", 
      RowBox[{"\"\<FOC wrt hP[t]\>\"", "->", "focHPt"}], ",", 
      RowBox[{"\"\<FOC wrt lP[t]\>\"", "->", "focLPt"}], ",", 
      RowBox[{"\"\<FOC wrt dP[t]\>\"", "->", "focDPt"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Output", " ", "the", " ", "first"}], "-", 
    RowBox[{"order", " ", "conditions"}]}], 
   "*)"}]}], "\[IndentingNewLine]", "DebugFOCs", "\n"}], "Input",
 CellChangeTimes->{{3.951400740621008*^9, 3.9514007406220016`*^9}, {
  3.951409162402775*^9, 
  3.9514091755029774`*^9}},ExpressionUUID->"192101d9-a452-ec4a-a416-\
01215e453114"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"FOC wrt cP[t]\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Alpha]P"}], ")"}], " ", "\[Xi]P"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Alpha]P"}], " ", 
         RowBox[{"cP", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
        RowBox[{"cP", "[", "t", "]"}]}]], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Alpha]P"}], ")"}], " ", "\[Alpha]P", " ", 
        "\[Beta]P", " ", "\[Xi]P"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Alpha]P"}], " ", 
         RowBox[{"cP", "[", "t", "]"}]}], "+", 
        RowBox[{"cP", "[", 
         RowBox[{"1", "+", "t"}], "]"}]}]], "+", 
      RowBox[{"\[Lambda]P", "[", "t", "]"}]}], "\[Equal]", "0"}]}], ",", 
   RowBox[{"\<\"FOC wrt hP[t]\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{
      FractionBox["\[CurlyEpsilon]P", 
       RowBox[{"hP", "[", "t", "]"}]], "+", 
      RowBox[{
       RowBox[{"qh", "[", "t", "]"}], " ", 
       RowBox[{"\[Lambda]P", "[", "t", "]"}]}], "-", 
      RowBox[{"\[Beta]P", " ", 
       RowBox[{"qh", "[", 
        RowBox[{"1", "+", "t"}], "]"}], " ", 
       RowBox[{"\[Lambda]P", "[", 
        RowBox[{"1", "+", "t"}], "]"}]}]}], "\[Equal]", "0"}]}], ",", 
   RowBox[{"\<\"FOC wrt lP[t]\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"lP", "[", "t", "]"}], "\[Phi]"]}], "-", 
      RowBox[{
       RowBox[{"wP", "[", "t", "]"}], " ", 
       RowBox[{"\[Lambda]P", "[", "t", "]"}]}]}], "\[Equal]", "0"}]}], ",", 
   RowBox[{"\<\"FOC wrt dP[t]\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Lambda]P", "[", "t", "]"}], "-", 
      FractionBox[
       RowBox[{"\[Beta]P", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"rdt", "[", "t", "]"}]}], ")"}], " ", 
        RowBox[{"\[Lambda]P", "[", 
         RowBox[{"1", "+", "t"}], "]"}]}], 
       RowBox[{"\[Pi]t", "[", 
        RowBox[{"1", "+", "t"}], "]"}]]}], "\[Equal]", "0"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.951400748258335*^9},
 CellLabel->"Out[78]=",ExpressionUUID->"5528f23b-e40d-8e49-8e6c-664d8d82e713"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.9501111028408756`*^9, 
  3.951400717124037*^9},ExpressionUUID->"331e89ae-d4d3-0148-9d6e-\
d62837cf9c8a"],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.942591478649725*^9, 3.942591478649725*^9}, 
   3.9425915249837914`*^9, {3.942591893611925*^9, 3.9425919125734234`*^9}, 
   3.9425920148237686`*^9, {3.9431068767277374`*^9, 3.9431068801445446`*^9}, {
   3.943373150584465*^9, 3.943373154683838*^9}, 3.943530733499941*^9, {
   3.9435311122916813`*^9, 3.9435311485272903`*^9}, {3.9436169128066196`*^9, 
   3.943616924451643*^9}, {3.943617362437744*^9, 3.943617382325964*^9}, {
   3.9436179521460266`*^9, 3.943617955790903*^9}, {3.9453529856666317`*^9, 
   3.9453530067840347`*^9}, {3.945361819427248*^9, 3.9453618221393833`*^9}, {
   3.9466612675401*^9, 3.9466612786488857`*^9}, {3.9466613158820724`*^9, 
   3.94666132181089*^9}, 3.9471762973235054`*^9, {3.94717643434391*^9, 
   3.9471764402908535`*^9}, 
   3.948380731015253*^9},ExpressionUUID->"9ace75de-4978-4347-8abf-\
940e21a736de"],

Cell[CellGroupData[{

Cell[BoxData[""], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.9453530115724983`*^9, {3.9453567033453445`*^9, 3.945356704812771*^9}, {
   3.9453567451134853`*^9, 3.945356790620058*^9}, 3.945361873726124*^9, 
   3.945444393223093*^9, 3.9466611651340885`*^9, 3.9466612297905045`*^9, 
   3.946661287221405*^9, 3.9466613275977764`*^9, 3.9471763760931816`*^9, {
   3.947176416060137*^9, 
   3.9471764208432503`*^9}},ExpressionUUID->"3180c1ab-5e0d-ca40-9394-\
5e86f56408d7"],

Cell[BoxData[""], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.9453530115724983`*^9, {3.9453567033453445`*^9, 3.945356704812771*^9}, {
   3.9453567451134853`*^9, 3.945356790620058*^9}, 3.945361873726124*^9, 
   3.945444393223093*^9, 3.9466611651340885`*^9, 3.9466612297905045`*^9, 
   3.946661287221405*^9, 
   3.947176360899105*^9},ExpressionUUID->"cba57453-8210-be49-9e99-\
e7c7a95b445f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Define", " ", "the", " ", "system", " ", "of", " ", "equations"}],
    "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"eqCP", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Alpha]P"}], ")"}], " ", "\[Xi]P"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Alpha]P"}], " ", 
           RowBox[{"cP", "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], "+", 
          RowBox[{"cP", "[", "t", "]"}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Alpha]P"}], ")"}], " ", "\[Alpha]P", " ", 
          "\[Beta]P", " ", "\[Xi]P"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Alpha]P"}], " ", 
           RowBox[{"cP", "[", "t", "]"}]}], "+", 
          RowBox[{"cP", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}], "+", 
       RowBox[{"\[Lambda]P", "[", "t", "]"}]}], "==", "0"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqHP", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CurlyEpsilon]P", "/", 
        RowBox[{"hP", "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"qh", "[", "t", "]"}], " ", 
        RowBox[{"\[Lambda]P", "[", "t", "]"}]}], "-", 
       RowBox[{"\[Beta]P", " ", 
        RowBox[{"qh", "[", 
         RowBox[{"t", "+", "1"}], "]"}], " ", 
        RowBox[{"\[Lambda]P", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}]}], "==", "0"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqLP", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{"lP", "[", "t", "]"}], "^", "\[Phi]"}]}], "-", 
       RowBox[{
        RowBox[{"wP", "[", "t", "]"}], " ", 
        RowBox[{"\[Lambda]P", "[", "t", "]"}]}]}], "==", "0"}]}], ";"}], "\n",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqDP", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Lambda]P", "[", "t", "]"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Beta]P", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"rdt", "[", "t", "]"}]}], ")"}], " ", 
          RowBox[{"\[Lambda]P", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], ")"}], "/", 
        RowBox[{"\[Pi]t", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}]}], "==", "0"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Solve", " ", "for", " ", 
     RowBox[{"lambda_P", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"solLambdaT", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{"eqCP", ",", 
         RowBox[{"\[Lambda]P", "[", "t", "]"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "//", "FullSimplify"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Shift", " ", "the", " ", "solution", " ", "to", " ", "obtain", " ", 
     RowBox[{"lambda_P", "[", 
      RowBox[{"t", "+", "1"}], "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"solLambdaT1", "=", 
     RowBox[{
      RowBox[{"solLambdaT", "/.", " ", 
       RowBox[{"t", "->", 
        RowBox[{"t", "+", "1"}]}]}], "//", "FullSimplify"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Substitute", " ", 
     RowBox[{"lambda_P", "[", "t", "]"}], " ", "and", " ", 
     RowBox[{"lambda_P", "[", 
      RowBox[{"t", "+", "1"}], "]"}], " ", "into", " ", "the", " ", 
     "remaining", " ", "equations"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"eqHPSub", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"eqHP", "/.", " ", "solLambdaT"}], "/.", " ", "solLambdaT1"}], 
      "//", "FullSimplify"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"eqLPSub", "=", 
     RowBox[{
      RowBox[{"eqLP", "/.", " ", "solLambdaT"}], "//", "FullSimplify"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"eqDPSub", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"eqDP", "/.", " ", "solLambdaT"}], "/.", " ", "solLambdaT1"}], 
      "//", "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Display", " ", "the", " ", "final", " ", "equations", " ", "without", " ",
      "lambda_P"}], "*)"}], "\n", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"{", 
     RowBox[{"eqHPSub", ",", "eqLPSub", ",", "eqDPSub"}], "}"}], "]"}], "\n", 
   "solLambdaT", "\n", "\[IndentingNewLine]", "\n"}]}]], "Input",
 CellChangeTimes->{{3.9471770066521263`*^9, 3.947177006654125*^9}, {
   3.9471771841496162`*^9, 3.9471772197199135`*^9}, {3.947177358902153*^9, 
   3.947177397399147*^9}, 3.947177812835148*^9, 3.9483808549701595`*^9, 
   3.9483808919548016`*^9, {3.948380978827957*^9, 3.948380994442505*^9}, {
   3.94873217108959*^9, 3.948732210490299*^9}, 3.9514012443002377`*^9, 
   3.9514016430147877`*^9, 3.951401812627945*^9, 3.951401843512556*^9, 
   3.951401948889839*^9, 3.9514019795078106`*^9, {3.951565080884676*^9, 
   3.9515650836251526`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"6cbdf14f-fcad-b24a-9b64-6f911cd48fed"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox["\[CurlyEpsilon]P", 
      RowBox[{"hP", "[", "t", "]"}]], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Alpha]P"}], ")"}], " ", "\[Xi]P", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Alpha]P"}], " ", 
           RowBox[{"cP", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
          RowBox[{"cP", "[", "t", "]"}]}]], "+", 
        FractionBox[
         RowBox[{"\[Alpha]P", " ", "\[Beta]P"}], 
         RowBox[{
          RowBox[{"\[Alpha]P", " ", 
           RowBox[{"cP", "[", "t", "]"}]}], "-", 
          RowBox[{"cP", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}]]}], ")"}], " ", 
      RowBox[{"qh", "[", "t", "]"}]}]}], "\[Equal]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Alpha]P"}], ")"}], " ", "\[Beta]P", " ", 
     "\[Xi]P", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Alpha]P"}], " ", 
          RowBox[{"cP", "[", "t", "]"}]}], "+", 
         RowBox[{"cP", "[", 
          RowBox[{"1", "+", "t"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{"\[Alpha]P", " ", "\[Beta]P"}], 
        RowBox[{
         RowBox[{"\[Alpha]P", " ", 
          RowBox[{"cP", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}], "-", 
         RowBox[{"cP", "[", 
          RowBox[{"2", "+", "t"}], "]"}]}]]}], ")"}], " ", 
     RowBox[{"qh", "[", 
      RowBox[{"1", "+", "t"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"lP", "[", "t", "]"}], "\[Phi]"], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Alpha]P"}], ")"}], " ", "\[Xi]P", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Alpha]P"}], " ", 
           RowBox[{"cP", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
          RowBox[{"cP", "[", "t", "]"}]}]], "+", 
        FractionBox[
         RowBox[{"\[Alpha]P", " ", "\[Beta]P"}], 
         RowBox[{
          RowBox[{"\[Alpha]P", " ", 
           RowBox[{"cP", "[", "t", "]"}]}], "-", 
          RowBox[{"cP", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}]]}], ")"}], " ", 
      RowBox[{"wP", "[", "t", "]"}]}]}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Alpha]P"}], ")"}], " ", "\[Xi]P", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Alpha]P"}], " ", 
          RowBox[{"cP", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"cP", "[", "t", "]"}]}]], "+", 
       FractionBox[
        RowBox[{"\[Alpha]P", " ", "\[Beta]P"}], 
        RowBox[{
         RowBox[{"\[Alpha]P", " ", 
          RowBox[{"cP", "[", "t", "]"}]}], "-", 
         RowBox[{"cP", "[", 
          RowBox[{"1", "+", "t"}], "]"}]}]], "-", 
       FractionBox[
        RowBox[{"\[Beta]P", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[Alpha]P"}], " ", 
              RowBox[{"cP", "[", "t", "]"}]}], "+", 
             RowBox[{"cP", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}]], "+", 
           FractionBox[
            RowBox[{"\[Alpha]P", " ", "\[Beta]P"}], 
            RowBox[{
             RowBox[{"\[Alpha]P", " ", 
              RowBox[{"cP", "[", 
               RowBox[{"1", "+", "t"}], "]"}]}], "-", 
             RowBox[{"cP", "[", 
              RowBox[{"2", "+", "t"}], "]"}]}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"rdt", "[", "t", "]"}]}], ")"}]}], 
        RowBox[{"\[Pi]t", "[", 
         RowBox[{"1", "+", "t"}], "]"}]]}], ")"}]}], "\[Equal]", "0"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.951401649372881*^9, 3.951401850194914*^9, 
  3.9514019910771275`*^9, 3.95156510385602*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"7534fc2b-c19a-7347-a838-1175749628d0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Lambda]P", "[", "t", "]"}], "\[Rule]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Alpha]P"}], ")"}], " ", "\[Xi]P", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Alpha]P"}], " ", 
         RowBox[{"cP", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
        RowBox[{"cP", "[", "t", "]"}]}]], "+", 
      FractionBox[
       RowBox[{"\[Alpha]P", " ", "\[Beta]P"}], 
       RowBox[{
        RowBox[{"\[Alpha]P", " ", 
         RowBox[{"cP", "[", "t", "]"}]}], "-", 
        RowBox[{"cP", "[", 
         RowBox[{"1", "+", "t"}], "]"}]}]]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.951401649372881*^9, 3.951401850194914*^9, 
  3.9514019910771275`*^9, 3.951565103861185*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"f9cab0d0-9845-224a-947c-34484fc574bd"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.9501111028568726`*^9, 
  3.9514012240940876`*^9},ExpressionUUID->"7c3554d3-4946-fd4b-bc7b-\
7e9e3ebaec7b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.9501111028588505`*^9, 
  3.95140121182708*^9},ExpressionUUID->"0c1908c2-3a31-d14e-ab3a-e4b82587ec48"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{{3.9471770066521263`*^9, 3.947177006654125*^9}, {
   3.9471771841496162`*^9, 3.9471772197199135`*^9}, {3.947177358902153*^9, 
   3.947177397399147*^9}, 3.947177812835148*^9, 
   3.949488593344095*^9},ExpressionUUID->"4978f1f1-0572-b84b-b184-\
a61a2eb98030"],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9471770066521263`*^9, 3.947177006654125*^9}, {
   3.9471771841496162`*^9, 3.9471772197199135`*^9}, {3.947177358902153*^9, 
   3.947177397399147*^9}, 3.947177812835148*^9, {3.949488593344095*^9, 
   3.94948859878549*^9}},ExpressionUUID->"45d14f52-30e0-da46-9903-\
bc98c6f0cfcd"],

Cell[CellGroupData[{

Cell[BoxData[""], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.9453530115724983`*^9, {3.9453567033453445`*^9, 3.945356704812771*^9}, {
   3.9453567451134853`*^9, 3.945356790620058*^9}, 3.945361873726124*^9, 
   3.945444393223093*^9, 3.9466611651340885`*^9, 3.9466612297905045`*^9, 
   3.947176336343334*^9},ExpressionUUID->"3b40c5c1-cbf0-244a-912a-\
65c58f9ab2e4"],

Cell[BoxData[""], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.9453530115724983`*^9, {3.9453567033453445`*^9, 3.945356704812771*^9}, {
   3.9453567451134853`*^9, 3.945356790620058*^9}, 3.945361873726124*^9, 
   3.945444393223093*^9, 
   3.9466611651340885`*^9},ExpressionUUID->"3dd3e17b-7b29-3d40-970d-\
7f04b4476b62"]
}, Open  ]]
}, Open  ]],

Cell["", "Text",
 CellChangeTimes->{{3.948381791916382*^9, 3.9483818207745*^9}, 
   3.948381854840227*^9},ExpressionUUID->"a69b7710-0a9d-1846-91aa-\
7a4298560cda"],

Cell[BoxData[
 RowBox[{"\n", "\n"}]], "Input",
 CellChangeTimes->{
  3.948381881067642*^9, {3.948382221302662*^9, 3.948382245748192*^9}, {
   3.9483822965825863`*^9, 3.9483823421609554`*^9}, 3.9483823813971424`*^9, 
   3.948382423237911*^9, 3.9484541616896267`*^9, {3.94873227466889*^9, 
   3.9487322905274315`*^9}, {3.9487323540735054`*^9, 3.94873241161858*^9}, {
   3.9488224649084167`*^9, 3.9488224943983135`*^9}, 
   3.9514011863868694`*^9},ExpressionUUID->"42a8e955-c96a-7241-b392-\
ab997b076293"],

Cell["", "Text",
 CellChangeTimes->{{3.948381791916382*^9, 
  3.948381823237238*^9}},ExpressionUUID->"b6a1118c-8d19-934d-bab1-\
26bb44974ff4"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{3.9471778347934628`*^9, 
  3.9483813188468075`*^9},ExpressionUUID->"aec07186-9953-eb4b-a898-\
e758c5d4aabf"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\n", "\n", "\n", "\n",
   "\[IndentingNewLine]", "\n"}]], "Input",
 CellChangeTimes->{{3.949160548335102*^9, 3.949160548336027*^9}, 
   3.9491606160273876`*^9, {3.9491608682781734`*^9, 3.949160905430361*^9}, {
   3.9491630254841213`*^9, 3.949163068362707*^9}, {3.949399970990902*^9, 
   3.9494000089316673`*^9}},ExpressionUUID->"665ccb08-e918-c74f-86bd-\
79b899402612"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9472605060053177`*^9, 3.9472605107869415`*^9}, {
   3.9472605593338985`*^9, 3.947260564568186*^9}, {3.9472627523949776`*^9, 
   3.9472627563084297`*^9}, 3.947263042091564*^9, {3.9476129373485565`*^9, 
   3.947612939510252*^9}, {3.9476132526794376`*^9, 3.9476132613216953`*^9}, {
   3.9476132917043533`*^9, 3.9476132994810257`*^9}, {3.947689046932955*^9, 
   3.947689049203066*^9}, {3.947689131070076*^9, 3.947689139681988*^9}, 
   3.947690286768343*^9, {3.9479488066840305`*^9, 3.947948848141241*^9}, 
   3.9483813041174603`*^9, {3.9487324460448093`*^9, 3.948732452103302*^9}, {
   3.948732498769882*^9, 3.948732539387699*^9}, 3.9487325701348076`*^9, {
   3.9488225935967216`*^9, 
   3.948822671563921*^9}},ExpressionUUID->"dc40e394-a162-e344-af1c-\
469b5ff19c55"],

Cell[BoxData[""], "Input",ExpressionUUID->"7a834a5d-16f4-cc45-8b91-2c83acb7bfcf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"loglin", " ", "equation"}], " ", "*)"}], 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "1.", " ", "Clear", " ", "anD", " ", "Declare", " ", "all", " ", 
    "variables", " ", "as", " ", 
    RowBox[{"symbols", "."}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "cpTm1", ",", "cpT", ",", "cpTp1", ",", "cpTp2", ",", "rtT", ",", 
      "pitTp1", ",", "a", ",", "xiP", ",", "betaP", ",", "t", ",", "cpBar", ",",
       "rtBar", ",", "pitBar", ",", "cpHatTm1", ",", "cpHatT", ",", 
      "cpHatTp1", ",", "cpHatTp2", ",", "rtHatT", ",", "pitHatTp1"}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Optionally", ",", 
     RowBox[{
      RowBox[{"loaD", " ", "them", " ", "as", " ", 
       RowBox[{"symbols", ":", 
        RowBox[{"Symbol", "/@", 
         RowBox[{"{", 
          
          RowBox[{"\"\<cpTm1\>\"", ",", "\"\<cpT\>\"", ",", "\"\<cpTp1\>\"", 
           ",", "\"\<cpTp2\>\"", ",", "\"\<rtT\>\"", ",", "\"\<pitTp1\>\"", 
           ",", "\"\<a\>\"", ",", "\"\<xiP\>\"", ",", "\"\<betaP\>\"", 
           ",", "\"\<t\>\"", ",", "\"\<cpBar\>\"", ",", "\"\<rtBar\>\"", 
           ",", "\"\<pitBar\>\"", ",", "\"\<cpHatTm1\>\"", 
           ",", "\"\<cpHatT\>\"", ",", "\"\<cpHatTp1\>\"", 
           ",", "\"\<cpHatTp2\>\"", ",", "\"\<rtHatT\>\"", 
           ",", "\"\<pitHatTp1\>\""}], "}"}]}]}]}], ";"}]}], "*)"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "2.", " ", "Define", " ", "the", " ", "original", " ", "equation", " ", 
      "F", 
      RowBox[{"(", "...", ")"}]}], "==", "0."}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{
      "cpTm1_", ",", "cpT_", ",", "cpTp1_", ",", "cpTp2_", ",", "rtT_", ",", 
       "pitTp1_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "a"}], ")"}], "*", "xiP", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "a"}], "*", "cpTm1"}], "+", "cpT"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "*", 
            RowBox[{"betaP", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", "*", "cpT"}], "-", "cpTp1"}], ")"}]}]}], ")"}]}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "a"}], ")"}], "*", 
          RowBox[{"betaP", "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "t"}], ")"}]}], "*", "xiP", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "a"}], "*", "cpT"}], "+", "cpTp1"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"a", "*", 
               RowBox[{"betaP", "^", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "t"}], ")"}]}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", "*", "cpTp1"}], "-", "cpTp2"}], ")"}]}]}], ")"}], 
          "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", "rtT"}], ")"}]}], ")"}], "/", "pitTp1"}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "Specify", " ", "the", " ", "list", " ", "of", " ", 
     "variables", " ", "to", " ", "Differentiate", " ", "with", " ", 
     "respect", " ", 
     RowBox[{"to", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{
      "cpTm1", ",", "cpT", ",", "cpTp1", ",", "cpTp2", ",", "rtT", ",", 
       "pitTp1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "4.", " ", "Compute", " ", "the", " ", "partial", " ", "Derivatives", " ",
       "of", " ", "F", " ", "with", " ", "respect", " ", "to", " ", "each", " ",
       "variable"}], ",", 
     RowBox[{
      RowBox[{"evaluating", " ", "at", " ", "steaDy", " ", 
       RowBox[{"state", ".", "We"}], " ", "assume", " ", "that", " ", "in", " ",
        "steaDy", " ", 
       RowBox[{"state", ":", 
        RowBox[{"cp", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}]}], "=", 
      RowBox[{
       RowBox[{"cp", "[", "t", "]"}], "=", 
       RowBox[{
        RowBox[{"cp", "[", 
         RowBox[{"t", "+", "1"}], "]"}], "=", 
        RowBox[{
         RowBox[{"cp", "[", 
          RowBox[{"t", "+", "2"}], "]"}], "=", "cpBar"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"rt", "[", "t", "]"}], "=", "rtBar"}], ",", 
     RowBox[{
      RowBox[{"anD", " ", 
       RowBox[{"pit", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], "=", 
      RowBox[{"pitBar", "."}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"cpTm1", "->", "cpBar"}], ",", 
          RowBox[{"cpT", "->", "cpBar"}], ",", 
          RowBox[{"cpTp1", "->", "cpBar"}], ",", 
          RowBox[{"cpTp2", "->", "cpBar"}], ",", 
          RowBox[{"rtT", "->", "rtBar"}], ",", 
          RowBox[{"pitTp1", "->", "pitBar"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"5.", " ", "Define", " ", "symbols", " ", "for", " ", "log"}], "-", 
     RowBox[{"Deviations", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "cpHatTm1", ",", "cpHatT", ",", "cpHatTp1", ",", "cpHatTp2", ",", 
      "rtHatT", ",", "pitHatTp1"}], "]"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
       "6.", " ", "Multiply", " ", "each", " ", "partial", " ", "Derivative", 
        " ", "by", " ", "the", " ", "steaDy", " ", "state", " ", "value", " ",
         "of", " ", "its", " ", "variable", " ", "anD", " ", "its", " ", 
        "corresponDing", " ", "log"}], "-", 
       RowBox[{
        RowBox[{"Deviation", ".", "The"}], " ", "orDer", " ", "corresponDs", " ", 
        RowBox[{"to", ":", 
         RowBox[{"cp", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}]}]}], "->", 
      RowBox[{"cpBar", "*", "cpHatTm1"}]}], ",", 
     RowBox[{
      RowBox[{"cp", "[", "t", "]"}], "->", 
      RowBox[{"cpBar", "*", "cpHatT"}]}], ",", 
     RowBox[{
      RowBox[{"cp", "[", 
       RowBox[{"t", "+", "1"}], "]"}], "->", 
      RowBox[{"cpBar", "*", "cpHatTp1"}]}], ",", 
     RowBox[{
      RowBox[{"cp", "[", 
       RowBox[{"t", "+", "2"}], "]"}], "->", 
      RowBox[{"cpBar", "*", "cpHatTp2"}]}], ",", 
     RowBox[{
      RowBox[{"rt", "[", "t", "]"}], "->", 
      RowBox[{"rtBar", "*", "rtHatT"}]}], ",", 
     RowBox[{
      RowBox[{"pit", "[", 
       RowBox[{"t", "+", "1"}], "]"}], "->", 
      RowBox[{"pitBar", "*", 
       RowBox[{"pitHatTp1", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varsBar", "=", 
     RowBox[{"{", 
      RowBox[{
      "cpBar", ",", "cpBar", ",", "cpBar", ",", "cpBar", ",", "rtBar", ",", 
       "pitBar"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", "cpBar", "*", "cpHatTm1"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", "cpBar", "*", "cpHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", "cpBar", "*", "cpHatTp1"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "*", "cpBar", "*", "cpHatTp2"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "*", "rtBar", "*", "rtHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "*", "pitBar", "*", "pitHatTp1"}]}], 
      "==", "0"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "7.", " ", "Simplify", " ", "the", " ", "final", " ", "linearizeD", " ", 
      RowBox[{"equation", ".", "Optionally"}]}], ",", 
     RowBox[{
     "replace", " ", "steaDy", " ", "state", " ", "values", " ", "with", " ", 
      "1", " ", "to", " ", "eliminate", " ", 
      RowBox[{"them", ":"}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"simplifieDLogLinEq", "=", 
     RowBox[{"Simplify", "[", "logLinEq", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"logLinEqNoBar", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"simplifieDLogLinEq", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cpBar", "->", "1"}], ",", 
         RowBox[{"rtBar", "->", "1"}], ",", 
         RowBox[{"pitBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "8.", " ", "Define", " ", "substitution", " ", "rules", " ", "to", " ", 
      "reintroDuce", " ", "time", " ", "inDices", " ", "for", " ", "the", " ",
       "log"}], "-", 
     RowBox[{"Deviations", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"timeSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cpHatTm1", "->", 
        RowBox[{"cpHat", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], ",", 
       RowBox[{"cpHatT", "->", 
        RowBox[{"cpHat", "[", "t", "]"}]}], ",", 
       RowBox[{"cpHatTp1", "->", 
        RowBox[{"cpHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"cpHatTp2", "->", 
        RowBox[{"cpHat", "[", 
         RowBox[{"t", "+", "2"}], "]"}]}], ",", 
       RowBox[{"rtHatT", "->", 
        RowBox[{"rtHat", "[", "t", "]"}]}], ",", 
       RowBox[{"pitHatTp1", "->", 
        RowBox[{"pitHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}]}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqTimeInDexeD", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Finally", ",", 
     RowBox[{
      RowBox[{"output", " ", "the", " ", "final", " ", "time"}], "-", 
      RowBox[{"inDexeD", " ", "linearizeD", " ", 
       RowBox[{"equation", ":"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"final", "=", 
    RowBox[{"FullSimplify", "[", "eqTimeInDexeD", "]"}]}], "\n"}]}]], "Input",
 CellChangeTimes->{{3.948822715947136*^9, 3.948822715947136*^9}, {
  3.951409217685196*^9, 
  3.951409248382677*^9}},ExpressionUUID->"04b06094-e411-2340-ae40-\
ed548ed14b86"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.9472605060053177`*^9, 3.9472605107869415`*^9}, {
   3.9472605593338985`*^9, 3.947260564568186*^9}, {3.9472627523949776`*^9, 
   3.9472627563084297`*^9}, 3.947263042091564*^9, {3.9476129373485565`*^9, 
   3.947612939510252*^9}, {3.9476132526794376`*^9, 3.9476132613216953`*^9}, {
   3.9476132917043533`*^9, 3.9476132994810257`*^9}, {3.947689046932955*^9, 
   3.947689049203066*^9}, {3.947689131070076*^9, 3.947689139681988*^9}, 
   3.947690286768343*^9, {3.9479488066840305`*^9, 3.947948848141241*^9}, 
   3.9483813041174603`*^9, {3.9487324460448093`*^9, 3.948732452103302*^9}, {
   3.948732498769882*^9, 3.948732539387699*^9}, 3.9487325701348076`*^9, {
   3.9488225935967216`*^9, 
   3.948822671563921*^9}},ExpressionUUID->"f0fa445f-5834-f94c-9a80-\
dd8f95a8acc3"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9472605060053177`*^9, 3.9472605107869415`*^9}, {
   3.9472605593338985`*^9, 3.947260564568186*^9}, {3.9472627523949776`*^9, 
   3.9472627563084297`*^9}, 3.947263042091564*^9, {3.9472639555408535`*^9, 
   3.9472639825124454`*^9}},ExpressionUUID->"5a156fc5-2eb4-7e48-b51d-\
4ec8fa2678b1"],

Cell[BoxData[""], "Input",ExpressionUUID->"67031162-bd98-8f49-8550-4b19913fb9a6"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.951476822853676*^9, 
  3.951476822855669*^9}},ExpressionUUID->"8dbb250f-d2e5-ea41-91a5-\
cfe2707f435d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"multi", " ", "period", " ", "impatient", " ", "households"}], " ",
    "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Parameters", " ", "anD", " ", "Variables", " ", "for", " ", "Impatient", " ",
     "HouseholDs"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"{", 
      RowBox[{"betaI", ",", "aD", ",", "phi", ",", "eps_ct", ",", "eps_ht", ",", 
       RowBox[{"cIt", "[", "t", "]"}], ",", 
       RowBox[{"cItLag", "[", "t", "]"}], ",", 
       RowBox[{"hIt", "[", "t", "]"}], ",", 
       RowBox[{"lIt", "[", "t", "]"}], ",", 
       RowBox[{"lItLag", "[", "t", "]"}], ",", 
       RowBox[{"bIt", "[", "t", "]"}], ",", 
       RowBox[{"bItLag", "[", "t", "]"}], ",", 
       RowBox[{"rBH", "[", "t", "]"}], ",", 
       RowBox[{"rBH", "[", "tLag", "]"}], ",", 
       RowBox[{"wIt", "[", "t", "]"}], ",", 
       RowBox[{"qt", "[", "t", "]"}], ",", 
       RowBox[{"pit", "[", "t", "]"}], ",", 
       RowBox[{"mLt", "[", "t", "]"}], ",", 
       RowBox[{"hItLag", "[", "t", "]"}]}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Utility", " ", "function", " ", "for", " ", "impatient", " ", 
     "householDs"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uImpatient", "[", 
      RowBox[{"cIt_", ",", "cItLag_", ",", "hIt_", ",", "lIt_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "aD"}], ")"}], " ", "eps_ct", " ", 
       RowBox[{"Log", "[", "cIt", "]"}]}], "-", 
      RowBox[{"aD", " ", 
       RowBox[{"Log", "[", "cItLag", "]"}]}], "+", 
      RowBox[{"eps_ht", " ", 
       RowBox[{"Log", "[", "hIt", "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"lIt", "^", 
         RowBox[{"(", 
          RowBox[{"1", "+", "phi"}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", "phi"}], ")"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "BuDget", " ", "constraint", " ", "for", " ", "impatient", " ", 
     "householDs", " ", "in", " ", "perioD", " ", "t"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BCImpatient", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"cIt", "[", "t", "]"}], "+", 
      RowBox[{
       RowBox[{"qt", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"hIt", "[", "t", "]"}], "-", 
         RowBox[{"hIt", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"rBH", "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ")"}], "/", 
         RowBox[{"pit", "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"bIt", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"wIt", "[", "t", "]"}], " ", 
       RowBox[{"lIt", "[", "t", "]"}]}], "-", 
      RowBox[{"bIt", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Borrowing", " ", "constraint", " ", "for", " ", "impatient", " ", 
     "householDs", " ", "in", " ", "perioD", " ", "t"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BorrowingConstraint", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"rBH", "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"bIt", "[", "t", "]"}]}], "-", 
      RowBox[{
       RowBox[{"mLt", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"qt", "[", 
          RowBox[{"t", "+", "1"}], "]"}], " ", 
         RowBox[{"hIt", "[", "t", "]"}], " ", 
         RowBox[{"pit", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "Lagrangian", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LI", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"uImpatient", "[", 
         RowBox[{
          RowBox[{"cIt", "[", "t", "]"}], ",", 
          RowBox[{"cIt", "[", 
           RowBox[{"t", "-", "1"}], "]"}], ",", 
          RowBox[{"hIt", "[", "t", "]"}], ",", 
          RowBox[{"lIt", "[", "t", "]"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{"lambDaI", "[", "t", "]"}], " ", 
         RowBox[{"BCImpatient", "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"muI", "[", "t", "]"}], " ", 
         RowBox[{"BorrowingConstraint", "[", "t", "]"}]}]}], ")"}], "+", 
      RowBox[{
       RowBox[{"betaI", "^", 
        RowBox[{"(", 
         RowBox[{"t", "+", "1"}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"uImpatient", "[", 
          RowBox[{
           RowBox[{"cIt", "[", 
            RowBox[{"t", "+", "1"}], "]"}], ",", 
           RowBox[{"cIt", "[", "t", "]"}], ",", 
           RowBox[{"hIt", "[", 
            RowBox[{"t", "+", "1"}], "]"}], ",", 
           RowBox[{"lIt", "[", 
            RowBox[{"t", "+", "1"}], "]"}]}], "]"}], "+", 
         RowBox[{
          RowBox[{"lambDaI", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"BCImpatient", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"muI", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"BorrowingConstraint", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}]}], ")"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"First", "-", 
     RowBox[{
     "orDer", " ", "conDitions", " ", "for", " ", "impatient", " ", 
      "householDs"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focCtI", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LI", ",", 
        RowBox[{"cIt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "consumption", " ", 
     RowBox[{"cIt", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focHtI", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LI", ",", 
        RowBox[{"hIt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "housing", " ", 
     RowBox[{"hIt", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focLtI", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LI", ",", 
        RowBox[{"lIt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "hours", " ", "workeD", " ", 
     RowBox[{"lIt", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focBtI", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LI", ",", 
        RowBox[{"bIt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "borrowing", " ", 
     RowBox[{"bIt", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Display", " ", "results"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DebugFOCs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<FOC wrt cIt[t]\>\"", "->", "focCtI"}], ",", 
       RowBox[{"\"\<FOC wrt hIt[t]\>\"", "->", "focHtI"}], ",", 
       RowBox[{"\"\<FOC wrt lIt[t]\>\"", "->", "focLtI"}], ",", 
       RowBox[{"\"\<FOC wrt bIt[t]\>\"", "->", "focBtI"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Output", " ", "the", " ", "Lagrangian", " ", "anD", " ", "FOCs"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Lagrangian\>\"", "->", "LI"}], ",", 
     RowBox[{"\"\<First-OrDer ConDitions\>\"", "->", "DebugFOCs"}]}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{
  3.9428556216292534`*^9, 3.9428558638346443`*^9, 3.942856329183136*^9, 
   3.9428564862004185`*^9, 3.9428566889696026`*^9, {3.942856910773079*^9, 
   3.9428569354905777`*^9}, {3.942857364787548*^9, 3.9428573898232937`*^9}, {
   3.9428577783808823`*^9, 3.9428578049808903`*^9}, 3.9428579940329285`*^9, {
   3.9428580395093536`*^9, 3.942858042871578*^9}, 3.9428591140860786`*^9, 
   3.9431155151779137`*^9, {3.9431158839568024`*^9, 3.943115919462967*^9}, {
   3.943116017131489*^9, 3.943116043165043*^9}, {3.943116203605345*^9, 
   3.943116248865116*^9}, 3.943116279396555*^9, {3.9431165276830425`*^9, 
   3.943116567202736*^9}, {3.94311672191103*^9, 3.943116753600672*^9}, {
   3.943116983151354*^9, 3.9431169998925896`*^9}, {3.9431182676864986`*^9, 
   3.943118310423565*^9}, {3.9431188651155624`*^9, 3.9431188743868217`*^9}, {
   3.9431189471438274`*^9, 3.943118963078903*^9}, {3.9431190017983513`*^9, 
   3.9431190163987827`*^9}, 3.9431844617301445`*^9, {3.943184531994499*^9, 
   3.9431845466193027`*^9}, {3.9431847557619095`*^9, 3.943184775501425*^9}, {
   3.943359097367693*^9, 3.943359119211834*^9}, 3.943368823503065*^9, 
   3.9433689041234646`*^9, 3.9433690047130775`*^9, {3.943372602202656*^9, 
   3.9433726292470894`*^9}, 3.9433731892332497`*^9, 3.943373405777813*^9, 
   3.943373880790806*^9, 3.9435298263594894`*^9, {3.943531181261368*^9, 
   3.943531227021929*^9}, 3.943533171298271*^9, {3.9435333243153496`*^9, 
   3.9435333617947254`*^9}, 3.9435362777779655`*^9, 3.9435367592692184`*^9, {
   3.9435380153508034`*^9, 3.943538038666689*^9}, {3.943548833672926*^9, 
   3.9435488363959446`*^9}, 3.9435490988596954`*^9, {3.9435491348483696`*^9, 
   3.943549140611929*^9}, {3.9435492777151756`*^9, 3.9435492934218426`*^9}, {
   3.943616506312252*^9, 3.9436165507183113`*^9}, {3.9436180500715656`*^9, 
   3.9436180530685368`*^9}, {3.945173009921896*^9, 3.945173031726755*^9}, {
   3.9451733102613754`*^9, 3.945173337662203*^9}, 3.9463751018555126`*^9, 
   3.9463802729152527`*^9, {3.946380978417076*^9, 3.9463810300157757`*^9}, 
   3.946396126499422*^9, 3.946397331734724*^9, 3.946398470666641*^9, 
   3.9463985289595127`*^9, 3.9463986259487324`*^9, {3.9464011586499176`*^9, 
   3.9464011613548775`*^9}, {3.9464016694565735`*^9, 
   3.9464017233964157`*^9}, {3.946402820333645*^9, 3.9464028291536007`*^9}, {
   3.9464035597819443`*^9, 3.946403566628748*^9}, {3.9514093220769672`*^9, 
   3.951409379722124*^9}},ExpressionUUID->"94fcf45b-6f21-634c-b1d5-\
7d0ae8a5c58d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"Lagrangian\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"lIt", "[", "t", "]"}], 
        RowBox[{"1", "+", "phi"}]], 
       RowBox[{"1", "+", "phi"}]]}], "-", 
     RowBox[{"aD", " ", 
      RowBox[{"Log", "[", 
       RowBox[{"cIt", "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "t"}], "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "aD"}], ")"}], " ", 
      RowBox[{"Log", "[", 
       RowBox[{"cIt", "[", "t", "]"}], "]"}], " ", "eps_ct"}], "+", 
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{"hIt", "[", "t", "]"}], "]"}], " ", "eps_ht"}], "+", 
     RowBox[{
      RowBox[{"muI", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"hIt", "[", "t", "]"}]}], " ", 
         RowBox[{"mLt", "[", "t", "]"}], " ", 
         RowBox[{"pit", "[", 
          RowBox[{"1", "+", "t"}], "]"}], " ", 
         RowBox[{"qt", "[", 
          RowBox[{"1", "+", "t"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"bIt", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"rBH", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"lambDaI", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"bIt", "[", "t", "]"}]}], "+", 
        RowBox[{"cIt", "[", "t", "]"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"hIt", "[", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
           RowBox[{"hIt", "[", "t", "]"}]}], ")"}], " ", 
         RowBox[{"qt", "[", "t", "]"}]}], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"bIt", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"rBH", "[", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], "]"}]}], ")"}]}], 
         RowBox[{"pit", "[", "t", "]"}]], "-", 
        RowBox[{
         RowBox[{"lIt", "[", "t", "]"}], " ", 
         RowBox[{"wIt", "[", "t", "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["betaI", 
       RowBox[{"1", "+", "t"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"lIt", "[", 
            RowBox[{"1", "+", "t"}], "]"}], 
           RowBox[{"1", "+", "phi"}]], 
          RowBox[{"1", "+", "phi"}]]}], "-", 
        RowBox[{"aD", " ", 
         RowBox[{"Log", "[", 
          RowBox[{"cIt", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "aD"}], ")"}], " ", 
         RowBox[{"Log", "[", 
          RowBox[{"cIt", "[", 
           RowBox[{"1", "+", "t"}], "]"}], "]"}], " ", "eps_ct"}], "+", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"hIt", "[", 
           RowBox[{"1", "+", "t"}], "]"}], "]"}], " ", "eps_ht"}], "+", 
        RowBox[{
         RowBox[{"muI", "[", 
          RowBox[{"1", "+", "t"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"hIt", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}], " ", 
            RowBox[{"mLt", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"pit", "[", 
             RowBox[{"2", "+", "t"}], "]"}], " ", 
            RowBox[{"qt", "[", 
             RowBox[{"2", "+", "t"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"bIt", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rBH", "[", 
               RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"lambDaI", "[", 
          RowBox[{"1", "+", "t"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"bIt", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], "+", 
           RowBox[{"cIt", "[", 
            RowBox[{"1", "+", "t"}], "]"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"hIt", "[", "t", "]"}]}], "+", 
              RowBox[{"hIt", "[", 
               RowBox[{"1", "+", "t"}], "]"}]}], ")"}], " ", 
            RowBox[{"qt", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"bIt", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rBH", "[", "t", "]"}]}], ")"}]}], 
            RowBox[{"pit", "[", 
             RowBox[{"1", "+", "t"}], "]"}]], "-", 
           RowBox[{
            RowBox[{"lIt", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"wIt", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{"\<\"First-OrDer ConDitions\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\<\"FOC wrt cIt[t]\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"aD", " ", 
            SuperscriptBox["betaI", 
             RowBox[{"1", "+", "t"}]]}], 
           RowBox[{"cIt", "[", "t", "]"}]]}], "+", 
         RowBox[{"lambDaI", "[", "t", "]"}], "+", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "aD"}], ")"}], " ", "eps_ct"}], 
          RowBox[{"cIt", "[", "t", "]"}]]}], "\[Equal]", "0"}]}], ",", 
      RowBox[{"\<\"FOC wrt hIt[t]\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{
         FractionBox["eps_ht", 
          RowBox[{"hIt", "[", "t", "]"}]], "+", 
         RowBox[{
          RowBox[{"lambDaI", "[", "t", "]"}], " ", 
          RowBox[{"qt", "[", "t", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["betaI", 
           RowBox[{"1", "+", "t"}]], " ", 
          RowBox[{"lambDaI", "[", 
           RowBox[{"1", "+", "t"}], "]"}], " ", 
          RowBox[{"qt", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"mLt", "[", "t", "]"}], " ", 
          RowBox[{"muI", "[", "t", "]"}], " ", 
          RowBox[{"pit", "[", 
           RowBox[{"1", "+", "t"}], "]"}], " ", 
          RowBox[{"qt", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}]}], "\[Equal]", "0"}]}], ",", 
      RowBox[{"\<\"FOC wrt lIt[t]\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"lIt", "[", "t", "]"}], "phi"]}], "-", 
         RowBox[{
          RowBox[{"lambDaI", "[", "t", "]"}], " ", 
          RowBox[{"wIt", "[", "t", "]"}]}]}], "\[Equal]", "0"}]}], ",", 
      RowBox[{"\<\"FOC wrt bIt[t]\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"lambDaI", "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"muI", "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"rBH", "[", "t", "]"}]}], ")"}]}], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox["betaI", 
            RowBox[{"1", "+", "t"}]], " ", 
           RowBox[{"lambDaI", "[", 
            RowBox[{"1", "+", "t"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"rBH", "[", "t", "]"}]}], ")"}]}], 
          RowBox[{"pit", "[", 
           RowBox[{"1", "+", "t"}], "]"}]]}], "\[Equal]", "0"}]}]}], 
     "}"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.9514047797194595`*^9},
 CellLabel->
  "Out[119]=",ExpressionUUID->"194248a8-00ed-fc49-88d9-41c4ce9dc562"]
}, Open  ]],

Cell[BoxData[""], "Input",ExpressionUUID->"b9ef39e2-d105-c74c-ae1b-589fe4deab77"],

Cell[BoxData[
 RowBox[{"\n", "\n", "\n", "\[IndentingNewLine]", 
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]}]], "Input",
 CellChangeTimes->{
  3.946400316124754*^9, 3.9464005812752533`*^9, {3.94640143677759*^9, 
   3.9464014829991436`*^9}, {3.946401823560726*^9, 3.946401836477703*^9}, 
   3.946403333041109*^9},ExpressionUUID->"8880107c-6260-f84b-9c38-\
4d69438e0d38"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", 
   RowBox[{"Define", " ", "FOC", " ", "wrt", " ", 
    RowBox[{"cIt", "[", "t", "]"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"eq1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"aD", " ", 
            RowBox[{"betaI", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}]}], ")"}], "/", 
          RowBox[{"cIt", "[", "t", "]"}]}], ")"}]}], "+", 
       RowBox[{"lambDaI", "[", "t", "]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "aD"}], ")"}], " ", "eps_ct"}], ")"}], "/", 
        RowBox[{"cIt", "[", "t", "]"}]}]}], "==", "0"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"1", ")"}], " ", "Solve", " ", "eq1", " ", "for", " ", 
     RowBox[{"lambDaI", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solLambDa", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"eq1", ",", 
       RowBox[{"lambDaI", "[", "t", "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Result", " ", "gives", " ", 
      RowBox[{"lambDaI", "[", "t", "]"}], " ", "in", " ", "terms", " ", "of", 
      " ", "aD"}], ",", "betaI", ",", "eps_ct", ",", 
     RowBox[{"anD", " ", 
      RowBox[{"cIt", "[", "t", "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Define", " ", "other", " ", "FOCs"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focSystem", "=", 
     RowBox[{"{", 
      RowBox[{"(*", 
       RowBox[{"FOC", " ", "wrt", " ", 
        RowBox[{"hIt", "[", "t", "]"}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"eps_ht", "/", 
          RowBox[{"hIt", "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"lambDaI", "[", "t", "]"}], " ", 
          RowBox[{"qt", "[", "t", "]"}]}], "-", 
         RowBox[{
          RowBox[{"betaI", "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "t"}], ")"}]}], " ", 
          RowBox[{"lambDaI", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"qt", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"mLt", "[", "t", "]"}], " ", 
          RowBox[{"muI", "[", "t", "]"}], " ", 
          RowBox[{"pit", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"qt", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}]}], "==", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"lIt", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{
           RowBox[{"lIt", "[", "t", "]"}], "^", "phi"}]}], "-", 
         RowBox[{
          RowBox[{"lambDaI", "[", "t", "]"}], " ", 
          RowBox[{"wIt", "[", "t", "]"}]}]}], "==", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"bIt", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"lambDaI", "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"muI", "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"rBH", "[", "t", "]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betaI", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}], " ", 
            RowBox[{"lambDaI", "[", 
             RowBox[{"t", "+", "1"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rBH", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"pit", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}]}], "==", "0"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"2", ")"}], " ", "Use", " ", "time", " ", "iDentity"}], ",", 
     RowBox[{
      RowBox[{"lambDaI", "[", 
       RowBox[{"t", "+", "1"}], "]"}], " ", "anD", " ", 
      RowBox[{"lambDaI", "[", 
       RowBox[{"t", "-", "1"}], "]"}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"lambDaNext", "=", 
     RowBox[{"solLambDa", "/.", " ", 
      RowBox[{"t", "->", 
       RowBox[{"t", "+", "1"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"lambDaPrev", "=", 
     RowBox[{"solLambDa", "/.", " ", 
      RowBox[{"t", "->", 
       RowBox[{"t", "-", "1"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"3", ")"}], " ", "Substitute", " ", "solution", " ", "into", " ",
      "the", " ", "system", " ", "of", " ", "FOCs"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focSystemSub", "=", 
     RowBox[{
      RowBox[{"focSystem", "/.", " ", 
       RowBox[{"solLambDa", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "/.", " ", 
      RowBox[{"lambDaNext", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Print", " ", "the", " ", "system", " ", "of", " ", "equations", " ", 
     "after", " ", "substitution"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<System of equations after substitution: \>\"", ",", 
      "focSystemSub"}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Solve", " ", "for", " ", "remaining", " ", "variables"}], "*)"}],
    "\n", 
   RowBox[{
    RowBox[{"solution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"focSystemSub", ",", 
       RowBox[{"{", 
        RowBox[{"muI", "[", "t", "]"}], 
        RowBox[{"(*", 
         RowBox[{
         "ADD", " ", "other", " ", "variables", " ", "if", " ", "neeDeD"}], 
         "*)"}], "}"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Example", ":", 
     RowBox[{"Substitute", " ", 
      RowBox[{"muI", "[", "t", "]"}], " ", "from", " ", "FOC", " ", "wrt", " ", 
      RowBox[{"bIt", "[", "t", "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"muISolution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"focSystemSub", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"muI", "[", "t", "]"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Substitute", " ", 
     RowBox[{"muI", "[", "t", "]"}], " ", "into", " ", "FOC", " ", "wrt", " ", 
     RowBox[{"hIt", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq1Sub", "=", 
     RowBox[{
      RowBox[{"focSystemSub", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/.", " ", 
      RowBox[{"muISolution", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Keep", " ", "FOC", " ", "wrt", " ", 
     RowBox[{"lIt", "[", "t", "]"}], " ", "unchangeD"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq2", "=", 
     RowBox[{"focSystemSub", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Print", " ", "results"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Equation wrt hIt[t] after elimination of muI[t]: \>\"", ",",
       "eq1Sub"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Equation wrt lIt[t] remains: \>\"", ",", "eq2"}], "]"}], 
    ";"}], "\[IndentingNewLine]", "solLambDa", "\[IndentingNewLine]", 
   "lambDaNext", "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Define", " ", "equations", " ", "with", " ", "Greek", " ", "letters"}], 
    "*)"}], 
   RowBox[{
    RowBox[{"eqLIt", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{"lI", "[", "t", "]"}], "^", "\[Phi]"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Alpha]D", " ", 
             RowBox[{"\[Beta]I", "^", 
              RowBox[{"(", 
               RowBox[{"1", "+", "t"}], ")"}]}]}], "-", "\[CurlyEpsilon]z", "+", 
            RowBox[{"\[Alpha]D", " ", "\[CurlyEpsilon]z"}]}], ")"}], " ", 
          RowBox[{"wI", "[", "t", "]"}]}], ")"}], "/", 
        RowBox[{"cI", "[", "t", "]"}]}]}], "==", "0"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqHIt", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CurlyEpsilon]h", "/", 
        RowBox[{"hI", "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Alpha]D", " ", 
             RowBox[{"\[Beta]I", "^", 
              RowBox[{"(", 
               RowBox[{"1", "+", "t"}], ")"}]}]}], "-", "\[CurlyEpsilon]z", "+", 
            RowBox[{"\[Alpha]D", " ", "\[CurlyEpsilon]z"}]}], ")"}], " ", 
          RowBox[{"qh", "[", "t", "]"}]}], ")"}], "/", 
        RowBox[{"cI", "[", "t", "]"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Beta]I", "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "t"}], ")"}]}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Alpha]D", " ", 
             RowBox[{"\[Beta]I", "^", 
              RowBox[{"(", 
               RowBox[{"2", "+", "t"}], ")"}]}]}], "-", "\[CurlyEpsilon]z", "+", 
            RowBox[{"\[Alpha]D", " ", "\[CurlyEpsilon]z"}]}], ")"}], " ", 
          RowBox[{"qh", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}], ")"}], "/", 
        RowBox[{"cI", "[", 
         RowBox[{"1", "+", "t"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mI", "[", "t", "]"}], " ", 
          RowBox[{"\[Pi]", "[", 
           RowBox[{"1", "+", "t"}], "]"}], " ", 
          RowBox[{"qh", "[", 
           RowBox[{"1", "+", "t"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Alpha]D", " ", 
                RowBox[{"\[Beta]I", "^", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", "t"}], ")"}]}]}], "-", "\[CurlyEpsilon]z",
                "+", 
               RowBox[{"\[Alpha]D", " ", "\[CurlyEpsilon]z"}]}], ")"}], "/", 
             RowBox[{"cI", "[", "t", "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Beta]I", "^", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "t"}], ")"}]}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Alpha]D", " ", 
                  RowBox[{"\[Beta]I", "^", 
                   RowBox[{"(", 
                    RowBox[{"2", "+", "t"}], ")"}]}]}], "-", 
                 "\[CurlyEpsilon]z", "+", 
                 RowBox[{"\[Alpha]D", " ", "\[CurlyEpsilon]z"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"rBH", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"cI", "[", 
                RowBox[{"1", "+", "t"}], "]"}], " ", 
               RowBox[{"\[Pi]", "[", 
                RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"rBH", "[", "t", "]"}]}], ")"}]}]}], "==", "0"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Display", " ", "the", " ", "equations"}], "*)"}], "\n", 
   RowBox[{"{", 
    RowBox[{"eqLIt", ",", "eqHIt"}], "}"}], "\n", "\n"}]}]], "Input",
 CellChangeTimes->{
  3.942592057012724*^9, {3.942592245428005*^9, 3.94259229837319*^9}, {
   3.94259276149564*^9, 3.942592764239746*^9}, {3.9425935259046726`*^9, 
   3.942593548727476*^9}, 3.9425936374098434`*^9, {3.942594582938095*^9, 
   3.942594602603157*^9}, 3.9425946466589737`*^9, {3.9425949113557167`*^9, 
   3.9425949911134377`*^9}, 3.942595094281233*^9, {3.942595174682337*^9, 
   3.942595279071537*^9}, 3.942595447132061*^9, {3.9425956151379395`*^9, 
   3.94259563994841*^9}, 3.942595669960287*^9, {3.9425959508937435`*^9, 
   3.9425959719109993`*^9}, 3.9427690351333847`*^9, 3.9427690682198257`*^9, 
   3.9427715635525856`*^9, 3.9428545977365494`*^9, 3.9430291244111385`*^9, {
   3.9430293293032436`*^9, 3.9430293321251163`*^9}, 3.943029903411661*^9, 
   3.943029935968582*^9, {3.9430300915187435`*^9, 3.9430300983569183`*^9}, 
   3.943030165224594*^9, 3.943031018565777*^9, 3.9430310525436935`*^9, 
   3.9430315909590073`*^9, {3.943031676607229*^9, 3.943031762295637*^9}, {
   3.943032046234873*^9, 3.94303207506736*^9}, {3.943032277998928*^9, 
   3.943032328893503*^9}, 3.9430323609657345`*^9, {3.9430338379985332`*^9, 
   3.9430338777026024`*^9}, {3.9430340737475815`*^9, 3.9430340995907764`*^9}, 
   3.943034138748911*^9, 3.943034215671747*^9, 3.9430955097704773`*^9, 
   3.9433588087017574`*^9, 3.9433588506085987`*^9, 3.9433604537355385`*^9, 
   3.9433690498361454`*^9, {3.943369097716297*^9, 3.9433691157514877`*^9}, {
   3.9433691779950886`*^9, 3.9433691920949574`*^9}, {3.943369408544922*^9, 
   3.943369419957775*^9}, {3.9433694534026623`*^9, 3.9433694610976887`*^9}, {
   3.9433718095535316`*^9, 3.9433718209741173`*^9}, {3.943371942155674*^9, 
   3.943371948822159*^9}, {3.943372132182953*^9, 3.9433721356424065`*^9}, {
   3.9433723369107685`*^9, 3.9433723433940105`*^9}, {3.9433725200260067`*^9, 
   3.943372539188036*^9}, 3.9433729214440956`*^9, 3.946134979625437*^9, {
   3.946135028668358*^9, 3.9461350308236866`*^9}, {3.946380295211197*^9, 
   3.946380296539772*^9}, {3.94640043978706*^9, 3.946400483226412*^9}, 
   3.9464023612987766`*^9, {3.9464025415333214`*^9, 3.9464025643481045`*^9}, {
   3.9464031878470516`*^9, 3.946403191088213*^9}, {3.9464034240072136`*^9, 
   3.9464034490416183`*^9}, {3.9488902899661713`*^9, 3.9488902933353233`*^9}, 
   3.948890337427595*^9, {3.9514064178541794`*^9, 
   3.9514064193590126`*^9}},ExpressionUUID->"b0b5f86b-cc2e-e04d-b2ed-\
4360d9e5fb4f"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"System of equations after substitution: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       FractionBox["eps_ht", 
        RowBox[{"hIt", "[", "t", "]"}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"aD", " ", 
            SuperscriptBox["betaI", 
             RowBox[{"1", "+", "t"}]]}], "-", "eps_ct", "+", 
           RowBox[{"aD", " ", "eps_ct"}]}], ")"}], " ", 
         RowBox[{"qt", "[", "t", "]"}]}], 
        RowBox[{"cIt", "[", "t", "]"}]], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["betaI", 
          RowBox[{"1", "+", "t"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"aD", " ", 
            SuperscriptBox["betaI", 
             RowBox[{"2", "+", "t"}]]}], "-", "eps_ct", "+", 
           RowBox[{"aD", " ", "eps_ct"}]}], ")"}], " ", 
         RowBox[{"qt", "[", 
          RowBox[{"1", "+", "t"}], "]"}]}], 
        RowBox[{"cIt", "[", 
         RowBox[{"1", "+", "t"}], "]"}]], "-", 
       RowBox[{
        RowBox[{"mLt", "[", "t", "]"}], " ", 
        RowBox[{"muI", "[", "t", "]"}], " ", 
        RowBox[{"pit", "[", 
         RowBox[{"1", "+", "t"}], "]"}], " ", 
        RowBox[{"qt", "[", 
         RowBox[{"1", "+", "t"}], "]"}]}]}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"lIt", "[", "t", "]"}], "phi"]}], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"aD", " ", 
            SuperscriptBox["betaI", 
             RowBox[{"1", "+", "t"}]]}], "-", "eps_ct", "+", 
           RowBox[{"aD", " ", "eps_ct"}]}], ")"}], " ", 
         RowBox[{"wIt", "[", "t", "]"}]}], 
        RowBox[{"cIt", "[", "t", "]"}]]}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"aD", " ", 
           SuperscriptBox["betaI", 
            RowBox[{"1", "+", "t"}]]}], "-", "eps_ct", "+", 
          RowBox[{"aD", " ", "eps_ct"}]}], 
         RowBox[{"cIt", "[", "t", "]"}]]}], "+", 
       RowBox[{
        RowBox[{"muI", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"rBH", "[", "t", "]"}]}], ")"}]}], "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["betaI", 
          RowBox[{"1", "+", "t"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"aD", " ", 
            SuperscriptBox["betaI", 
             RowBox[{"2", "+", "t"}]]}], "-", "eps_ct", "+", 
           RowBox[{"aD", " ", "eps_ct"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"rBH", "[", "t", "]"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"cIt", "[", 
          RowBox[{"1", "+", "t"}], "]"}], " ", 
         RowBox[{"pit", "[", 
          RowBox[{"1", "+", "t"}], "]"}]}]]}], "\[Equal]", "0"}]}], "}"}]}],
  SequenceForm[
  "System of equations after substitution: ", \
{$CellContext`hIt[$CellContext`t]^(-1) Pattern[$CellContext`eps, 
        Blank[$CellContext`ht]] + $CellContext`cIt[$CellContext`t]^(-1) \
($CellContext`aD $CellContext`betaI^(1 + $CellContext`t) - 
       Pattern[$CellContext`eps, 
        Blank[$CellContext`ct]] + $CellContext`aD Pattern[$CellContext`eps, 
          
          Blank[$CellContext`ct]]) $CellContext`qt[$CellContext`t] - \
$CellContext`betaI^(1 + $CellContext`t) $CellContext`cIt[
       1 + $CellContext`t]^(-1) ($CellContext`aD $CellContext`betaI^(
         2 + $CellContext`t) - Pattern[$CellContext`eps, 
       Blank[$CellContext`ct]] + $CellContext`aD Pattern[$CellContext`eps, 
         Blank[$CellContext`ct]]) $CellContext`qt[
      1 + $CellContext`t] - $CellContext`mLt[$CellContext`t] \
$CellContext`muI[$CellContext`t] $CellContext`pit[
      1 + $CellContext`t] $CellContext`qt[1 + $CellContext`t] == 
    0, -$CellContext`lIt[$CellContext`t]^$CellContext`phi - \
$CellContext`cIt[$CellContext`t]^(-1) ($CellContext`aD $CellContext`betaI^(
         1 + $CellContext`t) - Pattern[$CellContext`eps, 
       Blank[$CellContext`ct]] + $CellContext`aD Pattern[$CellContext`eps, 
         Blank[$CellContext`ct]]) $CellContext`wIt[$CellContext`t] == 
    0, -$CellContext`cIt[$CellContext`t]^(-1) ($CellContext`aD \
$CellContext`betaI^(1 + $CellContext`t) - Pattern[$CellContext`eps, 
        Blank[$CellContext`ct]] + $CellContext`aD Pattern[$CellContext`eps, 
          Blank[$CellContext`ct]]) + $CellContext`muI[$CellContext`t] (
       1 + $CellContext`rBH[$CellContext`t]) + $CellContext`betaI^(
        1 + $CellContext`t) $CellContext`cIt[
        1 + $CellContext`t]^(-1) ($CellContext`aD $CellContext`betaI^(
          2 + $CellContext`t) - Pattern[$CellContext`eps, 
        Blank[$CellContext`ct]] + $CellContext`aD Pattern[$CellContext`eps, 
          Blank[$CellContext`ct]]) $CellContext`pit[1 + $CellContext`t]^(-1) (
       1 + $CellContext`rBH[$CellContext`t]) == 0}],
  Editable->False]], "Print",
 CellChangeTimes->{3.9514060394044857`*^9},
 CellLabel->
  "During evaluation of \
In[151]:=",ExpressionUUID->"99c48eac-a0e0-9142-bc8a-0cb53fea0757"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Equation wrt hIt[t] after elimination of muI[t]: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     FractionBox["eps_ht", 
      RowBox[{"hIt", "[", "t", "]"}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"aD", " ", 
          SuperscriptBox["betaI", 
           RowBox[{"1", "+", "t"}]]}], "-", "eps_ct", "+", 
         RowBox[{"aD", " ", "eps_ct"}]}], ")"}], " ", 
       RowBox[{"qt", "[", "t", "]"}]}], 
      RowBox[{"cIt", "[", "t", "]"}]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["betaI", 
        RowBox[{"1", "+", "t"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"aD", " ", 
          SuperscriptBox["betaI", 
           RowBox[{"2", "+", "t"}]]}], "-", "eps_ct", "+", 
         RowBox[{"aD", " ", "eps_ct"}]}], ")"}], " ", 
       RowBox[{"qt", "[", 
        RowBox[{"1", "+", "t"}], "]"}]}], 
      RowBox[{"cIt", "[", 
       RowBox[{"1", "+", "t"}], "]"}]], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"mLt", "[", "t", "]"}], " ", 
       RowBox[{"pit", "[", 
        RowBox[{"1", "+", "t"}], "]"}], " ", 
       RowBox[{"qt", "[", 
        RowBox[{"1", "+", "t"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"aD", " ", 
            SuperscriptBox["betaI", 
             RowBox[{"1", "+", "t"}]]}], "-", "eps_ct", "+", 
           RowBox[{"aD", " ", "eps_ct"}]}], 
          RowBox[{"cIt", "[", "t", "]"}]], "-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["betaI", 
            RowBox[{"1", "+", "t"}]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"aD", " ", 
              SuperscriptBox["betaI", 
               RowBox[{"2", "+", "t"}]]}], "-", "eps_ct", "+", 
             RowBox[{"aD", " ", "eps_ct"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"rBH", "[", "t", "]"}]}], ")"}]}], 
          RowBox[{
           RowBox[{"cIt", "[", 
            RowBox[{"1", "+", "t"}], "]"}], " ", 
           RowBox[{"pit", "[", 
            RowBox[{"1", "+", "t"}], "]"}]}]]}], ")"}]}], 
      RowBox[{"1", "+", 
       RowBox[{"rBH", "[", "t", "]"}]}]]}], "\[Equal]", "0"}]}],
  SequenceForm[
  "Equation wrt hIt[t] after elimination of muI[t]: ", \
$CellContext`hIt[$CellContext`t]^(-1) Pattern[$CellContext`eps, 
       Blank[$CellContext`ht]] + $CellContext`cIt[$CellContext`t]^(-1) \
($CellContext`aD $CellContext`betaI^(1 + $CellContext`t) - 
      Pattern[$CellContext`eps, 
       Blank[$CellContext`ct]] + $CellContext`aD Pattern[$CellContext`eps, 
         Blank[$CellContext`ct]]) $CellContext`qt[$CellContext`t] - \
$CellContext`betaI^(1 + $CellContext`t) $CellContext`cIt[
      1 + $CellContext`t]^(-1) ($CellContext`aD $CellContext`betaI^(
        2 + $CellContext`t) - Pattern[$CellContext`eps, 
      Blank[$CellContext`ct]] + $CellContext`aD Pattern[$CellContext`eps, 
        Blank[$CellContext`ct]]) $CellContext`qt[
     1 + $CellContext`t] - $CellContext`mLt[$CellContext`t] $CellContext`pit[
     1 + $CellContext`t] $CellContext`qt[
     1 + $CellContext`t] (
      1 + $CellContext`rBH[$CellContext`t])^(-1) \
($CellContext`cIt[$CellContext`t]^(-1) ($CellContext`aD $CellContext`betaI^(
          1 + $CellContext`t) - Pattern[$CellContext`eps, 
        Blank[$CellContext`ct]] + $CellContext`aD Pattern[$CellContext`eps, 
          Blank[$CellContext`ct]]) - $CellContext`betaI^(
       1 + $CellContext`t) $CellContext`cIt[
       1 + $CellContext`t]^(-1) ($CellContext`aD $CellContext`betaI^(
         2 + $CellContext`t) - Pattern[$CellContext`eps, 
       Blank[$CellContext`ct]] + $CellContext`aD Pattern[$CellContext`eps, 
         Blank[$CellContext`ct]]) $CellContext`pit[1 + $CellContext`t]^(-1) (
      1 + $CellContext`rBH[$CellContext`t])) == 0],
  Editable->False]], "Print",
 CellChangeTimes->{3.9514060394114094`*^9},
 CellLabel->
  "During evaluation of \
In[151]:=",ExpressionUUID->"76e14aac-f008-9247-ad98-970a8de8d234"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Equation wrt lIt[t] remains: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox[
       RowBox[{"lIt", "[", "t", "]"}], "phi"]}], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"aD", " ", 
          SuperscriptBox["betaI", 
           RowBox[{"1", "+", "t"}]]}], "-", "eps_ct", "+", 
         RowBox[{"aD", " ", "eps_ct"}]}], ")"}], " ", 
       RowBox[{"wIt", "[", "t", "]"}]}], 
      RowBox[{"cIt", "[", "t", "]"}]]}], "\[Equal]", "0"}]}],
  SequenceForm[
  "Equation wrt lIt[t] remains: ", \
-$CellContext`lIt[$CellContext`t]^$CellContext`phi - \
$CellContext`cIt[$CellContext`t]^(-1) ($CellContext`aD $CellContext`betaI^(
        1 + $CellContext`t) - Pattern[$CellContext`eps, 
      Blank[$CellContext`ct]] + $CellContext`aD Pattern[$CellContext`eps, 
        Blank[$CellContext`ct]]) $CellContext`wIt[$CellContext`t] == 0],
  Editable->False]], "Print",
 CellChangeTimes->{3.9514060394184113`*^9},
 CellLabel->
  "During evaluation of \
In[151]:=",ExpressionUUID->"866ae9af-cacc-cf42-8f8f-373fca68e965"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"lambDaI", "[", "t", "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"aD", " ", 
       SuperscriptBox["betaI", 
        RowBox[{"1", "+", "t"}]]}], "-", "eps_ct", "+", 
      RowBox[{"aD", " ", "eps_ct"}]}], 
     RowBox[{"cIt", "[", "t", "]"}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.9514060394213943`*^9},
 CellLabel->
  "Out[164]=",ExpressionUUID->"52098315-e9ff-e247-8667-78eba5241467"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"lambDaI", "[", 
     RowBox[{"1", "+", "t"}], "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"aD", " ", 
       SuperscriptBox["betaI", 
        RowBox[{"2", "+", "t"}]]}], "-", "eps_ct", "+", 
      RowBox[{"aD", " ", "eps_ct"}]}], 
     RowBox[{"cIt", "[", 
      RowBox[{"1", "+", "t"}], "]"}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.9514060394274044`*^9},
 CellLabel->
  "Out[165]=",ExpressionUUID->"2535d51f-a0e1-874a-9613-1b58a30f0507"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.942592057012724*^9, {3.942592245428005*^9, 3.94259229837319*^9}, {
   3.94259276149564*^9, 3.942592764239746*^9}, {3.9425935259046726`*^9, 
   3.942593548727476*^9}, 3.9425936374098434`*^9, {3.942594582938095*^9, 
   3.942594602603157*^9}, 3.9425946466589737`*^9, {3.9425949113557167`*^9, 
   3.9425949911134377`*^9}, 3.942595094281233*^9, {3.942595174682337*^9, 
   3.942595279071537*^9}, 3.942595447132061*^9, {3.9425956151379395`*^9, 
   3.94259563994841*^9}, 3.942595669960287*^9, {3.9425959508937435`*^9, 
   3.9425959719109993`*^9}, 3.9427690351333847`*^9, 3.9427690682198257`*^9, 
   3.9427715635525856`*^9, 3.9428545977365494`*^9, 3.9430291244111385`*^9, {
   3.9430293293032436`*^9, 3.9430293321251163`*^9}, 3.943029903411661*^9, 
   3.943029935968582*^9, {3.9430300915187435`*^9, 3.9430300983569183`*^9}, 
   3.943030165224594*^9, 3.943031018565777*^9, 3.9430310525436935`*^9, 
   3.9430315909590073`*^9, {3.943031676607229*^9, 3.943031762295637*^9}, {
   3.943032046234873*^9, 3.94303207506736*^9}, {3.943032277998928*^9, 
   3.943032328893503*^9}, 3.9430323609657345`*^9, {3.9430338379985332`*^9, 
   3.9430338777026024`*^9}, {3.9430340737475815`*^9, 3.9430340995907764`*^9}, 
   3.943034138748911*^9, 3.943034215671747*^9, 3.9430955097704773`*^9, 
   3.9433588087017574`*^9, 3.9433588506085987`*^9, 3.9433604537355385`*^9, 
   3.9433690498361454`*^9, {3.943369097716297*^9, 3.9433691157514877`*^9}, {
   3.9433691779950886`*^9, 3.9433691920949574`*^9}, {3.943369408544922*^9, 
   3.943369419957775*^9}, {3.9433694534026623`*^9, 3.9433694610976887`*^9}, {
   3.9433718095535316`*^9, 3.9433718209741173`*^9}, {3.943371942155674*^9, 
   3.943371948822159*^9}, {3.943372132182953*^9, 3.9433721356424065`*^9}, {
   3.9433723369107685`*^9, 3.9433723433940105`*^9}, {3.9433725200260067`*^9, 
   3.943372539188036*^9}, 3.9433729214440956`*^9, 3.946134979625437*^9, {
   3.946135028668358*^9, 3.9461350308236866`*^9}, {3.946380295211197*^9, 
   3.946380296539772*^9}, {3.94640043978706*^9, 3.946400483226412*^9}, 
   3.9464023612987766`*^9, {3.9464025415333214`*^9, 3.9464025643481045`*^9}, {
   3.9464031878470516`*^9, 3.946403191088213*^9}, {3.9464034240072136`*^9, 
   3.9464034490416183`*^9}, 3.94734240899786*^9, 3.947342456115858*^9, 
   3.9476906366089897`*^9},ExpressionUUID->"5b2a032a-505e-c740-a415-\
a5a50f903e5d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Impatient", " ", "households"}], " ", "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "1.", " ", "Clear", " ", "anD", " ", "Declare", " ", "all", " ", 
    "variables", " ", "as", " ", 
    RowBox[{"symbols", "."}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "eps_ht", ",", "hIt", ",", "cIt", ",", "q", ",", "mL", ",", "pit", ",", 
      "rBH", ",", "eps_ct", ",", "aD", ",", "betaI", ",", "t", ",", "hItBar", 
      ",", "cItBar", ",", "qBar", ",", "cItBar1", ",", "qBar1", ",", "mLBar", 
      ",", "pitBar", ",", "rBHBar"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Optionally", ",", 
     RowBox[{
      RowBox[{"loaD", " ", "them", " ", "as", " ", 
       RowBox[{"symbols", ":", 
        RowBox[{"Symbol", "/@", 
         RowBox[{"{", 
          
          RowBox[{"\"\<eps_ht\>\"", ",", "\"\<hIt\>\"", ",", "\"\<cIt\>\"", 
           ",", "\"\<q\>\"", ",", "\"\<mL\>\"", ",", "\"\<pit\>\"", 
           ",", "\"\<rBH\>\"", ",", "\"\<eps_ct\>\"", ",", "\"\<aD\>\"", 
           ",", "\"\<betaI\>\"", ",", "\"\<t\>\"", ",", "\"\<hItBar\>\"", 
           ",", "\"\<cItBar\>\"", ",", "\"\<qBar\>\"", ",", "\"\<cItBar1\>\"",
            ",", "\"\<qBar1\>\"", ",", "\"\<mLBar\>\"", ",", "\"\<pitBar\>\"",
            ",", "\"\<rBHBar\>\""}], "}"}]}]}]}], ";"}]}], "*)"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "2.", " ", "Define", " ", "the", " ", "original", " ", "equation", " ", 
       "as", " ", "F", 
       RowBox[{"(", "...", ")"}]}], "==", 
      RowBox[{
      "0.", " ", "We", " ", "create", " ", "Dummy", " ", "variables", " ", 
       "for", " ", "the", " ", "time\:2011t", " ", "anD", " ", "time\:2011", 
       RowBox[{"(", 
        RowBox[{"t", "+", "1"}], ")"}], " ", 
       RowBox[{"objects", ".", 
        RowBox[{"Here", ":", 
         RowBox[{"-", "hItT"}]}]}]}]}], ",", "cItT", ",", 
     RowBox[{"qT", " ", "represent", " ", 
      RowBox[{"hIt", "[", "t", "]"}]}], ",", 
     RowBox[{"cIt", "[", "t", "]"}], ",", 
     RowBox[{"q", "[", "t", "]"}], ",", 
     RowBox[{"-", "cItT1"}], ",", "qT1", ",", 
     RowBox[{"pitT1", " ", "represent", " ", 
      RowBox[{"cIt", "[", 
       RowBox[{"1", "+", "t"}], "]"}]}], ",", 
     RowBox[{"q", "[", 
      RowBox[{"1", "+", "t"}], "]"}], ",", 
     RowBox[{"pit", "[", 
      RowBox[{"1", "+", "t"}], "]"}], ",", 
     RowBox[{
      RowBox[{"-", "mLT"}], " ", "anD", " ", "rBHt", " ", "Denote", " ", 
      RowBox[{"mL", "[", "t", "]"}], " ", "anD", " ", 
      RowBox[{
       RowBox[{"rBH", "[", "t", "]"}], "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{
      "hItT_", ",", "cItT_", ",", "qT_", ",", "cItT1_", ",", "qT1_", ",", 
       "mLT_", ",", "pitT1_", ",", "rBHt_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"eps_ht", "/", "hItT"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"aD", "*", 
            RowBox[{"betaI", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}]}], "-", "eps_ct", "+", 
           RowBox[{"aD", "*", "eps_ct"}]}], ")"}], "*", "qT"}], ")"}], "/", 
       "cItT"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"betaI", "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "t"}], ")"}]}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"aD", "*", 
            RowBox[{"betaI", "^", 
             RowBox[{"(", 
              RowBox[{"2", "+", "t"}], ")"}]}]}], "-", "eps_ct", "+", 
           RowBox[{"aD", "*", "eps_ct"}]}], ")"}], "*", "qT1"}], ")"}], "/", 
       "cItT1"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"mLT", "*", "pitT1", "*", "qT1", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"aD", "*", 
                RowBox[{"betaI", "^", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", "t"}], ")"}]}]}], "-", "eps_ct", "+", 
               RowBox[{"aD", "*", "eps_ct"}]}], ")"}], "/", "cItT"}], ")"}], "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"betaI", "^", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "t"}], ")"}]}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"aD", "*", 
                  RowBox[{"betaI", "^", 
                   RowBox[{"(", 
                    RowBox[{"2", "+", "t"}], ")"}]}]}], "-", "eps_ct", "+", 
                 RowBox[{"aD", "*", "eps_ct"}]}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{"1", "+", "rBHt"}], ")"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"cItT1", "*", "pitT1"}], ")"}]}], ")"}]}], ")"}]}], 
        ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", "rBHt"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]",
    "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"3.", " ", "Collect", " ", "the", " ", "variables", " ", 
     RowBox[{"we", "'"}], "ll", " ", "Differentiate", " ", "with", " ", 
     "respect", " ", 
     RowBox[{"to", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{
      "hItT", ",", "cItT", ",", "qT", ",", "cItT1", ",", "qT1", ",", "mLT", ",",
        "pitT1", ",", "rBHt"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "4.", " ", "Compute", " ", "partial", " ", "Derivatives", " ", "of", " ",
        "F", " ", "at", " ", "the", " ", "steaDy", " ", 
       RowBox[{"state", ".", "The"}], " ", "steaDy", " ", "state", " ", "is", 
       " ", "given", " ", "by", " ", 
       RowBox[{"replacing", ":", "hItT"}]}], "->", "hItBar"}], ",", 
     RowBox[{"cItT", "->", "cItBar"}], ",", 
     RowBox[{"qT", "->", "qBar"}], ",", 
     RowBox[{"cItT1", "->", "cItBar1"}], ",", 
     RowBox[{"qT1", "->", "qBar1"}], ",", 
     RowBox[{"mLT", "->", "mLBar"}], ",", 
     RowBox[{"pitT1", "->", "pitBar"}], ",", 
     RowBox[{"rBHt", "->", 
      RowBox[{"rBHBar", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"hItT", "->", "hItBar"}], ",", 
          RowBox[{"cItT", "->", "cItBar"}], ",", 
          RowBox[{"qT", "->", "qBar"}], ",", 
          RowBox[{"cItT1", "->", "cItBar1"}], ",", 
          RowBox[{"qT1", "->", "qBar1"}], ",", 
          RowBox[{"mLT", "->", "mLBar"}], ",", 
          RowBox[{"pitT1", "->", "pitBar"}], ",", 
          RowBox[{"rBHt", "->", "rBHBar"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"5.", " ", "Define", " ", "symbols", " ", "for", " ", "log"}], "\[Hyphen]", 
     RowBox[{"Deviations", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"D", " ", "ln", " ", "X"}], ")"}], "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "hItHatT", ",", "cItHatT", ",", "qHatT", ",", "cItHatT1", ",", "qHatT1", 
      ",", "mLHatT", ",", "pitHatT", ",", "rBHHatT"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "6.", " ", "Multiply", " ", "each", " ", "partial", " ", "Derivative", " ",
       "by", " ", "the", " ", "steaDy", " ", "state", " ", "level", " ", 
      "anD", " ", "its", " ", "corresponDing", " ", 
      RowBox[{"hat", ".", "This"}], " ", "yielDs", " ", "the", " ", 
      "linearizeD", " ", "equation", " ", "in", " ", "terms", " ", "of", " ", 
      "log"}], "\[Hyphen]", 
     RowBox[{"Deviations", "."}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"varsBar", "=", 
     RowBox[{"{", 
      RowBox[{
      "hItBar", ",", "cItBar", ",", "qBar", ",", "cItBar1", ",", "qBar1", ",",
        "mLBar", ",", "pitBar", ",", "rBHBar"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", "hItBar", "*", "hItHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", "cItBar", "*", "cItHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", "qBar", "*", "qHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "*", "cItBar1", "*", "cItHatT1"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "*", "qBar1", "*", "qHatT1"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "*", "mLBar", "*", "mLHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "7", "]"}], "]"}], "*", "pitBar", "*", "pitHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "8", "]"}], "]"}], "*", "rBHBar", "*", "rBHHatT"}]}], "==",
       "0"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"7.", " ", "Simplify", " ", "the", " ", "final", " ", "linear", " ", 
     RowBox[{"equation", "."}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"simplifieDLogLinEq", "=", 
     RowBox[{"Simplify", "[", "logLinEq", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Optionally", ",", 
     RowBox[{
     "replace", " ", "steaDy", " ", "state", " ", "values", " ", "with", " ", 
      "1", " ", "to", " ", "eliminate", " ", "them"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEqNoBar", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"simplifieDLogLinEq", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"hItBar", "->", "1"}], ",", 
         RowBox[{"cItBar", "->", "1"}], ",", 
         RowBox[{"qBar", "->", "1"}], ",", 
         RowBox[{"cItBar1", "->", "1"}], ",", 
         RowBox[{"qBar1", "->", "1"}], ",", 
         RowBox[{"mLBar", "->", "1"}], ",", 
         RowBox[{"pitBar", "->", "1"}], ",", 
         RowBox[{"rBHBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "8.", " ", "Define", " ", "substitution", " ", "rules", " ", "to", " ", 
       "reintroDuce", " ", "time", " ", 
       RowBox[{"inDices", ".", "Here"}], " ", "we", " ", 
       RowBox[{"assign", ":", "hItHatT"}]}], "->", 
      RowBox[{"hItHat", "[", "t", "]"}]}], ",", 
     RowBox[{"cItHatT", "->", 
      RowBox[{"cItHat", "[", "t", "]"}]}], ",", 
     RowBox[{"qHatT", "->", 
      RowBox[{"qHat", "[", "t", "]"}]}], ",", 
     RowBox[{"cItHatT1", "->", 
      RowBox[{"cItHat", "[", 
       RowBox[{"t", "+", "1"}], "]"}]}], ",", 
     RowBox[{"qHatT1", "->", 
      RowBox[{"qHat", "[", 
       RowBox[{"t", "+", "1"}], "]"}]}], ",", 
     RowBox[{"mLHatT", "->", 
      RowBox[{"mLHat", "[", "t", "]"}]}], ",", 
     RowBox[{"pitHatT", "->", 
      RowBox[{"pitHat", "[", 
       RowBox[{"t", "+", "1"}], "]"}]}], ",", 
     RowBox[{"rBHHatT", "->", 
      RowBox[{"rBHHat", "[", "t", "]"}]}], ",", 
     RowBox[{"anD", " ", "we", " ", "also", " ", "re"}], "\[Hyphen]", 
     RowBox[{"write", " ", "the", " ", "time"}], "\[Dash]", 
     RowBox[{"exponents", " ", "on", " ", 
      RowBox[{"betaI", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"timeSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"hItHatT", "->", 
        RowBox[{"hItHat", "[", "t", "]"}]}], ",", 
       RowBox[{"cItHatT", "->", 
        RowBox[{"cItHat", "[", "t", "]"}]}], ",", 
       RowBox[{"qHatT", "->", 
        RowBox[{"qHat", "[", "t", "]"}]}], ",", 
       RowBox[{"cItHatT1", "->", 
        RowBox[{"cItHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"qHatT1", "->", 
        RowBox[{"qHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"mLHatT", "->", 
        RowBox[{"mLHat", "[", "t", "]"}]}], ",", 
       RowBox[{"pitHatT", "->", 
        RowBox[{"pitHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"rBHHatT", "->", 
        RowBox[{"rBHHat", "[", "t", "]"}]}], ",", 
       RowBox[{
        RowBox[{"betaI", "^", 
         RowBox[{"(", 
          RowBox[{"1", "+", "t"}], ")"}]}], "->", 
        RowBox[{"betaI", "^", 
         RowBox[{"(", 
          RowBox[{"t", "+", "1"}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{"betaI", "^", 
         RowBox[{"(", 
          RowBox[{"2", "+", "t"}], ")"}]}], "->", 
        RowBox[{"betaI", "^", 
         RowBox[{"(", 
          RowBox[{"t", "+", "2"}], ")"}]}]}]}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqTimeInDexeD", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Finally", ",", 
     RowBox[{
     "output", " ", "the", " ", "versions", " ", "without", " ", "time", " ", 
      "inDices", " ", "anD", " ", "with", " ", "time", " ", 
      RowBox[{"inDices", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
   "logLinEqNoBar", "\n", 
   RowBox[{"final", " ", "=", 
    RowBox[{"FullSimplify", "[", "eqTimeInDexeD", "]"}]}], "\[IndentingNewLine]",
    "final", "\n"}]}]], "Input",
 CellChangeTimes->{
  3.942592057012724*^9, {3.942592245428005*^9, 3.94259229837319*^9}, {
   3.94259276149564*^9, 3.942592764239746*^9}, {3.9425935259046726`*^9, 
   3.942593548727476*^9}, 3.9425936374098434`*^9, {3.942594582938095*^9, 
   3.942594602603157*^9}, 3.9425946466589737`*^9, {3.9425949113557167`*^9, 
   3.9425949911134377`*^9}, 3.942595094281233*^9, {3.942595174682337*^9, 
   3.942595279071537*^9}, 3.942595447132061*^9, {3.9425956151379395`*^9, 
   3.94259563994841*^9}, 3.942595669960287*^9, {3.9425959508937435`*^9, 
   3.9425959719109993`*^9}, 3.9427690351333847`*^9, 3.9427690682198257`*^9, 
   3.9427715635525856`*^9, 3.9428545977365494`*^9, 3.9430291244111385`*^9, {
   3.9430293293032436`*^9, 3.9430293321251163`*^9}, 3.943029903411661*^9, 
   3.943029935968582*^9, {3.9430300915187435`*^9, 3.9430300983569183`*^9}, 
   3.943030165224594*^9, 3.943031018565777*^9, 3.9430310525436935`*^9, 
   3.9430315909590073`*^9, {3.943031676607229*^9, 3.943031762295637*^9}, {
   3.943032046234873*^9, 3.94303207506736*^9}, {3.943032277998928*^9, 
   3.943032328893503*^9}, 3.9430323609657345`*^9, {3.9430338379985332`*^9, 
   3.9430338777026024`*^9}, {3.9430340737475815`*^9, 3.9430340995907764`*^9}, 
   3.943034138748911*^9, 3.943034215671747*^9, 3.9430955097704773`*^9, 
   3.9433588087017574`*^9, 3.9433588506085987`*^9, 3.9433604537355385`*^9, 
   3.9433690498361454`*^9, {3.943369097716297*^9, 3.9433691157514877`*^9}, {
   3.9433691779950886`*^9, 3.9433691920949574`*^9}, {3.943369408544922*^9, 
   3.943369419957775*^9}, {3.9433694534026623`*^9, 3.9433694610976887`*^9}, {
   3.9433718095535316`*^9, 3.9433718209741173`*^9}, {3.943371942155674*^9, 
   3.943371948822159*^9}, {3.943372132182953*^9, 3.9433721356424065`*^9}, {
   3.9433723369107685`*^9, 3.9433723433940105`*^9}, {3.9433725200260067`*^9, 
   3.943372539188036*^9}, 3.9433729214440956`*^9, 3.946134979625437*^9, {
   3.946135028668358*^9, 3.9461350308236866`*^9}, {3.946380295211197*^9, 
   3.946380296539772*^9}, {3.94640043978706*^9, 3.946400483226412*^9}, 
   3.9464023612987766`*^9, {3.9464025415333214`*^9, 3.9464025643481045`*^9}, {
   3.9464031878470516`*^9, 3.946403191088213*^9}, {3.9464034240072136`*^9, 
   3.9464034490416183`*^9}, 3.94734240899786*^9, {3.947342456115858*^9, 
   3.9473425197101955`*^9}, {3.9473429805323334`*^9, 3.9473429810118866`*^9}, 
   3.947343041703169*^9, 3.9476906567326527`*^9, {3.947690980682455*^9, 
   3.9476909851086464`*^9}, {3.947691065119421*^9, 3.947691067107668*^9}, {
   3.9479502014980087`*^9, 3.9479502457827015`*^9}, {3.951409406484953*^9, 
   3.951409462081337*^9}},ExpressionUUID->"0e074e25-5497-e244-8216-\
c9871e946f7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "1.", " ", "Clear", " ", "anD", " ", "Declare", " ", "all", " ", 
    "variables", " ", "as", " ", 
    RowBox[{"symbols", "."}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "lItT", ",", "cItT", ",", "wItT", ",", "aD", ",", "betaI", ",", "eps_ct",
       ",", "phi", ",", "t", ",", "lItBar", ",", "cItBar", ",", "wItBar"}], 
     "]"}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"Optionally", ",", 
     RowBox[{
      RowBox[{"loaD", " ", "them", " ", "as", " ", 
       RowBox[{"symbols", ":", 
        RowBox[{"Symbol", "/@", 
         RowBox[{"{", 
          
          RowBox[{"\"\<lItT\>\"", ",", "\"\<cItT\>\"", ",", "\"\<wItT\>\"", 
           ",", "\"\<aD\>\"", ",", "\"\<betaI\>\"", ",", "\"\<eps_ct\>\"", 
           ",", "\"\<phi\>\"", ",", "\"\<t\>\"", ",", "\"\<lItBar\>\"", 
           ",", "\"\<cItBar\>\"", ",", "\"\<wItBar\>\""}], "}"}]}]}]}], 
      ";"}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "2.", " ", "Define", " ", "the", " ", "original", " ", "equation", " ", 
       "as", " ", "F", 
       RowBox[{"(", "...", ")"}]}], "==", 
      RowBox[{"0.", " ", "Here"}]}], ",", "lItT", ",", "cItT", ",", 
     RowBox[{"anD", " ", "wItT", " ", "corresponD", " ", "to", " ", 
      RowBox[{"lIt", "[", "t", "]"}]}], ",", 
     RowBox[{"cIt", "[", "t", "]"}], ",", 
     RowBox[{"anD", " ", 
      RowBox[{"wIt", "[", "t", "]"}]}], ",", 
     RowBox[{"respectively", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{"lItT_", ",", "cItT_", ",", "wItT_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"lItT", "^", "phi"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"aD", "*", 
            RowBox[{"betaI", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}]}], "-", "eps_ct", "+", 
           RowBox[{"aD", "*", "eps_ct"}]}], ")"}], "*", "wItT"}], ")"}], "/", 
       "cItT"}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"3.", " ", "Collect", " ", "the", " ", "variables", " ", 
     RowBox[{"we", "'"}], "ll", " ", "Differentiate", " ", "with", " ", 
     "respect", " ", 
     RowBox[{"to", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{"lItT", ",", "cItT", ",", "wItT"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "4.", " ", "Compute", " ", "partial", " ", "Derivatives", " ", "of", " ",
        "F", " ", "at", " ", "the", " ", "steaDy", " ", 
       RowBox[{"state", ".", "The"}], " ", "steaDy", " ", "state", " ", "is", 
       " ", "imposeD", " ", "by", " ", 
       RowBox[{"replacing", ":", "lItT"}]}], "->", "lItBar"}], ",", 
     RowBox[{"cItT", "->", "cItBar"}], ",", 
     RowBox[{"wItT", "->", 
      RowBox[{"wItBar", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"lItT", "->", "lItBar"}], ",", 
          RowBox[{"cItT", "->", "cItBar"}], ",", 
          RowBox[{"wItT", "->", "wItBar"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"5.", " ", "Define", " ", "symbols", " ", "for", " ", "log"}], "\[Hyphen]", 
     RowBox[{"Deviations", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"D", " ", "ln", " ", "X"}], ")"}], "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"lItHatT", ",", "cItHatT", ",", "wItHatT"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "6.", " ", "Multiply", " ", "each", " ", "partial", " ", "Derivative", " ",
       "by", " ", "the", " ", "steaDy", " ", "state", " ", "level", " ", 
      "anD", " ", "its", " ", "corresponDing", " ", "log"}], "\[Hyphen]", 
     RowBox[{
      RowBox[{
       RowBox[{"Deviation", ".", "This"}], " ", "yielDs", " ", "the", " ", 
       "linearizeD", " ", "equation", " ", "F"}], "=", 
      RowBox[{"0", " ", "in", " ", "terms", " ", "of", " ", "the", " ", 
       RowBox[{"\[OpenCurlyDoubleQuote]", "hat", "\[CloseCurlyDoubleQuote]"}],
        " ", 
       RowBox[{"variables", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varsBar", "=", 
     RowBox[{"{", 
      RowBox[{"lItBar", ",", "cItBar", ",", "wItBar"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", "lItBar", "*", "lItHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", "cItBar", "*", "cItHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", "wItBar", "*", "wItHatT"}]}], "==",
       "0"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"7.", " ", "Simplify", " ", "the", " ", "final", " ", "linear", " ", 
     RowBox[{"equation", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"simplifieDLogLinEq", "=", 
     RowBox[{"Simplify", "[", "logLinEq", "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Optionally", ",", 
     RowBox[{
     "replace", " ", "steaDy", " ", "state", " ", "values", " ", "with", " ", 
      "1", " ", "to", " ", "eliminate", " ", 
      RowBox[{"them", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEqNoBar", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"simplifieDLogLinEq", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"lItBar", "->", "1"}], ",", 
         RowBox[{"cItBar", "->", "1"}], ",", 
         RowBox[{"wItBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "8.", " ", "Define", " ", "substitution", " ", "rules", " ", "to", " ", 
       "reintroDuce", " ", "time", " ", 
       RowBox[{"inDices", ".", "Here"}], " ", "we", " ", 
       RowBox[{"assign", ":", "lItHatT"}]}], "->", 
      RowBox[{"lItHat", "[", "t", "]"}]}], ",", 
     RowBox[{"cItHatT", "->", 
      RowBox[{"cItHat", "[", "t", "]"}]}], ",", 
     RowBox[{"wItHatT", "->", 
      RowBox[{"wItHat", "[", "t", "]"}]}], ",", 
     RowBox[{"anD", " ", "also", " ", "re"}], "\[Hyphen]", 
     RowBox[{"write", " ", 
      RowBox[{"betaI", "^", 
       RowBox[{"(", 
        RowBox[{"1", "+", "t"}], ")"}]}], " ", "as", " ", 
      RowBox[{
       RowBox[{"betaI", "^", 
        RowBox[{"(", 
         RowBox[{"t", "+", "1"}], ")"}]}], "."}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"timeSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"lItHatT", "->", 
        RowBox[{"lItHat", "[", "t", "]"}]}], ",", 
       RowBox[{"cItHatT", "->", 
        RowBox[{"cItHat", "[", "t", "]"}]}], ",", 
       RowBox[{"wItHatT", "->", 
        RowBox[{"wItHat", "[", "t", "]"}]}], ",", 
       RowBox[{
        RowBox[{"betaI", "^", 
         RowBox[{"(", 
          RowBox[{"1", "+", "t"}], ")"}]}], "->", 
        RowBox[{"betaI", "^", 
         RowBox[{"(", 
          RowBox[{"t", "+", "1"}], ")"}]}]}]}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqTimeInDexeD", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Finally", ",", 
     RowBox[{
     "output", " ", "both", " ", "the", " ", "version", " ", "without", " ", 
      "time", " ", "inDices", " ", "anD", " ", "with", " ", "time", " ", 
      RowBox[{"inDices", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
   "logLinEqNoBar", "\n", 
   RowBox[{"final", " ", "=", 
    RowBox[{"FullSimplify", "[", "eqTimeInDexeD", "]"}]}], "\[IndentingNewLine]",
    "final", "\n"}]}]], "Input",
 CellChangeTimes->{
  3.9476919365670357`*^9, {3.94795032638373*^9, 3.947950374200945*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"fb2f931c-bc15-f341-bf84-64962e1f5fe1"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9513961574111843`*^9, 3.9513961588647785`*^9}, 
   3.9514038540944614`*^9},ExpressionUUID->"a9e0b9e7-323f-1e41-8090-\
9b78c8cfbd2d"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{
  3.942592057012724*^9, {3.942592245428005*^9, 3.94259229837319*^9}, {
   3.94259276149564*^9, 3.942592764239746*^9}, {3.9425935259046726`*^9, 
   3.942593548727476*^9}, 3.9425936374098434`*^9, {3.942594582938095*^9, 
   3.942594602603157*^9}, 3.9425946466589737`*^9, {3.9425949113557167`*^9, 
   3.9425949911134377`*^9}, 3.942595094281233*^9, {3.942595174682337*^9, 
   3.942595279071537*^9}, 3.942595447132061*^9, {3.9425956151379395`*^9, 
   3.94259563994841*^9}, 3.942595669960287*^9, {3.9425959508937435`*^9, 
   3.9425959719109993`*^9}, 3.9427690351333847`*^9, 3.9427690682198257`*^9, 
   3.9427715635525856`*^9, 3.9428545977365494`*^9, 3.9430291244111385`*^9, {
   3.9430293293032436`*^9, 3.9430293321251163`*^9}, 3.943029903411661*^9, 
   3.943029935968582*^9, {3.9430300915187435`*^9, 3.9430300983569183`*^9}, 
   3.943030165224594*^9, 3.943031018565777*^9, 3.9430310525436935`*^9, 
   3.9430315909590073`*^9, {3.943031676607229*^9, 3.943031762295637*^9}, {
   3.943032046234873*^9, 3.94303207506736*^9}, {3.943032277998928*^9, 
   3.943032328893503*^9}, 3.9430323609657345`*^9, {3.9430338379985332`*^9, 
   3.9430338777026024`*^9}, {3.9430340737475815`*^9, 3.9430340995907764`*^9}, 
   3.943034138748911*^9, 3.943034215671747*^9, 3.9430955097704773`*^9, 
   3.9433588087017574`*^9, 3.9433588506085987`*^9, 3.9433604537355385`*^9, 
   3.9433690498361454`*^9, {3.943369097716297*^9, 3.9433691157514877`*^9}, {
   3.9433691779950886`*^9, 3.9433691920949574`*^9}, {3.943369408544922*^9, 
   3.943369419957775*^9}, {3.9433694534026623`*^9, 3.9433694610976887`*^9}, {
   3.9433718095535316`*^9, 3.9433718209741173`*^9}, {3.943371942155674*^9, 
   3.943371948822159*^9}, {3.943372132182953*^9, 3.9433721356424065`*^9}, {
   3.9433723369107685`*^9, 3.9433723433940105`*^9}, {3.9433725200260067`*^9, 
   3.943372539188036*^9}, 3.9433729214440956`*^9, 3.946134979625437*^9, {
   3.946135028668358*^9, 3.9461350308236866`*^9}, {3.946380295211197*^9, 
   3.946380296539772*^9}, {3.94640043978706*^9, 3.946400483226412*^9}, 
   3.9464023612987766`*^9, {3.9464025415333214`*^9, 3.9464025643481045`*^9}, {
   3.9464031878470516`*^9, 3.946403191088213*^9}, {3.9464034240072136`*^9, 
   3.9464034490416183`*^9}, 3.94734240899786*^9, {3.947342456115858*^9, 
   3.9473425197101955`*^9}, 3.949767809319248*^9, 3.9514046455524693`*^9, 
   3.9514046928271656`*^9},ExpressionUUID->"a67f113d-d41d-d24a-8f3f-\
b4722fe41f74"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.9497693584958725`*^9, 3.9497693734034348`*^9}, 
   3.9514046247508106`*^9},ExpressionUUID->"9b5be767-603c-0b4d-b011-\
d7ba65064b4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "loglin", "*)"}], "\[IndentingNewLine]", "\n"}]], "Input",
 CellChangeTimes->{{3.949769381376913*^9, 3.949769381376913*^9}, {
  3.951409518890789*^9, 3.9514095405654793`*^9}, {3.9514769589510345`*^9, 
  3.9514769673027782`*^9}},ExpressionUUID->"701e4a68-645d-5947-9384-\
1c5f4e49b6a5"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.9501111033685436`*^9, 
  3.951476980729805*^9},ExpressionUUID->"9ead36bb-5963-aa40-8fe7-\
c50aeb708fcd"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9497693584958725`*^9, 3.9497693734034348`*^9}, 
   3.9497700940558033`*^9},ExpressionUUID->"58b14532-419e-124a-a555-\
ae1c8fa742c0"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.9497693584958725`*^9, 3.9497693734034348`*^9}, {
   3.9497700940558033`*^9, 3.9497701031086597`*^9}, {3.9497702910418186`*^9, 
   3.9497702933579082`*^9}, 
   3.9514064555498276`*^9},ExpressionUUID->"6bdb1088-4e1c-f54b-9a0b-\
13f60053de22"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"entrappanuer", " ", "multi", " ", "period", " ", "Lagrange"}], 
   " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Parameters", " ", "anD", " ", "Variables", " ", "for", " ", 
     "Entrepreneurs"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"{", 
      RowBox[{"betaE", ",", "alpha", ",", "Delta", ",", "xi1", ",", "xi2", ",", 
       RowBox[{"AE", "[", "t", "]"}], ",", 
       RowBox[{"wpt", "[", "t", "]"}], ",", 
       RowBox[{"wip", "[", "t", "]"}], ",", 
       RowBox[{"qt", "[", "t", "]"}], ",", 
       RowBox[{"rtE", "[", "t", "]"}], ",", 
       RowBox[{"pit", "[", "t", "]"}], ",", 
       RowBox[{"ctE", "[", "t", "]"}], ",", 
       RowBox[{"btE", "[", "t", "]"}], ",", 
       RowBox[{"kEt", "[", "t", "]"}], ",", 
       RowBox[{"uEt", "[", "t", "]"}], ",", 
       RowBox[{"mEt", "[", "t", "]"}], ",", 
       RowBox[{"LEP", "[", "t", "]"}], ",", 
       RowBox[{"LEI", "[", "t", "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Utility", " ", "function", " ", "for", " ", "entrepreneurs"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uEntrepreneur", "[", 
      RowBox[{"ctE_", ",", "ctELag_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Log", "[", "ctE", "]"}], "-", 
      RowBox[{"alpha", " ", 
       RowBox[{"Log", "[", "ctELag", "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"ProDuction", " ", "function", " ", "for", " ", "entrepreneurs"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yE", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"AE", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"kE", "[", 
          RowBox[{"t", "-", "1"}], "]"}], "^", "alpha"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LEP", "[", "t", "]"}], "+", 
           RowBox[{"LEI", "[", "t", "]"}]}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"1", "-", "alpha"}], ")"}]}]}], ")"}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Utilization", " ", "cost", " ", "function"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FUtil", "[", "u_", "]"}], ":=", 
     RowBox[{
      RowBox[{"xi1", " ", 
       RowBox[{"(", 
        RowBox[{"u", "-", "1"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"xi2", "/", "2"}], ")"}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"u", "-", "1"}], ")"}], "^", "2"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "BuDget", " ", "constraint", " ", "for", " ", "entrepreneurs", " ", "in", 
     " ", "perioD", " ", "t"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BCEntrepreneur", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"ctE", "[", "t", "]"}], "+", 
      RowBox[{
       RowBox[{"wpt", "[", "t", "]"}], " ", 
       RowBox[{"LEP", "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"wip", "[", "t", "]"}], " ", 
       RowBox[{"LEI", "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"rtE", "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ")"}], "/", 
         RowBox[{"pit", "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"btE", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"qt", "[", "t", "]"}], " ", 
       RowBox[{"kEt", "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"FUtil", "[", 
        RowBox[{"uEt", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"kEt", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], "-", 
      RowBox[{"yE", "[", "t", "]"}], "-", 
      RowBox[{"btE", "[", "t", "]"}], "-", 
      RowBox[{
       RowBox[{"qt", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "Delta"}], ")"}], " ", 
       RowBox[{"kEt", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Borrowing", " ", "constraint", " ", "for", " ", "entrepreneurs", " ", 
     "in", " ", "perioD", " ", "t"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BorrowingConstraint", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"rtE", "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"btE", "[", "t", "]"}]}], "-", 
      RowBox[{
       RowBox[{"Mt", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"qt", "[", 
          RowBox[{"t", "+", "1"}], "]"}], " ", 
         RowBox[{"pit", "[", 
          RowBox[{"t", "+", "1"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "Delta"}], ")"}], " ", 
         RowBox[{"kEt", "[", "t", "]"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "Lagrangian", "*)"}], "\n", 
   RowBox[{
    RowBox[{"LE", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"betaE", "^", "t"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"uEntrepreneur", "[", 
          RowBox[{
           RowBox[{"ctE", "[", "t", "]"}], ",", 
           RowBox[{"ctE", "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], "]"}], "+", 
         RowBox[{
          RowBox[{"lambDaE", "[", "t", "]"}], " ", 
          RowBox[{"BCEntrepreneur", "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"muE", "[", "t", "]"}], " ", 
          RowBox[{"BorrowingConstraint", "[", "t", "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"betaE", "^", 
        RowBox[{"(", 
         RowBox[{"t", "+", "1"}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"uEntrepreneur", "[", 
          RowBox[{
           RowBox[{"ctE", "[", 
            RowBox[{"t", "+", "1"}], "]"}], ",", 
           RowBox[{"ctE", "[", "t", "]"}]}], "]"}], "+", 
         RowBox[{
          RowBox[{"lambDaE", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"BCEntrepreneur", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"muE", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"BorrowingConstraint", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"First", "-", 
     RowBox[{"orDer", " ", "conDitions", " ", "for", " ", "entrepreneurs"}]}],
     "*)"}], "\n", 
   RowBox[{
    RowBox[{"focCtE", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LE", ",", 
        RowBox[{"ctE", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "consumption", " ", 
     RowBox[{"ctE", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focKEt", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LE", ",", 
        RowBox[{"kEt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "capital", " ", 
     RowBox[{"kEt", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focBtE", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LE", ",", 
        RowBox[{"btE", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "borrowing", " ", 
     RowBox[{"btE", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focUEt", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LE", ",", 
        RowBox[{"uEt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "utilization", " ", 
     RowBox[{"uEt", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Display", " ", "results"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"DebugFOCs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<FOC wrt ctE[t]\>\"", "->", "focCtE"}], ",", 
       RowBox[{"\"\<FOC wrt kEt[t]\>\"", "->", "focKEt"}], ",", 
       RowBox[{"\"\<FOC wrt btE[t]\>\"", "->", "focBtE"}], ",", 
       RowBox[{"\"\<FOC wrt uEt[t]\>\"", "->", "focUEt"}]}], "}"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Output", " ", "the", " ", "Lagrangian"}], ",", "FOCs"}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Lagrangian\>\"", "->", "LE"}], ",", 
     RowBox[{"\"\<First-OrDer ConDitions\>\"", "->", "DebugFOCs"}]}], "}"}], 
   "\n"}]}]], "Input",
 CellChangeTimes->{
  3.942592057012724*^9, {3.942592245428005*^9, 3.94259229837319*^9}, {
   3.94259276149564*^9, 3.942592764239746*^9}, {3.9425935259046726`*^9, 
   3.942593548727476*^9}, 3.9425936374098434`*^9, {3.942594582938095*^9, 
   3.942594602603157*^9}, 3.9425946466589737`*^9, {3.9425949113557167`*^9, 
   3.9425949911134377`*^9}, 3.942595094281233*^9, {3.942595174682337*^9, 
   3.942595279071537*^9}, 3.942595447132061*^9, {3.9425956151379395`*^9, 
   3.94259563994841*^9}, 3.942595669960287*^9, {3.9425959508937435`*^9, 
   3.9425959719109993`*^9}, 3.9427690351333847`*^9, 3.9427690682198257`*^9, 
   3.9427715635525856`*^9, 3.9428545977365494`*^9, 3.9430291244111385`*^9, {
   3.9430293293032436`*^9, 3.9430293321251163`*^9}, 3.943029903411661*^9, 
   3.943029935968582*^9, {3.9430300915187435`*^9, 3.9430300983569183`*^9}, 
   3.943030165224594*^9, 3.943031018565777*^9, 3.9430310525436935`*^9, 
   3.9430315909590073`*^9, {3.943031676607229*^9, 3.943031762295637*^9}, {
   3.943032046234873*^9, 3.94303207506736*^9}, {3.943032277998928*^9, 
   3.943032328893503*^9}, 3.9430323609657345`*^9, {3.9430338379985332`*^9, 
   3.9430338777026024`*^9}, {3.9430340737475815`*^9, 3.9430340995907764`*^9}, 
   3.943034138748911*^9, 3.943034215671747*^9, 3.9430955097704773`*^9, 
   3.9433588087017574`*^9, 3.9433588506085987`*^9, 3.9433604537355385`*^9, 
   3.9433690498361454`*^9, {3.943369097716297*^9, 3.9433691157514877`*^9}, {
   3.9433691779950886`*^9, 3.9433691920949574`*^9}, {3.943369408544922*^9, 
   3.943369419957775*^9}, {3.9433694534026623`*^9, 3.9433694610976887`*^9}, {
   3.9433718095535316`*^9, 3.9433718209741173`*^9}, {3.943371942155674*^9, 
   3.943371948822159*^9}, {3.943372132182953*^9, 3.9433721356424065`*^9}, {
   3.9433723369107685`*^9, 3.9433723433940105`*^9}, {3.9433725200260067`*^9, 
   3.943372539188036*^9}, 3.9433729214440956`*^9, 3.946134979625437*^9, {
   3.946135028668358*^9, 3.9461350308236866`*^9}, {3.946380295211197*^9, 
   3.946380296539772*^9}, {3.94640043978706*^9, 3.946400483226412*^9}, 
   3.9464023612987766`*^9, {3.9464025415333214`*^9, 3.9464025643481045`*^9}, {
   3.9464031878470516`*^9, 3.946403191088213*^9}, {3.9464034240072136`*^9, 
   3.9464034490416183`*^9}, 3.94734240899786*^9, {3.947342456115858*^9, 
   3.9473425048120995`*^9}, {3.9514095638074265`*^9, 3.951409582832823*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"24e808de-ed6a-4146-a49a-28e49cf93adc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"Lagrangian\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{
      SuperscriptBox["betaE", "t"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "alpha"}], " ", 
         RowBox[{"Log", "[", 
          RowBox[{"ctE", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}], "]"}]}], "+", 
        RowBox[{"Log", "[", 
         RowBox[{"ctE", "[", "t", "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"muE", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "Delta"}], ")"}], " ", 
              RowBox[{"kEt", "[", "t", "]"}], " ", 
              RowBox[{"Mt", "[", "t", "]"}], " ", 
              RowBox[{"pit", "[", 
               RowBox[{"1", "+", "t"}], "]"}], " ", 
              RowBox[{"qt", "[", 
               RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"btE", "[", "t", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"lambDaE", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"btE", "[", "t", "]"}]}], "+", 
           RowBox[{"ctE", "[", "t", "]"}], "-", 
           RowBox[{
            RowBox[{"AE", "[", "t", "]"}], " ", 
            SuperscriptBox[
             RowBox[{"kE", "[", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "t"}], "]"}], "alpha"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"LEI", "[", "t", "]"}], "+", 
               RowBox[{"LEP", "[", "t", "]"}]}], ")"}], 
             RowBox[{"1", "-", "alpha"}]]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Delta"}], ")"}], " ", 
            RowBox[{"kEt", "[", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
            RowBox[{"qt", "[", "t", "]"}]}], "+", 
           RowBox[{
            RowBox[{"kEt", "[", "t", "]"}], " ", 
            RowBox[{"qt", "[", "t", "]"}]}], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"btE", "[", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rtE", "[", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "t"}], "]"}]}], ")"}]}], 
            RowBox[{"pit", "[", "t", "]"}]], "+", 
           RowBox[{
            RowBox[{"kEt", "[", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xi1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"uEt", "[", "t", "]"}]}], ")"}]}], "+", 
              RowBox[{
               FractionBox["1", "2"], " ", "xi2", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"uEt", "[", "t", "]"}]}], ")"}], "2"]}]}], ")"}]}], 
           "+", 
           RowBox[{
            RowBox[{"LEI", "[", "t", "]"}], " ", 
            RowBox[{"wip", "[", "t", "]"}]}], "+", 
           RowBox[{
            RowBox[{"LEP", "[", "t", "]"}], " ", 
            RowBox[{"wpt", "[", "t", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["betaE", 
       RowBox[{"1", "+", "t"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "alpha"}], " ", 
         RowBox[{"Log", "[", 
          RowBox[{"ctE", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"Log", "[", 
         RowBox[{"ctE", "[", 
          RowBox[{"1", "+", "t"}], "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"muE", "[", 
          RowBox[{"1", "+", "t"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "Delta"}], ")"}], " ", 
              RowBox[{"kEt", "[", 
               RowBox[{"1", "+", "t"}], "]"}], " ", 
              RowBox[{"Mt", "[", 
               RowBox[{"1", "+", "t"}], "]"}], " ", 
              RowBox[{"pit", "[", 
               RowBox[{"2", "+", "t"}], "]"}], " ", 
              RowBox[{"qt", "[", 
               RowBox[{"2", "+", "t"}], "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"btE", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rtE", "[", 
               RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"lambDaE", "[", 
          RowBox[{"1", "+", "t"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"btE", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], "+", 
           RowBox[{"ctE", "[", 
            RowBox[{"1", "+", "t"}], "]"}], "-", 
           RowBox[{
            RowBox[{"AE", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"kE", "[", "t", "]"}], "alpha"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"LEI", "[", 
                RowBox[{"1", "+", "t"}], "]"}], "+", 
               RowBox[{"LEP", "[", 
                RowBox[{"1", "+", "t"}], "]"}]}], ")"}], 
             RowBox[{"1", "-", "alpha"}]]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Delta"}], ")"}], " ", 
            RowBox[{"kEt", "[", "t", "]"}], " ", 
            RowBox[{"qt", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"kEt", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"qt", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"btE", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}], 
            RowBox[{"pit", "[", 
             RowBox[{"1", "+", "t"}], "]"}]], "+", 
           RowBox[{
            RowBox[{"kEt", "[", "t", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xi1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"uEt", "[", 
                  RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
              RowBox[{
               FractionBox["1", "2"], " ", "xi2", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"uEt", "[", 
                   RowBox[{"1", "+", "t"}], "]"}]}], ")"}], "2"]}]}], ")"}]}],
            "+", 
           RowBox[{
            RowBox[{"LEI", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"wip", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"LEP", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"wpt", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{"\<\"First-OrDer ConDitions\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\<\"FOC wrt ctE[t]\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"alpha", " ", 
            SuperscriptBox["betaE", 
             RowBox[{"1", "+", "t"}]]}], 
           RowBox[{"ctE", "[", "t", "]"}]]}], "+", 
         RowBox[{
          SuperscriptBox["betaE", "t"], " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"ctE", "[", "t", "]"}]], "+", 
            RowBox[{"lambDaE", "[", "t", "]"}]}], ")"}]}]}], "\[Equal]", 
        "0"}]}], ",", 
      RowBox[{"\<\"FOC wrt kEt[t]\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox["betaE", "t"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"lambDaE", "[", "t", "]"}], " ", 
             RowBox[{"qt", "[", "t", "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "Delta"}], ")"}], " ", 
             RowBox[{"Mt", "[", "t", "]"}], " ", 
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"pit", "[", 
              RowBox[{"1", "+", "t"}], "]"}], " ", 
             RowBox[{"qt", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["betaE", 
           RowBox[{"1", "+", "t"}]], " ", 
          RowBox[{"lambDaE", "[", 
           RowBox[{"1", "+", "t"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "Delta"}], ")"}], " ", 
               RowBox[{"qt", "[", 
                RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
            RowBox[{"xi1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"uEt", "[", 
                RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             FractionBox["1", "2"], " ", "xi2", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"uEt", "[", 
                 RowBox[{"1", "+", "t"}], "]"}]}], ")"}], "2"]}]}], ")"}]}]}],
         "\[Equal]", "0"}]}], ",", 
      RowBox[{"\<\"FOC wrt btE[t]\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox["betaE", 
            RowBox[{"1", "+", "t"}]], " ", 
           RowBox[{"lambDaE", "[", 
            RowBox[{"1", "+", "t"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}], 
          RowBox[{"pit", "[", 
           RowBox[{"1", "+", "t"}], "]"}]], "+", 
         RowBox[{
          SuperscriptBox["betaE", "t"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"lambDaE", "[", "t", "]"}]}], "+", 
            RowBox[{
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}], "\[Equal]",
         "0"}]}], ",", 
      RowBox[{"\<\"FOC wrt uEt[t]\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{
         SuperscriptBox["betaE", "t"], " ", 
         RowBox[{"kEt", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
         RowBox[{"lambDaE", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"xi1", "+", 
           RowBox[{"xi2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"uEt", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], "\[Equal]",
         "0"}]}]}], "}"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.9518424404445972`*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"8bfddbbc-a0d9-d94f-9d8c-8f46c6a145c3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\"\<Lagrangian\>\"", "\[Rule]", 
    RowBox[{
     RowBox[{
      SuperscriptBox["betaE", "t"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "alpha"}], " ", 
         RowBox[{"Log", "[", 
          RowBox[{"ctE", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}], "]"}]}], "+", 
        RowBox[{"Log", "[", 
         RowBox[{"ctE", "[", "t", "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"muE", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "Delta"}], ")"}], " ", 
              RowBox[{"kEt", "[", "t", "]"}], " ", 
              RowBox[{"Mt", "[", "t", "]"}], " ", 
              RowBox[{"pit", "[", 
               RowBox[{"1", "+", "t"}], "]"}], " ", 
              RowBox[{"qt", "[", 
               RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"btE", "[", "t", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"lambDaE", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"btE", "[", "t", "]"}]}], "+", 
           RowBox[{"ctE", "[", "t", "]"}], "-", 
           RowBox[{
            RowBox[{"AE", "[", "t", "]"}], " ", 
            SuperscriptBox[
             RowBox[{"kE", "[", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "t"}], "]"}], "alpha"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"LEI", "[", "t", "]"}], "+", 
               RowBox[{"LEP", "[", "t", "]"}]}], ")"}], 
             RowBox[{"1", "-", "alpha"}]]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Delta"}], ")"}], " ", 
            RowBox[{"kEt", "[", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
            RowBox[{"qt", "[", "t", "]"}]}], "+", 
           RowBox[{
            RowBox[{"kEt", "[", "t", "]"}], " ", 
            RowBox[{"qt", "[", "t", "]"}]}], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"btE", "[", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rtE", "[", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "t"}], "]"}]}], ")"}]}], 
            RowBox[{"pit", "[", "t", "]"}]], "+", 
           RowBox[{
            RowBox[{"kEt", "[", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xi1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"uEt", "[", "t", "]"}]}], ")"}]}], "+", 
              RowBox[{
               FractionBox["1", "2"], " ", "xi2", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"uEt", "[", "t", "]"}]}], ")"}], "2"]}]}], ")"}]}], 
           "+", 
           RowBox[{
            RowBox[{"LEI", "[", "t", "]"}], " ", 
            RowBox[{"wip", "[", "t", "]"}]}], "+", 
           RowBox[{
            RowBox[{"LEP", "[", "t", "]"}], " ", 
            RowBox[{"wpt", "[", "t", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["betaE", 
       RowBox[{"1", "+", "t"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "alpha"}], " ", 
         RowBox[{"Log", "[", 
          RowBox[{"ctE", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"Log", "[", 
         RowBox[{"ctE", "[", 
          RowBox[{"1", "+", "t"}], "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"muE", "[", 
          RowBox[{"1", "+", "t"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "Delta"}], ")"}], " ", 
              RowBox[{"kEt", "[", 
               RowBox[{"1", "+", "t"}], "]"}], " ", 
              RowBox[{"Mt", "[", 
               RowBox[{"1", "+", "t"}], "]"}], " ", 
              RowBox[{"pit", "[", 
               RowBox[{"2", "+", "t"}], "]"}], " ", 
              RowBox[{"qt", "[", 
               RowBox[{"2", "+", "t"}], "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"btE", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rtE", "[", 
               RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"lambDaE", "[", 
          RowBox[{"1", "+", "t"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"btE", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], "+", 
           RowBox[{"ctE", "[", 
            RowBox[{"1", "+", "t"}], "]"}], "-", 
           RowBox[{
            RowBox[{"AE", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"kE", "[", "t", "]"}], "alpha"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"LEI", "[", 
                RowBox[{"1", "+", "t"}], "]"}], "+", 
               RowBox[{"LEP", "[", 
                RowBox[{"1", "+", "t"}], "]"}]}], ")"}], 
             RowBox[{"1", "-", "alpha"}]]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Delta"}], ")"}], " ", 
            RowBox[{"kEt", "[", "t", "]"}], " ", 
            RowBox[{"qt", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"kEt", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"qt", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"btE", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}], 
            RowBox[{"pit", "[", 
             RowBox[{"1", "+", "t"}], "]"}]], "+", 
           RowBox[{
            RowBox[{"kEt", "[", "t", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xi1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"uEt", "[", 
                  RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
              RowBox[{
               FractionBox["1", "2"], " ", "xi2", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"uEt", "[", 
                   RowBox[{"1", "+", "t"}], "]"}]}], ")"}], "2"]}]}], ")"}]}],
            "+", 
           RowBox[{
            RowBox[{"LEI", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"wip", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"LEP", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"wpt", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{"\"\<First-OrDer ConDitions\>\"", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FOC wrt ctE[t]\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"alpha", " ", 
            SuperscriptBox["betaE", 
             RowBox[{"1", "+", "t"}]]}], 
           RowBox[{"ctE", "[", "t", "]"}]]}], "+", 
         RowBox[{
          SuperscriptBox["betaE", "t"], " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"ctE", "[", "t", "]"}]], "+", 
            RowBox[{"lambDaE", "[", "t", "]"}]}], ")"}]}]}], "\[Equal]", 
        "0"}]}], ",", 
      RowBox[{"\"\<FOC wrt kEt[t]\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox["betaE", "t"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"lambDaE", "[", "t", "]"}], " ", 
             RowBox[{"qt", "[", "t", "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "Delta"}], ")"}], " ", 
             RowBox[{"Mt", "[", "t", "]"}], " ", 
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"pit", "[", 
              RowBox[{"1", "+", "t"}], "]"}], " ", 
             RowBox[{"qt", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["betaE", 
           RowBox[{"1", "+", "t"}]], " ", 
          RowBox[{"lambDaE", "[", 
           RowBox[{"1", "+", "t"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "Delta"}], ")"}], " ", 
               RowBox[{"qt", "[", 
                RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
            RowBox[{"xi1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"uEt", "[", 
                RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             FractionBox["1", "2"], " ", "xi2", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"uEt", "[", 
                 RowBox[{"1", "+", "t"}], "]"}]}], ")"}], "2"]}]}], ")"}]}]}],
         "\[Equal]", "0"}]}], ",", 
      RowBox[{"\"\<FOC wrt btE[t]\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox["betaE", 
            RowBox[{"1", "+", "t"}]], " ", 
           RowBox[{"lambDaE", "[", 
            RowBox[{"1", "+", "t"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}], 
          RowBox[{"pit", "[", 
           RowBox[{"1", "+", "t"}], "]"}]], "+", 
         RowBox[{
          SuperscriptBox["betaE", "t"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"lambDaE", "[", "t", "]"}]}], "+", 
            RowBox[{
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}], "\[Equal]",
         "0"}]}], ",", 
      RowBox[{"\"\<FOC wrt uEt[t]\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{
         SuperscriptBox["betaE", "t"], " ", 
         RowBox[{"kEt", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
         RowBox[{"lambDaE", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"xi1", "+", 
           RowBox[{"xi2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"uEt", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], "\[Equal]",
         "0"}]}]}], "}"}]}]}], "}"}]], "Input",
 CellChangeTimes->{
  3.9501111034094353`*^9},ExpressionUUID->"32923660-840a-4b4d-a40a-\
87b153dac6e3"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9464031981481724`*^9, 
  3.9464032115819416`*^9}},ExpressionUUID->"4129f409-7408-7d45-9299-\
8b83db08acfc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Definisikan", " ", "FOC", " ", "wrt", " ", 
    RowBox[{"c_t", "^", "E"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"eq1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"alpha", " ", 
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}]}], ")"}], "/", 
          RowBox[{"ctE", "[", "t", "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"betaE", "^", "t"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"ctE", "[", "t", "]"}]}], "+", 
          RowBox[{"lambDaE", "[", "t", "]"}]}], ")"}]}]}], "==", "0"}]}], 
    ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"1", ")"}], " ", "Pecahkan", " ", "eq1", " ", "untuk", " ", 
     RowBox[{"lambDaE", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solLambDa", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"eq1", ",", 
       RowBox[{"lambDaE", "[", "t", "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Hasilnya", " ", "memberi", " ", 
      RowBox[{"lambDaE", "[", "t", "]"}], " ", "Dalam", " ", "fungsi", " ", 
      "alpha"}], ",", "betaE", ",", 
     RowBox[{"Dan", " ", 
      RowBox[{"ctE", "[", "t", "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Misal", " ", "AnDa", " ", "punya", " ", "FOC"}], "-", 
     RowBox[{
     "FOC", " ", "lain", " ", "sebagai", " ", "Daftar", " ", "persamaan", " ", 
      RowBox[{"(", 
       RowBox[{"sesuaikan", " ", "senDiri"}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focSystem", "=", 
     RowBox[{"{", 
      RowBox[{"(*", 
       RowBox[{"FOC", " ", "wrt", " ", 
        RowBox[{"kE", "[", "t", "]"}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"lambDaE", "[", "t", "]"}], " ", 
             RowBox[{"qt", "[", "t", "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "Delta"}], ")"}], " ", 
             RowBox[{"Mt", "[", "t", "]"}], " ", 
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"pit", "[", 
              RowBox[{"1", "+", "t"}], "]"}], " ", 
             RowBox[{"qt", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"betaE", "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "t"}], ")"}]}], " ", 
          RowBox[{"lambDaE", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "Delta"}], ")"}], " ", 
               RowBox[{"qt", "[", 
                RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}], "+", 
            RowBox[{"xi1", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"uEt", "[", 
                RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], " ", "xi2", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"uEt", "[", 
                 RowBox[{"t", "+", "1"}], "]"}]}], ")"}], "^", "2"}]}]}], 
           ")"}]}]}], "==", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"bE", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}], " ", 
            RowBox[{"lambDaE", "[", 
             RowBox[{"t", "+", "1"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"pit", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"lambDaE", "[", "t", "]"}]}], "+", 
            RowBox[{
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}], "==", 
        "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"uE", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"betaE", "^", "t"}], " ", 
         RowBox[{"kEt", "[", 
          RowBox[{"t", "-", "1"}], "]"}], " ", 
         RowBox[{"lambDaE", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"xi1", "+", 
           RowBox[{"xi2", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"uEt", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], "==", 
        "0"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"2", ")"}], " ", "Gunakan", " ", "iDentitas", " ", "waktu"}], ",", 
     RowBox[{
      RowBox[{"misal", " ", 
       RowBox[{"lambDaE", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], "=", 
      RowBox[{
       RowBox[{"lambDaE", "[", 
        RowBox[{"t", "+", "1"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"DiDapat", " ", "Dengan", " ", "mengganti", " ", "t"}], "->", 
          RowBox[{"t", "+", 
           RowBox[{"1", " ", "Di", " ", "solLambDa"}]}]}], ",", 
         RowBox[{"Dsb", "."}]}], ")"}]}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"lambDaNext", "=", 
     RowBox[{"solLambDa", "/.", " ", 
      RowBox[{"t", "->", 
       RowBox[{"t", "+", "1"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"3", ")"}], " ", "Substitusikan", " ", "solusi", " ", "ke", " ", 
     "sistem", " ", "FOC"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focSystemSub", "=", 
     RowBox[{
      RowBox[{"focSystem", "/.", " ", 
       RowBox[{"solLambDa", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "/.", " ", 
      RowBox[{"lambDaNext", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Selanjutnya", ",", 
     RowBox[{
     "AnDa", " ", "bisa", " ", "gunakan", " ", "Solve", " ", "atau", " ", 
      "NSolve", " ", "untuk", " ", "menyelesaikan", " ", "sistem", " ", 
      "lengkap"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"solution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"focSystemSub", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"lambDaE", "[", "t", "]"}], ",", 
         RowBox[{"muE", "[", "t", "]"}]}], 
        RowBox[{"(*", 
         RowBox[{
         "variabel", " ", "lain", " ", "yang", " ", "ingin", " ", 
          "Dipecahkan"}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{"Dsb", "."}], "*)"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Definisikan", " ", "FOC", " ", "wrt", " ", 
     RowBox[{"c_t", "^", "E"}]}], "*)"}], 
   RowBox[{
    RowBox[{"eq1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"alpha", " ", 
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}]}], ")"}], "/", 
          RowBox[{"ctE", "[", "t", "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"betaE", "^", "t"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"ctE", "[", "t", "]"}]}], "+", 
          RowBox[{"lambDaE", "[", "t", "]"}]}], ")"}]}]}], "==", "0"}]}], 
    ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"1", ")"}], " ", "Pecahkan", " ", "eq1", " ", "untuk", " ", 
     RowBox[{"lambDaE", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solLambDa", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"eq1", ",", 
       RowBox[{"lambDaE", "[", "t", "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Hasilnya", " ", "memberi", " ", 
      RowBox[{"lambDaE", "[", "t", "]"}], " ", "Dalam", " ", "fungsi", " ", 
      "alpha"}], ",", "betaE", ",", 
     RowBox[{"Dan", " ", 
      RowBox[{"ctE", "[", "t", "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Misal", " ", "AnDa", " ", "punya", " ", "FOC"}], "-", 
     RowBox[{
     "FOC", " ", "lain", " ", "sebagai", " ", "Daftar", " ", "persamaan", " ", 
      RowBox[{"(", 
       RowBox[{"sesuaikan", " ", "senDiri"}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focSystem", "=", 
     RowBox[{"{", 
      RowBox[{"(*", 
       RowBox[{"FOC", " ", "wrt", " ", 
        RowBox[{"kE", "[", "t", "]"}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"lambDaE", "[", "t", "]"}], " ", 
             RowBox[{"qt", "[", "t", "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "Delta"}], ")"}], " ", 
             RowBox[{"Mt", "[", "t", "]"}], " ", 
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"pit", "[", 
              RowBox[{"1", "+", "t"}], "]"}], " ", 
             RowBox[{"qt", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"betaE", "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "t"}], ")"}]}], " ", 
          RowBox[{"lambDaE", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "Delta"}], ")"}], " ", 
               RowBox[{"qt", "[", 
                RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}], "+", 
            RowBox[{"xi1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"uEt", "[", 
                RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], " ", "xi2", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"uEt", "[", 
                 RowBox[{"t", "+", "1"}], "]"}]}], ")"}], "^", "2"}]}]}], 
           ")"}]}]}], "==", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"bE", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}], " ", 
            RowBox[{"lambDaE", "[", 
             RowBox[{"t", "+", "1"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"pit", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"lambDaE", "[", "t", "]"}]}], "+", 
            RowBox[{
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}], "==", 
        "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"uE", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"betaE", "^", "t"}], " ", 
         RowBox[{"kEt", "[", 
          RowBox[{"t", "-", "1"}], "]"}], " ", 
         RowBox[{"lambDaE", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"xi1", "+", 
           RowBox[{"xi2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"uEt", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], "==", 
        "0"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"2", ")"}], " ", "Gunakan", " ", "iDentitas", " ", "waktu"}], ",", 
     RowBox[{
      RowBox[{"misal", " ", 
       RowBox[{"lambDaE", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], "=", 
      RowBox[{
       RowBox[{"lambDaE", "[", 
        RowBox[{"t", "+", "1"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"DiDapat", " ", "Dengan", " ", "mengganti", " ", "t"}], "->", 
          RowBox[{"t", "+", 
           RowBox[{"1", " ", "Di", " ", "solLambDa"}]}]}], ",", 
         RowBox[{"Dsb", "."}]}], ")"}]}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"lambDaNext", "=", 
     RowBox[{"solLambDa", "/.", " ", 
      RowBox[{"t", "->", 
       RowBox[{"t", "+", "1"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"3", ")"}], " ", "Substitusikan", " ", "solusi", " ", "ke", " ", 
     "sistem", " ", "FOC"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focSystemSub", "=", 
     RowBox[{
      RowBox[{"focSystem", "/.", " ", 
       RowBox[{"solLambDa", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "/.", " ", 
      RowBox[{"lambDaNext", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Cetak", " ", "sistem", " ", "persamaan", " ", "yang", " ", "baru"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Sistem persamaan setelah substitusi: \>\"", ",", 
      "focSystemSub"}], "]"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Selanjutnya", ",", 
     RowBox[{
     "AnDa", " ", "bisa", " ", "gunakan", " ", "Solve", " ", "atau", " ", 
      "NSolve", " ", "untuk", " ", "menyelesaikan", " ", "sistem", " ", 
      "lengkap"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"focSystemSub", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"lambDaE", "[", "t", "]"}], ",", 
         RowBox[{"muE", "[", "t", "]"}]}], 
        RowBox[{"(*", 
         RowBox[{
         "variabel", " ", "lain", " ", "yang", " ", "ingin", " ", 
          "Dipecahkan"}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{"Dsb", "."}], "*)"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]",
    "lambDaNext", "\n", "solLambDa", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.946139816861929*^9, 3.9461398521181507`*^9, {3.946140256790245*^9, 
   3.9461402839309597`*^9}, {3.9461405343897038`*^9, 3.9461405627286797`*^9}, 
   3.9488954161556416`*^9, {3.9488955403604584`*^9, 3.948895543585516*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"e52c92a4-2eb6-c645-94b2-60c371363739"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Sistem persamaan setelah substitusi: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["betaE", "t"], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
            RowBox[{"qt", "[", "t", "]"}]}], 
           RowBox[{"ctE", "[", "t", "]"}]], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Delta"}], ")"}], " ", 
           RowBox[{"Mt", "[", "t", "]"}], " ", 
           RowBox[{"muE", "[", "t", "]"}], " ", 
           RowBox[{"pit", "[", 
            RowBox[{"1", "+", "t"}], "]"}], " ", 
           RowBox[{"qt", "[", 
            RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}], "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["betaE", 
          RowBox[{"1", "+", "t"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "Delta"}], ")"}], " ", 
              RowBox[{"qt", "[", 
               RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
           RowBox[{"xi1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"uEt", "[", 
               RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
           RowBox[{
            FractionBox["1", "2"], " ", "xi2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"uEt", "[", 
                RowBox[{"1", "+", "t"}], "]"}]}], ")"}], "2"]}]}], ")"}]}], 
        RowBox[{"ctE", "[", 
         RowBox[{"1", "+", "t"}], "]"}]]}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["betaE", 
          RowBox[{"1", "+", "t"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"ctE", "[", 
          RowBox[{"1", "+", "t"}], "]"}], " ", 
         RowBox[{"pit", "[", 
          RowBox[{"1", "+", "t"}], "]"}]}]], "+", 
       RowBox[{
        SuperscriptBox["betaE", "t"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"alpha", " ", "betaE"}]}], 
            RowBox[{"ctE", "[", "t", "]"}]]}], "+", 
          RowBox[{
           RowBox[{"muE", "[", "t", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}], "\[Equal]",
       "0"}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox["betaE", "t"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
        RowBox[{"kEt", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"xi1", "+", 
          RowBox[{"xi2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"uEt", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{"ctE", "[", "t", "]"}]], "\[Equal]", "0"}]}], "}"}]}],
  SequenceForm[
  "Sistem persamaan setelah substitusi: ", {$CellContext`betaE^$CellContext`t \
((-1 + $CellContext`alpha $CellContext`betaE) \
$CellContext`ctE[$CellContext`t]^(-1) $CellContext`qt[$CellContext`t] - (
        1 - $CellContext`Delta) $CellContext`Mt[$CellContext`t] \
$CellContext`muE[$CellContext`t] $CellContext`pit[
        1 + $CellContext`t] $CellContext`qt[
        1 + $CellContext`t]) + $CellContext`betaE^(
        1 + $CellContext`t) (-1 + $CellContext`alpha $CellContext`betaE) \
$CellContext`ctE[
        1 + $CellContext`t]^(-1) ((-(1 - $CellContext`Delta)) $CellContext`qt[
         1 + $CellContext`t] + $CellContext`xi1 (-1 + $CellContext`uEt[
          1 + $CellContext`t]) + 
       Rational[
         1, 2] $CellContext`xi2 (-1 + $CellContext`uEt[
           1 + $CellContext`t])^2) == 
    0, $CellContext`betaE^(
        1 + $CellContext`t) (-1 + $CellContext`alpha $CellContext`betaE) \
$CellContext`ctE[1 + $CellContext`t]^(-1) $CellContext`pit[
        1 + $CellContext`t]^(-1) (
       1 + $CellContext`rtE[$CellContext`t]) + \
$CellContext`betaE^$CellContext`t ((-(-1 + $CellContext`alpha \
$CellContext`betaE))/$CellContext`ctE[$CellContext`t] + \
$CellContext`muE[$CellContext`t] (1 + $CellContext`rtE[$CellContext`t])) == 
    0, $CellContext`betaE^$CellContext`t (-1 + $CellContext`alpha \
$CellContext`betaE) $CellContext`ctE[$CellContext`t]^(-1) $CellContext`kEt[-1 + \
$CellContext`t] ($CellContext`xi1 + $CellContext`xi2 (-1 + \
$CellContext`uEt[$CellContext`t])) == 0}],
  Editable->False]], "Print",
 CellChangeTimes->{3.9514088672184467`*^9},
 CellLabel->
  "During evaluation of \
In[184]:=",ExpressionUUID->"a5490c30-ac37-344c-8f8a-02868d6220b5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"lambDaE", "[", 
     RowBox[{"1", "+", "t"}], "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"alpha", " ", "betaE"}]}], 
     RowBox[{"ctE", "[", 
      RowBox[{"1", "+", "t"}], "]"}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.9514088672334366`*^9},
 CellLabel->
  "Out[197]=",ExpressionUUID->"e2c714d2-7bd3-fb4c-8d33-274a646f496d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"lambDaE", "[", "t", "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"alpha", " ", "betaE"}]}], 
     RowBox[{"ctE", "[", "t", "]"}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.9514088672363987`*^9},
 CellLabel->
  "Out[198]=",ExpressionUUID->"96bffbcc-cb29-a548-8f4f-78e3e5767649"]
}, Open  ]],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{
  3.942511329185976*^9, 3.942511423550762*^9, 3.942591573184946*^9, {
   3.9425916035900593`*^9, 3.942591633542879*^9}, {3.9425918643458405`*^9, 
   3.9425918709932823`*^9}, 3.9430982526884403`*^9, {3.943106042988516*^9, 
   3.943106076844755*^9}, {3.943108704823662*^9, 3.9431087103972626`*^9}, {
   3.943358560356596*^9, 3.943358583894329*^9}, 3.943358615914463*^9, 
   3.9433587817943974`*^9, 3.943368571775612*^9, {3.9433686889968395`*^9, 
   3.943368716318613*^9}, 
   3.943368758918228*^9},ExpressionUUID->"f19b7f51-99bd-4547-9650-\
5ff8e4c33086"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"lin", " ", "log"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.951409650561117*^9, 
  3.951409680608284*^9}},ExpressionUUID->"002de0c7-8e14-2747-b392-\
58662b103a4a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Sistem", " ", "persamaan", " ", "setelah", " ", "substitusi"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"focSystemSub", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
               RowBox[{"qt", "[", "t", "]"}]}], ")"}], "/", 
             RowBox[{"ctE", "[", "t", "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "Delta"}], ")"}], " ", 
             RowBox[{"Mt", "[", "t", "]"}], " ", 
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"pit", "[", 
              RowBox[{"1", "+", "t"}], "]"}], " ", 
             RowBox[{"qt", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "Delta"}], ")"}], " ", 
                 RowBox[{"qt", "[", 
                  RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
              RowBox[{"xi1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"uEt", "[", 
                  RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"1", "/", "2"}], " ", "xi2", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"uEt", "[", 
                   RowBox[{"1", "+", "t"}], "]"}]}], ")"}], "^", "2"}]}]}], 
             ")"}]}], ")"}], "/", 
          RowBox[{"ctE", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}]}], "==", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ctE", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"pit", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"alpha", " ", "betaE"}]}], ")"}], "/", 
               RowBox[{"ctE", "[", "t", "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}], "==", 
        "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"betaE", "^", "t"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
           RowBox[{"kEt", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"xi1", "+", 
             RowBox[{"xi2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"uEt", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
         RowBox[{"ctE", "[", "t", "]"}]}], "==", "0"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Pecahkan", " ", "persamaan", " ", "keDua", " ", "untuk", " ", 
     RowBox[{"muE", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"muESolution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"focSystemSub", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"muE", "[", "t", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Substitusikan", " ", "hasil", " ", 
     RowBox[{"muE", "[", "t", "]"}], " ", "ke", " ", "persamaan", " ", 
     "pertama"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq1Sub", "=", 
     RowBox[{
      RowBox[{"focSystemSub", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/.", " ", 
      RowBox[{"muESolution", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Tambahkan", " ", "persamaan", " ", "ketiga", " ", "ke", " ", "output"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq3", "=", 
     RowBox[{"focSystemSub", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Cetak", " ", "hasil"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Persamaan pertama setelah eliminasi muE[t]: \>\"", ",", 
      "eq1Sub"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Persamaan ketiga tetap: \>\"", ",", "eq3"}], "]"}], ";"}], "\n",
    "solLambDa", "\n", "lambDaNext", "\[IndentingNewLine]", "\n"}]}]], "Input",
 CellChangeTimes->{{3.942508348357641*^9, 3.9425083483586407`*^9}, 
   3.9425104770787735`*^9, 3.946140941609421*^9, {3.9461411946531467`*^9, 
   3.9461412087808075`*^9}, {3.948895005448641*^9, 3.94889500683679*^9}, 
   3.948895068023226*^9, {3.9514096352321167`*^9, 3.9514096390162926`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"e2c58ebf-4fbc-3d4b-ac91-cf15352134a5"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Persamaan pertama setelah eliminasi muE[t]: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["betaE", "t"], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
          RowBox[{"qt", "[", "t", "]"}]}], 
         RowBox[{"ctE", "[", "t", "]"}]], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "Delta"}], ")"}], " ", 
          RowBox[{"Mt", "[", "t", "]"}], " ", 
          RowBox[{"qt", "[", 
           RowBox[{"1", "+", "t"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betaE", " ", 
             RowBox[{"ctE", "[", "t", "]"}]}], "-", 
            RowBox[{
             RowBox[{"ctE", "[", 
              RowBox[{"1", "+", "t"}], "]"}], " ", 
             RowBox[{"pit", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}], "+", 
            RowBox[{"betaE", " ", 
             RowBox[{"ctE", "[", "t", "]"}], " ", 
             RowBox[{"rtE", "[", "t", "]"}]}]}], ")"}]}], 
         RowBox[{
          RowBox[{"ctE", "[", "t", "]"}], " ", 
          RowBox[{"ctE", "[", 
           RowBox[{"1", "+", "t"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}]]}], ")"}]}], "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox["betaE", 
        RowBox[{"1", "+", "t"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Delta"}], ")"}], " ", 
            RowBox[{"qt", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
         RowBox[{"xi1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"uEt", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
         RowBox[{
          FractionBox["1", "2"], " ", "xi2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"uEt", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}], ")"}], "2"]}]}], ")"}]}], 
      RowBox[{"ctE", "[", 
       RowBox[{"1", "+", "t"}], "]"}]]}], "\[Equal]", "0"}]}],
  SequenceForm[
  "Persamaan pertama setelah eliminasi muE[t]: ", \
$CellContext`betaE^$CellContext`t ((-1 + $CellContext`alpha \
$CellContext`betaE) $CellContext`ctE[$CellContext`t]^(-1) \
$CellContext`qt[$CellContext`t] + (-1 + $CellContext`alpha \
$CellContext`betaE) (
        1 - $CellContext`Delta) $CellContext`ctE[$CellContext`t]^(-1) \
$CellContext`ctE[
         1 + $CellContext`t]^(-1) $CellContext`Mt[$CellContext`t] \
$CellContext`qt[
        1 + $CellContext`t] (
         1 + $CellContext`rtE[$CellContext`t])^(-1) ($CellContext`betaE \
$CellContext`ctE[$CellContext`t] - $CellContext`ctE[
         1 + $CellContext`t] $CellContext`pit[
         1 + $CellContext`t] + $CellContext`betaE \
$CellContext`ctE[$CellContext`t] $CellContext`rtE[$CellContext`t])) + \
$CellContext`betaE^(
       1 + $CellContext`t) (-1 + $CellContext`alpha $CellContext`betaE) \
$CellContext`ctE[
       1 + $CellContext`t]^(-1) (-(1 - $CellContext`Delta) $CellContext`qt[
        1 + $CellContext`t] + $CellContext`xi1 (-1 + $CellContext`uEt[
         1 + $CellContext`t]) + 
      Rational[1, 
         2] $CellContext`xi2 (-1 + $CellContext`uEt[1 + $CellContext`t])^2) == 
   0],
  Editable->False]], "Print",
 CellChangeTimes->{3.9518422433057346`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"27a6b6a9-dd39-e946-8645-2ba6d1ddb0de"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Persamaan ketiga tetap: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["betaE", "t"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
      RowBox[{"kEt", "[", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"xi1", "+", 
        RowBox[{"xi2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"uEt", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], 
     RowBox[{"ctE", "[", "t", "]"}]], "\[Equal]", "0"}]}],
  SequenceForm[
  "Persamaan ketiga tetap: ", $CellContext`betaE^$CellContext`t (-1 + \
$CellContext`alpha $CellContext`betaE) $CellContext`ctE[$CellContext`t]^(-1) \
$CellContext`kEt[-1 + $CellContext`t] ($CellContext`xi1 + $CellContext`xi2 \
(-1 + $CellContext`uEt[$CellContext`t])) == 0],
  Editable->False]], "Print",
 CellChangeTimes->{3.951842243311716*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"cf9e50f6-712c-424c-95be-dbd7337e74ff"]
}, Open  ]],

Cell[BoxData["solLambDa"], "Output",
 CellChangeTimes->{3.951842243316704*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"05d66967-42a9-1b46-bc60-6572d22973cd"],

Cell[BoxData["lambDaNext"], "Output",
 CellChangeTimes->{3.951842243321764*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"b470bf8d-902b-4b41-88ec-e30ef5408830"]
}, Open  ]],

Cell[BoxData[""], "Input",ExpressionUUID->"b88ee315-af2d-ad44-b33b-38496d3a52d4"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.942508439620474*^9, 3.942508439622467*^9}, 
   3.947343144267002*^9},ExpressionUUID->"4126ecf3-b2bc-c34e-b9ce-\
ab3dbe467b58"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", 
   RowBox[{"1.", " ", "Clear", " ", "all", " ", "symbols"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "betaE", ",", "alpha", ",", "Delta", ",", "xi1", ",", "xi2", ",", "t", ",",
       "cET", ",", "qT", ",", "MT", ",", "rET", ",", "cET1", ",", "qT1", ",", 
      "pitT1", ",", "uET1", ",", "cETBar", ",", "qBar", ",", "MBar", ",", 
      "rEBar", ",", "cETBar1", ",", "qBar1", ",", "pitBar1", ",", "uEBar1", ",",
       "cEhatT", ",", "qHatT", ",", "MhatT", ",", "rEhatT", ",", "cEhatT1", ",",
       "qHatT1", ",", "pitHatT1", ",", "uEhatT1", ",", "cEhat", ",", "qHat", ",",
       "Mhat", ",", "rEhat", ",", "pitHat", ",", "uEhat"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "2.", " ", "Define", " ", "the", " ", "equation", " ", "function", " ", 
      "F", " ", "cET"}], ",", "qT", ",", "MT", ",", 
     RowBox[{"rET", " ", "represent", " ", 
      RowBox[{"cE", "[", "t", "]"}]}], ",", 
     RowBox[{"q", "[", "t", "]"}], ",", 
     RowBox[{"M", "[", "t", "]"}], ",", 
     RowBox[{
      RowBox[{"rE", "[", "t", "]"}], ";", "\[IndentingNewLine]", "cET1"}], ",",
      "qT1", ",", "pitT1", ",", 
     RowBox[{"uET1", " ", "represent", " ", 
      RowBox[{"cE", "[", 
       RowBox[{"1", "+", "t"}], "]"}]}], ",", 
     RowBox[{"q", "[", 
      RowBox[{"1", "+", "t"}], "]"}], ",", 
     RowBox[{"pit", "[", 
      RowBox[{"1", "+", "t"}], "]"}], ",", 
     RowBox[{
      RowBox[{"uE", "[", 
       RowBox[{"1", "+", "t"}], "]"}], "."}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{
      "cET_", ",", "qT_", ",", "MT_", ",", "rET_", ",", "cET1_", ",", "qT1_", 
       ",", "pitT1_", ",", "uET1_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"betaE", "^", "t"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"alpha", "*", "betaE"}]}], ")"}], "*", "qT"}], ")"}], "/",
           "cET"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"alpha", "*", "betaE"}]}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"1", "-", "Delta"}], ")"}], "*", "MT", "*", "qT1", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"betaE", "*", "cET"}], "-", 
               RowBox[{"cET1", "*", "pitT1"}], "+", 
               RowBox[{"betaE", "*", "cET", "*", "rET"}]}], ")"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"cET", "*", "cET1", "*", 
             RowBox[{"(", 
              RowBox[{"1", "+", "rET"}], ")"}]}], ")"}]}], ")"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"betaE", "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "t"}], ")"}]}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"alpha", "*", "betaE"}]}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "Delta"}], ")"}], "*", "qT1"}], ")"}]}], "+", 
           RowBox[{"xi1", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "uET1"}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"1", "/", "2"}], "*", "xi2", "*", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "uET1"}], ")"}], "^", "2"}]}]}], 
          ")"}]}], ")"}], "/", "cET1"}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "List", " ", "variables", " ", "for", " ", "Differentiation"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{
      "cET", ",", "qT", ",", "MT", ",", "rET", ",", "cET1", ",", "qT1", ",", 
       "pitT1", ",", "uET1"}], "}"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "4.", " ", "Compute", " ", "partial", " ", "Derivatives", " ", "of", " ", 
     "F", " ", "at", " ", "the", " ", "steaDy", " ", "state"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"cET", "->", "cETBar"}], ",", 
          RowBox[{"qT", "->", "qBar"}], ",", 
          RowBox[{"MT", "->", "MBar"}], ",", 
          RowBox[{"rET", "->", "rEBar"}], ",", 
          RowBox[{"cET1", "->", "cETBar1"}], ",", 
          RowBox[{"qT1", "->", "qBar1"}], ",", 
          RowBox[{"pitT1", "->", "pitBar1"}], ",", 
          RowBox[{"uET1", "->", "uEBar1"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"5.", " ", "Define", " ", "symbols", " ", "for", " ", "log"}], "-",
      "Deviations"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"These", " ", "represent", " ", "the", " ", "Deviations", " ", 
     RowBox[{"(", 
      RowBox[{"D", " ", "ln", 
       RowBox[{"(", "variable", ")"}]}], ")"}], " ", "from", " ", "steaDy", " ",
      "state"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"For", " ", "time", " ", "t", " ", 
     RowBox[{"variables", ":"}]}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"cEhatT", ",", "qHatT", ",", "MhatT", ",", "rEhatT"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"For", " ", "time", " ", "t"}], "+", 
     RowBox[{"1", " ", 
      RowBox[{"variables", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"cEhatT1", ",", "qHatT1", ",", "pitHatT1", ",", "uEhatT1"}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"6.", " ", "Form", " ", "the", " ", "linearizeD", " ", 
     RowBox[{"equation", ":", 
      RowBox[{
      "multiply", " ", "each", " ", "Derivative", " ", "by", " ", "steaDy", " ",
        "state", "*", "hat"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", "cETBar", "*", "cEhatT"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", "qBar", "*", "qHatT"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "*", "MBar", "*", "MhatT"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "*", "rEBar", "*", "rEhatT"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "*", "cETBar1", "*", "cEhatT1"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "6", "]"}], "]"}], "*", "qBar1", "*", "qHatT1"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "7", "]"}], "]"}], "*", "pitBar1", "*", "pitHatT1"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "8", "]"}], "]"}], "*", "uEBar1", "*", "uEhatT1"}]}]}], 
    ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "7.", " ", "Simplify", " ", "anD", " ", "set", " ", "steaDy", " ", 
     "state", " ", "values", " ", "equal", " ", "to", " ", "1", " ", 
     RowBox[{"(", "optional", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEqNoBar", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEq", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cETBar", "->", "1"}], ",", 
         RowBox[{"qBar", "->", "1"}], ",", 
         RowBox[{"MBar", "->", "1"}], ",", 
         RowBox[{"rEBar", "->", "1"}], ",", 
         RowBox[{"cETBar1", "->", "1"}], ",", 
         RowBox[{"qBar1", "->", "1"}], ",", 
         RowBox[{"pitBar1", "->", "1"}], ",", 
         RowBox[{"uEBar1", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "8.", " ", "ReintroDuce", " ", "time", " ", "inDices", " ", "anD", " ", 
     "aDjust", " ", "exponents", " ", "on", " ", "betaE"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"timeSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cEhatT", "->", 
        RowBox[{"cEhat", "[", "t", "]"}]}], ",", 
       RowBox[{"qHatT", "->", 
        RowBox[{"qHat", "[", "t", "]"}]}], ",", 
       RowBox[{"MhatT", "->", 
        RowBox[{"Mhat", "[", "t", "]"}]}], ",", 
       RowBox[{"rEhatT", "->", 
        RowBox[{"rEhat", "[", "t", "]"}]}], ",", 
       RowBox[{"cEhatT1", "->", 
        RowBox[{"cEhat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"qHatT1", "->", 
        RowBox[{"qHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"pitHatT1", "->", 
        RowBox[{"pitHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"uEhatT1", "->", 
        RowBox[{"uEhat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"betaE", "^", 
         RowBox[{"(", 
          RowBox[{"1", "+", "t"}], ")"}]}], "->", 
        RowBox[{"betaE", "^", 
         RowBox[{"(", 
          RowBox[{"t", "+", "1"}], ")"}]}]}]}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqTimeInDexeD", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Output", " ", "the", " ", "final", " ", "linearizeD", " ", "equations"}],
     "*)"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"final", "=", 
    RowBox[{"FullSimplify", "[", "eqTimeInDexeD", "]"}]}], "\n", "final", 
   "\[IndentingNewLine]", "\n"}]}]], "Input",
 CellChangeTimes->{{3.942508439620474*^9, 3.942508439622467*^9}, 
   3.947343144267002*^9, 3.947343225841057*^9, 3.9476921206255417`*^9, 
   3.9476925659858646`*^9, {3.9476929256355705`*^9, 3.9476929420413055`*^9}, {
   3.947693156454401*^9, 3.947693171855715*^9}, {3.947693208884466*^9, 
   3.947693262539545*^9}, 3.9476933214529095`*^9, {3.947951709971283*^9, 
   3.947951764419405*^9}, {3.9489897158642616`*^9, 3.9489897394031467`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"e455865f-d51a-c546-92e4-fe2425237d2b"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{{3.9497706593053455`*^9, 3.9497706593053455`*^9}, {
  3.9497709221557274`*^9, 
  3.949770939730934*^9}},ExpressionUUID->"36afece9-c926-264b-a26f-\
39f47d59542e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\"\<Lagrangian\>\"", "\[Rule]", 
    RowBox[{
     RowBox[{"muE", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Delta"}], ")"}], " ", "kEt", " ", "mEt", " ", 
           "pit", " ", "qt"}], ")"}]}], "+", 
        RowBox[{"btE", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "rtE"}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{"lambDaE", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "btE"}], "+", "ctE", "-", 
        RowBox[{"AE", " ", 
         SuperscriptBox["kEt", "alpha"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"LEI", "+", "LEP"}], ")"}], 
          RowBox[{"1", "-", "alpha"}]]}], "+", 
        RowBox[{"kEt", " ", "qt"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "Delta"}], ")"}], " ", "kEt", " ", "qt"}], "+", 
        FractionBox[
         RowBox[{"btE", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "rtE"}], ")"}]}], "pit"], "+", 
        RowBox[{"LEI", " ", "wip"}], "+", 
        RowBox[{"LEP", " ", "wpt"}], "+", 
        RowBox[{"kEt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "uEt"}], ")"}], " ", "xi1"}], "+", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "uEt"}], ")"}], "2"], " ", "xi2"}]}], 
          ")"}]}]}], ")"}]}], "+", 
     RowBox[{"Log", "[", "ctE", "]"}]}]}], ",", 
   RowBox[{"\"\<First-OrDer ConDitions\>\"", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FOC wrt ctE\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{
         FractionBox["1", "ctE"], "+", "lambDaE"}], "\[Equal]", "0"}]}], ",", 
      RowBox[{"\"\<FOC wrt kEt\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Delta"}], ")"}], " ", "mEt", " ", "muE", " ", 
            "pit", " ", "qt"}], ")"}]}], "+", 
         RowBox[{"lambDaE", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "AE"}], " ", "alpha", " ", 
             SuperscriptBox["kEt", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "alpha"}]], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"LEI", "+", "LEP"}], ")"}], 
              RowBox[{"1", "-", "alpha"}]]}], "+", "qt", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "Delta"}], ")"}], " ", "qt"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "uEt"}], ")"}], " ", "xi1"}], "+", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "uEt"}], ")"}], "2"], " ", "xi2"}]}],
            ")"}]}]}], "\[Equal]", "0"}]}], ",", 
      RowBox[{"\"\<FOC wrt btE\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"muE", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "rtE"}], ")"}]}], "+", 
         RowBox[{"lambDaE", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            FractionBox[
             RowBox[{"1", "+", "rtE"}], "pit"]}], ")"}]}]}], "\[Equal]", 
        "0"}]}], ",", 
      RowBox[{"\"\<FOC wrt uEt\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"kEt", " ", "lambDaE", " ", 
         RowBox[{"(", 
          RowBox[{"xi1", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "uEt"}], ")"}], " ", "xi2"}]}], 
          ")"}]}], "\[Equal]", "0"}]}]}], "}"}]}]}], "}"}]], "Input",
 CellChangeTimes->{
  3.9501111036457767`*^9},ExpressionUUID->"ac571d23-c186-944e-833e-\
c2c84de86d8f"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.9476933821967697`*^9, 3.9476933997913017`*^9}, {
  3.9479516911854343`*^9, 
  3.9479517038352757`*^9}},ExpressionUUID->"2dd959b2-176f-8a4f-80e4-\
1ab403b9ba23"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9476933821967697`*^9, 
  3.9476933997913017`*^9}},ExpressionUUID->"7e7eb5ba-8e84-5b42-acd7-\
29c01026fa12"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"1.", " ", "Clear", " ", "all", " ", "symbols"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "betaE", ",", "alpha", ",", "xi1", ",", "xi2", ",", "t", ",", "kEtT", ",",
       "ctET", ",", "uEtT", ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "variables", " ", "in", " ", "F", " ", "corresponDing", " ", "to", " ", 
         RowBox[{"kEt", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ",", 
        RowBox[{"ctE", "[", "t", "]"}], ",", 
        RowBox[{"uEt", "[", "t", "]"}]}], "*)"}], "kEBar", ",", "ctEBar", ",",
       "uEBar", ",", 
      RowBox[{"(*", 
       RowBox[{"steaDy", " ", "state", " ", "values"}], "*)"}], "kEhatT", ",",
       "ctEhatT", ",", "uEhatT", ",", 
      RowBox[{"(*", 
       RowBox[{"log", "-", "Deviations"}], "*)"}], "kEhat", ",", "ctEhat", ",",
       "uEhat"}], "       ", 
     RowBox[{"(*", 
      RowBox[{"time", "-", 
       RowBox[{"inDexeD", " ", "log", " ", "Deviations"}]}], "*)"}], "]"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "2.", " ", "Define", " ", "the", " ", "original", " ", "equation", " ", 
       "as", " ", "F", 
       RowBox[{"(", "...", ")"}]}], "==", 
      RowBox[{"0.", " ", "Here"}]}], ",", 
     RowBox[{"kEtT", " ", "represents", " ", 
      RowBox[{"kEt", "[", 
       RowBox[{"t", "-", "1"}], "]"}]}], ",", 
     RowBox[{"ctET", " ", "represents", " ", 
      RowBox[{"ctE", "[", "t", "]"}]}], ",", 
     RowBox[{"anD", " ", "uEtT", " ", "represents", " ", 
      RowBox[{
       RowBox[{"uEt", "[", "t", "]"}], "."}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{"kEtT_", ",", "ctET_", ",", "uEtT_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"betaE", "^", "t"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"alpha", "*", "betaE"}]}], ")"}], "*", "kEtT", "*", 
        RowBox[{"(", 
         RowBox[{"xi1", "+", 
          RowBox[{"xi2", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "uEtT"}], ")"}]}]}], ")"}]}], ")"}], "/",
       "ctET"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "List", " ", "the", " ", "variables", " ", "for", " ", 
     "Differentiation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{"kEtT", ",", "ctET", ",", "uEtT"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "4.", " ", "Compute", " ", "partial", " ", "Derivatives", " ", "of", " ", 
     "F", " ", "at", " ", "the", " ", "steaDy", " ", "state"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"kEtT", "->", "kEBar"}], ",", 
          RowBox[{"ctET", "->", "ctEBar"}], ",", 
          RowBox[{"uEtT", "->", "uEBar"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"5.", " ", "Define", " ", "symbols", " ", "for", " ", "log"}], "-", 
     RowBox[{"Deviations", " ", 
      RowBox[{"(", 
       RowBox[{"D", " ", "ln", 
        RowBox[{"(", "variable", ")"}]}], ")"}]}]}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"kEhatT", " ", "corresponDs", " ", "to", " ", 
       RowBox[{"kEt", "'"}], "s", " ", "log", " ", "Deviation", " ", "at", " ",
        "time", " ", "t"}], "-", "1"}], ",", 
     RowBox[{"etc", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"kEhatT", ",", "ctEhatT", ",", "uEhatT"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "6.", " ", "Form", " ", "the", " ", "linearizeD", " ", "equation", " ", 
      "by", " ", "multiplying", " ", "each", " ", "Derivative", " ", "by", " ",
       "the", " ", "corresponDing", " ", "steaDy", " ", "state", " ", "anD", " ",
       "log"}], "-", "Deviation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", "kEBar", "*", "kEhatT"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", "ctEBar", "*", "ctEhatT"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "*", "uEBar", "*", "uEhatT"}]}]}], 
    ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "7.", " ", "Simplify", " ", "anD", " ", "optionally", " ", "normalize", " ",
      "steaDy", " ", "state", " ", "values", " ", "to", " ", "1"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEqNoBar", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEq", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"kEBar", "->", "1"}], ",", 
         RowBox[{"ctEBar", "->", "1"}], ",", 
         RowBox[{"uEBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"8.", " ", "ReintroDuce", " ", "time", " ", 
       RowBox[{"inDices", ":", "kEhatT"}]}], "->", 
      RowBox[{
       RowBox[{"kEhat", "[", 
        RowBox[{"t", "-", "1"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"since", " ", "kEtT", " ", "represents", " ", 
         RowBox[{"kEt", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ")"}]}]}], ",", 
     RowBox[{"ctEhatT", "->", 
      RowBox[{"ctEhat", "[", "t", "]"}]}], ",", 
     RowBox[{"uEhatT", "->", 
      RowBox[{"uEhat", "[", "t", "]"}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"timeSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"kEhatT", "->", 
        RowBox[{"kEhat", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], ",", 
       RowBox[{"ctEhatT", "->", 
        RowBox[{"ctEhat", "[", "t", "]"}]}], ",", 
       RowBox[{"uEhatT", "->", 
        RowBox[{"uEhat", "[", "t", "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"eqTimeInDexeD", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Output", " ", "the", " ", "final", " ", "linearizeD", " ", "equations"}],
     "*)"}], "\n", "logLinEqNoBar", "\n", "eqTimeInDexeD", "\n", 
   "\[IndentingNewLine]", "\n"}]}]], "Input",
 CellChangeTimes->{{3.946985315020729*^9, 3.9469853498544445`*^9}, {
   3.9469855371680393`*^9, 3.9469855426712666`*^9}, {3.946986379214081*^9, 
   3.946986384157078*^9}, 3.9469868520171394`*^9, {3.946987699902313*^9, 
   3.9469877303491592`*^9}, 3.9469881338402653`*^9, {3.946988164224745*^9, 
   3.9469881780090294`*^9}, {3.947004166869732*^9, 3.947004204956812*^9}, {
   3.947178139271166*^9, 3.9471781409626083`*^9}, {3.9473433951528263`*^9, 
   3.947343404765833*^9}, 3.9476921024180756`*^9, {3.947693597434248*^9, 
   3.947693625683399*^9}, {3.947694955148752*^9, 3.9476949754949703`*^9}},
 CellLabel->
  "In[206]:=",ExpressionUUID->"0ee05957-9f4b-5148-9577-73fb4d317e3e"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.946985315020729*^9, 3.9469853498544445`*^9}, {
   3.9469855371680393`*^9, 3.9469855426712666`*^9}, {3.946986379214081*^9, 
   3.946986384157078*^9}, 3.9469868520171394`*^9, {3.946987699902313*^9, 
   3.9469877303491592`*^9}, 3.9469881338402653`*^9, {3.946988164224745*^9, 
   3.9469881780090294`*^9}, {3.947004166869732*^9, 3.947004204956812*^9}, {
   3.947178139271166*^9, 3.9471781409626083`*^9}, 3.9473433951528263`*^9, {
   3.947774463264351*^9, 3.947774582804943*^9}, {3.9477746544935417`*^9, 
   3.9477746704503098`*^9}, {3.9488891389506054`*^9, 
   3.9488891511059494`*^9}},ExpressionUUID->"d50ef5dd-7d10-9347-8ed7-\
e6a9098ab778"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9477832974356384`*^9, 3.947783320320606*^9}, 
   3.9488891654065704`*^9},ExpressionUUID->"63b0b1fd-2390-274b-9686-\
decf9bf4215f"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9477832974356384`*^9, 3.9477833320736427`*^9}, {
   3.947783444542406*^9, 3.9477834917791805`*^9}, {3.9477835283245945`*^9, 
   3.9477835684462967`*^9}, 
   3.9477836422302113`*^9},ExpressionUUID->"71ece0e5-c6b3-3242-9291-\
2dce22eed9c9"],

Cell[BoxData[
 RowBox[{"\n", "\[IndentingNewLine]", "\n", "\n", "\n"}]], "Input",
 CellChangeTimes->{{3.9477765584922104`*^9, 3.9477765996736145`*^9}, {
   3.9477766523289223`*^9, 3.9477766537406273`*^9}, {3.947777218009754*^9, 
   3.9477772629500523`*^9}, {3.9477773108772793`*^9, 3.947777314516247*^9}, {
   3.9477774559547176`*^9, 3.94777747338566*^9}, 3.947778172717783*^9, 
   3.9477782078892593`*^9, 3.9477782395551414`*^9, {3.9477796378394737`*^9, 
   3.947779650137188*^9}, {3.9477827329496593`*^9, 3.947782752283697*^9}, {
   3.94778280092708*^9, 3.947782853216881*^9}, {3.948377858154047*^9, 
   3.9483781494883423`*^9}, {3.948889182108549*^9, 
   3.9488891970021114`*^9}},ExpressionUUID->"2c594bee-dfa3-0445-a3c2-\
f168b0935ff6"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9488892088131886`*^9, 
  3.9488892088153896`*^9}},ExpressionUUID->"e7592208-471d-8b47-8fcd-\
f3187cd3bdcd"],

Cell[BoxData[""], "Input",ExpressionUUID->"dcfcb1a1-4b7e-0b43-9670-8664b3289327"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{
  3.9427542379518967`*^9, {3.9427544965523434`*^9, 3.9427545632885056`*^9}, {
   3.946568422636217*^9, 3.9465684433856716`*^9}, 3.9465684783490505`*^9, 
   3.946568532208021*^9, {3.946568632693981*^9, 3.946568653514969*^9}, {
   3.946569857761751*^9, 3.9465698651066914`*^9}, 3.9465723397106075`*^9, 
   3.94665877743454*^9, {3.9466588743666687`*^9, 3.946658879360529*^9}, {
   3.946658937645237*^9, 3.9466589592356358`*^9}, {3.94666007926388*^9, 
   3.946660096683794*^9}, {3.946660162254713*^9, 3.946660179652712*^9}, {
   3.9466603112136536`*^9, 3.9466603652698765`*^9}, 3.9466606586495495`*^9, 
   3.946660721591772*^9, {3.9466614892396374`*^9, 3.946661517609167*^9}, {
   3.9466615581775208`*^9, 3.94666162347818*^9}, 3.9466620995132637`*^9, 
   3.946662154477379*^9, 3.946662259309641*^9, 3.946662304670412*^9, 
   3.9466641153553944`*^9, 3.9477757023255024`*^9, {3.9477757356890717`*^9, 
   3.9477757536725636`*^9}, {3.9477761576092434`*^9, 3.9477761750114326`*^9}},
 CellLabel->"",ExpressionUUID->"a5650fd1-18d4-1d4e-89f1-7b4f1f908005"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.947784073489916*^9, 3.947784073489916*^9}, {
   3.9479524236628036`*^9, 3.947952454649807*^9}, {3.947952601062275*^9, 
   3.947952641709175*^9}, 
   3.948889236198662*^9},ExpressionUUID->"e2dbdcc9-c66d-4441-907d-\
edfe421a4271"],

Cell[BoxData[""], "Input",
 CellLabel->"In[92]:=",ExpressionUUID->"39487013-ded2-0e45-9fd8-d526c979fc41"],

Cell[BoxData[""], "Input",ExpressionUUID->"ad54bf90-5079-e447-887e-2c9f31b492f1"],

Cell[BoxData[
 RowBox[{"\n", "\n"}]], "Input",
 CellChangeTimes->{
  3.948378689768938*^9, {3.9488892704537334`*^9, 
   3.9488892816550026`*^9}},ExpressionUUID->"25e88d48-476a-5a46-a379-\
8531149d9a08"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{{3.94698950101556*^9, 3.9469895031470222`*^9}, {
  3.946989691328703*^9, 
  3.946989705939865*^9}},ExpressionUUID->"90347a46-5dbd-b54f-8f1e-\
a6938e1fe31a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"capital", " ", "goods", "  ", "producers"}], " ", "*)"}], "\n", 
  "\n"}]], "Input",
 CellChangeTimes->{
  3.946989910123577*^9, 3.9477748578081017`*^9, 3.9501860836427307`*^9, {
   3.950186199588213*^9, 3.9501862016725807`*^9}, {3.9502658868305664`*^9, 
   3.9502659086831207`*^9}, 3.9502659491633244`*^9, {3.951487402261017*^9, 
   3.9514874451825047`*^9}},ExpressionUUID->"d48f496e-7176-4c4a-84fa-\
2b0987060b46"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Suppose", " ", "the", " ", "entrepreneur"}], 
       "\[CloseCurlyQuote]"}], "s", " ", "per"}], "-", 
     RowBox[{"period", " ", "utility", " ", 
      RowBox[{"is", ":", "U_t"}]}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CurlyEpsilon]", "*", "Log", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"cE", "[", "t", "]"}], "-", 
          RowBox[{"\[Alpha]", "*", 
           RowBox[{"cE", "[", 
            RowBox[{"t", "-", "1"}], "]"}]}]}], ")"}], ".", "Then"}], " ", 
       "the", " ", "stochastic", " ", "discount", " ", "factor", " ", 
       RowBox[{"(", "SDF", ")"}], " ", "from", " ", "t", " ", "to", " ", 
       "t"}], "+", 
      RowBox[{"1", " ", "arises", " ", 
       RowBox[{"from", ":", 
        RowBox[{"SDF", "[", "t", "]"}]}]}]}], "=", 
     RowBox[{
      RowBox[{"\[Beta]", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"U", "'"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"cE", "[", 
             RowBox[{"t", "+", "1"}], "]"}], ")"}], "/", 
           RowBox[{"U", "'"}]}], 
          RowBox[{"(", 
           RowBox[{"cE", "[", "t", "]"}], ")"}]}], ")"}], ".", "Below"}], " ",
        "is", " ", "a", " ", "Mathematica", " ", "snippet", " ", "that", " ", 
       "defines", " ", "these", " ", "pieces", " ", "and", " ", "shows", " ", 
       "the", " ", "resulting", " ", "closed"}], "-", 
      RowBox[{"form", " ", 
       RowBox[{"expression", "."}]}]}]}]}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{"Parameters", " ", "anD", " ", "Variables"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", 
       RowBox[{"(*", "\[CurlyEpsilon]", "*)"}], "\[Alpha]", ",", 
       RowBox[{"(*", 
        RowBox[{"\[Alpha]", ",", 
         RowBox[{"habit", " ", "parameter"}]}], "*)"}], "\[Beta]", ",", 
       RowBox[{"(*", 
        RowBox[{"\[Beta]", ",", 
         RowBox[{"discount", " ", "factor"}]}], "*)"}], 
       RowBox[{"cE", "[", "t", "]"}], ",", 
       RowBox[{"cE", "[", 
        RowBox[{"t", "-", "1"}], "]"}], ",", 
       RowBox[{"cE", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], "  ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"consumption", " ", "in", " ", "t"}], ",", 
        RowBox[{"t", "-", "1"}], ",", 
        RowBox[{"t", "+", "1"}]}], "*)"}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Utility", " ", "function", " ", "for", " ", "entrepreneurs"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uEntrepreneur", "[", 
      RowBox[{"c_", ",", "cLag_"}], "]"}], ":=", 
     RowBox[{"\[Epsilon]", " ", 
      RowBox[{"Log", "[", 
       RowBox[{"c", "-", 
        RowBox[{"\[Alpha]", " ", "cLag"}]}], "]"}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Marginal", " ", "utility", " ", "wrt", " ", "c"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uEntrepreneurPrime", "[", 
      RowBox[{"c_", ",", "cLag_"}], "]"}], ":=", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"uEntrepreneur", "[", 
        RowBox[{"c", ",", "cLag"}], "]"}], ",", "c"}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "StoChastic", " ", "Discount", " ", "Factor", " ", "from", " ", "t", " ",
       "to", " ", "t"}], "+", "1"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SDF", "[", "t_", "]"}], ":=", 
     RowBox[{"\[Beta]", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"uEntrepreneurPrime", "[", 
         RowBox[{
          RowBox[{"cE", "[", 
           RowBox[{"t", "+", "1"}], "]"}], ",", 
          RowBox[{"cE", "[", "t", "]"}]}], "]"}], "/", 
        RowBox[{"uEntrepreneurPrime", "[", 
         RowBox[{
          RowBox[{"cE", "[", "t", "]"}], ",", 
          RowBox[{"cE", "[", 
           RowBox[{"t", "-", "1"}], "]"}]}], "]"}]}], ")"}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Check", " ", "the", " ", "closed"}], "-", 
     RowBox[{"form", " ", "expression"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SDFExplicit", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"SDF", "[", "t", "]"}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Display", " ", "the", " ", "result"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<SDF[t] Symbolic\>\"", "->", 
      RowBox[{"SDF", "[", "t", "]"}]}], ",", 
     RowBox[{"\"\<SDF[t] Simplified\>\"", "->", "SDFExplicit"}]}], "}"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
        "This", " ", "Mathematica", " ", "code", " ", "sets", " ", "up", " ", 
         "the", " ", "capital"}], "-", 
        RowBox[{"goods", " ", "producer"}]}], "\[CloseCurlyQuote]"}], "s", " ",
       "problem", " ", "shown", " ", "in", " ", "the", " ", 
      RowBox[{"images", ".", "The"}], " ", "CGP", " ", 
      RowBox[{"maximizes", ":", 
       RowBox[{"E0", " ", 
        RowBox[{"\[Sum]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[CapitalLambda]", "^", "E_"}], 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "t"}], "}"}], "[", 
             RowBox[{
              RowBox[{
               RowBox[{"q", "^", "k_t"}], " ", "\[CapitalDelta]x\:0304_t"}], "-",
               "i_t"}], "]"}]}], ")"}], " ", "subject", " ", "to"}]}]}], ":", 
       "x\:0304_t"}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"x\:0304_", 
        RowBox[{"{", 
         RowBox[{"t", "-", "1"}], "}"}]}], "+", 
       RowBox[{
        RowBox[{"[", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Kappa]_i", "/", "2"}], ")"}], "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i_t", "*", 
                RowBox[{
                 RowBox[{"\[CurlyEpsilon]", "^", "k_t"}], "/", "i_"}], 
                RowBox[{"{", 
                 RowBox[{"t", "-", "1"}], "}"}]}], ")"}], "-", "1"}], ")"}], "^",
             "2"}]}]}], "]"}], "*", "i_t", " ", "where", " ", 
        "\[CapitalDelta]x\:0304_t"}]}], "=", 
      RowBox[{"k_t", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Delta]"}], ")"}], " ", "k_", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", "-", "1"}], "}"}], ".", "We"}], " ", "retain", " ", 
        "the", " ", "same", " ", "SDF", " ", "definition", " ", 
        RowBox[{"(", 
         RowBox[{"SDF", "[", "t", "]"}], ")"}], " ", "that", " ", "you", " ", 
        RowBox[{"requested", "."}]}]}]}]}], "*)"}], 
   RowBox[{"(*", 
    RowBox[{
    "Parameters", " ", "anD", " ", "Variables", " ", "matching", " ", "the", " ",
      "problem", " ", "in", " ", "the", " ", "pictures"}], "*)"}], 
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"{", 
      RowBox[{"betaE", ",", "alpha", ",", "delta", ",", "kappaI", ",", 
       RowBox[{"epsilonqk", "[", "t", "]"}], ",", 
       RowBox[{"lambdaCGP", "[", "t", "]"}], ",", 
       RowBox[{"qk", "[", "t", "]"}], ",", 
       RowBox[{"xBar", "[", "t", "]"}], ",", 
       RowBox[{"xBar", "[", 
        RowBox[{"t", "-", "1"}], "]"}], ",", 
       RowBox[{"k", "[", "t", "]"}], ",", 
       RowBox[{"k", "[", 
        RowBox[{"t", "-", "1"}], "]"}], ",", 
       RowBox[{"i", "[", "t", "]"}], ",", 
       RowBox[{"i", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Stochastic", " ", "Discount", " ", "Factor", " ", "for", " ", 
     "entrepreneurs", " ", 
     RowBox[{"(", 
      RowBox[{"kept", " ", "the", " ", "same"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SDF", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"betaE", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "alpha"}], " ", 
           RowBox[{"cE", "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], "+", 
          RowBox[{"cE", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "alpha"}], " ", 
         RowBox[{"cE", "[", "t", "]"}]}], "+", 
        RowBox[{"cE", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Definition", " ", "of", " ", "\[CapitalDelta]x\:0304_t"}], "=", 
     RowBox[{
      RowBox[{"k", "[", "t", "]"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Delta]"}], ")"}], " ", 
       RowBox[{"k", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DeltaXBar", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"k", "[", "t", "]"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "delta"}], ")"}], " ", 
       RowBox[{"k", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{"Quadratic", " ", "adjustment", " ", "cost", " ", 
     RowBox[{"function", ":", 
      RowBox[{
       RowBox[{"\[Kappa]_i", "/", "2"}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"i", "[", "t", "]"}], "*", 
            RowBox[{
             RowBox[{"\[CurlyEpsilon]", "^", "k_t"}], "/", 
             RowBox[{"i", "[", 
              RowBox[{"t", "-", "1"}], "]"}]}]}], ")"}], "-", "1"}], ")"}], "^",
         "2"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PhiAdjust", "[", 
      RowBox[{"i_", ",", "iLag_", ",", "eps_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"kappaI", "/", "2"}], ")"}], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", " ", 
           RowBox[{"eps", "/", "iLag"}]}], ")"}], "-", "1"}], ")"}], "^", 
       "2"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Law", " ", "of", " ", 
      RowBox[{"Motion", ":", "x\:0304_t"}]}], "=", 
     RowBox[{
      RowBox[{"x\:0304_", 
       RowBox[{"{", 
        RowBox[{"t", "-", "1"}], "}"}]}], "+", 
      RowBox[{
       RowBox[{"[", 
        RowBox[{"1", "-", 
         RowBox[{"\[CurlyPhi]", 
          RowBox[{"(", "...", ")"}]}]}], "]"}], "*", 
       RowBox[{"i", "[", "t", "]"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"XBarLaw", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"xBar", "[", "t", "]"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"xBar", "[", 
         RowBox[{"t", "-", "1"}], "]"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"PhiAdjust", "[", 
            RowBox[{
             RowBox[{"i", "[", "t", "]"}], ",", 
             RowBox[{"i", "[", 
              RowBox[{"t", "-", "1"}], "]"}], ",", 
             RowBox[{"epsilonqk", "[", "t", "]"}]}], "]"}]}], ")"}], " ", 
         RowBox[{"i", "[", "t", "]"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Per", "-", 
     RowBox[{"period", " ", 
      RowBox[{"payoff", ":", 
       RowBox[{
        RowBox[{
         RowBox[{"q", "^", "k_t"}], "*", "\[CapitalDelta]x\:0304_t"}], "-", 
        RowBox[{"i", "[", "t", "]"}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Payoff", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"qk", "[", "t", "]"}], " ", 
       RowBox[{"DeltaXBar", "[", "t", "]"}]}], "-", 
      RowBox[{"i", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Two", "-", 
      RowBox[{"period", " ", "Lagrangian", " ", "for", " ", "the", " ", 
       RowBox[{"CGP", ":", 
        RowBox[{
         RowBox[{"We", " ", "show", " ", "t", " ", "and", " ", "t"}], "+", 
         RowBox[{"1", " ", "explicitly"}]}]}]}]}], ",", 
     RowBox[{"mirroring", " ", "your", " ", "example", " ", "code", " ", 
      RowBox[{"style", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"LCGP", "=", 
    RowBox[{
     RowBox[{"betaE", "^", "t"}], "*", 
     RowBox[{"SDF", "[", "t", "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Payoff", "[", "t", "]"}], "+", 
       RowBox[{
        RowBox[{"lambdaCGP", "[", "t", "]"}], " ", 
        RowBox[{"XBarLaw", "[", "t", "]"}]}]}], ")"}]}]}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"+", 
      RowBox[{"betaE", "^", 
       RowBox[{"(", 
        RowBox[{"t", "+", "1"}], ")"}]}]}], "*", 
     RowBox[{"SDF", "[", 
      RowBox[{"t", "+", "1"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Payoff", "[", 
        RowBox[{"t", "+", "1"}], "]"}], "+", 
       RowBox[{
        RowBox[{"lambdaCGP", "[", 
         RowBox[{"t", "+", "1"}], "]"}], " ", 
        RowBox[{"XBarLaw", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"First", "-", 
        RowBox[{
        "OrDer", " ", "conDitions", " ", "for", " ", "the", " ", "CGP"}]}], 
       "\[CloseCurlyQuote]"}], "s", " ", "choice", " ", "variables", " ", 
      "x\:0304_t"}], ",", "i_t"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focXBar", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LCGP", ",", 
        RowBox[{"xBar", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "  ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "x\:0304_t"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focIt", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LCGP", ",", 
        RowBox[{"i", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "     ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", 
     RowBox[{"i", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Display", " ", "results"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DebugFOCsCGP", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<FOC wrt x\:0304_t\>\"", "->", "focXBar"}], ",", 
       RowBox[{"\"\<FOC wrt i[t]\>\"", "->", "focIt"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Output", " ", "the", " ", "Lagrangian", " ", "anD", " ", "FOCs"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Lagrangian (CGP)\>\"", "->", "LCGP"}], ",", 
     RowBox[{"\"\<First-OrDer ConDitions (CGP)\>\"", "->", "DebugFOCsCGP"}]}],
     "}"}], "\[IndentingNewLine]", "\n"}]}]], "Input",
 CellChangeTimes->{{3.9469965989965515`*^9, 3.946996631543125*^9}, {
   3.946996679326996*^9, 3.946996680746643*^9}, {3.9469967383488903`*^9, 
   3.9469967415651703`*^9}, 3.947000760794897*^9, 3.947774826414343*^9, {
   3.9501999609721794`*^9, 3.9502000322933025`*^9}, {3.950200238019457*^9, 
   3.9502002517959785`*^9}, {3.950200764215065*^9, 3.9502007662074356`*^9}, 
   3.9502013952283783`*^9, 3.9502674799783707`*^9, 3.950267528983282*^9, 
   3.950267569137388*^9},
 CellLabel->
  "In[166]:=",ExpressionUUID->"16a53433-1cc7-e74a-b3e2-121a43b05c36"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"SDF[t] Symbolic\"\>", "\[Rule]", 
    FractionBox[
     RowBox[{"\[Beta]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Alpha]"}], " ", 
         RowBox[{"cE", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
        RowBox[{"cE", "[", "t", "]"}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[Alpha]"}], " ", 
       RowBox[{"cE", "[", "t", "]"}]}], "+", 
      RowBox[{"cE", "[", 
       RowBox[{"1", "+", "t"}], "]"}]}]]}], ",", 
   RowBox[{"\<\"SDF[t] Simplified\"\>", "\[Rule]", 
    FractionBox[
     RowBox[{"\[Beta]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Alpha]"}], " ", 
         RowBox[{"cE", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
        RowBox[{"cE", "[", "t", "]"}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[Alpha]"}], " ", 
       RowBox[{"cE", "[", "t", "]"}]}], "+", 
      RowBox[{"cE", "[", 
       RowBox[{"1", "+", "t"}], "]"}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.951406501485552*^9},
 CellLabel->
  "Out[171]=",ExpressionUUID->"f4623e57-3245-7040-a916-f679b48e75eb"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["betaE", 
    RowBox[{"1", "+", "t"}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "alpha"}], " ", 
      RowBox[{"cE", "[", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
     RowBox[{"cE", "[", "t", "]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"i", "[", "t", "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "delta"}], ")"}], " ", 
           RowBox[{"k", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], "]"}]}], ")"}]}], "+", 
        RowBox[{"k", "[", "t", "]"}]}], ")"}], " ", 
      RowBox[{"qk", "[", "t", "]"}]}], "+", 
     RowBox[{
      RowBox[{"lambdaCGP", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"i", "[", "t", "]"}]}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            FractionBox["1", "2"], " ", "kappaI", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"epsilonqk", "[", "t", "]"}], " ", 
                 RowBox[{"i", "[", "t", "]"}]}], 
                RowBox[{"i", "[", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "t"}], "]"}]]}], ")"}], "2"]}]}], 
          ")"}]}], "-", 
        RowBox[{"xBar", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}], "+", 
        RowBox[{"xBar", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{
    RowBox[{"-", "alpha"}], " ", 
    RowBox[{"cE", "[", "t", "]"}]}], "+", 
   RowBox[{"cE", "[", 
    RowBox[{"1", "+", "t"}], "]"}]}]]], "Output",
 CellChangeTimes->{3.951406501491602*^9},
 CellLabel->
  "Out[178]=",ExpressionUUID->"e913f95b-f991-7148-b251-827c609892fb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"Lagrangian (CGP)\"\>", "\[Rule]", 
    FractionBox[
     RowBox[{
      SuperscriptBox["betaE", 
       RowBox[{"1", "+", "t"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "alpha"}], " ", 
         RowBox[{"cE", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
        RowBox[{"cE", "[", "t", "]"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"i", "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "delta"}], ")"}], " ", 
              RowBox[{"k", "[", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "t"}], "]"}]}], ")"}]}], "+", 
           RowBox[{"k", "[", "t", "]"}]}], ")"}], " ", 
         RowBox[{"qk", "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"lambdaCGP", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"i", "[", "t", "]"}]}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{
               FractionBox["1", "2"], " ", "kappaI", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"epsilonqk", "[", "t", "]"}], " ", 
                    RowBox[{"i", "[", "t", "]"}]}], 
                   RowBox[{"i", "[", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "t"}], "]"}]]}], ")"}], "2"]}]}],
              ")"}]}], "-", 
           RowBox[{"xBar", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], "]"}], "+", 
           RowBox[{"xBar", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"-", "alpha"}], " ", 
       RowBox[{"cE", "[", "t", "]"}]}], "+", 
      RowBox[{"cE", "[", 
       RowBox[{"1", "+", "t"}], "]"}]}]]}], ",", 
   RowBox[{"\<\"First-OrDer ConDitions (CGP)\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\<\"FOC wrt x\:0304_t\"\>", "\[Rule]", 
       RowBox[{
        FractionBox[
         RowBox[{
          SuperscriptBox["betaE", 
           RowBox[{"1", "+", "t"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "alpha"}], " ", 
             RowBox[{"cE", "[", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
            RowBox[{"cE", "[", "t", "]"}]}], ")"}], " ", 
          RowBox[{"lambdaCGP", "[", "t", "]"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"-", "alpha"}], " ", 
           RowBox[{"cE", "[", "t", "]"}]}], "+", 
          RowBox[{"cE", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}]], "\[Equal]", "0"}]}], ",", 
      RowBox[{"\<\"FOC wrt i[t]\"\>", "\[Rule]", 
       RowBox[{
        FractionBox[
         RowBox[{
          SuperscriptBox["betaE", 
           RowBox[{"1", "+", "t"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "alpha"}], " ", 
             RowBox[{"cE", "[", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
            RowBox[{"cE", "[", "t", "]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               FractionBox[
                RowBox[{"kappaI", " ", 
                 RowBox[{"epsilonqk", "[", "t", "]"}], " ", 
                 RowBox[{"i", "[", "t", "]"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   FractionBox[
                    RowBox[{
                    RowBox[{"epsilonqk", "[", "t", "]"}], " ", 
                    RowBox[{"i", "[", "t", "]"}]}], 
                    RowBox[{"i", "[", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "t"}], "]"}]]}], ")"}]}], 
                RowBox[{"i", "[", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "t"}], "]"}]], "+", 
               RowBox[{
                FractionBox["1", "2"], " ", "kappaI", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   FractionBox[
                    RowBox[{
                    RowBox[{"epsilonqk", "[", "t", "]"}], " ", 
                    RowBox[{"i", "[", "t", "]"}]}], 
                    RowBox[{"i", "[", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "t"}], "]"}]]}], ")"}], "2"]}]}],
               ")"}], " ", 
             RowBox[{"lambdaCGP", "[", "t", "]"}]}]}], ")"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"-", "alpha"}], " ", 
           RowBox[{"cE", "[", "t", "]"}]}], "+", 
          RowBox[{"cE", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}]], "\[Equal]", "0"}]}]}], 
     "}"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.9514065015005817`*^9},
 CellLabel->
  "Out[183]=",ExpressionUUID->"34f16153-f5b0-854d-abf7-da8cc57f71b8"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9469965989965515`*^9, 3.946996631543125*^9}, {
   3.946996679326996*^9, 3.946996680746643*^9}, {3.9469967383488903`*^9, 
   3.9469967415651703`*^9}, 3.947000760794897*^9, 3.947774826414343*^9, {
   3.9501999609721794`*^9, 3.9502000322933025`*^9}, {3.950200238019457*^9, 
   3.9502002517959785`*^9}, {3.950200764215065*^9, 3.9502007662074356`*^9}, {
   3.9502013952283783`*^9, 3.950201402744711*^9}, {3.9502022054596615`*^9, 
   3.9502022201002007`*^9}, 3.9502030838401623`*^9, {3.9502692312131824`*^9, 
   3.950269286096243*^9}, {3.950270005848982*^9, 3.95027008061767*^9}, {
   3.950270637712412*^9, 3.9502707108744354`*^9}, {3.9502707971885796`*^9, 
   3.950270806424429*^9}, {3.9502806454427814`*^9, 3.9502806777824135`*^9}, 
   3.950280734597988*^9, {3.9502808394181385`*^9, 3.9502808580168877`*^9}, {
   3.9502809261695385`*^9, 3.9502809374790955`*^9}, {3.9502812606911793`*^9, 
   3.9502812795056458`*^9}, {3.9502813808223953`*^9, 3.950281413786543*^9}, {
   3.950281729008545*^9, 3.950281768098095*^9}, 
   3.9514775792455254`*^9},ExpressionUUID->"77eb66bf-25c7-814f-892e-\
141a5e72138f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "alpha", ",", "betaE", ",", "cE", ",", "lambdaCGP", ",", "kappaI", ",", 
    "epsilonqk", ",", "i", ",", "t"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"eqFOCi", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"betaE", "^", 
        RowBox[{"(", 
         RowBox[{"1", "+", "t"}], ")"}]}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "alpha"}], " ", 
          RowBox[{"cE", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"cE", "[", "t", "]"}]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"kappaI", "*", 
               RowBox[{"epsilonqk", "[", "t", "]"}], "*", 
               RowBox[{"i", "[", "t", "]"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"epsilonqk", "[", "t", "]"}], "*", 
                    RowBox[{"i", "[", "t", "]"}]}], ")"}], "/", 
                  RowBox[{"i", "[", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "t"}], "]"}]}]}], ")"}]}], ")"}],
              "/", 
             RowBox[{"i", "[", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"1", "/", "2"}], "*", "kappaI", "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"epsilonqk", "[", "t", "]"}], "*", 
                   RowBox[{"i", "[", "t", "]"}]}], ")"}], "/", 
                 RowBox[{"i", "[", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "t"}], "]"}]}]}], ")"}], "^", 
              "2"}]}]}], ")"}], "*", 
          RowBox[{"lambdaCGP", "[", "t", "]"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "alpha"}], " ", 
        RowBox[{"cE", "[", "t", "]"}]}], "+", 
       RowBox[{"cE", "[", 
        RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "==", "0"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{"eqFOCi", ",", 
     RowBox[{"lambdaCGP", "[", "t", "]"}]}], "]"}]}], "\n"}], "\n"}], "Input",
 CellChangeTimes->{{3.9469965989965515`*^9, 3.946996631543125*^9}, {
   3.946996679326996*^9, 3.946996680746643*^9}, {3.9469967383488903`*^9, 
   3.9469967415651703`*^9}, 3.947000760794897*^9, 3.947774826414343*^9, {
   3.9501999609721794`*^9, 3.9502000322933025`*^9}, {3.950200238019457*^9, 
   3.9502002517959785`*^9}, {3.950200764215065*^9, 3.9502007662074356`*^9}, {
   3.9502013952283783`*^9, 3.950201402744711*^9}, {3.9502022054596615`*^9, 
   3.9502022232219734`*^9}, 3.9502024738345585`*^9, 3.950202628363079*^9, 
   3.9502027110537453`*^9, {3.95020293721303*^9, 3.9502029626750774`*^9}, {
   3.950203564431284*^9, 3.950203579588623*^9}, 3.9502860199324055`*^9, 
   3.95028612207493*^9, {3.951409869828396*^9, 3.9514099013589478`*^9}, {
   3.951409948108919*^9, 3.951409951859535*^9}, {3.9514775974279156`*^9, 
   3.9514776047801476`*^9}, 3.951488415994793*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"d3fbe8a6-1bcf-4c49-aab0-7b7e97bb8801"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"lambdaCGP", "[", "t", "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"i", "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "t"}], "]"}], "2"]}], 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SuperscriptBox[
        RowBox[{"i", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}], "2"]}], "+", 
      RowBox[{"kappaI", " ", 
       SuperscriptBox[
        RowBox[{"i", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}], "2"]}], "-", 
      RowBox[{"4", " ", "kappaI", " ", 
       RowBox[{"epsilonqk", "[", "t", "]"}], " ", 
       RowBox[{"i", "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
       RowBox[{"i", "[", "t", "]"}]}], "+", 
      RowBox[{"3", " ", "kappaI", " ", 
       SuperscriptBox[
        RowBox[{"epsilonqk", "[", "t", "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"i", "[", "t", "]"}], "2"]}]}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.9514884306452007`*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"d6ce9a1e-4cd2-5542-b529-9213b99720e6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "alpha", ",", "betaE", ",", "cE", ",", "lambdaCGP", ",", "kappaI", ",", 
      "epsilonqk", ",", "i", ",", "t"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Define", " ", "FOC", " ", "wrt", " ", "x\:0304_t"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"eqXbar", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"betaE", "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "t"}], ")"}]}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "alpha"}], " ", 
            RowBox[{"cE", "[", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
           RowBox[{"cE", "[", "t", "]"}]}], ")"}], "*", 
         RowBox[{"lambdaCGP", "[", "t", "]"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "alpha"}], " ", 
          RowBox[{"cE", "[", "t", "]"}]}], "+", 
         RowBox[{"cE", "[", 
          RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "==", "0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Previously", " ", "solved", " ", "expression", " ", "for", " ", 
     RowBox[{"\[Lambda]CGP", "[", "t", "]"}], " ", "from", " ", "FOC", " ", 
     "wrt", " ", 
     RowBox[{"i", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"lambdaSol", "=", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"kappaI", "*", 
           RowBox[{"epsilonqk", "[", "t", "]"}], "*", 
           RowBox[{"i", "[", "t", "]"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"epsilonqk", "[", "t", "]"}], "*", 
                RowBox[{"i", "[", "t", "]"}]}], ")"}], "/", 
              RowBox[{"i", "[", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "t"}], "]"}]}]}], ")"}]}], ")"}], "/", 
         RowBox[{"i", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"1", "/", "2"}], "*", "kappaI", "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"epsilonqk", "[", "t", "]"}], "*", 
               RowBox[{"i", "[", "t", "]"}]}], ")"}], "/", 
             RowBox[{"i", "[", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "t"}], "]"}]}]}], ")"}], "^", 
          "2"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Substitute", " ", "the", " ", "solution", " ", "into", " ", "eqXbar"}], 
    "*)"}], "\n", 
   RowBox[{"eqXbarSub", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"eqXbar", "/.", " ", 
      RowBox[{
       RowBox[{"lambdaCGP", "[", "t", "]"}], "->", "lambdaSol"}]}], "]"}]}], 
   "\n", "\n"}]}]], "Input",
 CellChangeTimes->{{3.9469965989965515`*^9, 3.946996631543125*^9}, {
   3.946996679326996*^9, 3.946996680746643*^9}, {3.9469967383488903`*^9, 
   3.9469967415651703`*^9}, 3.947000760794897*^9, 3.947774826414343*^9, {
   3.9501999609721794`*^9, 3.9502000322933025`*^9}, {3.950200238019457*^9, 
   3.9502002517959785`*^9}, {3.950200764215065*^9, 3.9502007662074356`*^9}, {
   3.9502013952283783`*^9, 3.950201402744711*^9}, {3.9502022054596615`*^9, 
   3.9502022232219734`*^9}, 3.9502024738345585`*^9, 3.950202628363079*^9, 
   3.9502027110537453`*^9, {3.95020293721303*^9, 3.9502029626750774`*^9}, {
   3.950203564431284*^9, 3.950203579588623*^9}, 3.9502860199324055`*^9, 
   3.95028612207493*^9, {3.950286423485401*^9, 3.950286446982321*^9}, {
   3.950286506835623*^9, 3.9502865275831623`*^9}, {3.951409975829359*^9, 
   3.9514100034472713`*^9}, {3.9514770402051067`*^9, 3.9514770609336014`*^9}, 
   3.9514886954558296`*^9},
 CellLabel->"In[4]:=",ExpressionUUID->"d37752d8-fb3d-7247-8f77-660249fd4a56"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["betaE", 
     RowBox[{"1", "+", "t"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"alpha", " ", 
       RowBox[{"cE", "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "-", 
      RowBox[{"cE", "[", "t", "]"}]}], ")"}], " ", 
    RowBox[{"i", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "t"}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"alpha", " ", 
       RowBox[{"cE", "[", "t", "]"}]}], "-", 
      RowBox[{"cE", "[", 
       RowBox[{"1", "+", "t"}], "]"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "kappaI"}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"i", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}], "2"]}], "-", 
      RowBox[{"4", " ", "kappaI", " ", 
       RowBox[{"epsilonqk", "[", "t", "]"}], " ", 
       RowBox[{"i", "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
       RowBox[{"i", "[", "t", "]"}]}], "+", 
      RowBox[{"3", " ", "kappaI", " ", 
       SuperscriptBox[
        RowBox[{"epsilonqk", "[", "t", "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"i", "[", "t", "]"}], "2"]}]}], ")"}]}]], "\[Equal]", 
  "0"}]], "Output",
 CellChangeTimes->{3.9502861321010246`*^9, 3.9502864523893433`*^9, 
  3.9502865403053646`*^9, 3.951488700395708*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"42d42ef7-26f8-c04c-8ef7-1a1b4a14750e"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.9502016545038395`*^9, 3.950201654505865*^9}, 
   3.9502025131039963`*^9},ExpressionUUID->"29301e91-6e10-8c4f-afc4-\
c94f23b0efb0"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{3.950201691279455*^9, 3.9506120021878185`*^9, 
  3.9506120837707024`*^9},ExpressionUUID->"f05d0b3f-6357-3446-a911-\
25cc90b9a22c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"gooD", " ", "retailers"}], " ", "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.950103647952732*^9, 
  3.9501036726561413`*^9}},ExpressionUUID->"d070ec15-5827-424c-a894-\
be6eaf80dbd8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
        "Suppose", " ", "the", " ", "\"\<patient\>\"", " ", "household"}], 
        "\[CloseCurlyQuote]"}], "s", " ", "per"}], "-", 
      RowBox[{"period", " ", "utility", " ", 
       RowBox[{"is", ":", 
        RowBox[{"U_t", "^", "P"}]}]}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"\[Alpha]", "^", "P"}]}], ")"}], "*", 
        RowBox[{"\[Xi]_t", "^", "P"}], "*", 
        RowBox[{"Log", "[", 
         RowBox[{"c_t", "^", "P"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"\[Alpha]", "^", "P"}], "*", "c_", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", "-", "1"}], "}"}], "^", "P"}]}], "+", 
       RowBox[{
        RowBox[{"\[CurlyEpsilon]_t", "^", "P"}], "*", 
        RowBox[{"Log", "[", 
         RowBox[{"l_t", "^", "P"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"l_t", "^", "P"}], ")"}], "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[CurlyPhi]"}], ")"}]}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "+", "\[CurlyPhi]"}], ")"}]}], " ", "Then", " ", "the",
         " ", "Stochastic", " ", "Discount", " ", "Factor", " ", 
        RowBox[{"(", "SDF", ")"}], " ", "from", " ", "t", " ", "to", " ", 
        "t"}], "+", 
       RowBox[{"1", " ", 
        RowBox[{"is", ":", 
         RowBox[{"SDF", "[", "t", "]"}]}]}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Beta]", "^", "P"}], "*", 
        RowBox[{"(", 
         RowBox[{"MU_", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", "+", "1"}], "}"}], "/", "MU_t"}]}], ")"}], " ", 
        "where", " ", "MU_t"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[PartialD]", 
           RowBox[{"U_t", "^", "P"}]}], "/", 
          RowBox[{
           RowBox[{"\[PartialD]", 
            RowBox[{"c_t", "^", "P"}]}], ".", "Below"}]}], " ", "is", " ", 
         "a", " ", "Mathematica", " ", "snippet", " ", "that", " ", "defines",
          " ", "these", " ", "pieces", " ", "and", " ", "shows", " ", "the", " ",
          "resulting", " ", "closed"}], "-", 
        RowBox[{"form", " ", "expression"}]}]}]}]}], ",", 
    RowBox[{"using", " ", "Greek", " ", "letters", " ", "where", " ", 
     RowBox[{"appropriate", "."}]}]}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "Parameters", " ", "and", " ", "Variables", " ", "for", " ", "the", 
    " ", "\"\<patient\>\"", " ", "household"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"{", 
      RowBox[{"\[Beta]P", ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"\[Beta]", "^", "P"}], ",", 
         RowBox[{"discount", " ", "factor"}]}], "*)"}], "\[Alpha]P", ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"\[Alpha]", "^", "P"}], ",", 
         RowBox[{"habit", " ", "parameter"}]}], "*)"}], "\[Phi]", ",", 
       RowBox[{"(*", 
        RowBox[{"\[CurlyPhi]", ",", 
         RowBox[{"disutility", "-", "of", "-", 
          RowBox[{"labor", " ", "exponent"}]}]}], "*)"}], 
       RowBox[{"cP", "[", "t", "]"}], ",", 
       RowBox[{"cP", "[", 
        RowBox[{"t", "-", "1"}], "]"}], ",", 
       RowBox[{"cP", "[", 
        RowBox[{"t", "+", "1"}], "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"consumption", " ", "at", " ", "t"}], "-", "1"}], ",", "t", 
         ",", 
         RowBox[{"t", "+", "1"}]}], "*)"}], 
       RowBox[{"lP", "[", "t", "]"}], ",", 
       RowBox[{"lP", "[", 
        RowBox[{"t", "+", "1"}], "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"labor", " ", "at", " ", "t"}], ",", 
         RowBox[{"t", "+", "1"}]}], "*)"}], 
       RowBox[{"\[Xi]P", "[", "t", "]"}], ",", 
       RowBox[{"\[Xi]P", "[", 
        RowBox[{"t", "+", "1"}], "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{"shock", " ", 
         RowBox[{"\[Xi]_t", "^", "P"}]}], "*)"}], 
       RowBox[{"\[Epsilon]P", "[", "t", "]"}], ",", 
       RowBox[{"\[Epsilon]P", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], "  ", 
      RowBox[{"(*", 
       RowBox[{"shock", " ", 
        RowBox[{"\[CurlyEpsilon]_t", "^", "P"}]}], "*)"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"1", ")"}], " ", "Utility", " ", "function", " ", "for", " ", 
     "the", " ", "patient", " ", "household"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uPatient", "[", 
     RowBox[{"c_", ",", "cLag_", ",", "l_", ",", "xi_", ",", "eps_"}], "]"}], 
    ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Alpha]P"}], ")"}], " ", "xi", " ", 
     RowBox[{"Log", "[", "c", "]"}]}]}], "\n", 
   RowBox[{
    RowBox[{"-", "\[Alpha]P"}], " ", "cLag"}], "\n", 
   RowBox[{
    RowBox[{"+", "eps"}], " ", 
    RowBox[{"Log", "[", "l", "]"}]}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"l", "^", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Phi]"}], ")"}]}]}], "/", 
     RowBox[{"(", 
      RowBox[{"1", "+", "\[Phi]"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"2", ")"}], " ", "Marginal", " ", "utility", " ", "wrt", " ", 
     "consumption", " ", "c"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uPatientPrime", "[", 
      RowBox[{"c_", ",", "cLag_", ",", "l_", ",", "xi_", ",", "eps_"}], "]"}],
      ":=", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"uPatient", "[", 
        RowBox[{"c", ",", "cLag", ",", "l", ",", "xi", ",", "eps"}], "]"}], ",",
        "c"}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"3", ")"}], " ", "Stochastic", " ", "Discount", " ", "Factor",
         " ", "from", " ", "t", " ", "to", " ", "t"}], "+", "1"}], ":", 
      RowBox[{"SDF", "[", "t", "]"}]}], "=", 
     RowBox[{
      RowBox[{"\[Beta]", "^", "P"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"uPatientPrime", "[", 
         RowBox[{"t", "+", "1"}], "]"}], "/", 
        RowBox[{"uPatientPrime", "[", "t", "]"}]}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SDF", "[", "t_", "]"}], ":=", 
     RowBox[{"\[Beta]P", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"uPatientPrime", "[", 
         RowBox[{
          RowBox[{"cP", "[", 
           RowBox[{"t", "+", "1"}], "]"}], ",", 
          RowBox[{"cP", "[", "t", "]"}], ",", 
          RowBox[{"lP", "[", 
           RowBox[{"t", "+", "1"}], "]"}], ",", 
          RowBox[{"\[Xi]P", "[", 
           RowBox[{"t", "+", "1"}], "]"}], ",", 
          RowBox[{"\[Epsilon]P", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "]"}], "/", 
        RowBox[{"uPatientPrime", "[", 
         RowBox[{
          RowBox[{"cP", "[", "t", "]"}], ",", 
          RowBox[{"cP", "[", 
           RowBox[{"t", "-", "1"}], "]"}], ",", 
          RowBox[{"lP", "[", "t", "]"}], ",", 
          RowBox[{"\[Xi]P", "[", "t", "]"}], ",", 
          RowBox[{"\[Epsilon]P", "[", "t", "]"}]}], "]"}]}], ")"}]}]}], ";"}],
    "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"4", ")"}], " ", "Check", " ", "the", " ", "closed"}], "-", 
     RowBox[{"form", " ", "expression"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SDFExplicit", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"SDF", "[", "t", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Output", " ", "the", " ", "SDF", " ", "and", " ", "its", " ", 
     "simplified", " ", "form"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<SDF[t] (Symbolic)\>\"", "->", 
      RowBox[{"SDF", "[", "t", "]"}]}], ",", 
     RowBox[{"\"\<SDF[t] (Simplified)\>\"", "->", "SDFExplicit"}]}], "}"}], 
   "\n", "\n"}]}]], "Input",
 CellChangeTimes->{{3.9469966392186947`*^9, 3.9469966392196903`*^9}, 
   3.9469967613630085`*^9, 3.950289481443823*^9, {3.950289633809429*^9, 
   3.9502896490426273`*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"0d88e268-8e18-e44d-b2d8-cdf7e7401492"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "cLag"}], " ", "\[Alpha]P"}]], "Output",
 CellChangeTimes->{3.95028948822678*^9, 3.950289654259281*^9, 
  3.9506238611198215`*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"5d8d1637-1790-d84b-8c45-427fa9f5f89a"],

Cell[BoxData[
 RowBox[{"eps", " ", 
  RowBox[{"Log", "[", "l", "]"}]}]], "Output",
 CellChangeTimes->{3.95028948822678*^9, 3.950289654259281*^9, 
  3.9506238611228123`*^9},
 CellLabel->"Out[75]=",ExpressionUUID->"3b94fb6c-6563-db47-9ae1-75ac9172b9e8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"SDF[t] (Symbolic)\"\>", "\[Rule]", 
    FractionBox[
     RowBox[{"\[Beta]P", " ", 
      RowBox[{"cP", "[", "t", "]"}], " ", 
      RowBox[{"\[Xi]P", "[", 
       RowBox[{"1", "+", "t"}], "]"}]}], 
     RowBox[{
      RowBox[{"cP", "[", 
       RowBox[{"1", "+", "t"}], "]"}], " ", 
      RowBox[{"\[Xi]P", "[", "t", "]"}]}]]}], ",", 
   RowBox[{"\<\"SDF[t] (Simplified)\"\>", "\[Rule]", 
    FractionBox[
     RowBox[{"\[Beta]P", " ", 
      RowBox[{"cP", "[", "t", "]"}], " ", 
      RowBox[{"\[Xi]P", "[", 
       RowBox[{"1", "+", "t"}], "]"}]}], 
     RowBox[{
      RowBox[{"cP", "[", 
       RowBox[{"1", "+", "t"}], "]"}], " ", 
      RowBox[{"\[Xi]P", "[", "t", "]"}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.95028948822678*^9, 3.950289654259281*^9, 
  3.9506238611268024`*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"087c4fde-4a2d-c241-aa36-e9571c2992a7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", "\n", "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.9501038916986656`*^9, 3.9501038916986656`*^9}, {
   3.9501039715672855`*^9, 3.9501040144899654`*^9}, 3.9501045020819263`*^9, {
   3.950610212966301*^9, 3.950610214822403*^9}, {3.950622506897087*^9, 
   3.9506225088915863`*^9}, {3.9506225420766373`*^9, 3.950622544900259*^9}, 
   3.9506234791285343`*^9, {3.9506235099291496`*^9, 3.9506235528670616`*^9}, {
   3.9506236030889893`*^9, 3.9506236454205265`*^9}, {3.9506236820965614`*^9, 
   3.9506236972244263`*^9}, {3.950623728740467*^9, 3.9506237329032574`*^9}, {
   3.950623793799574*^9, 3.9506238010631504`*^9}, 
   3.9514876583881836`*^9},ExpressionUUID->"32740707-fdc4-094d-a0d5-\
67e710750ce0"],

Cell[BoxData[
 TemplateBox[{
  "ClearAll", "wrsym", 
   "\"Symbol \\!\\(\\*RowBox[{\\\"\[Pi]\\\"}]\\) is Protected.\"", 2, 81, 3, 
   17699579354684730934, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.9506236523467464`*^9, 3.9506237411679287`*^9, 
  3.9506238834722404`*^9},
 CellLabel->
  "During evaluation of \
In[81]:=",ExpressionUUID->"fb32da6d-2ccc-6546-8db4-9eb0b2a70c51"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["Pj", 
    RowBox[{
     RowBox[{"-", "1"}], "-", "\[Epsilon]u"}]], " ", "Y", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "Pj"}], "-", 
     RowBox[{"2", " ", "Pj", " ", "\[Epsilon]u"}], "+", 
     RowBox[{"2", " ", "Pw", " ", "\[Epsilon]u"}], "+", 
     RowBox[{"Pj", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "\[Pi]"}], "+", "Pj"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"\[Pi]", "+", 
        RowBox[{"Pj", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "+", "\[Epsilon]u"}], ")"}]}], "-", 
        RowBox[{"\[Pi]", " ", "\[Epsilon]u"}]}], ")"}], " ", "\[Kappa]p"}]}], 
    ")"}]}], "\[Equal]", "0"}]], "Output",
 CellChangeTimes->{3.9506237411798954`*^9, 3.9506238834792233`*^9},
 CellLabel->"Out[91]=",ExpressionUUID->"13f628c2-b0d4-1c49-8294-708100449985"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\n", "\n", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.946997714031584*^9, {3.946997818668518*^9, 3.946997840825136*^9}, {
   3.9469981410677166`*^9, 3.9469981620450706`*^9}, {3.9469984739662876`*^9, 
   3.9469984868744564`*^9}, {3.9470004652612762`*^9, 
   3.9470004746943607`*^9}, {3.947000923688463*^9, 3.9470009573882008`*^9}, {
   3.9470011983600025`*^9, 3.947001200512789*^9}, {3.9470014349401226`*^9, 
   3.947001442098938*^9}, 
   3.9477748041658745`*^9},ExpressionUUID->"040b9176-9fb1-6c42-b2d6-\
b57a6d9f6770"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9469965989965515`*^9, 
  3.946996631543125*^9}},ExpressionUUID->"415c207e-69ac-8e4e-b60e-\
cce02daeab93"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\n"}]], "Input",
 CellChangeTimes->{{3.947087114500244*^9, 3.9470871163989105`*^9}, {
   3.9470871676026287`*^9, 3.9470871922291965`*^9}, {3.947087223790371*^9, 
   3.9470873702921944`*^9}, {3.9470874023732185`*^9, 3.947087413339325*^9}, {
   3.9470913294324627`*^9, 3.9470913359381046`*^9}, {3.94709139935532*^9, 
   3.9470914606802616`*^9}, {3.9470915357667885`*^9, 3.947091559078287*^9}, {
   3.9470916095928574`*^9, 3.947091637500084*^9}, {3.9473460120193176`*^9, 
   3.947346041941885*^9}, {3.947346107088167*^9, 3.9473461398450375`*^9}, {
   3.948990694389536*^9, 3.9489907262754*^9}, 3.949058697599327*^9, 
   3.9495757030521927`*^9, 3.95028873151202*^9, 
   3.9502887987568645`*^9},ExpressionUUID->"fa04d5b8-3a30-3845-b5fc-\
decb17933490"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{"Goods", " ", "Retailers"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Contoh", " ", "pemecahan", " ", "fungsi", " ", "profit", " ", 
     "retailer"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Parameter", " ", "contoh"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"{", 
      RowBox[{
      "\[Beta]R", ",", "\[Kappa]P", ",", "\[Iota]", ",", "\[Pi]Star", ",", 
       RowBox[{"\[Epsilon]U", "[", "t", "]"}], ",", 
       RowBox[{"Pt", "[", "t", "]"}], ",", 
       RowBox[{"Pw", "[", "t", "]"}], ",", 
       RowBox[{"Y", "[", "t", "]"}], ",", 
       RowBox[{"\[Pi]", "[", "t", "]"}], ",", 
       RowBox[{"Pj", "[", "t", "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]",
    "\n", 
   RowBox[{"(*", 
    RowBox[{"1.", " ", "Bagian", " ", "Pendapatan"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"revenue", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Pj", "[", "t", "]"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Pj", "[", "t", "]"}], "/", 
          RowBox[{"Pt", "[", "t", "]"}]}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{"\[Epsilon]U", "[", "t", "]"}]}], ")"}]}], ")"}], "*", 
      RowBox[{"Y", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"2.", " ", "Bagian", " ", "Biaya", " ", "Wholesale"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"costWholesale", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Pw", "[", "t", "]"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Pj", "[", "t", "]"}], "/", 
          RowBox[{"Pt", "[", "t", "]"}]}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{"\[Epsilon]U", "[", "t", "]"}]}], ")"}]}], ")"}], "*", 
      RowBox[{"Y", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "Bagian", " ", "Quadratic", " ", "Adjustment", " ", "Cost"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"aDjCost", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Kappa]P", "/", "2"}], ")"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Pj", "[", "t", "]"}], "/", 
           RowBox[{"Pj", "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ")"}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Pi]", "[", 
            RowBox[{"t", "-", "1"}], "]"}], "^", "\[Iota]"}], "*", 
          RowBox[{"\[Pi]Star", "^", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Iota]"}], ")"}]}]}]}], ")"}], "^", "2"}], "*", 
      RowBox[{"Pj", "[", "t", "]"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Pj", "[", "t", "]"}], "/", 
          RowBox[{"Pt", "[", "t", "]"}]}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{"\[Epsilon]U", "[", "t", "]"}]}], ")"}]}], ")"}], "*", 
      RowBox[{"Y", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "4.", " ", "Fungsi", " ", "Profit", " ", "Total", " ", "Periode", " ", 
     "t"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"profitRetail", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"revenue", "[", "t", "]"}], "-", 
      RowBox[{"costWholesale", "[", "t", "]"}], "-", 
      RowBox[{"aDjCost", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{"Stochastic", " ", "Discount", " ", "Factor", " ", 
     RowBox[{"(", "SDF", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sDf", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Beta]P", "*", 
        RowBox[{"cP", "[", "t", "]"}], "*", 
        RowBox[{"\[Xi]P", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"cP", "[", 
         RowBox[{"t", "+", "1"}], "]"}], "*", 
        RowBox[{"\[Xi]P", "[", "t", "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "5.", " ", "Contoh", " ", "Fungsi", " ", "Objektif", " ", "Dua", " ", 
     "Periode", " ", "Dengan", " ", 
     RowBox[{"SDF", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"obj", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"revenue", "[", "t", "]"}], "-", 
        RowBox[{"costWholesale", "[", "t", "]"}], "-", 
        RowBox[{"aDjCost", "[", "t", "]"}]}], ")"}], "+", 
      RowBox[{
       RowBox[{"\[Beta]R", "^", 
        RowBox[{"(", 
         RowBox[{"t", "+", "1"}], ")"}]}], "*", 
       RowBox[{"sDf", "[", "t", "]"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"revenue", "[", 
          RowBox[{"t", "+", "1"}], "]"}], "-", 
         RowBox[{"costWholesale", "[", 
          RowBox[{"t", "+", "1"}], "]"}], "-", 
         RowBox[{"aDjCost", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"6.", " ", "First"}], "-", 
     RowBox[{"Order", " ", "Condition", " ", "wrt", " ", 
      RowBox[{"Pj", "[", "t", "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focPjt", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"obj", ",", 
        RowBox[{"Pj", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"fiul", "=", 
     RowBox[{"FullSimplify", "[", "focPjt", "]"}]}], ";"}], "\[IndentingNewLine]",
    "5", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Display", " ", "the", " ", "simplified", " ", "first"}], "-", 
     RowBox[{"order", " ", "condition"}]}], "*)"}], "\n", "fiul", "\n", 
   "\n"}]}]], "Input",
 CellChangeTimes->{
  3.948990784621073*^9, 3.9490587149937515`*^9, 3.9490588209595146`*^9, {
   3.9490601859770145`*^9, 3.9490602059949303`*^9}, {3.9490603001104393`*^9, 
   3.949060303477806*^9}, {3.949416913439928*^9, 3.949416919322603*^9}, {
   3.9495132256066513`*^9, 3.9495132279911957`*^9}, {3.949575483712454*^9, 
   3.949575505946844*^9}, {3.949575556964756*^9, 3.94957555847365*^9}, {
   3.9495757187829437`*^9, 3.94957579527203*^9}, {3.9495766264864006`*^9, 
   3.949576649652191*^9}, 3.9495768077102947`*^9, {3.949576842721739*^9, 
   3.949576846706112*^9}, {3.9495778787948666`*^9, 3.9495778978648014`*^9}, {
   3.9495782206362915`*^9, 3.949578239020588*^9}, 3.9495782955702114`*^9, {
   3.949578344308897*^9, 3.949578385973671*^9}, {3.949578672307455*^9, 
   3.949578700062748*^9}, {3.949578757591608*^9, 3.9495787675603943`*^9}, {
   3.9495788526952324`*^9, 3.9495789187073097`*^9}, {3.9495790065344944`*^9, 
   3.949579010646*^9}, {3.949579213140497*^9, 3.949579222446415*^9}, {
   3.9495792607795753`*^9, 3.9495792721928806`*^9}, {3.9495793613146553`*^9, 
   3.949579365756941*^9}, {3.9495799993750553`*^9, 3.949580021268612*^9}, 
   3.949580152260338*^9, {3.9495803301675854`*^9, 3.949580339349781*^9}, {
   3.9495803877309704`*^9, 3.94958042670409*^9}, {3.9495807157365246`*^9, 
   3.949580718630356*^9}, 3.950288261790224*^9, {3.9502884080633144`*^9, 
   3.9502884230570087`*^9}, {3.950289828265522*^9, 3.9502898524403305`*^9}, {
   3.950289890057598*^9, 3.950289909494385*^9}, 3.9502900316960487`*^9, {
   3.950290405021696*^9, 3.950290410751833*^9}, 3.9502909116297283`*^9, 
   3.9502910670200405`*^9, 3.9506080009321632`*^9, 3.950608693083746*^9, 
   3.9506097519764824`*^9},
 CellLabel->"In[24]:=",ExpressionUUID->"a4784151-fd95-5549-b874-48705f8102dd"],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{3.950290045323078*^9, 3.9502910721047287`*^9, 
  3.9506080896452484`*^9, 3.9506097594294167`*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"bf51b92c-4e72-934d-8751-669a5601e7bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    FractionBox["1", 
     RowBox[{"Pj", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "t"}], "]"}]], 
    RowBox[{
     SuperscriptBox["\[Pi]Star", 
      RowBox[{"-", "\[Iota]"}]], " ", 
     RowBox[{"Pj", "[", "t", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        RowBox[{"Pj", "[", "t", "]"}], 
        RowBox[{"Pt", "[", "t", "]"}]], ")"}], 
      RowBox[{"-", 
       RowBox[{"\[Epsilon]U", "[", "t", "]"}]}]], " ", 
     RowBox[{"Y", "[", "t", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Kappa]P", " ", 
        SuperscriptBox["\[Pi]Star", 
         RowBox[{"2", " ", "\[Iota]"}]], " ", 
        SuperscriptBox[
         RowBox[{"Pj", "[", "t", "]"}], "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"\[Epsilon]U", "[", "t", "]"}]}], ")"}]}], "-", 
       RowBox[{"2", " ", "\[Kappa]P", " ", 
        SuperscriptBox["\[Pi]Star", 
         RowBox[{"1", "+", "\[Iota]"}]], " ", 
        SuperscriptBox[
         RowBox[{"\[Pi]", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}], "\[Iota]"], " ", 
        RowBox[{"Pj", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Pj", "[", "t", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{"\[Epsilon]U", "[", "t", "]"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Pj", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                SuperscriptBox["\[Pi]Star", 
                 RowBox[{"2", " ", "\[Iota]"}]]}], "-", 
               RowBox[{"\[Kappa]P", " ", 
                SuperscriptBox["\[Pi]Star", "2"], " ", 
                SuperscriptBox[
                 RowBox[{"\[Pi]", "[", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "t"}], "]"}], 
                 RowBox[{"2", " ", "\[Iota]"}]]}]}], ")"}], " ", 
             RowBox[{"Pj", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"\[Epsilon]U", "[", "t", "]"}]}], ")"}]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[Pi]Star", 
            RowBox[{"2", " ", "\[Iota]"}]], " ", 
           RowBox[{"Pw", "[", "t", "]"}], " ", 
           RowBox[{"\[Epsilon]U", "[", "t", "]"}]}]}], ")"}]}]}], ")"}]}]}], "+", 
   FractionBox[
    RowBox[{"2", " ", "\[Beta]P", " ", 
     SuperscriptBox["\[Beta]R", 
      RowBox[{"1", "+", "t"}]], " ", "\[Kappa]P", " ", 
     RowBox[{"cP", "[", "t", "]"}], " ", 
     RowBox[{"Pj", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Pj", "[", 
       RowBox[{"1", "+", "t"}], "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Pi]Star"}], " ", 
        SuperscriptBox[
         RowBox[{"\[Pi]", "[", "t", "]"}], "\[Iota]"], " ", 
        RowBox[{"Pj", "[", "t", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["\[Pi]Star", "\[Iota]"], " ", 
        RowBox[{"Pj", "[", 
         RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        RowBox[{"Pj", "[", 
         RowBox[{"1", "+", "t"}], "]"}], 
        RowBox[{"Pt", "[", 
         RowBox[{"1", "+", "t"}], "]"}]], ")"}], 
      RowBox[{"-", 
       RowBox[{"\[Epsilon]U", "[", 
        RowBox[{"1", "+", "t"}], "]"}]}]], " ", 
     RowBox[{"Y", "[", 
      RowBox[{"1", "+", "t"}], "]"}], " ", 
     RowBox[{"\[Xi]P", "[", 
      RowBox[{"1", "+", "t"}], "]"}]}], 
    RowBox[{
     RowBox[{"cP", "[", 
      RowBox[{"1", "+", "t"}], "]"}], " ", 
     RowBox[{"Pj", "[", "t", "]"}], " ", 
     RowBox[{"\[Xi]P", "[", "t", "]"}]}]]}], "\[Equal]", "0"}]], "Output",
 CellChangeTimes->{3.950290045323078*^9, 3.9502910721047287`*^9, 
  3.9506080896452484`*^9, 3.9506097594369144`*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"b333a2d0-b13f-f541-b271-cf5107960c75"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.9424252827947807`*^9, 3.9424879659349766`*^9, {3.9473471907510777`*^9, 
   3.947347191898058*^9}, 3.947784779983919*^9, 3.947784987716772*^9, {
   3.9489903079272823`*^9, 3.9489903243434563`*^9}, {3.948990848866911*^9, 
   3.9489909081112175`*^9}, 3.949060587099819*^9, 3.9490606225196743`*^9, 
   3.9490611373178616`*^9, {3.949061176404995*^9, 3.9490611796429768`*^9}, {
   3.9490612340961494`*^9, 3.949061235260706*^9}, 
   3.9506096593547516`*^9},ExpressionUUID->"52999333-fe05-e84a-acf1-\
fc22be5bf2ea"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"--", 
      RowBox[{"-", "Apply"}]}], " ", "the", " ", "mapping", " ", "to", " ", 
     "the", " ", "English", " ", 
     RowBox[{"expression", "--"}]}], "-"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"mappedEnglishFOC", "=", 
     RowBox[{"englishFOC", "/.", " ", "mapping"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"-", "Check"}]}], " ", "equivalence", " ", "by", " ", 
      "simplifying", " ", "the", " ", 
      RowBox[{"difference", "--"}]}], "-"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"difference", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"mappedEnglishFOC", "-", "greekFOC"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", "difference", "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"1.", " ", "Clear", " ", "all", " ", "symbols"}], "*)"}], 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "Pj", ",", "Pt", ",", "Y", ",", "epsU", ",", "Pw", ",", "PjFut", ",", 
      "PtFut", ",", "YFut", ",", "epsUFut", ",", "PjLag", ",", "PiLag", ",", 
      "piVar", ",", "beta", ",", "LambDaE", ",", "kappaP", ",", "piStar", ",",
       "iota", ",", "betaR", ",", "t", ",", "PjBar", ",", "PtBar", ",", 
      "YBar", ",", "epsUBar", ",", "PwBar", ",", "PjFutBar", ",", "PtFutBar", 
      ",", "YFutBar", ",", "epsUFutBar", ",", "PjLagBar", ",", "PiLagBar", ",",
       "piVarBar", ",", "PjHat", ",", "PtHat", ",", "YHat", ",", "epsUHat", ",",
       "PwHat", ",", "PjFutHat", ",", "PtFutHat", ",", "YFutHat", ",", 
      "epsUFutHat", ",", "PjLagHat", ",", "PiLagHat", ",", "piVarHat"}], 
     "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "2.", " ", "Define", " ", "the", " ", "original", " ", "nonlinear", " ",
        "equation", " ", "F"}], "==", "0"}], ",", 
     RowBox[{
     "now", " ", "incluDing", " ", "all", " ", "variables", " ", "for", " ", 
      RowBox[{"consistency", "."}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{
      "Pj_", ",", "Pt_", ",", "Y_", ",", "epsU_", ",", "Pw_", ",", "PjFut_", ",",
        "PtFut_", ",", "YFut_", ",", "epsUFut_", ",", "PjLag_", ",", "PiLag_",
        ",", "piVar_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"PjLag", " ", "Pj"}], ")"}]}], ")"}], "*", 
      RowBox[{"piStar", "^", 
       RowBox[{"-", "iota"}]}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Pj", "/", "Pt"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"-", "epsU"}], ")"}]}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "kappaP", " ", 
         RowBox[{"piStar", "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "iota"}], ")"}]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "epsU"}], ")"}], " ", 
         RowBox[{"PiLag", "^", "iota"}], " ", "PjLag", " ", 
         RowBox[{"Pj", "^", "2"}]}], "-", 
        RowBox[{"kappaP", " ", 
         RowBox[{"piStar", "^", 
          RowBox[{"(", 
           RowBox[{"2", " ", "iota"}], ")"}]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "+", "epsU"}], ")"}], " ", 
         RowBox[{"Pj", "^", "3"}]}], "+", 
        RowBox[{
         RowBox[{"PjLag", "^", "2"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "epsU"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{"piStar", "^", 
                RowBox[{"(", 
                 RowBox[{"2", " ", "iota"}], ")"}]}]}], "-", 
              RowBox[{"kappaP", " ", 
               RowBox[{"piStar", "^", "2"}], " ", 
               RowBox[{"PiLag", "^", 
                RowBox[{"(", 
                 RowBox[{"2", " ", "iota"}], ")"}]}]}]}], ")"}], " ", "Pj"}], 
           "-", 
           RowBox[{"2", " ", 
            RowBox[{"piStar", "^", 
             RowBox[{"(", 
              RowBox[{"2", " ", "iota"}], ")"}]}], " ", "epsU", " ", "Pw"}]}],
           ")"}]}]}], ")"}], "*", "Y"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "List", " ", "all", " ", "variables", " ", "for", " ", 
     "Differentiation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{
      "Pj", ",", "Pt", ",", "Y", ",", "epsU", ",", "Pw", ",", "PjFut", ",", 
       "PtFut", ",", "YFut", ",", "epsUFut", ",", "PjLag", ",", "PiLag", ",", 
       "piVar"}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"CorresponDing", " ", "log"}], "-", 
     RowBox[{"Deviation", " ", "symbols"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logDevs", "=", 
     RowBox[{"{", 
      RowBox[{
      "PjHat", ",", "PtHat", ",", "YHat", ",", "epsUHat", ",", "PwHat", ",", 
       "PjFutHat", ",", "PtFutHat", ",", "YFutHat", ",", "epsUFutHat", ",", 
       "PjLagHat", ",", "PiLagHat", ",", "piVarHat"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "4.", " ", "Compute", " ", "partial", " ", "Derivatives", " ", "of", " ", 
     "F", " ", "with", " ", "respect", " ", "to", " ", "each", " ", 
     "variable", " ", "at", " ", "the", " ", "steaDy", " ", "state"}], "*)"}],
    "\n", 
   RowBox[{
    RowBox[{"steaDyStateSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Pj", "->", "PjBar"}], ",", 
       RowBox[{"Pt", "->", "PtBar"}], ",", 
       RowBox[{"Y", "->", "YBar"}], ",", 
       RowBox[{"epsU", "->", "epsUBar"}], ",", 
       RowBox[{"Pw", "->", "PwBar"}], ",", 
       RowBox[{"PjFut", "->", "PjFutBar"}], ",", 
       RowBox[{"PtFut", "->", "PtFutBar"}], ",", 
       RowBox[{"YFut", "->", "YFutBar"}], ",", 
       RowBox[{"epsUFut", "->", "epsUFutBar"}], ",", 
       RowBox[{"PjLag", "->", "PjLagBar"}], ",", 
       RowBox[{"PiLag", "->", "PiLagBar"}], ",", 
       RowBox[{"piVar", "->", "piVarBar"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        "steaDyStateSubs"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "5.", " ", "Form", " ", "the", " ", "linearizeD", " ", "equation", " ", 
      "as", " ", "the", " ", "sum", " ", "of", " ", "each", " ", "Derivative",
       " ", "times", " ", "its", " ", "corresponDing", " ", "steaDy"}], "-", 
     RowBox[{"state", " ", "value", " ", "times", " ", "the", " ", "log"}], "-",
      "Deviation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", "PjBar", "*", "PjHat"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", "PtBar", "*", "PtHat"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "*", "YBar", "*", "YHat"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "*", "epsUBar", "*", "epsUHat"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "*", "PwBar", "*", "PwHat"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "6", "]"}], "]"}], "*", "PjFutBar", "*", "PjFutHat"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "7", "]"}], "]"}], "*", "PtFutBar", "*", "PtFutHat"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "8", "]"}], "]"}], "*", "YFutBar", "*", "YFutHat"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "9", "]"}], "]"}], "*", "epsUFutBar", "*", 
       "epsUFutHat"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "10", "]"}], "]"}], "*", "PjLagBar", "*", "PjLagHat"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "11", "]"}], "]"}], "*", "PiLagBar", "*", "PiLagHat"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "12", "]"}], "]"}], "*", "piVarBar", "*", 
       "piVarHat"}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "6.", " ", "Simplify", " ", "anD", " ", "normalize", " ", "steaDy"}], "-", 
     RowBox[{"state", " ", "values", " ", "to", " ", "1"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEqNoBar", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEq", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PjBar", "->", "1"}], ",", 
         RowBox[{"PtBar", "->", "1"}], ",", 
         RowBox[{"YBar", "->", "1"}], ",", 
         RowBox[{"epsUBar", "->", "1"}], ",", 
         RowBox[{"PwBar", "->", "1"}], ",", 
         RowBox[{"PjFutBar", "->", "1"}], ",", 
         RowBox[{"PtFutBar", "->", "1"}], ",", 
         RowBox[{"YFutBar", "->", "1"}], ",", 
         RowBox[{"epsUFutBar", "->", "1"}], ",", 
         RowBox[{"PjLagBar", "->", "1"}], ",", 
         RowBox[{"PiLagBar", "->", "1"}], ",", 
         RowBox[{"piVarBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "7.", " ", "ReintroDuce", " ", "time", " ", "inDices", " ", "for", " ", 
      "the", " ", "log", " ", 
      RowBox[{"Deviations", ":", 
       RowBox[{"-", "Pj"}]}]}], ",", "Pt", ",", "Y", ",", "epsU", ",", "Pw", ",", 
     RowBox[{
      RowBox[{"piVar", " ", "are", " ", "current", " ", 
       RowBox[{"(", "t", ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"-", "PjFut"}]}], ",", "PtFut", ",", "YFut", ",", 
     RowBox[{
      RowBox[{"epsUFut", " ", "are", " ", "leaDs", " ", 
       RowBox[{"(", 
        RowBox[{"t", "+", "1"}], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"-", "PjLag"}]}], ",", 
     RowBox[{"PiLag", " ", "are", " ", "lags", " ", 
      RowBox[{"(", 
       RowBox[{"t", "-", "1"}], ")"}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"timeSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PjHat", "->", 
        RowBox[{"PjHat", "[", "t", "]"}]}], ",", 
       RowBox[{"PtHat", "->", 
        RowBox[{"PtHat", "[", "t", "]"}]}], ",", 
       RowBox[{"YHat", "->", 
        RowBox[{"YHat", "[", "t", "]"}]}], ",", 
       RowBox[{"epsUHat", "->", 
        RowBox[{"epsUHat", "[", "t", "]"}]}], ",", 
       RowBox[{"PwHat", "->", 
        RowBox[{"PwHat", "[", "t", "]"}]}], ",", 
       RowBox[{"PjFutHat", "->", 
        RowBox[{"PjHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"PtFutHat", "->", 
        RowBox[{"PtHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"YFutHat", "->", 
        RowBox[{"YHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"epsUFutHat", "->", 
        RowBox[{"epsUHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"PjLagHat", "->", 
        RowBox[{"PjHat", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], ",", 
       RowBox[{"PiLagHat", "->", 
        RowBox[{"PiHat", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], ",", 
       RowBox[{"piVarHat", "->", 
        RowBox[{"piVarHat", "[", "t", "]"}]}]}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqTimeInDexeD", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "8.", " ", "Output", " ", "the", " ", "final", " ", "linearizeD", " ", 
     "equation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", "eqTimeInDexeD", "}"}], "\[IndentingNewLine]", "\n", "\n", 
   "\n"}]}]], "Input",
 CellChangeTimes->{
  3.9424252827947807`*^9, 3.9424879659349766`*^9, {3.9473471907510777`*^9, 
   3.947347191898058*^9}, 3.947784779983919*^9, 3.947784987716772*^9, {
   3.9489903079272823`*^9, 3.9489903243434563`*^9}, {3.948990848866911*^9, 
   3.9489909081112175`*^9}, 3.949060587099819*^9, 3.9490606225196743`*^9, 
   3.9490611373178616`*^9, {3.949061176404995*^9, 3.9490611796429768`*^9}, {
   3.9490612340961494`*^9, 3.949061235260706*^9}, {3.9506096593547516`*^9, 
   3.950609666267605*^9}, 3.950609798692766*^9, 
   3.950610098099264*^9},ExpressionUUID->"ad8361d1-9451-6540-9108-\
f1b045aacd4a"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.942508401042242*^9, 
  3.942508401044237*^9}},ExpressionUUID->"e44d3794-52ef-d540-95ab-\
731b5a7762cd"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"retail", " ", "banking"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{
  3.942425871529419*^9, 3.942426101584881*^9, 3.9424261402649555`*^9, 
   3.9473466087112083`*^9, {3.947346779662201*^9, 3.947346796649639*^9}, 
   3.947346964656801*^9, {3.9473470205344906`*^9, 3.9473470595561905`*^9}, 
   3.9473471027397194`*^9, {3.9477846114062653`*^9, 3.947784628251028*^9}, {
   3.947954466290764*^9, 3.947954468666727*^9}, {3.9479545001509304`*^9, 
   3.9479545383854084`*^9}},ExpressionUUID->"28629b7d-e028-5846-af8b-\
9f2b85a1dc47"],

Cell[BoxData[""], "Input",ExpressionUUID->"dd97dce5-0f5a-5548-85d4-2d3b84c46059"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"eqStatic", ":=", 
    RowBox[{
     RowBox[{"1", "-", "\[CurlyEpsilon]bs", "+", 
      RowBox[{"\[CurlyEpsilon]bs", " ", 
       RowBox[{"Rb", "/", "rbs"}]}], "-", 
      RowBox[{"\[Kappa]bs", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"rbs", "/", "rbs"}], "-", "1"}], ")"}]}], "+", 
      RowBox[{"rbs", "/", "rbs"}], "+", 
      RowBox[{"\[Beta]P", " ", 
       RowBox[{"(", 
        RowBox[{"\[Lambda]Pp", "/", "\[Lambda]P"}], ")"}], " ", "\[Kappa]bs", 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"rbs", "/", "rbs"}], "-", "1"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"rbs", "^", "2"}], "/", "rbs"}], ")"}], " ", 
       RowBox[{"bbs", "/", "b"}]}]}], "==", "0"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Substitute", " ", "\[Lambda]P", " ", "with", " ", "its", " ", "steady"}],
     "-", 
    RowBox[{"state", " ", "expression"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]PStatic", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Alpha]P"}], ")"}], " ", "\[Xi]P", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Alpha]P"}], " ", "cP"}], "+", "cP"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Alpha]P", " ", "\[Beta]P"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Alpha]P", " ", "cP"}], "-", "cP"}], ")"}]}]}], ")"}]}]}],
    ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"eqStaticSubstituted", ":=", 
   RowBox[{"eqStatic", "/.", " ", 
    RowBox[{"\[Lambda]P", "->", "\[Lambda]PStatic"}]}]}], 
  ";"}], "\n", "eqStaticSubstituted"}], "Input",
 CellChangeTimes->{{3.951571785255003*^9, 3.9515718275415726`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"ea338578-7420-814a-bae0-ec6916006705"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", "-", "\[CurlyEpsilon]bs", "+", 
   FractionBox[
    RowBox[{"Rb", " ", "\[CurlyEpsilon]bs"}], "rbs"]}], "\[Equal]", 
  "0"}]], "Output",
 CellChangeTimes->{3.9515718350604935`*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"97cbc76e-74c7-d54b-b297-742ca10fc7dc"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"equation", " ", "1", " ", "static", " ", "Lagrange"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.9501035481934986`*^9, 3.950103581184595*^9}, {
  3.9514101030618286`*^9, 
  3.9514101414057465`*^9}},ExpressionUUID->"2fefe0a9-ef4a-b34c-88da-\
f0fbd0a95d25"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.950092656613249*^9, 3.950092681770752*^9}, {
   3.9500987526921844`*^9, 3.950098754735853*^9}, 
   3.951493141684023*^9},ExpressionUUID->"50cbb85b-ef5a-214e-b4ad-\
571c43e9c839"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.950111042650362*^9, 
  3.9514931848393364`*^9},ExpressionUUID->"ba9c6190-3889-1544-a4e6-\
fd4742f29bbf"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.9501110426533527`*^9, {3.951493159418339*^9, 
   3.9514931672835026`*^9}},ExpressionUUID->"d3ed06ee-b8ff-294e-b91e-\
7c9f954290f7"],

Cell[BoxData[
 RowBox[{"\n", "\[IndentingNewLine]", "\n", "\n", "\n", "\[IndentingNewLine]",
   "\n", "\n"}]], "Input",
 CellChangeTimes->{
  3.9490687074669514`*^9, {3.949068754841463*^9, 3.949068756088009*^9}, {
   3.9490687910101223`*^9, 3.9490688132811527`*^9}, {3.94906888461211*^9, 
   3.9490689272287006`*^9}, {3.949068960412428*^9, 3.949069041337929*^9}, {
   3.949069086418791*^9, 3.949069167821823*^9}, {3.949069200770897*^9, 
   3.949069202041834*^9}, {3.9490692516573524`*^9, 3.9490692527366753`*^9}, {
   3.9490697657280025`*^9, 3.949069780665613*^9}, {3.9490700076472836`*^9, 
   3.949070033644764*^9}, {3.949070099642252*^9, 3.9490701034060173`*^9}, {
   3.9490709872374725`*^9, 3.9490709995323486`*^9}, {3.9490727711307964`*^9, 
   3.9490728062286434`*^9}, {3.9490747667031612`*^9, 
   3.9490747907226295`*^9}, {3.9490748560217476`*^9, 3.949074857912815*^9}, {
   3.949074892676176*^9, 3.9490748943268585`*^9}, 3.949075283245247*^9, 
   3.9490755041517677`*^9, {3.9490755973720856`*^9, 3.9490756110217266`*^9}, {
   3.9491483521069202`*^9, 3.94914837157139*^9}, 3.949148418114006*^9, 
   3.949148473105919*^9, {3.949148527629196*^9, 3.9491485562413616`*^9}, {
   3.9491488517219257`*^9, 3.949148853639353*^9}, {3.9491507260546207`*^9, 
   3.9491507453534584`*^9}},ExpressionUUID->"ddbf74b7-28ae-e646-950d-\
853adb6de2be"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.948211170519268*^9},ExpressionUUID->"4b97082b-f52c-d940-8b60-\
cf5f1725bfda"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{{3.948211170519268*^9, 3.9482111876671753`*^9}, {
   3.9482112794644413`*^9, 3.9482112948257694`*^9}, {3.9482756884700985`*^9, 
   3.9482757018341217`*^9}, 3.9482761056397743`*^9, 3.9482784758201923`*^9, 
   3.948278957803278*^9, {3.94897400115378*^9, 3.948974115359949*^9}, {
   3.9489766614298*^9, 3.9489766736456013`*^9}, {3.948976913824997*^9, 
   3.94897693385376*^9}, {3.9489771231243935`*^9, 3.9489771250207157`*^9}, 
   3.9489771676231384`*^9, 
   3.9489888952604027`*^9},ExpressionUUID->"5dd43024-de83-cb41-a7b3-\
b837d316dc18"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.94820885691658*^9},
 CellLabel->"",ExpressionUUID->"dfc70790-c88c-054d-8485-03f8062fbf9d"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.9482109068747272`*^9, 3.9482109437608814`*^9, 
  3.9482110261963253`*^9, 
  3.9482111329284325`*^9},ExpressionUUID->"87f03399-2a49-8741-8bdb-\
0504f8780838"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9482792941288185`*^9, 3.9482793172546787`*^9}, 
   3.94897700525461*^9, {3.9489772194163303`*^9, 
   3.9489772319667683`*^9}},ExpressionUUID->"7f8fbad5-21e7-284d-8454-\
d537c7ac8fad"],

Cell[BoxData[""], "Input",ExpressionUUID->"22c9a5ff-e8ca-da4a-bea9-0829d17500f1"],

Cell[BoxData[
 RowBox[{"(*", "loglin", "*)"}]], "Input",
 CellChangeTimes->{{3.9514101750811577`*^9, 
  3.951410182622984*^9}},ExpressionUUID->"3f549fa7-3ec6-0845-958c-\
4197cedab296"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.9482172029295044`*^9, {3.9482172767034664`*^9, 3.948217329190628*^9}, 
   3.948217605001524*^9, {3.948218357118347*^9, 3.948218401248472*^9}, {
   3.9482184816585445`*^9, 3.948218554252701*^9}, {3.948218584625622*^9, 
   3.9482186765515785`*^9}, {3.948218792408987*^9, 3.9482188281772537`*^9}, 
   3.9482192330981655`*^9, {3.94821929869018*^9, 3.9482193203191605`*^9}, {
   3.9482757633364906`*^9, 3.948275779501955*^9}, {3.9482758564138184`*^9, 
   3.948275882938244*^9}, 
   3.9482780949387245`*^9},ExpressionUUID->"6b2be15b-ddfc-2e4b-8670-\
7e87cade0d44"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", "equation2", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Original", " ", "dynamic", " ", "equation"}], ",", 
    "symbolically"}], "*)"}], 
  RowBox[{
   RowBox[{"eqDynamic", ":=", 
    RowBox[{"-", "1"}]}], "\n", 
   RowBox[{"+", "epsd"}], "                           ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\[CurlyEpsilon]", "^", "d_t"}], ",", 
     RowBox[{"the", " ", "deposit", " ", "shock"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"-", "epsd"}], "*", 
    RowBox[{"(", 
     RowBox[{"rd", "/", "rd"}], ")"}]}], "                   ", 
   RowBox[{"(*", 
    RowBox[{"term", " ", "with", " ", 
     RowBox[{
      RowBox[{"r", "^", "d_t"}], "/", 
      RowBox[{"r", "^", "d_"}]}], 
     RowBox[{"{", 
      RowBox[{"t", "-", "1"}], "}"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"-", "kd"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"rd", "/", "rd"}], ")"}], "-", "1"}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{"rd", "/", "rd"}], ")"}]}], "\n", 
   RowBox[{"+", 
    RowBox[{"(", 
     RowBox[{"rd", "/", "rd"}], ")"}]}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"+", "\[Beta]P"}], "*", 
      RowBox[{"(", 
       RowBox[{"\[Lambda]P", "/", "\[Lambda]P"}], ")"}], "*", "kd", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"rd", "/", "rd"}], ")"}], "-", "1"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"rd", "/", "rd"}], ")"}], "^", "2"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"d", "/", "d"}], ")"}]}], ")"}]}], "==", "0"}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Substitute", " ", "\[Lambda]P", " ", "with", " ", "its", " ", 
      "steady"}], "-", 
     RowBox[{"state", " ", "expression"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]PStatic", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Alpha]P"}], ")"}], " ", "\[Xi]P", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[Alpha]P"}], " ", "cP"}], "+", "cP"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Alpha]P", " ", "\[Beta]P"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Alpha]P", " ", "cP"}], "-", "cP"}], ")"}]}]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"eqStaticSubstituted", ":=", 
     RowBox[{"eqStatic", "/.", " ", 
      RowBox[{"\[Lambda]P", "->", "\[Lambda]PStatic"}]}]}], ";"}], "\n", 
   "eqStaticSubstituted", "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Now", " ", "impose", " ", "strict", " ", "steady"}],
                  "-", 
                 RowBox[{"state", " ", 
                  RowBox[{"conditions", ":", "1"}]}]}], ")"}], " ", 
               RowBox[{"rd", "/", "rd"}]}], "->", 
              RowBox[{"1", " ", "2"}]}], ")"}], " ", 
            RowBox[{
             RowBox[{"\[Lambda]P", "[", 
              RowBox[{"t", "+", "1"}], "]"}], "/", 
             RowBox[{"\[Lambda]P", "[", "t", "]"}]}]}], "->", 
           RowBox[{"1", " ", "3"}]}], ")"}], " ", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"t", "+", "1"}], "]"}], "/", 
          RowBox[{"d", "[", "t", "]"}]}]}], "->", 
        RowBox[{"1", " ", "4"}]}], ")"}], " ", "epsd"}], "->", 
     RowBox[{"some", " ", "constant", " ", 
      RowBox[{"(", 
       RowBox[{"often", " ", "1", " ", "or", " ", "0"}], ")"}]}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.9482172029295044`*^9, {3.9482172767034664`*^9, 3.948217329190628*^9}, 
   3.948217605001524*^9, {3.948218357118347*^9, 3.948218401248472*^9}, {
   3.9482184816585445`*^9, 3.948218554252701*^9}, {3.948218584625622*^9, 
   3.9482186765515785`*^9}, {3.948218792408987*^9, 3.9482188281772537`*^9}, 
   3.9482192330981655`*^9, {3.94821929869018*^9, 3.9482193203191605`*^9}, {
   3.9482757633364906`*^9, 3.948275779501955*^9}, {3.9482758564138184`*^9, 
   3.948275882938244*^9}, 3.9482780949387245`*^9, {3.948978039301388*^9, 
   3.9489780614751873`*^9}, {3.94897813577087*^9, 3.948978184816408*^9}, {
   3.9489782151446056`*^9, 3.9489782350011406`*^9}, {3.948978265102497*^9, 
   3.9489782672387295`*^9}, {3.9489878968216286`*^9, 
   3.9489879510043163`*^9}, {3.948988023691309*^9, 3.9489881130165176`*^9}, {
   3.948988688444702*^9, 3.948988723817602*^9}, {3.948989421971798*^9, 
   3.9489894308176804`*^9}, 3.948989469978512*^9, {3.949062856610857*^9, 
   3.949062858448099*^9}, 3.949062889994978*^9, {3.951574607329151*^9, 
   3.951574683923481*^9}, 3.9519035636162167`*^9, {3.951903759978941*^9, 
   3.951903762059183*^9}, {3.9519038019659805`*^9, 3.951903849039879*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"60263157-24c5-8d40-91d8-a0bfe38a098a"],

Cell[BoxData["epsd"], "Output",
 CellChangeTimes->{3.951574645508299*^9, 3.9515746907380466`*^9, 
  3.9519037694863453`*^9, 3.951903856760683*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"2a66e8a6-8a4f-3f43-adc5-e5db2c3ae8e3"],

Cell[BoxData[
 RowBox[{"-", "epsd"}]], "Output",
 CellChangeTimes->{3.951574645508299*^9, 3.9515746907380466`*^9, 
  3.9519037694863453`*^9, 3.9519038567636814`*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"bdba59b6-fe4e-894e-bf3d-af7ac59b9eb3"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.951574645508299*^9, 3.9515746907380466`*^9, 
  3.9519037694863453`*^9, 3.9519038567677784`*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"93d5ca5f-c1f9-d34f-8da3-b796ee22dfb7"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.951574645508299*^9, 3.9515746907380466`*^9, 
  3.9519037694863453`*^9, 3.9519038567706585`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"906020aa-d556-454e-a4d1-58c1381e1938"],

Cell[BoxData["eqStatic"], "Output",
 CellChangeTimes->{3.951574645508299*^9, 3.9515746907380466`*^9, 
  3.9519037694863453`*^9, 3.951903856773649*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"11eb2e07-f791-b247-bb18-b8115762a9a4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"1.", " ", "Clear", " ", "all", " ", "symbols"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "rD", ",", "rDLag", ",", "rDNext", ",", "Rt", ",", "Dt", ",", "DtNext", ",",
       "cpTm1", ",", "cpT", ",", "cpTp1", ",", "cpTp2", ",", "epsD", ",", 
      "kappaD", ",", "beta", ",", "a", ",", "xiP", ",", "betaP", ",", "t", ",",
       "rDBar", ",", "rDLagBar", ",", "rDNextBar", ",", "RtBar", ",", "DtBar",
       ",", "DtNextBar", ",", "cpTm1Bar", ",", "cpTBar", ",", "cpTp1Bar", ",",
       "cpTp2Bar", ",", "rDHat", ",", "rDLagHat", ",", "rDNextHat", ",", 
      "RtHat", ",", "DtHat", ",", "DtNextHat", ",", "cpTm1Hat", ",", "cpTHat",
       ",", "cpTp1Hat", ",", "cpTp2Hat", ",", "cpHat"}], "]"}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "2.", " ", "Define", " ", "the", " ", "original", " ", "nonlinear", " ", 
      "equation", " ", "F"}], "==", "0"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{
      "rD_", ",", "rDLag_", ",", "rDNext_", ",", "Rt_", ",", "Dt_", ",", 
       "DtNext_", ",", "cpTm1_", ",", "cpT_", ",", "cpTp1_", ",", "cpTp2_"}], 
      "]"}], ":=", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "epsD", "-", 
      RowBox[{"(", 
       RowBox[{"epsD", "*", 
        RowBox[{"Rt", "/", "rD"}]}], ")"}], "-", 
      RowBox[{"kappaD", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"rD", "/", "rDLag"}], ")"}], "-", "1"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"rD", "/", "Rt"}], ")"}]}], "+", 
      RowBox[{"beta", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "a"}], ")"}], "*", "xiP", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "a"}], "*", "cpT"}], "+", "cpTp1"}], ")"}]}], 
               "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"a", "*", 
                  RowBox[{"betaP", "^", 
                   RowBox[{"(", 
                    RowBox[{"2", "+", "t"}], ")"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"a", "*", "cpTp1"}], "-", "cpTp2"}], ")"}]}]}], 
              ")"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "a"}], ")"}], "*", "xiP", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "a"}], "*", "cpTm1"}], "+", "cpT"}], ")"}]}], 
               "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"a", "*", 
                  RowBox[{"betaP", "^", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", "t"}], ")"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"a", "*", "cpT"}], "-", "cpTp1"}], ")"}]}]}], 
              ")"}]}], ")"}]}], ")"}], "*", "kappaD", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"rDNext", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"epsD", "/", 
                 RowBox[{"(", 
                  RowBox[{"epsD", "-", "1"}], ")"}]}], ")"}], "*", "Rt"}], 
              ")"}]}], ")"}], "-", "1"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"rDNext", "/", "Rt"}], ")"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"rDNext", "/", "rD"}], ")"}], "^", "2"}], "*", 
         RowBox[{"(", 
          RowBox[{"DtNext", "/", "Dt"}], ")"}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "3.", " ", "Set", " ", "up", " ", "steaDy", " ", "state", " ", 
      "substitutions"}], ",", 
     RowBox[{"variable", " ", "lists"}], ",", 
     RowBox[{
      RowBox[{"anD", " ", "corresponDing", " ", "log"}], "-", 
      "Deviations"}]}], "*)"}], 
   RowBox[{
    RowBox[{"steaDySubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rD", "->", "rDBar"}], ",", 
       RowBox[{"rDLag", "->", "rDLagBar"}], ",", 
       RowBox[{"rDNext", "->", "rDNextBar"}], ",", 
       RowBox[{"Rt", "->", "RtBar"}], ",", 
       RowBox[{"Dt", "->", "DtBar"}], ",", 
       RowBox[{"DtNext", "->", "DtNextBar"}], ",", 
       RowBox[{"cpTm1", "->", "cpTm1Bar"}], ",", 
       RowBox[{"cpT", "->", "cpTBar"}], ",", 
       RowBox[{"cpTp1", "->", "cpTp1Bar"}], ",", 
       RowBox[{"cpTp2", "->", "cpTp2Bar"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{
      "rD", ",", "rDLag", ",", "rDNext", ",", "Rt", ",", "Dt", ",", "DtNext", 
       ",", "cpTm1", ",", "cpT", ",", "cpTp1", ",", "cpTp2"}], "}"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logDevs", "=", 
     RowBox[{"{", 
      RowBox[{
      "rDHat", ",", "rDLagHat", ",", "rDNextHat", ",", "RtHat", ",", "DtHat", 
       ",", "DtNextHat", ",", "cpTm1Hat", ",", "cpTHat", ",", "cpTp1Hat", ",",
        "cpTp2Hat"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "4.", " ", "Compute", " ", "partial", " ", "Derivatives", " ", "with", " ",
      "respect", " ", "to", " ", "each", " ", "variable", " ", "at", " ", 
     "the", " ", "steaDy", " ", "state"}], "*)"}], 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", "steaDySubs"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "5.", " ", "Form", " ", "the", " ", "linearizeD", " ", "equation", " ", 
      "by", " ", "multiplying", " ", "each", " ", "Derivative", " ", "by", " ",
       "the", " ", "corresponDing", " ", "steaDy", " ", "state", " ", "anD", " ",
       "log"}], "-", "Deviation"}], "*)"}], 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", "rDBar", "*", "rDHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", "rDLagBar", "*", "rDLagHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", "rDNextBar", "*", "rDNextHat"}],
        "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "*", "RtBar", "*", "RtHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "*", "DtBar", "*", "DtHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "*", "DtNextBar", "*", "DtNextHat"}],
        "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "7", "]"}], "]"}], "*", "cpTm1Bar", "*", "cpTm1Hat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "8", "]"}], "]"}], "*", "cpTBar", "*", "cpTHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "9", "]"}], "]"}], "*", "cpTp1Bar", "*", "cpTp1Hat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "10", "]"}], "]"}], "*", "cpTp2Bar", "*", 
        "cpTp2Hat"}]}], " ", "==", "0"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "6.", " ", "Simplify", " ", "anD", " ", "normalize", " ", "steaDy", " ", 
     "state", " ", "values", " ", "to", " ", "1"}], "*)"}], 
   RowBox[{
    RowBox[{"logLinEqNoBar", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEq", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rDBar", "->", "1"}], ",", 
         RowBox[{"rDLagBar", "->", "1"}], ",", 
         RowBox[{"rDNextBar", "->", "1"}], ",", 
         RowBox[{"RtBar", "->", "1"}], ",", 
         RowBox[{"DtBar", "->", "1"}], ",", 
         RowBox[{"DtNextBar", "->", "1"}], ",", 
         RowBox[{"cpTm1Bar", "->", "1"}], ",", 
         RowBox[{"cpTBar", "->", "1"}], ",", 
         RowBox[{"cpTp1Bar", "->", "1"}], ",", 
         RowBox[{"cpTp2Bar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "7.", " ", "ReintroDuce", " ", "time", " ", "inDices", " ", "using", " ", 
     "a", " ", "single", " ", "log", " ", "Deviation", " ", "symbol", " ", 
     "for", " ", "consumption", " ", 
     RowBox[{"(", "cpHat", ")"}]}], "*)"}], 
   RowBox[{
    RowBox[{"timeSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rDHat", "->", 
        RowBox[{"rDHat", "[", "t", "]"}]}], ",", 
       RowBox[{"rDLagHat", "->", 
        RowBox[{"rDHat", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], ",", 
       RowBox[{"rDNextHat", "->", 
        RowBox[{"rDHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"RtHat", "->", 
        RowBox[{"RtHat", "[", "t", "]"}]}], ",", 
       RowBox[{"DtHat", "->", 
        RowBox[{"DtHat", "[", "t", "]"}]}], ",", 
       RowBox[{"DtNextHat", "->", 
        RowBox[{"DtHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"cpTm1Hat", "->", 
        RowBox[{"cpHat", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], ",", 
       RowBox[{"cpTHat", "->", 
        RowBox[{"cpHat", "[", "t", "]"}]}], ",", 
       RowBox[{"cpTp1Hat", "->", 
        RowBox[{"cpHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"cpTp2Hat", "->", 
        RowBox[{"cpHat", "[", 
         RowBox[{"t", "+", "2"}], "]"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqTimeInDexeD", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "8.", " ", "Output", " ", "the", " ", "final", " ", "linearizeD", " ", 
     "equations"}], "*)"}], 
   RowBox[{"{", 
    RowBox[{"logLinEqNoBar", ",", "eqTimeInDexeD"}], "}"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n"}]}]], "Input",
 CellChangeTimes->{
  3.9482172029295044`*^9, {3.9482172767034664`*^9, 3.948217329190628*^9}, 
   3.948217605001524*^9, {3.948218357118347*^9, 3.948218401248472*^9}, {
   3.9482184816585445`*^9, 3.948218554252701*^9}, {3.948218584625622*^9, 
   3.9482186765515785`*^9}, {3.948218792408987*^9, 3.9482188281772537`*^9}, 
   3.9482192330981655`*^9, {3.94821929869018*^9, 3.9482193203191605`*^9}, {
   3.9482757633364906`*^9, 3.948275779501955*^9}, {3.9482758564138184`*^9, 
   3.948275882938244*^9}, 3.9482780949387245`*^9, {3.948978039301388*^9, 
   3.9489780614751873`*^9}, {3.94897813577087*^9, 3.948978184816408*^9}, {
   3.9489782151446056`*^9, 3.9489782350011406`*^9}, {3.948978265102497*^9, 
   3.9489782672387295`*^9}, {3.9489878968216286`*^9, 
   3.9489879510043163`*^9}, {3.948988023691309*^9, 3.9489881130165176`*^9}, {
   3.948988688444702*^9, 3.948988723817602*^9}, {3.948989421971798*^9, 
   3.9489894308176804`*^9}, 3.948989469978512*^9, {3.949062856610857*^9, 
   3.949062858448099*^9}, 3.949062889994978*^9, {3.951574607329151*^9, 
   3.951574623277405*^9}},ExpressionUUID->"a30013b0-af0b-3641-a2e1-\
1eb1f625762d"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{
  3.9482761909525433`*^9, {3.948277591011326*^9, 3.9482776045391216`*^9}, {
   3.9489774692270775`*^9, 3.948977477896446*^9}, {3.948977618269253*^9, 
   3.9489777223346996`*^9}, {3.948977756008646*^9, 3.948977759945881*^9}, 
   3.9489778093769207`*^9, {3.948978000729273*^9, 3.948978015332199*^9}, {
   3.9500922721349106`*^9, 3.950092279818041*^9}, 
   3.951487797253174*^9},ExpressionUUID->"540827f2-e3ff-e24a-a159-\
4c33fa9eb206"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.9501110427022247`*^9, 
  3.951487779760866*^9},ExpressionUUID->"e93d444f-4bdb-cb44-a85c-\
59c6d307d81b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.9501110427082005`*^9, 
  3.9514877693065434`*^9},ExpressionUUID->"6c6f9bb5-a604-ca4c-b028-\
7d67f6d69e9e"],

Cell[BoxData[""], "Input",ExpressionUUID->"6e1aa942-3024-de42-8538-e83358f2155a"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\n"}]], "Input",
 CellChangeTimes->{
  3.9482780305935287`*^9, {3.94898954372686*^9, 
   3.9489895578695507`*^9}},ExpressionUUID->"e37bc72f-5857-5947-a697-\
98458db7a9ed"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.948281184816969*^9},ExpressionUUID->"833b7c30-e8c4-9243-8c0c-\
bcc486ee4cf1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "jb", ",", "rbHH", ",", "bH", ",", "rbE", ",", "bE", ",", "rD", ",", "D", 
     ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb", ",", "ADjB", ",", 
     "vars", ",", "partials", ",", "logLinEq", ",", "logLinEqNoBar", ",", 
     "timeSubs", ",", "logLinEqTime", ",", "final"}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "1.", " ", "Define", " ", "the", " ", "original", " ", "nonlinear", " ", 
     "equation", " ", "F"}], "==", "0"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{
     "jb_", ",", "rbHH_", ",", "bH_", ",", "rbE_", ",", "bE_", ",", "rD_", ",",
       "D_", ",", "Kb_", ",", "Bt_", ",", "nu_", ",", "kappaKb_", ",", 
      "ADjB_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"rbHH", "*", "bH"}], "+", 
     RowBox[{"rbE", "*", "bE"}], "-", 
     RowBox[{"rD", "*", "D"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"kappaKb", "/", "2"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Kb", "/", "Bt"}], "-", "nu"}], ")"}], "^", "2"}], ")"}], "*",
       "Kb"}], "-", "ADjB"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "2.", " ", "List", " ", "the", " ", "variables", " ", "for", " ", 
    "Differentiation"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"vars", "=", 
    RowBox[{"{", 
     RowBox[{
     "rbHH", ",", "bH", ",", "rbE", ",", "bE", ",", "rD", ",", "D", ",", "Kb",
       ",", "Bt", ",", "nu", ",", "kappaKb", ",", "ADjB"}], "}"}]}], ";"}], 
  "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "3.", " ", "Compute", " ", "partial", " ", "Derivatives", " ", "at", " ", 
    "the", " ", "steaDy", " ", "state"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"partials", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{
          "jb", ",", "rbHH", ",", "bH", ",", "rbE", ",", "bE", ",", "rD", ",",
            "D", ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb", ",", 
           "ADjB"}], "]"}], ",", 
         RowBox[{"vars", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rbHH", "->", "rbHHBar"}], ",", 
         RowBox[{"bH", "->", "bHBar"}], ",", 
         RowBox[{"rbE", "->", "rbEBar"}], ",", 
         RowBox[{"bE", "->", "bEBar"}], ",", 
         RowBox[{"rD", "->", "rDBar"}], ",", 
         RowBox[{"D", "->", "DBar"}], ",", 
         RowBox[{"Kb", "->", "KbBar"}], ",", 
         RowBox[{"Bt", "->", "BtBar"}], ",", 
         RowBox[{"nu", "->", "nuBar"}], ",", 
         RowBox[{"kappaKb", "->", "kappaKbBar"}], ",", 
         RowBox[{"ADjB", "->", "ADjBBar"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"4.", " ", "Define", " ", "log"}], "-", 
    RowBox[{"Deviation", " ", "variables"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "rbHH", ",", "bH", ",", "rbE", ",", "bE", ",", "rD", ",", "D", ",", "Kb", 
     ",", "Bt", ",", "nu", ",", "kappaKb", ",", "ADjB"}], "]"}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "5.", " ", "Multiply", " ", "each", " ", "Derivative", " ", "by", " ", 
    "steaDy", " ", "state", " ", "anD", " ", "corresponDing", " ", 
    "Deviation"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEq", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", "rbHHBar", "*", "rbHH"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", "bHBar", "*", "bH"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "*", "rbEBar", "*", "rbE"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "*", "bEBar", "*", "bE"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "*", "rDBar", "*", "rD"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "6", "]"}], "]"}], "*", "DBar", "*", "D"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "7", "]"}], "]"}], "*", "KbBar", "*", "Kb"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "8", "]"}], "]"}], "*", "BtBar", "*", "Bt"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "9", "]"}], "]"}], "*", "nuBar", "*", "nu"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "10", "]"}], "]"}], "*", "kappaKbBar", "*", "kappaKb"}], 
      "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "11", "]"}], "]"}], "*", "ADjBBar", "*", "ADjB"}]}], "==",
      "0"}]}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "6.", " ", "Simplify", " ", "anD", " ", "normalize", " ", "by", " ", 
    "setting", " ", "steaDy", " ", "states", " ", "to", " ", "1"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEqNoBar", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"logLinEq", "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rbHHBar", "->", "1"}], ",", 
        RowBox[{"bHBar", "->", "1"}], ",", 
        RowBox[{"rbEBar", "->", "1"}], ",", 
        RowBox[{"bEBar", "->", "1"}], ",", 
        RowBox[{"rDBar", "->", "1"}], ",", 
        RowBox[{"DBar", "->", "1"}], ",", 
        RowBox[{"KbBar", "->", "1"}], ",", 
        RowBox[{"BtBar", "->", "1"}], ",", 
        RowBox[{"nuBar", "->", "1"}], ",", 
        RowBox[{"kappaKbBar", "->", "1"}], ",", 
        RowBox[{"ADjBBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "7.", " ", "ReintroDuce", " ", "the", " ", "original", " ", "time", " ", 
    "inDices"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"timeSubs", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"rbHH", "->", 
       RowBox[{"rbHH", "[", "t", "]"}]}], ",", 
      RowBox[{"bH", "->", 
       RowBox[{"bH", "[", "t", "]"}]}], ",", 
      RowBox[{"rbE", "->", 
       RowBox[{"rbE", "[", "t", "]"}]}], ",", 
      RowBox[{"bE", "->", 
       RowBox[{"bE", "[", "t", "]"}]}], ",", 
      RowBox[{"rD", "->", 
       RowBox[{"rD", "[", "t", "]"}]}], ",", 
      RowBox[{"D", "->", 
       RowBox[{"D", "[", "t", "]"}]}], ",", 
      RowBox[{"Kb", "->", 
       RowBox[{"Kb", "[", "t", "]"}]}], ",", 
      RowBox[{"Bt", "->", 
       RowBox[{"Bt", "[", "t", "]"}]}], ",", 
      RowBox[{"nu", "->", 
       RowBox[{"nu", "[", "t", "]"}]}], ",", 
      RowBox[{"kappaKb", "->", 
       RowBox[{"kappaKb", "[", "t", "]"}]}], ",", 
      RowBox[{"ADjB", "->", 
       RowBox[{"ADjB", "[", "t", "]"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEqTime", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "8.", " ", "FullSimplify", " ", "the", " ", "final", " ", "linear", " ", 
    "equation"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"final", "=", 
    RowBox[{"FullSimplify", "[", "logLinEqTime", "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"9.", " ", "Show", " ", "the", " ", "result"}], 
   "*)"}]}], "\[IndentingNewLine]", "final", "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Define", " ", "the", " ", "equation"}], "*)"}], 
  RowBox[{
   RowBox[{"jb", "=", 
    RowBox[{
     RowBox[{"rBH", " ", "bH"}], "+", 
     RowBox[{"rBE", " ", "bE"}], "-", 
     RowBox[{"rD", " ", "D"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"kappaKb", "/", "2"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Kb", "/", "B"}], "-", "nuB"}], ")"}], "^", "2"}], ")"}], "*",
       "Kb"}], "-", "ADjCostB"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"wholesale", " ", "branch"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.948281214895033*^9, 3.950099478081703*^9, {3.9501109091585255`*^9, 
   3.950110921750189*^9}, {3.95018217527186*^9, 
   3.9501822001883545`*^9}},ExpressionUUID->"a82bb35f-23d4-1148-92be-\
97a819c647e0"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{
  3.948281214895033*^9, 3.950099478081703*^9, {3.9501109091585255`*^9, 
   3.9501109293399296`*^9}, {3.9501111261300335`*^9, 3.95011112798559*^9}, {
   3.9501111650228825`*^9, 3.9501111887031784`*^9}, {3.950111233133087*^9, 
   3.9501112536108837`*^9}, 
   3.9514776993714046`*^9},ExpressionUUID->"ca8719e8-b838-0c42-afec-\
188b76645ec7"],

Cell[BoxData[
 RowBox[{"\n", "\n"}]], "Input",
 CellChangeTimes->{
  3.9501110427551517`*^9, 3.9501115420520096`*^9, 3.950111572894432*^9, 
   3.9501116221599846`*^9, {3.950111872230009*^9, 3.9501118975357914`*^9}, {
   3.9501131763620224`*^9, 3.9501131978147163`*^9}, 3.950113743897209*^9, {
   3.950114077590885*^9, 3.9501141059134846`*^9}, {3.9501145766775513`*^9, 
   3.9501145967697277`*^9}, 
   3.951477678011156*^9},ExpressionUUID->"35543f6f-269e-cc4e-a11e-\
1fbde1359623"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "Rb", ",", "rt", ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb", ",", 
      "vars", ",", "partials", ",", "logLinEq", ",", "logLinEqNoBar", ",", 
      "timeSubs", ",", "logLinEqTime", ",", "final"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Define", " ", "the", " ", "equation"}], "*)"}], 
   RowBox[{
    RowBox[{
     RowBox[{"Kb", "[", "t", "]"}], "==", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Delta]b"}], ")"}], " ", 
       RowBox[{"Kb", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], "+", 
      RowBox[{"\[Omega]b", " ", 
       RowBox[{"jb", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "1.", " ", "Define", " ", "the", " ", "original", " ", "nonlinear", " ", 
      "equation", " ", "F"}], "==", "0"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{
      "Rb_", ",", "rt_", ",", "Kb_", ",", "Bt_", ",", "nu_", ",", 
       "kappaKb_"}], "]"}], ":=", 
     RowBox[{"Rb", "-", "rt", "-", 
      RowBox[{"kappaKb", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Kb", "/", "Bt"}], "-", "nu"}], ")"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Kb", "/", "Bt"}], ")"}], "^", "2"}]}], ")"}]}]}]}], ";"}],
    "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "2.", " ", "List", " ", "the", " ", "variables", " ", "for", " ", 
     "Differentiation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{
      "Rb", ",", "rt", ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "Compute", " ", "partial", " ", "Derivatives", " ", "at", " ", 
     "the", " ", "steaDy", " ", "state"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "[", 
           RowBox[{
           "Rb", ",", "rt", ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb"}],
            "]"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Rb", "->", "RbBar"}], ",", 
          RowBox[{"rt", "->", "rtBar"}], ",", 
          RowBox[{"Kb", "->", "KbBar"}], ",", 
          RowBox[{"Bt", "->", "BtBar"}], ",", 
          RowBox[{"nu", "->", "nuBar"}], ",", 
          RowBox[{"kappaKb", "->", "kappaKbBar"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"4.", " ", "Define", " ", "log"}], "-", 
     RowBox[{"Deviation", " ", "variables"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "Rb", ",", "rt", ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb"}], 
     "]"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "5.", " ", "Multiply", " ", "each", " ", "Derivative", " ", "by", " ", 
     "steaDy", " ", "state", " ", "anD", " ", "corresponDing", " ", 
     "Deviation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", "RbBar", "*", "Rb"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", "rtBar", "*", "rt"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", "KbBar", "*", "Kb"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "*", "BtBar", "*", "Bt"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "*", "nuBar", "*", "nu"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "*", "kappaKbBar", "*", 
        "kappaKb"}]}], "==", "0"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "6.", " ", "Simplify", " ", "anD", " ", "normalize", " ", "by", " ", 
     "setting", " ", "steaDy", " ", "states", " ", "to", " ", "1"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEqNoBar", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEq", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RbBar", "->", "1"}], ",", 
         RowBox[{"rtBar", "->", "1"}], ",", 
         RowBox[{"KbBar", "->", "1"}], ",", 
         RowBox[{"BtBar", "->", "1"}], ",", 
         RowBox[{"nuBar", "->", "1"}], ",", 
         RowBox[{"kappaKbBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "7.", " ", "ReintroDuce", " ", "the", " ", "original", " ", "time", " ", 
     "inDices"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"timeSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Rb", "->", 
        RowBox[{"Rb", "[", "t", "]"}]}], ",", 
       RowBox[{"rt", "->", 
        RowBox[{"rt", "[", "t", "]"}]}], ",", 
       RowBox[{"Kb", "->", 
        RowBox[{"Kb", "[", "t", "]"}]}], ",", 
       RowBox[{"Bt", "->", 
        RowBox[{"Bt", "[", "t", "]"}]}], ",", 
       RowBox[{"nu", "->", 
        RowBox[{"nu", "[", "t", "]"}]}], ",", 
       RowBox[{"kappaKb", "->", 
        RowBox[{"kappaKb", "[", "t", "]"}]}]}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEqTime", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "8.", " ", "FullSimplify", " ", "the", " ", "final", " ", "linear", " ", 
     "equation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"final", "=", 
     RowBox[{"FullSimplify", "[", "logLinEqTime", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"9.", " ", "Show", " ", "the", " ", "result"}], "*)"}], "\[IndentingNewLine]",
    "final", "\n"}]}]], "Input",
 CellChangeTimes->{{3.948282608006546*^9, 3.9482826444877167`*^9}, 
   3.950110087762638*^9, {3.950184488796919*^9, 
   3.950184492991724*^9}},ExpressionUUID->"a56cb576-82c8-7c48-8c63-\
0ad7fd764497"],

Cell[BoxData[""], "Input",ExpressionUUID->"9061a5ee-35fe-5741-ba37-38de218add33"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "Rb", ",", "rt", ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb", ",", 
     "vars", ",", "partials", ",", "logLinEq", ",", "logLinEqNoBar", ",", 
     "timeSubs", ",", "logLinEqTime", ",", "final"}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "1.", " ", "Define", " ", "the", " ", "original", " ", "nonlinear", " ", 
     "equation", " ", "F"}], "==", "0"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{
     "Rb_", ",", "rt_", ",", "Kb_", ",", "Bt_", ",", "nu_", ",", "kappaKb_"}],
      "]"}], ":=", 
    RowBox[{"Rb", "-", "rt", "+", 
     RowBox[{"kappaKb", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Kb", "/", "Bt"}], "-", "nu"}], ")"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Kb", "/", "Bt"}], ")"}], "^", "2"}]}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "2.", " ", "List", " ", "the", " ", "variables", " ", "for", " ", 
    "Differentiation"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vars", "=", 
    RowBox[{"{", 
     RowBox[{
     "Rb", ",", "rt", ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb"}], 
     "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "3.", " ", "Compute", " ", "partial", " ", "Derivatives", " ", "at", " ", 
    "the", " ", "steaDy", " ", "state"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"partials", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{
          "Rb", ",", "rt", ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb"}], 
          "]"}], ",", 
         RowBox[{"vars", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Rb", "->", "RbBar"}], ",", 
         RowBox[{"rt", "->", "rtBar"}], ",", 
         RowBox[{"Kb", "->", "KbBar"}], ",", 
         RowBox[{"Bt", "->", "BtBar"}], ",", 
         RowBox[{"nu", "->", "nuBar"}], ",", 
         RowBox[{"kappaKb", "->", "kappaKbBar"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], "\n",
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"4.", " ", "Define", " ", "log"}], "-", 
    RowBox[{"Deviation", " ", "variables"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "Rb", ",", "rt", ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb"}], "]"}],
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "5.", " ", "Multiply", " ", "each", " ", "Derivative", " ", "by", " ", 
    "steaDy", " ", "state", " ", "anD", " ", "corresponDing", " ", 
    "Deviation"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEq", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", "RbBar", "*", "Rb"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", "rtBar", "*", "rt"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "*", "KbBar", "*", "Kb"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "*", "BtBar", "*", "Bt"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "*", "nuBar", "*", "nu"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "6", "]"}], "]"}], "*", "kappaKbBar", "*", "kappaKb"}]}],
      "==", "0"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "6.", " ", "Simplify", " ", "anD", " ", "normalize", " ", "by", " ", 
    "setting", " ", "steaDy", " ", "states", " ", "to", " ", "1"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEqNoBar", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"logLinEq", "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RbBar", "->", "1"}], ",", 
        RowBox[{"rtBar", "->", "1"}], ",", 
        RowBox[{"KbBar", "->", "1"}], ",", 
        RowBox[{"BtBar", "->", "1"}], ",", 
        RowBox[{"nuBar", "->", "1"}], ",", 
        RowBox[{"kappaKbBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "7.", " ", "ReintroDuce", " ", "the", " ", "original", " ", "time", " ", 
    "inDices"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"timeSubs", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Rb", "->", 
       RowBox[{"Rb", "[", "t", "]"}]}], ",", 
      RowBox[{"rt", "->", 
       RowBox[{"rt", "[", "t", "]"}]}], ",", 
      RowBox[{"Kb", "->", 
       RowBox[{"Kb", "[", "t", "]"}]}], ",", 
      RowBox[{"Bt", "->", 
       RowBox[{"Bt", "[", "t", "]"}]}], ",", 
      RowBox[{"nu", "->", 
       RowBox[{"nu", "[", "t", "]"}]}], ",", 
      RowBox[{"kappaKb", "->", 
       RowBox[{"kappaKb", "[", "t", "]"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEqTime", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "8.", " ", "FullSimplify", " ", "the", " ", "final", " ", "linear", " ", 
    "equation"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"final", "=", 
    RowBox[{"FullSimplify", "[", "logLinEqTime", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"9.", " ", "Show", " ", "the", " ", "result"}], 
   "*)"}]}], "\n", "final", "\n"}], "Input",
 CellChangeTimes->{3.948283056384369*^9},
 CellLabel->
  "In[106]:=",ExpressionUUID->"ff208aaa-6375-2b49-b93f-5d5062c77685"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "Rb", ",", "rt", ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb", ",", 
     "vars", ",", "partials", ",", "logLinEq", ",", "logLinEqNoBar", ",", 
     "timeSubs", ",", "logLinEqTime", ",", "final"}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "1.", " ", "Define", " ", "the", " ", "original", " ", "nonlinear", " ", 
     "equation", " ", "F"}], "==", "0"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{
     "Rb_", ",", "rt_", ",", "Kb_", ",", "Bt_", ",", "nu_", ",", "kappaKb_"}],
      "]"}], ":=", 
    RowBox[{"Rb", "-", "rt", "+", 
     RowBox[{"kappaKb", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Kb", "/", "Bt"}], "-", "nu"}], ")"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Kb", "/", "Bt"}], ")"}], "^", "2"}]}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "2.", " ", "List", " ", "the", " ", "variables", " ", "for", " ", 
    "Differentiation"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"vars", "=", 
    RowBox[{"{", 
     RowBox[{
     "Rb", ",", "rt", ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb"}], 
     "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "3.", " ", "Compute", " ", "partial", " ", "Derivatives", " ", "at", " ", 
    "the", " ", "steaDy", " ", "state"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"partials", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{
          "Rb", ",", "rt", ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb"}], 
          "]"}], ",", 
         RowBox[{"vars", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Rb", "->", "RbBar"}], ",", 
         RowBox[{"rt", "->", "rtBar"}], ",", 
         RowBox[{"Kb", "->", "KbBar"}], ",", 
         RowBox[{"Bt", "->", "BtBar"}], ",", 
         RowBox[{"nu", "->", "nuBar"}], ",", 
         RowBox[{"kappaKb", "->", "kappaKbBar"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"4.", " ", "Define", " ", "log"}], "-", 
    RowBox[{"Deviation", " ", "variables"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "Rb", ",", "rt", ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb"}], "]"}],
    ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "5.", " ", "Multiply", " ", "each", " ", "Derivative", " ", "by", " ", 
    "steaDy", " ", "state", " ", "anD", " ", "corresponDing", " ", 
    "Deviation"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEq", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", "RbBar", "*", "Rb"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", "rtBar", "*", "rt"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "*", "KbBar", "*", "Kb"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "*", "BtBar", "*", "Bt"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "*", "nuBar", "*", "nu"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "6", "]"}], "]"}], "*", "kappaKbBar", "*", "kappaKb"}]}],
      "==", "0"}]}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "6.", " ", "Simplify", " ", "anD", " ", "normalize", " ", "by", " ", 
    "setting", " ", "steaDy", " ", "states", " ", "to", " ", "1"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEqNoBar", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"logLinEq", "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RbBar", "->", "1"}], ",", 
        RowBox[{"rtBar", "->", "1"}], ",", 
        RowBox[{"KbBar", "->", "1"}], ",", 
        RowBox[{"BtBar", "->", "1"}], ",", 
        RowBox[{"nuBar", "->", "1"}], ",", 
        RowBox[{"kappaKbBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "7.", " ", "ReintroDuce", " ", "the", " ", "original", " ", "time", " ", 
    "inDices"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"timeSubs", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Rb", "->", 
       RowBox[{"Rb", "[", "t", "]"}]}], ",", 
      RowBox[{"rt", "->", 
       RowBox[{"rt", "[", "t", "]"}]}], ",", 
      RowBox[{"Kb", "->", 
       RowBox[{"Kb", "[", "t", "]"}]}], ",", 
      RowBox[{"Bt", "->", 
       RowBox[{"Bt", "[", "t", "]"}]}], ",", 
      RowBox[{"nu", "->", 
       RowBox[{"nu", "[", "t", "]"}]}], ",", 
      RowBox[{"kappaKb", "->", 
       RowBox[{"kappaKb", "[", "t", "]"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEqTime", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "8.", " ", "FullSimplify", " ", "the", " ", "final", " ", "linear", " ", 
    "equation"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"final", "=", 
    RowBox[{"FullSimplify", "[", "logLinEqTime", "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"9.", " ", "Show", " ", "the", " ", "result"}], 
   "*)"}]}], "\[IndentingNewLine]", "final", "\n"}], "Input",
 CellChangeTimes->{3.94828331388431*^9},
 CellLabel->
  "In[117]:=",ExpressionUUID->"d8e75efd-76ab-8a46-9fc3-e125253aba0d"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.9482840089863453`*^9, 3.948284027505615*^9}, 
   3.948822339260597*^9},ExpressionUUID->"3b72adb7-506f-a242-9ce8-\
568a43db7148"],

Cell[BoxData[""], "Input",ExpressionUUID->"2c909075-ae9a-1e46-bacf-b4aff58794cf"],

Cell[BoxData[
 RowBox[{"\n", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.948290165256489*^9, 3.9482902270903816`*^9, {3.9483006378467236`*^9, 
   3.9483006804550667`*^9}, 
   3.9488221135338364`*^9},ExpressionUUID->"67d8674f-acfb-3043-9b8d-\
8ee7033e485e"],

Cell[BoxData[""], "Input",ExpressionUUID->"c5f2b5fd-741a-8049-a956-ffe3b238359b"],

Cell[BoxData[""], "Input",ExpressionUUID->"ab316537-3e7d-3446-8567-ba591898cdf1"],

Cell[BoxData[""], "Input",ExpressionUUID->"997334ee-ab42-4643-8d15-288531846b9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"interest", " ", "rates"}], " ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "rt", ",", "rtprev", ",", "r", ",", "DeltaR", ",", "pit", ",", "pi", ",",
       "phipi", ",", "yt", ",", "yt1", ",", "phiy", ",", "epsilont", ",", 
      "vars", ",", "partials", ",", "logLinEq", ",", "logLinEqNoBar", ",", 
      "timeSubs", ",", "logLinEqTime", ",", "final"}], "]"}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "1.", " ", "Define", " ", "the", " ", "original", " ", "nonlinear", " ", 
      "equation", " ", "F"}], "==", "0"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{
      "rt_", ",", "rtprev_", ",", "r_", ",", "DeltaR_", ",", "pit_", ",", 
       "pi_", ",", "phipi_", ",", "yt_", ",", "yt1_", ",", "phiy_", ",", 
       "epsilont_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "rt"}], ")"}], "-", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "r"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"1", "-", "DeltaR"}], ")"}]}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "rtprev"}], ")"}], "^", "DeltaR"}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"pit", "/", "pi"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"phipi", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "DeltaR"}], ")"}]}], ")"}]}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"yt", "/", "yt1"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"phiy", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "DeltaR"}], ")"}]}], ")"}]}], " ", 
       "epsilont"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "2.", " ", "List", " ", "the", " ", "variables", " ", "for", " ", 
     "Differentiation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{
      "rt", ",", "rtprev", ",", "r", ",", "pit", ",", "pi", ",", "yt", ",", 
       "yt1", ",", "epsilont"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "Compute", " ", "partial", " ", "Derivatives", " ", "at", " ", 
     "the", " ", "steaDy", " ", "state"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "[", 
           RowBox[{
           "rt", ",", "rtprev", ",", "r", ",", "DeltaR", ",", "pit", ",", 
            "pi", ",", "phipi", ",", "yt", ",", "yt1", ",", "phiy", ",", 
            "epsilont"}], "]"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"rt", "->", "rBar"}], ",", 
          RowBox[{"rtprev", "->", "rBar"}], ",", 
          RowBox[{"r", "->", "rBar"}], ",", 
          RowBox[{"pit", "->", "piBar"}], ",", 
          RowBox[{"pi", "->", "piBar"}], ",", 
          RowBox[{"yt", "->", 
           RowBox[{"gamma", "*", "EyEBar"}]}], ",", 
          RowBox[{"yt1", "->", 
           RowBox[{"gamma", "*", "EyEBar"}]}], ",", 
          RowBox[{"epsilont", "->", "epsilonbar"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"4.", " ", "Define", " ", "log"}], "-", 
     RowBox[{"Deviation", " ", "variables"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "rt", ",", "rtprev", ",", "r", ",", "pit", ",", "pi", ",", "yt", ",", 
      "yt1", ",", "epsilont"}], "]"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "5.", " ", "Multiply", " ", "each", " ", "Derivative", " ", "by", " ", 
     "steaDy", " ", "state", " ", "anD", " ", "corresponDing", " ", 
     "Deviation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", "rBar", "*", "rt"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", "rBar", "*", "rtprev"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "*", "piBar", "*", "pit"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "*", "piBar", "*", "pi"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "*", "gamma", "*", "EyEBar", "*", 
        "yt"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "7", "]"}], "]"}], "*", "gamma", "*", "EyEBar", "*", 
        "yt1"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "8", "]"}], "]"}], "*", "epsilont", "*", 
        "epsilonbar"}]}], "==", "0"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "6.", " ", "Simplify", " ", "anD", " ", "normalize", " ", "by", " ", 
     "setting", " ", "steaDy", " ", "states", " ", "to", " ", "1"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEqNoBar", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEq", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rBar", "->", "1"}], ",", 
         RowBox[{"piBar", "->", "1"}], ",", 
         RowBox[{
          RowBox[{"gamma", "*", "EyEBar"}], "->", "1"}], ",", 
         RowBox[{"epsilonbar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "7.", " ", "ReintroDuce", " ", "the", " ", "original", " ", "time", " ", 
     "inDices"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"timeSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rt", "->", 
        RowBox[{"r", "[", "t", "]"}]}], ",", 
       RowBox[{"rtprev", "->", 
        RowBox[{"r", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], ",", 
       RowBox[{"r", "->", "r"}], ",", 
       RowBox[{"pit", "->", 
        RowBox[{"pit", "[", "t", "]"}]}], ",", 
       RowBox[{"pi", "->", 
        RowBox[{"pi", "[", "t", "]"}]}], ",", 
       RowBox[{"yt", "->", 
        RowBox[{"gamma", "*", 
         RowBox[{"EyE", "[", "t", "]"}]}]}], ",", 
       RowBox[{"yt1", "->", 
        RowBox[{"gamma", "*", 
         RowBox[{"EyE", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}]}], ",", 
       RowBox[{"epsilont", "->", 
        RowBox[{"epsilont", "[", "t", "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"logLinEqTime", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "8.", " ", "FullSimplify", " ", "the", " ", "final", " ", "linear", " ", 
     "equation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"final", "=", 
     RowBox[{"FullSimplify", "[", "logLinEqTime", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"9.", " ", "Show", " ", "the", " ", "result"}], "*)"}], "\n", 
   "final", "\n", "\n", "\n"}]}]], "Input",
 CellChangeTimes->{
  3.948290797825924*^9, {3.9482908870602665`*^9, 3.9482909038465385`*^9}, {
   3.948291328198168*^9, 3.9482913579914494`*^9}, {3.9482919728943176`*^9, 
   3.9482919752060814`*^9}, 3.948294263133692*^9, {3.948294545288492*^9, 
   3.9482945637916813`*^9}, 3.9482949137900887`*^9, {3.948300224204357*^9, 
   3.94830024748044*^9}, {3.948300432697098*^9, 3.94830046694265*^9}, {
   3.948301726822344*^9, 3.9483017762476215`*^9}, {3.948368617069916*^9, 
   3.948368637847414*^9}, 3.948368670113468*^9, 3.948370868668873*^9, 
   3.9483709421856117`*^9, 3.9483709776544304`*^9, {3.9483720614720592`*^9, 
   3.948372079081949*^9}, {3.948372117270647*^9, 3.9483721547778893`*^9}, 
   3.9483723872874947`*^9, {3.9483724359224377`*^9, 3.9483724949128914`*^9}, 
   3.9483760291753025`*^9, 3.9483760635531807`*^9, 3.950109457102211*^9, {
   3.9506121886890926`*^9, 3.9506121904269714`*^9}, 
   3.950612431581133*^9},ExpressionUUID->"4d53601a-fd38-8d4f-a5bd-\
6776aef1197c"],

Cell[BoxData[
 RowBox[{"\n", "\n"}]], "Input",
 CellChangeTimes->{
  3.9482949528246784`*^9, 3.9482950677238617`*^9, 3.948295122942894*^9, 
   3.948295163384453*^9, 3.948295240413183*^9, {3.94829543609647*^9, 
   3.9482954550522633`*^9}, {3.9482956533275127`*^9, 3.948295664961014*^9}, {
   3.94829678226198*^9, 3.9482968005008698`*^9}, 3.9483001506649837`*^9, {
   3.9501067338312187`*^9, 3.9501067351425323`*^9}, {3.9501068244580364`*^9, 
   3.950106851911623*^9}, 
   3.950106894988388*^9},ExpressionUUID->"1e372a0a-d04a-0043-8634-\
a06ae95ac5f2"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9489945600283966`*^9, 3.9489945768175735`*^9}, 
   3.948994652798132*^9, {3.9489951630497417`*^9, 3.9489954439801025`*^9}, {
   3.9489961835008106`*^9, 
   3.948996187438553*^9}},ExpressionUUID->"8620db63-1855-fb4d-8f03-\
43e480652571"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\n"}]], "Input",
 CellChangeTimes->{{3.948992292102009*^9, 3.948992312656969*^9}, 
   3.9489923446774673`*^9, {3.9489923804373207`*^9, 3.9489923833659534`*^9}, {
   3.94899247539674*^9, 3.948992492646641*^9}, 3.948992562946371*^9, 
   3.94899280039859*^9, {3.9489928346182537`*^9, 3.948992836203594*^9}, {
   3.9489928792084503`*^9, 3.9489929105452404`*^9}, {3.9489930457092705`*^9, 
   3.9489930513937454`*^9}},ExpressionUUID->"269dff81-a812-9249-a1f5-\
6e70ad846896"],

Cell[BoxData[""], "Input",ExpressionUUID->"833d72fc-f1ef-2541-b874-706d0c32da9b"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\n", "\n"}]], "Input",
 CellChangeTimes->{{3.9484531036409836`*^9, 3.948453252554985*^9}, {
   3.948453491951372*^9, 3.9484535026756477`*^9}, {3.9484535364761105`*^9, 
   3.948453600848089*^9}, {3.948822157816473*^9, 3.948822171699688*^9}, 
   3.9488222750960217`*^9, 3.9489912779161777`*^9, {3.9489916587065735`*^9, 
   3.9489917421482697`*^9}, 
   3.9489922532462616`*^9},ExpressionUUID->"bf85dff3-cfcf-194f-8172-\
c7888df28bf7"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9490547996499767`*^9, 3.9490547996508904`*^9}, 
   3.9501046944944763`*^9},ExpressionUUID->"1619ea84-a057-f840-b9a9-\
74fb06551168"],

Cell[BoxData[""], "Input",ExpressionUUID->"bbc937ae-faa9-334f-86a3-c07cb38540d6"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\n", "\[IndentingNewLine]", "\n", "\n", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.948902028097927*^9, 3.948902028097927*^9}, {
   3.9489020649795914`*^9, 3.9489021345402603`*^9}, {3.9489021688100224`*^9, 
   3.9489022711608696`*^9}, {3.9489027129443207`*^9, 3.948902719111843*^9}, {
   3.948902749429943*^9, 3.9489027733288803`*^9}, {3.9489036511578445`*^9, 
   3.9489036853736763`*^9}, {3.9489038117008038`*^9, 3.948903829468157*^9}, 
   3.9489041828586197`*^9, 3.948904431542452*^9, {3.9489044770826054`*^9, 
   3.9489044847675667`*^9}, {3.9489046599095173`*^9, 3.9489046807480087`*^9}, 
   3.9489056105456142`*^9, 3.948905649044409*^9, 3.948905797111294*^9, 
   3.94899150006662*^9},ExpressionUUID->"398bba21-27f0-ba4f-8d02-\
b70493bc16d2"]
},
WindowSize->{1380.75, 765.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f489a022-fb60-3043-af9e-b0ff28a7caa3"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 9669, 182, 484, "Input",ExpressionUUID->"f9fb2cec-0218-1946-a7a4-614cfc63c79f"],
Cell[10248, 206, 217, 4, 32, "Output",ExpressionUUID->"72576288-5b27-e542-8734-fa9fc2bb7aa8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10502, 215, 1977, 54, 218, "Input",ExpressionUUID->"6c8204b6-abb9-764b-8ef5-a85325ed64d1"],
Cell[12482, 271, 203, 3, 32, "Output",ExpressionUUID->"fc7cbeef-2439-8b4a-b7f6-1454a9bb35c3"],
Cell[12688, 276, 203, 3, 32, "Output",ExpressionUUID->"3f744072-e234-194c-a31c-c641b6793d6c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12928, 284, 5653, 78, 142, "Input",ExpressionUUID->"4b3eccfc-eaf3-934c-bb83-3f5e58677cb9"],
Cell[18584, 364, 1042, 31, 48, "Output",ExpressionUUID->"1d0aea1a-43b1-0e41-bbb6-acb2d3394f51"]
}, Open  ]],
Cell[19641, 398, 150, 3, 28, "Input",ExpressionUUID->"89f46449-40bc-454b-bf12-432d0c41fab6"],
Cell[CellGroupData[{
Cell[19816, 405, 602, 10, 66, "Input",ExpressionUUID->"73a5e06e-15c9-2347-9c11-545b67147ef3"],
Cell[20421, 417, 1013, 31, 48, "Output",ExpressionUUID->"69f708d9-2fde-d048-a3ef-9909f0b57037"]
}, Open  ]],
Cell[21449, 451, 147, 3, 28, "Input",ExpressionUUID->"989a8f9c-9396-624a-b30a-0383185b187d"],
Cell[21599, 456, 130, 3, 28, "Input",ExpressionUUID->"93063096-b854-5642-83fe-da57c1f294a1"],
Cell[21732, 461, 206, 4, 28, "Input",ExpressionUUID->"0708fca9-59ce-8847-af89-18fc69779938"],
Cell[CellGroupData[{
Cell[21963, 469, 6794, 193, 541, "Input",ExpressionUUID->"192101d9-a452-ec4a-a416-01215e453114"],
Cell[28760, 664, 2311, 66, 88, "Output",ExpressionUUID->"5528f23b-e40d-8e49-8e6c-664d8d82e713"]
}, Open  ]],
Cell[31086, 733, 152, 3, 28, "Input",ExpressionUUID->"331e89ae-d4d3-0148-9d6e-d62837cf9c8a"],
Cell[CellGroupData[{
Cell[31263, 740, 883, 13, 28, "Input",ExpressionUUID->"9ace75de-4978-4347-8abf-940e21a736de"],
Cell[CellGroupData[{
Cell[32171, 757, 506, 10, 22, "Print",ExpressionUUID->"3180c1ab-5e0d-ca40-9394-5e86f56408d7"],
Cell[32680, 769, 428, 9, 22, "Print",ExpressionUUID->"cba57453-8210-be49-9e99-e7c7a95b445f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33157, 784, 5264, 140, 503, "Input",ExpressionUUID->"6cbdf14f-fcad-b24a-9b64-6f911cd48fed"],
Cell[38424, 926, 4328, 128, 149, "Output",ExpressionUUID->"7534fc2b-c19a-7347-a838-1175749628d0"],
Cell[42755, 1056, 958, 27, 48, "Output",ExpressionUUID->"f9cab0d0-9845-224a-947c-34484fc574bd"]
}, Open  ]],
Cell[43728, 1086, 154, 3, 28, "Input",ExpressionUUID->"7c3554d3-4946-fd4b-bc7b-7e9e3ebaec7b"],
Cell[43885, 1091, 149, 2, 28, "Input",ExpressionUUID->"0c1908c2-3a31-d14e-ab3a-e4b82587ec48"],
Cell[44037, 1095, 305, 5, 47, "Input",ExpressionUUID->"4978f1f1-0572-b84b-b184-a61a2eb98030"],
Cell[CellGroupData[{
Cell[44367, 1104, 326, 5, 28, "Input",ExpressionUUID->"45d14f52-30e0-da46-9903-bc98c6f0cfcd"],
Cell[CellGroupData[{
Cell[44718, 1113, 402, 8, 22, "Print",ExpressionUUID->"3b40c5c1-cbf0-244a-912a-65c58f9ab2e4"],
Cell[45123, 1123, 356, 8, 22, "Print",ExpressionUUID->"3dd3e17b-7b29-3d40-970d-7f04b4476b62"]
}, Open  ]]
}, Open  ]],
Cell[45506, 1135, 163, 3, 33, "Text",ExpressionUUID->"a69b7710-0a9d-1846-91aa-7a4298560cda"],
Cell[45672, 1140, 502, 9, 66, "Input",ExpressionUUID->"42a8e955-c96a-7241-b392-ab997b076293"],
Cell[46177, 1151, 142, 3, 33, "Text",ExpressionUUID->"b6a1118c-8d19-934d-bab1-26bb44974ff4"],
Cell[46322, 1156, 156, 3, 47, "Input",ExpressionUUID->"aec07186-9953-eb4b-a898-e758c5d4aabf"],
Cell[46481, 1161, 439, 7, 180, "Input",ExpressionUUID->"665ccb08-e918-c74f-86bd-79b899402612"],
Cell[46923, 1170, 813, 12, 28, "Input",ExpressionUUID->"dc40e394-a162-e344-af1c-469b5ff19c55"],
Cell[47739, 1184, 81, 0, 28, "Input",ExpressionUUID->"7a834a5d-16f4-cc45-8b91-2c83acb7bfcf"],
Cell[47823, 1186, 20673, 595, 903, "Input",ExpressionUUID->"04b06094-e411-2340-ae40-ed548ed14b86"],
Cell[68499, 1783, 899, 14, 104, "Input",ExpressionUUID->"f0fa445f-5834-f94c-9a80-dd8f95a8acc3"],
Cell[69401, 1799, 335, 5, 28, "Input",ExpressionUUID->"5a156fc5-2eb4-7e48-b51d-4ec8fa2678b1"],
Cell[69739, 1806, 81, 0, 28, "Input",ExpressionUUID->"67031162-bd98-8f49-8550-4b19913fb9a6"],
Cell[69823, 1808, 152, 3, 28, "Input",ExpressionUUID->"8dbb250f-d2e5-ea41-91a5-cfe2707f435d"],
Cell[CellGroupData[{
Cell[70000, 1815, 10307, 247, 560, "Input",ExpressionUUID->"94fcf45b-6f21-634c-b1d5-7d0ae8a5c58d"],
Cell[80310, 2064, 7874, 223, 305, "Output",ExpressionUUID->"194248a8-00ed-fc49-88d9-41c4ce9dc562"]
}, Open  ]],
Cell[88199, 2290, 81, 0, 28, "Input",ExpressionUUID->"b9ef39e2-d105-c74c-ae1b-589fe4deab77"],
Cell[88283, 2292, 379, 7, 104, "Input",ExpressionUUID->"8880107c-6260-f84b-9c38-4d69438e0d38"],
Cell[CellGroupData[{
Cell[88687, 2303, 14254, 351, 941, "Input",ExpressionUUID->"b0b5f86b-cc2e-e04d-b2ed-4360d9e5fb4f"],
Cell[CellGroupData[{
Cell[102966, 2658, 5234, 125, 85, "Print",ExpressionUUID->"99c48eac-a0e0-9142-bc8a-0cb53fea0757"],
Cell[108203, 2785, 4097, 98, 75, "Print",ExpressionUUID->"76e14aac-f008-9247-ad98-970a8de8d234"],
Cell[112303, 2885, 1150, 29, 42, "Print",ExpressionUUID->"866ae9af-cacc-cf42-8f8f-373fca68e965"]
}, Open  ]],
Cell[113468, 2917, 486, 14, 51, "Output",ExpressionUUID->"52098315-e9ff-e247-8667-78eba5241467"],
Cell[113957, 2933, 539, 16, 51, "Output",ExpressionUUID->"2535d51f-a0e1-874a-9613-1b58a30f0507"]
}, Open  ]],
Cell[114511, 2952, 2380, 33, 28, "Input",ExpressionUUID->"5b2a032a-505e-c740-a415-a5a50f903e5d"],
Cell[116894, 2987, 26040, 687, 1017, "Input",ExpressionUUID->"0e074e25-5497-e244-8216-c9871e946f7c"],
Cell[142937, 3676, 18129, 519, 865, "Input",ExpressionUUID->"fb2f931c-bc15-f341-bf84-64962e1f5fe1"],
Cell[161069, 4197, 181, 3, 28, "Input",ExpressionUUID->"a9e0b9e7-323f-1e41-8090-9b78c8cfbd2d"],
Cell[161253, 4202, 2458, 34, 47, "Input",ExpressionUUID->"a67f113d-d41d-d24a-8f3f-b4722fe41f74"],
Cell[163714, 4238, 200, 3, 47, "Input",ExpressionUUID->"9b5be767-603c-0b4d-b011-d7ba65064b4b"],
Cell[163917, 4243, 325, 6, 66, "Input",ExpressionUUID->"701e4a68-645d-5947-9384-1c5f4e49b6a5"],
Cell[164245, 4251, 152, 3, 28, "Input",ExpressionUUID->"9ead36bb-5963-aa40-8fe7-c50aeb708fcd"],
Cell[164400, 4256, 181, 3, 28, "Input",ExpressionUUID->"58b14532-419e-124a-a555-ae1c8fa742c0"],
Cell[164584, 4261, 308, 5, 47, "Input",ExpressionUUID->"6bdb1088-4e1c-f54b-9a0b-13f60053de22"],
Cell[CellGroupData[{
Cell[164917, 4270, 11276, 280, 732, "Input",ExpressionUUID->"24e808de-ed6a-4146-a49a-28e49cf93adc"],
Cell[176196, 4552, 11716, 321, 383, "Output",ExpressionUUID->"8bfddbbc-a0d9-d94f-9d8c-8f46c6a145c3"]
}, Open  ]],
Cell[187927, 4876, 11696, 322, 408, "Input",ExpressionUUID->"32923660-840a-4b4d-a40a-87b153dac6e3"],
Cell[199626, 5200, 156, 3, 28, "Input",ExpressionUUID->"4129f409-7408-7d45-9299-8b83db08acfc"],
Cell[CellGroupData[{
Cell[199807, 5207, 15759, 435, 1036, "Input",ExpressionUUID->"e52c92a4-2eb6-c645-94b2-60c371363739"],
Cell[215569, 5644, 5539, 146, 110, "Print",ExpressionUUID->"a5490c30-ac37-344c-8f8a-02868d6220b5"],
Cell[221111, 5792, 458, 14, 49, "Output",ExpressionUUID->"e2c714d2-7bd3-fb4c-8d33-274a646f496d"],
Cell[221572, 5808, 405, 12, 49, "Output",ExpressionUUID->"96bffbcc-cb29-a548-8f4f-78e3e5767649"]
}, Open  ]],
Cell[221992, 5823, 602, 10, 47, "Input",ExpressionUUID->"f19b7f51-99bd-4547-9650-5ff8e4c33086"],
Cell[222597, 5835, 246, 6, 47, "Input",ExpressionUUID->"002de0c7-8e14-2747-b392-58662b103a4a"],
Cell[CellGroupData[{
Cell[222868, 5845, 6549, 174, 446, "Input",ExpressionUUID->"e2c58ebf-4fbc-3d4b-ac91-cf15352134a5"],
Cell[CellGroupData[{
Cell[229442, 6023, 4094, 109, 87, "Print",ExpressionUUID->"27a6b6a9-dd39-e946-8645-2ba6d1ddb0de"],
Cell[233539, 6134, 1157, 31, 40, "Print",ExpressionUUID->"cf9e50f6-712c-424c-95be-dbd7337e74ff"]
}, Open  ]],
Cell[234711, 6168, 156, 2, 32, "Output",ExpressionUUID->"05d66967-42a9-1b46-bc60-6572d22973cd"],
Cell[234870, 6172, 157, 2, 32, "Output",ExpressionUUID->"b470bf8d-902b-4b41-88ec-e30ef5408830"]
}, Open  ]],
Cell[235042, 6177, 81, 0, 28, "Input",ExpressionUUID->"b88ee315-af2d-ad44-b33b-38496d3a52d4"],
Cell[235126, 6179, 175, 3, 28, "Input",ExpressionUUID->"4126ecf3-b2bc-c34e-b9ce-ab3dbe467b58"],
Cell[235304, 6184, 10936, 274, 827, "Input",ExpressionUUID->"e455865f-d51a-c546-92e4-fe2425237d2b"],
Cell[246243, 6460, 209, 4, 47, "Input",ExpressionUUID->"36afece9-c926-264b-a26f-39f47d59542e"],
Cell[246455, 6466, 4154, 119, 172, "Input",ExpressionUUID->"ac571d23-c186-944e-833e-c2c84de86d8f"],
Cell[250612, 6587, 228, 4, 47, "Input",ExpressionUUID->"2dd959b2-176f-8a4f-80e4-1ab403b9ba23"],
Cell[250843, 6593, 156, 3, 28, "Input",ExpressionUUID->"7e7eb5ba-8e84-5b42-acd7-29c01026fa12"],
Cell[251002, 6598, 7716, 195, 656, "Input",ExpressionUUID->"0ee05957-9f4b-5148-9577-73fb4d317e3e"],
Cell[258721, 6795, 687, 10, 28, "Input",ExpressionUUID->"d50ef5dd-7d10-9347-8ed7-e6a9098ab778"],
Cell[259411, 6807, 179, 3, 28, "Input",ExpressionUUID->"63b0b1fd-2390-274b-9686-decf9bf4215f"],
Cell[259593, 6812, 287, 5, 28, "Input",ExpressionUUID->"71ece0e5-c6b3-3242-9291-2dce22eed9c9"],
Cell[259883, 6819, 740, 11, 123, "Input",ExpressionUUID->"2c594bee-dfa3-0445-a3c2-f168b0935ff6"],
Cell[260626, 6832, 156, 3, 28, "Input",ExpressionUUID->"e7592208-471d-8b47-8fcd-f3187cd3bdcd"],
Cell[260785, 6837, 81, 0, 28, "Input",ExpressionUUID->"dcfcb1a1-4b7e-0b43-9670-8664b3289327"],
Cell[260869, 6839, 1093, 15, 47, "Input",ExpressionUUID->"a5650fd1-18d4-1d4e-89f1-7b4f1f908005"],
Cell[261965, 6856, 277, 5, 28, "Input",ExpressionUUID->"e2dbdcc9-c66d-4441-907d-edfe421a4271"],
Cell[262245, 6863, 105, 1, 28, "Input",ExpressionUUID->"39487013-ded2-0e45-9fd8-d526c979fc41"],
Cell[262353, 6866, 81, 0, 28, "Input",ExpressionUUID->"ad54bf90-5079-e447-887e-2c9f31b492f1"],
Cell[262437, 6868, 202, 5, 66, "Input",ExpressionUUID->"25e88d48-476a-5a46-a379-8531149d9a08"],
Cell[262642, 6875, 204, 4, 47, "Input",ExpressionUUID->"90347a46-5dbd-b54f-8f1e-a6938e1fe31a"],
Cell[262849, 6881, 469, 10, 66, "Input",ExpressionUUID->"d48f496e-7176-4c4a-84fa-2b0987060b46"],
Cell[CellGroupData[{
Cell[263343, 6895, 15567, 429, 1036, "Input",ExpressionUUID->"16a53433-1cc7-e74a-b3e2-121a43b05c36"],
Cell[278913, 7326, 1260, 39, 48, "Output",ExpressionUUID->"f4623e57-3245-7040-a916-f679b48e75eb"],
Cell[280176, 7367, 2062, 65, 60, "Output",ExpressionUUID->"e913f95b-f991-7148-b251-827c609892fb"],
Cell[282241, 7434, 5460, 152, 205, "Output",ExpressionUUID->"34f16153-f5b0-854d-abf7-da8cc57f71b8"]
}, Open  ]],
Cell[287716, 7589, 1144, 16, 28, "Input",ExpressionUUID->"77eb66bf-25c7-814f-892e-141a5e72138f"],
Cell[CellGroupData[{
Cell[288885, 7609, 3630, 90, 161, "Input",ExpressionUUID->"d3fbe8a6-1bcf-4c49-aab0-7b7e97bb8801"],
Cell[292518, 7701, 1202, 35, 52, "Output",ExpressionUUID->"d6ce9a1e-4cd2-5542-b529-9213b99720e6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[293757, 7741, 4158, 104, 199, "Input",ExpressionUUID->"d37752d8-fb3d-7247-8f77-660249fd4a56"],
Cell[297918, 7847, 1551, 47, 54, "Output",ExpressionUUID->"42d42ef7-26f8-c04c-8ef7-1a1b4a14750e"]
}, Open  ]],
Cell[299484, 7897, 198, 3, 47, "Input",ExpressionUUID->"29301e91-6e10-8c4f-afc4-c94f23b0efb0"],
Cell[299685, 7902, 178, 3, 47, "Input",ExpressionUUID->"f05d0b3f-6357-3446-a911-25cc90b9a22c"],
Cell[299866, 7907, 258, 7, 47, "Input",ExpressionUUID->"d070ec15-5827-424c-a894-be6eaf80dbd8"],
Cell[CellGroupData[{
Cell[300149, 7918, 8337, 226, 522, "Input",ExpressionUUID->"0d88e268-8e18-e44d-b2d8-cdf7e7401492"],
Cell[308489, 8146, 248, 5, 32, "Output",ExpressionUUID->"5d8d1637-1790-d84b-8c45-427fa9f5f89a"],
Cell[308740, 8153, 251, 5, 32, "Output",ExpressionUUID->"3b94fb6c-6563-db47-9ae1-75ac9172b9e8"],
Cell[308994, 8160, 928, 25, 48, "Output",ExpressionUUID->"087c4fde-4a2d-c241-aa36-e9571c2992a7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[309959, 8190, 761, 11, 104, "Input",ExpressionUUID->"32740707-fdc4-094d-a0d5-67e710750ce0"],
Cell[310723, 8203, 419, 11, 26, "Message",ExpressionUUID->"fb32da6d-2ccc-6546-8db4-9eb0b2a70c51"],
Cell[311145, 8216, 893, 24, 32, "Output",ExpressionUUID->"13f628c2-b0d4-1c49-8294-708100449985"]
}, Open  ]],
Cell[312053, 8243, 559, 10, 85, "Input",ExpressionUUID->"040b9176-9fb1-6c42-b2d6-b57a6d9f6770"],
Cell[312615, 8255, 154, 3, 28, "Input",ExpressionUUID->"415c207e-69ac-8e4e-b60e-cce02daeab93"],
Cell[312772, 8260, 794, 12, 66, "Input",ExpressionUUID->"fa04d5b8-3a30-3845-b5fc-decb17933490"],
Cell[CellGroupData[{
Cell[313591, 8276, 8003, 196, 675, "Input",ExpressionUUID->"a4784151-fd95-5549-b874-48705f8102dd"],
Cell[321597, 8474, 224, 3, 32, "Output",ExpressionUUID->"bf51b92c-4e72-934d-8751-669a5601e7bf"],
Cell[321824, 8479, 4356, 122, 123, "Output",ExpressionUUID->"b333a2d0-b13f-f541-b271-cf5107960c75"]
}, Open  ]],
Cell[326195, 8604, 558, 9, 28, "Input",ExpressionUUID->"52999333-fe05-e84a-acf1-fc22be5bf2ea"],
Cell[326756, 8615, 13061, 320, 1055, "Input",ExpressionUUID->"ad8361d1-9451-6540-9108-f1b045aacd4a"],
Cell[339820, 8937, 152, 3, 28, "Input",ExpressionUUID->"e44d3794-52ef-d540-95ab-731b5a7762cd"],
Cell[339975, 8942, 605, 11, 47, "Input",ExpressionUUID->"28629b7d-e028-5846-af8b-9f2b85a1dc47"],
Cell[340583, 8955, 81, 0, 28, "Input",ExpressionUUID->"dd97dce5-0f5a-5548-85d4-2d3b84c46059"],
Cell[CellGroupData[{
Cell[340689, 8959, 2021, 58, 142, "Input",ExpressionUUID->"ea338578-7420-814a-bae0-ec6916006705"],
Cell[342713, 9019, 298, 7, 46, "Output",ExpressionUUID->"97cbc76e-74c7-d54b-b297-742ca10fc7dc"]
}, Open  ]],
Cell[343026, 9029, 340, 8, 47, "Input",ExpressionUUID->"2fefe0a9-ef4a-b34c-88da-f0fbd0a95d25"],
Cell[343369, 9039, 246, 4, 47, "Input",ExpressionUUID->"50cbb85b-ef5a-214e-b4ad-571c43e9c839"],
Cell[343618, 9045, 152, 3, 28, "Input",ExpressionUUID->"ba9c6190-3889-1544-a4e6-fd4742f29bbf"],
Cell[343773, 9050, 182, 4, 28, "Input",ExpressionUUID->"d3ed06ee-b8ff-294e-b91e-7c9f954290f7"],
Cell[343958, 9056, 1337, 20, 180, "Input",ExpressionUUID->"ddbf74b7-28ae-e646-950d-853adb6de2be"],
Cell[345298, 9078, 128, 3, 28, "Input",ExpressionUUID->"4b97082b-f52c-d940-8b60-cf5f1725bfda"],
Cell[345429, 9083, 585, 9, 47, "Input",ExpressionUUID->"5dd43024-de83-cb41-a7b3-b837d316dc18"],
Cell[346017, 9094, 138, 2, 28, "Input",ExpressionUUID->"dfc70790-c88c-054d-8485-03f8062fbf9d"],
Cell[346158, 9098, 205, 4, 28, "Input",ExpressionUUID->"87f03399-2a49-8741-8bdb-0504f8780838"],
Cell[346366, 9104, 232, 4, 28, "Input",ExpressionUUID->"7f8fbad5-21e7-284d-8454-d537c7ac8fad"],
Cell[346601, 9110, 81, 0, 28, "Input",ExpressionUUID->"22c9a5ff-e8ca-da4a-bea9-0829d17500f1"],
Cell[346685, 9112, 184, 4, 28, "Input",ExpressionUUID->"3f549fa7-3ec6-0845-958c-4197cedab296"],
Cell[346872, 9118, 609, 10, 28, "Input",ExpressionUUID->"6b2be15b-ddfc-2e4b-8670-7e87cade0d44"],
Cell[CellGroupData[{
Cell[347506, 9132, 5366, 139, 370, "Input",ExpressionUUID->"60263157-24c5-8d40-91d8-a0bfe38a098a"],
Cell[352875, 9273, 225, 3, 32, "Output",ExpressionUUID->"2a66e8a6-8a4f-3f43-adc5-e5db2c3ae8e3"],
Cell[353103, 9278, 244, 4, 32, "Output",ExpressionUUID->"bdba59b6-fe4e-894e-bf3d-af7ac59b9eb3"],
Cell[353350, 9284, 224, 3, 32, "Output",ExpressionUUID->"93d5ca5f-c1f9-d34f-8da3-b796ee22dfb7"],
Cell[353577, 9289, 224, 3, 32, "Output",ExpressionUUID->"906020aa-d556-454e-a4d1-58c1381e1938"],
Cell[353804, 9294, 229, 3, 76, "Output",ExpressionUUID->"11eb2e07-f791-b247-bb18-b8115762a9a4"]
}, Open  ]],
Cell[354048, 9300, 11904, 293, 522, "Input",ExpressionUUID->"a30013b0-af0b-3641-a2e1-1eb1f625762d"],
Cell[365955, 9595, 482, 8, 47, "Input",ExpressionUUID->"540827f2-e3ff-e24a-a159-4c33fa9eb206"],
Cell[366440, 9605, 152, 3, 28, "Input",ExpressionUUID->"e93d444f-4bdb-cb44-a85c-59c6d307d81b"],
Cell[366595, 9610, 154, 3, 28, "Input",ExpressionUUID->"6c6f9bb5-a604-ca4c-b028-7d67f6d69e9e"],
Cell[366752, 9615, 81, 0, 28, "Input",ExpressionUUID->"6e1aa942-3024-de42-8538-e83358f2155a"],
Cell[366836, 9617, 218, 5, 66, "Input",ExpressionUUID->"e37bc72f-5857-5947-a697-98458db7a9ed"],
Cell[367057, 9624, 147, 3, 47, "Input",ExpressionUUID->"833b7c30-e8c4-9243-8c0c-bcc486ee4cf1"],
Cell[367207, 9629, 8715, 239, 675, "Input",ExpressionUUID->"a82bb35f-23d4-1148-92be-97a819c647e0"],
Cell[375925, 9870, 387, 7, 47, "Input",ExpressionUUID->"ca8719e8-b838-0c42-afec-188b76645ec7"],
Cell[376315, 9879, 480, 9, 66, "Input",ExpressionUUID->"35543f6f-269e-cc4e-a11e-1fbde1359623"],
Cell[376798, 9890, 6681, 177, 618, "Input",ExpressionUUID->"a56cb576-82c8-7c48-8c63-0ad7fd764497"],
Cell[383482, 10069, 81, 0, 28, "Input",ExpressionUUID->"9061a5ee-35fe-5741-ba37-38de218add33"],
Cell[383566, 10071, 6088, 173, 599, "Input",ExpressionUUID->"ff208aaa-6375-2b49-b93f-5d5062c77685"],
Cell[389657, 10246, 6087, 173, 599, "Input",ExpressionUUID->"d8e75efd-76ab-8a46-9fc3-e125253aba0d"],
Cell[395747, 10421, 196, 3, 47, "Input",ExpressionUUID->"3b72adb7-506f-a242-9ce8-568a43db7148"],
Cell[395946, 10426, 81, 0, 28, "Input",ExpressionUUID->"2c909075-ae9a-1e46-bacf-b4aff58794cf"],
Cell[396030, 10428, 271, 6, 66, "Input",ExpressionUUID->"67d8674f-acfb-3043-9b8d-8ee7033e485e"],
Cell[396304, 10436, 81, 0, 28, "Input",ExpressionUUID->"c5f2b5fd-741a-8049-a956-ffe3b238359b"],
Cell[396388, 10438, 81, 0, 28, "Input",ExpressionUUID->"ab316537-3e7d-3446-8567-ba591898cdf1"],
Cell[396472, 10440, 81, 0, 28, "Input",ExpressionUUID->"997334ee-ab42-4643-8d15-288531846b9e"],
Cell[396556, 10442, 8469, 213, 732, "Input",ExpressionUUID->"4d53601a-fd38-8d4f-a5bd-6776aef1197c"],
Cell[405028, 10657, 550, 10, 66, "Input",ExpressionUUID->"1e372a0a-d04a-0043-8634-a06ae95ac5f2"],
Cell[405581, 10669, 285, 5, 28, "Input",ExpressionUUID->"8620db63-1855-fb4d-8f03-43e480652571"],
Cell[405869, 10676, 516, 8, 66, "Input",ExpressionUUID->"269dff81-a812-9249-a1f5-6e70ad846896"],
Cell[406388, 10686, 81, 0, 28, "Input",ExpressionUUID->"833d72fc-f1ef-2541-b874-706d0c32da9b"],
Cell[406472, 10688, 478, 8, 85, "Input",ExpressionUUID->"bf85dff3-cfcf-194f-8172-c7888df28bf7"],
Cell[406953, 10698, 181, 3, 28, "Input",ExpressionUUID->"1619ea84-a057-f840-b9a9-74fb06551168"],
Cell[407137, 10703, 81, 0, 28, "Input",ExpressionUUID->"bbc937ae-faa9-334f-86a3-c07cb38540d6"],
Cell[407221, 10705, 831, 12, 161, "Input",ExpressionUUID->"398bba21-27f0-ba4f-8d02-b70493bc16d2"]
}
]
*)

