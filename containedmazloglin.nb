(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    191638,       4937]
NotebookOptionsPosition[    184053,       4836]
NotebookOutlinePosition[    184498,       4853]
CellTagsIndexPosition[    184455,       4850]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.9424097710067005`*^9, 3.9424097735303288`*^9}, 
   3.942409986837412*^9, {3.942410224952446*^9, 3.942410250698843*^9}, 
   3.942414205266445*^9, 3.9424171668779297`*^9, 3.942419692092272*^9, 
   3.9424204177254696`*^9, 3.9424204789909916`*^9, {3.942420720045725*^9, 
   3.942420728957245*^9}, {3.9424208281063786`*^9, 3.9424208471915607`*^9}, {
   3.942420880106722*^9, 3.942420886782583*^9}, 3.9424222361942863`*^9, {
   3.942423052980547*^9, 3.9424230739505024`*^9}, 3.942423164222044*^9, 
   3.9424232036387615`*^9, {3.9424232833174133`*^9, 3.942423307845436*^9}, {
   3.942423342657379*^9, 3.942423370843012*^9}, {3.9424235561691933`*^9, 
   3.942423573217308*^9}, 3.9424237825038567`*^9, 3.942423914171425*^9, 
   3.94248768227162*^9, 3.942502868082756*^9, 3.942503100647709*^9, 
   3.942503140525156*^9, 3.9425046010225945`*^9, {3.9425052399102135`*^9, 
   3.9425052421572056`*^9}, {3.9425064032796345`*^9, 3.9425064272894344`*^9}, 
   3.94250658942535*^9, 3.9425067828417664`*^9, 3.942506854326124*^9, {
   3.9425079465509777`*^9, 3.94250799672328*^9}, 3.9425081754514484`*^9, 
   3.942510581203039*^9, {3.942511009251314*^9, 3.942511017852148*^9}, {
   3.942511221733576*^9, 3.9425112586265945`*^9}, 3.9425117108579197`*^9, 
   3.9425117602628727`*^9, {3.942511856447809*^9, 3.9425119345891457`*^9}, 
   3.9425122263945293`*^9, {3.942512955427664*^9, 3.9425129698917313`*^9}, {
   3.94251301365139*^9, 3.9425130307669353`*^9}, {3.942513108585476*^9, 
   3.942513112112303*^9}, {3.9425135466473694`*^9, 3.942513556385315*^9}, {
   3.942513868974186*^9, 3.942513921787203*^9}, {3.9425139580605755`*^9, 
   3.9425139700600357`*^9}, 3.9425140419308376`*^9, {3.942514134970972*^9, 
   3.9425141648856773`*^9}, {3.9425141998729115`*^9, 
   3.9425142444404106`*^9}, {3.9425142927988625`*^9, 3.942514303916441*^9}, {
   3.9425148598096733`*^9, 3.9425148712374344`*^9}, {3.942514910480751*^9, 
   3.942514917020756*^9}, {3.942514973867367*^9, 3.9425150148147144`*^9}, 
   3.9425161769270763`*^9, 3.9425162112263985`*^9, {3.9425166428949184`*^9, 
   3.942516672205147*^9}, {3.942517042567255*^9, 3.9425170621009064`*^9}, {
   3.9425171674338245`*^9, 3.9425171874190807`*^9}, 3.942517223580761*^9, 
   3.9425173582750072`*^9, 3.942517406842678*^9, {3.9425176475276356`*^9, 
   3.942517664750183*^9}, {3.942517718150387*^9, 3.942517744371004*^9}, {
   3.9425178154654617`*^9, 3.942517834731922*^9}, 3.942517913433714*^9, 
   3.942518014903372*^9, {3.9425881118939304`*^9, 3.942588226554573*^9}, {
   3.9425896390154*^9, 3.942589660098751*^9}, {3.9425905522714367`*^9, 
   3.942590594677908*^9}, {3.9425911684561577`*^9, 3.9425911698701305`*^9}, 
   3.942751573759756*^9, 3.942751621808159*^9, 3.9427516680874004`*^9, {
   3.9427517329189034`*^9, 3.9427517351424484`*^9}, {3.9427519255838013`*^9, 
   3.9427519869494553`*^9}, 3.9427520332742233`*^9, 3.942752333177307*^9, {
   3.942752770986908*^9, 3.9427527730965176`*^9}, {3.94275302368054*^9, 
   3.942753025683384*^9}, {3.9428474340546665`*^9, 3.9428474362622166`*^9}, {
   3.9428483214733906`*^9, 3.942848362170891*^9}, 3.9428484049196663`*^9, 
   3.942848454450346*^9, {3.9428490839405823`*^9, 3.942849160084255*^9}, {
   3.942849213918829*^9, 3.942849287185663*^9}, {3.9428493507735596`*^9, 
   3.942849353695465*^9}, 3.9428493846297016`*^9, {3.942850052822735*^9, 
   3.9428500750204296`*^9}, {3.9428501420583496`*^9, 
   3.9428501459492645`*^9}, {3.9428503972435436`*^9, 
   3.9428504100488663`*^9}, {3.942853049260662*^9, 3.9428530504676895`*^9}, {
   3.942853092458111*^9, 3.9428531192472134`*^9}, {3.942853353568598*^9, 
   3.9428533545898075`*^9}, {3.9428533987449627`*^9, 
   3.9428534229557915`*^9}, {3.9429231648091373`*^9, 3.942923166138708*^9}, {
   3.9429246809890385`*^9, 3.942924683690712*^9}, {3.9429247321913033`*^9, 
   3.942924732889475*^9}, {3.9429254250561047`*^9, 3.9429254513153687`*^9}, 
   3.9429254838702602`*^9, {3.9429255434986267`*^9, 3.942925560423479*^9}, {
   3.942925616054928*^9, 3.942925642339443*^9}, {3.9429261874701004`*^9, 
   3.9429262104446373`*^9}, {3.942926484765465*^9, 3.942926497715992*^9}, {
   3.94292658112232*^9, 3.9429265839319725`*^9}, {3.9429267900613174`*^9, 
   3.9429267947414474`*^9}, 3.9429268487589626`*^9, {3.94293422696509*^9, 
   3.9429342288360386`*^9}, {3.9429343606643944`*^9, 
   3.9429343661244335`*^9}, {3.942934751577406*^9, 3.9429347571734104`*^9}, {
   3.9429348102113075`*^9, 3.942934825030098*^9}, 3.9429349712800045`*^9, {
   3.942935395628916*^9, 3.9429354119468803`*^9}, {3.942935638691334*^9, 
   3.9429356840764217`*^9}, 3.9429360778661404`*^9, {3.9429361132493095`*^9, 
   3.9429361676882057`*^9}, {3.942936520458252*^9, 3.942936526243181*^9}, {
   3.9429461492206955`*^9, 3.9429461723246975`*^9}, {3.943008575399826*^9, 
   3.943008584860981*^9}, {3.943012952041334*^9, 3.9430129533912315`*^9}, {
   3.9430272878138313`*^9, 3.9430272905139027`*^9}, 3.943106855318901*^9, {
   3.943373167306566*^9, 
   3.943373172855282*^9}},ExpressionUUID->"f9fb2cec-0218-1946-a7a4-\
614cfc63c79f"],

Cell[BoxData[""], "Input",ExpressionUUID->"93063096-b854-5642-83fe-da57c1f294a1"],

Cell[BoxData[""], "Input",ExpressionUUID->"0708fca9-59ce-8847-af89-18fc69779938"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"patient", " ", "households", " ", "Lagrange"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "Parameters", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"params", "=", 
    RowBox[{"{", 
     RowBox[{
     "betaP", ",", "alpha", ",", "xiP", ",", "epsilonP", ",", "phi", ",", 
      "qh", ",", 
      RowBox[{"wt", "[", "t", "]"}], ",", 
      RowBox[{"rt", "[", "t", "]"}], ",", 
      RowBox[{"pit", "[", "t", "]"}], ",", 
      RowBox[{"cp", "[", "t", "]"}], ",", 
      RowBox[{"dp", "[", "t", "]"}], ",", 
      RowBox[{"hp", "[", "t", "]"}], ",", 
      RowBox[{"lambdaP", "[", "t", "]"}]}], "}"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Utility", " ", "function", " ", "for", " ", "patient", " ", 
    "households"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uPatient", "[", 
     RowBox[{"cp_", ",", "cpLag_", ",", "hp_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "alpha"}], ")"}], " ", "xiP", " ", 
      RowBox[{"Log", "[", 
       RowBox[{"cp", "-", 
        RowBox[{"a", " ", "cpLag"}]}], "]"}]}], "+", 
     RowBox[{"epsilonP", " ", 
      RowBox[{"Log", "[", "hp", "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"hp", "^", 
        RowBox[{"(", 
         RowBox[{"1", "+", "phi"}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", "phi"}], ")"}]}]}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Budget", " ", "constraint", " ", "for", " ", "patient", " ", "households",
     " ", "in", " ", "period", " ", "t"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BCPatient", "[", "t_", "]"}], ":=", 
    RowBox[{
     RowBox[{"cp", "[", "t", "]"}], "+", 
     RowBox[{"qh", " ", 
      RowBox[{"hp", "[", "t", "]"}]}], "+", 
     RowBox[{"dp", "[", "t", "]"}], "-", 
     RowBox[{
      RowBox[{"wt", "[", "t", "]"}], " ", 
      RowBox[{"hp", "[", "t", "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"rt", "[", 
           RowBox[{"t", "-", "1"}], "]"}]}], ")"}], "/", 
        RowBox[{"pit", "[", "t", "]"}]}], ")"}], " ", 
      RowBox[{"dp", "[", 
       RowBox[{"t", "-", "1"}], "]"}]}]}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Define", " ", "Lagrangian", " ", "for", " ", "two", " ", "periods", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"t", " ", "and", " ", "t"}], "+", "1"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LP", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"uPatient", "[", 
        RowBox[{
         RowBox[{"cp", "[", "t", "]"}], ",", 
         RowBox[{"cp", "[", 
          RowBox[{"t", "-", "1"}], "]"}], ",", 
         RowBox[{"hp", "[", "t", "]"}]}], "]"}], "+", 
       RowBox[{
        RowBox[{"lambdaP", "[", "t", "]"}], "*", 
        RowBox[{"BCPatient", "[", "t", "]"}]}]}], ")"}], "+", 
     RowBox[{
      RowBox[{"betaP", "^", 
       RowBox[{"(", 
        RowBox[{"t", "+", "1"}], ")"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"uPatient", "[", 
         RowBox[{
          RowBox[{"cp", "[", 
           RowBox[{"t", "+", "1"}], "]"}], ",", 
          RowBox[{"cp", "[", "t", "]"}], ",", 
          RowBox[{"hp", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{"lambdaP", "[", 
          RowBox[{"t", "+", "1"}], "]"}], "*", 
         RowBox[{"BCPatient", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}]}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"First", "-", 
    RowBox[{
    "order", " ", "conditions", " ", "for", " ", "patient", " ", 
     "households"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"focPCt", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"LP", ",", 
       RowBox[{"cp", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], 
  "        ", 
  RowBox[{"(*", 
   RowBox[{"FOC", " ", "with", " ", "respect", " ", "to", " ", 
    RowBox[{"cp", "[", "t", "]"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"focPHt", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"LP", ",", 
       RowBox[{"hp", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], 
  "        ", 
  RowBox[{"(*", 
   RowBox[{"FOC", " ", "with", " ", "respect", " ", "to", " ", 
    RowBox[{"hp", "[", "t", "]"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"focPdP", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"LP", ",", 
       RowBox[{"dp", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], 
  "        ", 
  RowBox[{"(*", 
   RowBox[{"FOC", " ", "with", " ", "respect", " ", "to", " ", 
    RowBox[{"dp", "[", "t", "]"}]}], "*)"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Debug", " ", "the", " ", "FOCs", " ", "before", " ", "solving"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"debugFOCs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<FOC wrt cp[t]\>\"", "->", "focPCt"}], ",", 
     RowBox[{"\"\<FOC wrt hp[t]\>\"", "->", "focPHt"}], ",", 
     RowBox[{"\"\<FOC wrt dp[t]\>\"", "->", "focPdP"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", "debugFOCs", "\n"}], "Input",
 CellChangeTimes->{{3.942591478649725*^9, 3.942591478649725*^9}, 
   3.9425915249837914`*^9, {3.942591893611925*^9, 3.9425919125734234`*^9}, 
   3.9425920148237686`*^9, {3.9431068767277374`*^9, 3.9431068801445446`*^9}, {
   3.943373150584465*^9, 3.943373154683838*^9}, 3.943530733499941*^9, {
   3.9435311122916813`*^9, 3.9435311485272903`*^9}, {3.9436169128066196`*^9, 
   3.943616924451643*^9}, {3.943617362437744*^9, 3.943617382325964*^9}, {
   3.9436179521460266`*^9, 3.943617955790903*^9}, {3.9453529856666317`*^9, 
   3.9453530067840347`*^9}, {3.945361819427248*^9, 3.9453618221393833`*^9}, {
   3.9466612675401*^9, 3.9466612786488857`*^9}, {3.9466613158820724`*^9, 
   3.94666132181089*^9}, 3.9471762973235054`*^9, {3.94717643434391*^9, 
   3.9471764402908535`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"9ace75de-4978-4347-8abf-940e21a736de"],

Cell[CellGroupData[{

Cell[BoxData[""], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.9453530115724983`*^9, {3.9453567033453445`*^9, 3.945356704812771*^9}, {
   3.9453567451134853`*^9, 3.945356790620058*^9}, 3.945361873726124*^9, 
   3.945444393223093*^9, 3.9466611651340885`*^9, 3.9466612297905045`*^9, 
   3.946661287221405*^9, 3.9466613275977764`*^9, 3.9471763760931816`*^9, {
   3.947176416060137*^9, 
   3.9471764208432503`*^9}},ExpressionUUID->"3180c1ab-5e0d-ca40-9394-\
5e86f56408d7"],

Cell[BoxData[""], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.9453530115724983`*^9, {3.9453567033453445`*^9, 3.945356704812771*^9}, {
   3.9453567451134853`*^9, 3.945356790620058*^9}, 3.945361873726124*^9, 
   3.945444393223093*^9, 3.9466611651340885`*^9, 3.9466612297905045`*^9, 
   3.946661287221405*^9, 
   3.947176360899105*^9},ExpressionUUID->"cba57453-8210-be49-9e99-\
e7c7a95b445f"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Define", " ", "the", " ", "equation"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"eq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"epsilonP", "/", 
         RowBox[{"hp", "[", "t", "]"}]}], ")"}], "-", 
       RowBox[{
        RowBox[{"hp", "[", "t", "]"}], "^", "phi"}], "+", 
       RowBox[{
        RowBox[{"lambdaP", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"qh", "-", 
          RowBox[{"wt", "[", "t", "]"}]}], ")"}]}]}], "==", "0"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Solve", " ", "for", " ", 
     RowBox[{"lambdaP", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{"lambdaSolution", "=", 
    RowBox[{"Solve", "[", 
     RowBox[{"eq", ",", 
      RowBox[{"lambdaP", "[", "t", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{"Output", " ", "the", " ", "solution"}], "*)"}], 
   "\[IndentingNewLine]", "lambdaSolution", "\[IndentingNewLine]", 
   "\n"}]}]], "Input",
 CellChangeTimes->{{3.9471770066521263`*^9, 3.947177006654125*^9}, {
   3.9471771841496162`*^9, 3.9471772197199135`*^9}, {3.947177358902153*^9, 
   3.947177397399147*^9}, 3.947177812835148*^9},
 CellLabel->"In[89]:=",ExpressionUUID->"6cbdf14f-fcad-b24a-9b64-6f911cd48fed"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", "\n"}]], "Input",
 CellChangeTimes->{{3.9471770066521263`*^9, 3.947177006654125*^9}, {
   3.9471771841496162`*^9, 3.9471772197199135`*^9}, {3.947177358902153*^9, 
   3.947177397399147*^9}, 
   3.947177812835148*^9},ExpressionUUID->"4978f1f1-0572-b84b-b184-\
a61a2eb98030"],

Cell[CellGroupData[{

Cell[BoxData[""], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.9453530115724983`*^9, {3.9453567033453445`*^9, 3.945356704812771*^9}, {
   3.9453567451134853`*^9, 3.945356790620058*^9}, 3.945361873726124*^9, 
   3.945444393223093*^9, 3.9466611651340885`*^9, 3.9466612297905045`*^9, 
   3.947176336343334*^9},ExpressionUUID->"3b40c5c1-cbf0-244a-912a-\
65c58f9ab2e4"],

Cell[BoxData[""], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.9453530115724983`*^9, {3.9453567033453445`*^9, 3.945356704812771*^9}, {
   3.9453567451134853`*^9, 3.945356790620058*^9}, 3.945361873726124*^9, 
   3.945444393223093*^9, 
   3.9466611651340885`*^9},ExpressionUUID->"3dd3e17b-7b29-3d40-970d-\
7f04b4476b62"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Define", " ", "the", " ", "equations"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"eq1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "alpha"}], ")"}], " ", "xiP"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "a"}], " ", 
           RowBox[{"cp", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
          RowBox[{"cp", "[", "t", "]"}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "alpha"}], ")"}], " ", 
          RowBox[{"betaP", "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "t"}], ")"}]}], " ", "xiP"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "a"}], " ", 
           RowBox[{"cp", "[", "t", "]"}]}], "+", 
          RowBox[{"cp", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
       RowBox[{"lambdaP", "[", "t", "]"}]}], "==", "0"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"eq2", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"lambdaP", "[", "t", "]"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"betaP", "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "t"}], ")"}]}], " ", 
          RowBox[{"lambdaP", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"rt", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
        RowBox[{"pit", "[", 
         RowBox[{"1", "+", "t"}], "]"}]}]}], "==", "0"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Define", " ", "substitution", " ", "rules", " ", "for", " ", 
     RowBox[{"lambda", "[", "t", "]"}], " ", "and", " ", 
     RowBox[{"lambda", "[", 
      RowBox[{"t", "+", "1"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lambdaRule", "=", 
     RowBox[{
      RowBox[{"lambdaP", "[", "t", "]"}], "->", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "epsilonP"}], "+", 
         RowBox[{
          RowBox[{"hp", "[", "t", "]"}], "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"hp", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"qh", "-", 
           RowBox[{"wt", "[", "t", "]"}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"lambdaFutureRule", "=", 
     RowBox[{
      RowBox[{"lambdaP", "[", 
       RowBox[{"t", "+", "1"}], "]"}], "->", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "epsilonP"}], "+", 
         RowBox[{
          RowBox[{"hp", "[", 
           RowBox[{"t", "+", "1"}], "]"}], "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"hp", "[", 
          RowBox[{"t", "+", "1"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"qh", "-", 
           RowBox[{"wt", "[", 
            RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Substitute", " ", "the", " ", "lambda", " ", "expressions", " ", "into", 
     " ", "the", " ", "equations"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq1Substituted", "=", 
     RowBox[{"eq1", "/.", " ", "lambdaRule"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"eq2Substituted", "=", 
     RowBox[{"eq2", "/.", " ", 
      RowBox[{"{", 
       RowBox[{"lambdaRule", ",", "lambdaFutureRule"}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Simplify", " ", "the", " ", "resulting", " ", "equations"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq1Simplified", "=", 
     RowBox[{"Simplify", "[", "eq1Substituted", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"eq2Simplified", "=", 
     RowBox[{"Simplify", "[", "eq2Substituted", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Output", " ", "the", " ", "final", " ", "equations"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"eq1Simplified", ",", "eq2Simplified"}], "}"}], "\n"}]}]], "Input",
 CellChangeTimes->{3.9471778347934628`*^9},
 CellLabel->"In[70]:=",ExpressionUUID->"aec07186-9953-eb4b-a898-e758c5d4aabf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "alpha"}], ")"}], " ", "xiP"}], 
       RowBox[{
        RowBox[{"a", " ", 
         RowBox[{"cp", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "-", 
        RowBox[{"cp", "[", "t", "]"}]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "epsilonP"}], "+", 
        SuperscriptBox[
         RowBox[{"hp", "[", "t", "]"}], 
         RowBox[{"1", "+", "phi"}]]}], 
       RowBox[{
        RowBox[{"hp", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"qh", "-", 
          RowBox[{"wt", "[", "t", "]"}]}], ")"}]}]]}], "\[Equal]", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "alpha"}], ")"}], " ", 
       SuperscriptBox["betaP", 
        RowBox[{"1", "+", "t"}]], " ", "xiP"}], 
      RowBox[{
       RowBox[{"a", " ", 
        RowBox[{"cp", "[", "t", "]"}]}], "-", 
       RowBox[{"cp", "[", 
        RowBox[{"1", "+", "t"}], "]"}]}]]}], ",", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"-", "epsilonP"}], "+", 
        SuperscriptBox[
         RowBox[{"hp", "[", "t", "]"}], 
         RowBox[{"1", "+", "phi"}]]}], 
       RowBox[{
        RowBox[{"hp", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"qh", "-", 
          RowBox[{"wt", "[", "t", "]"}]}], ")"}]}]], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["betaP", 
         RowBox[{"1", "+", "t"}]], " ", 
        RowBox[{"(", 
         RowBox[{"epsilonP", "-", 
          SuperscriptBox[
           RowBox[{"hp", "[", 
            RowBox[{"1", "+", "t"}], "]"}], 
           RowBox[{"1", "+", "phi"}]]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"rt", "[", "t", "]"}]}], ")"}]}], 
       RowBox[{
        RowBox[{"hp", "[", 
         RowBox[{"1", "+", "t"}], "]"}], " ", 
        RowBox[{"pit", "[", 
         RowBox[{"1", "+", "t"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"qh", "-", 
          RowBox[{"wt", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}]]}], "\[Equal]", "0"}]}], 
   "}"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"1", ")"}], " ", "Clear", " ", "and", " ", "declare", " ", "all", 
    " ", "variables", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "so", " ", "they", " ", "are", " ", "treated", " ", "purely", " ", "as",
        " ", "symbols"}], ")"}], "."}]}], "*)"}], 
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"cp1", ",", "cpt", ",", "cp2", ",", "hp", ",", "w"}], "]"}], 
   ";"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "alpha", ",", "xiP", ",", "a", ",", "cpBar", ",", "hpBar", ",", "wBar", 
     ",", "qh", ",", "epsilonP", ",", "betaP", ",", "phi", ",", "t"}], "]"}], 
   ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"Optionally", ",", 
    RowBox[{
     RowBox[{"load", " ", "them", " ", "as", " ", 
      RowBox[{"symbols", ":", 
       RowBox[{"Symbol", "/@", 
        RowBox[{"{", 
         RowBox[{
         "\"\<cp1\>\"", ",", "\"\<cpt\>\"", ",", "\"\<cp2\>\"", ",", 
          "\"\<hp\>\"", ",", "\"\<w\>\"", ",", "\"\<alpha\>\"", ",", 
          "\"\<xiP\>\"", ",", "\"\<a\>\"", ",", "\"\<cpBar\>\"", ",", 
          "\"\<hpBar\>\"", ",", "\"\<wBar\>\"", ",", "\"\<qh\>\"", ",", 
          "\"\<epsilonP\>\"", ",", "\"\<betaP\>\"", ",", "\"\<phi\>\"", ",", 
          "\"\<t\>\""}], "}"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"But", " ", 
      RowBox[{"simply", "'"}], 
      RowBox[{"ClearAll", "'"}], " ", "is", " ", "typically", " ", 
      RowBox[{"enough", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"2", ")"}], " ", "Define", " ", "the", " ", "original", " ", 
     "equation", " ", "as", " ", "F", 
     RowBox[{"(", "...", ")"}]}], "==", "0."}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{"cp1_", ",", "cpt_", ",", "cp2_", ",", "hp_", ",", "w_"}], "]"}],
     ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "alpha"}], ")"}], " ", "xiP"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", " ", "cp1"}], "-", "cpt"}], ")"}]}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "epsilonP"}], "+", 
         RowBox[{"hp", "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"hp", " ", 
         RowBox[{"(", 
          RowBox[{"qh", "-", "w"}], ")"}]}], ")"}]}], ")"}], "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "alpha"}], ")"}], " ", 
         RowBox[{"betaP", "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "t"}], ")"}]}], " ", "xiP"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", "cpt"}], "-", "cp2"}], ")"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"3", ")"}], " ", "Collect", " ", "the", " ", "variables", " ", 
    RowBox[{"we", "'"}], "ll", " ", "differentiate", " ", "with", " ", 
    "respect", " ", 
    RowBox[{"to", "."}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"vars", "=", 
    RowBox[{"{", 
     RowBox[{"cp1", ",", "cpt", ",", "cp2", ",", "hp", ",", "w"}], "}"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"4", ")"}], " ", "Compute", " ", "partial", " ", "derivatives", 
     " ", "of", " ", "F", " ", "at", " ", "the", " ", "steady", " ", 
     RowBox[{"state", ".", "The"}], " ", "replacement", " ", "forces", " ", 
     "each", " ", "variable", " ", "to", " ", "be", " ", "its", " ", 
     "steady"}], "\[Hyphen]", 
    RowBox[{"state", " ", "value", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"cpBar", ",", "hpBar", ",", 
        RowBox[{"etc", "."}]}], ")"}], "."}]}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"partials", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"F", "@@", "vars"}], ",", 
         RowBox[{"vars", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cp1", "->", "cpBar"}], ",", 
         RowBox[{"cpt", "->", "cpBar"}], ",", 
         RowBox[{"cp2", "->", "cpBar"}], ",", 
         RowBox[{"hp", "->", "hpBar"}], ",", 
         RowBox[{"w", "->", "wBar"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"5", ")"}], " ", "Define", " ", "symbols", " ", "for", " ", 
     "log"}], "\[Hyphen]", 
    RowBox[{"deviations", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d", " ", "ln", " ", "X"}], ")"}], "."}]}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"cHat1", ",", "cHatT", ",", "cHat2", ",", "hHat", ",", "wHat"}], 
    "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"6", ")"}], " ", "Multiply", " ", "each", " ", "partial", " ", 
     "by", " ", "XBar", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"hat", " ", "variable"}], ")"}], ".", "This"}], " ", "yields", 
     " ", "the", " ", "linearized", " ", "equation", " ", "F"}], "=", 
    RowBox[{"0", " ", "in", " ", "terms", " ", "of", " ", 
     RowBox[{"hats", "."}]}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"varsBar", "=", 
   RowBox[{"{", 
    RowBox[{"cpBar", ",", "cpBar", ",", "cpBar", ",", "hpBar", ",", "wBar"}], 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEq", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", "cpBar", "*", "cHat1"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", "cpBar", "*", "cHatT"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "*", "cpBar", "*", "cHat2"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "*", "hpBar", "*", "hHat"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "*", "wBar", "*", "wHat"}]}], "==", 
     "0"}]}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"7", ")"}], " ", "Simplify", " ", "the", " ", "final", " ", 
    "linear", " ", 
    RowBox[{"equation", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "logLinEq", "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9472605060053177`*^9, 3.9472605107869415`*^9}, {
   3.9472605593338985`*^9, 3.947260564568186*^9}, {3.9472627523949776`*^9, 
   3.9472627563084297`*^9}, 3.947263042091564*^9},
 CellLabel->"In[26]:=",ExpressionUUID->"dc40e394-a162-e344-af1c-469b5ff19c55"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9472605060053177`*^9, 3.9472605107869415`*^9}, {
   3.9472605593338985`*^9, 3.947260564568186*^9}, {3.9472627523949776`*^9, 
   3.9472627563084297`*^9}, 3.947263042091564*^9, {3.9472639555408535`*^9, 
   3.9472639825124454`*^9}},ExpressionUUID->"5a156fc5-2eb4-7e48-b51d-\
4ec8fa2678b1"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.9472605060053177`*^9, 3.9472605107869415`*^9}, {
   3.9472605593338985`*^9, 3.947260564568186*^9}, {3.9472627523949776`*^9, 
   3.9472627563084297`*^9}, 3.947263042091564*^9, {3.9472639555408535`*^9, 
   3.9472639825124454`*^9}, 3.9472650860728855`*^9, 
   3.947326695474926*^9},ExpressionUUID->"f6161ecb-49e3-0c4a-ab4f-\
763494e1bca1"],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9472605060053177`*^9, 3.9472605107869415`*^9}, {
   3.9472605593338985`*^9, 3.947260564568186*^9}, {3.9472627523949776`*^9, 
   3.9472627563084297`*^9}, 3.947263042091564*^9, {3.9472639555408535`*^9, 
   3.9472639825124454`*^9}, 3.9472650860728855`*^9, 
   3.947326695474926*^9},ExpressionUUID->"184313ad-6fee-e246-a53e-\
3bc49837b331"],

Cell[BoxData[""], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.9453530115724983`*^9, {3.9453567033453445`*^9, 3.945356704812771*^9}, {
   3.9453567451134853`*^9, 3.945356790620058*^9}, 3.945361873726124*^9, 
   3.946661150942011*^9},ExpressionUUID->"bd798fe7-18dc-194b-9c9c-\
5302cebc1728"]
}, Open  ]],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{3.947257404036455*^9, 3.947258203517639*^9, 
  3.947265307673126*^9},ExpressionUUID->"3224bd35-aa5b-8741-8dba-\
9ef0919b61c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "1.", " ", "Clear", " ", "and", " ", "declare", " ", "all", " ", 
    "variables"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "hp", ",", "wt", ",", "rt", ",", "pit", ",", "betaP", ",", "epsilonP", 
      ",", "phi", ",", "qh", ",", "t"}], "]"}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "2.", " ", "Define", " ", "the", " ", "original", " ", "equation", " ", 
      "as", " ", "F", 
      RowBox[{"(", "...", ")"}]}], "==", "0"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{"hp_", ",", "wt_", ",", "rt_", ",", "pit_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "epsilonP"}], "+", 
         RowBox[{"hp", "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"hp", " ", 
         RowBox[{"(", 
          RowBox[{"qh", "-", "wt"}], ")"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"betaP", "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "t"}], ")"}]}], " ", 
         RowBox[{"(", 
          RowBox[{"epsilonP", "-", 
           RowBox[{"hp", "^", 
            RowBox[{"(", 
             RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "rt"}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"hp", " ", "pit", " ", 
         RowBox[{"(", 
          RowBox[{"qh", "-", "wt"}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "Collect", " ", "the", " ", "variables", " ", "to", " ", 
     "differentiate", " ", "with", " ", "respect", " ", "to"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{"hp", ",", "wt", ",", "rt", ",", "pit"}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "4.", " ", "Compute", " ", "partial", " ", "derivatives", " ", "of", " ", 
     "F", " ", "at", " ", "the", " ", "steady", " ", "state"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"hp", "->", "hpBar"}], ",", 
          RowBox[{"wt", "->", "wBar"}], ",", 
          RowBox[{"rt", "->", "rBar"}], ",", 
          RowBox[{"pit", "->", "piBar"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"5.", " ", "Define", " ", "symbols", " ", "for", " ", "log"}], 
     "-", 
     RowBox[{"deviations", " ", 
      RowBox[{"(", 
       RowBox[{"d", " ", "ln", " ", "X"}], ")"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"hHat", ",", "wHat", ",", "rHat", ",", "piHat"}], "]"}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "6.", " ", "Multiply", " ", "each", " ", "partial", " ", "by", " ", 
     "XBar", "*", 
     RowBox[{"(", 
      RowBox[{"hat", " ", "variable"}], ")"}], " ", "to", " ", "get", " ", 
     "the", " ", "linearized", " ", "equation"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varsBar", "=", 
     RowBox[{"{", 
      RowBox[{"hpBar", ",", "wBar", ",", "rBar", ",", "piBar"}], "}"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", "hpBar", "*", "hHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", "wBar", "*", "wHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", "rBar", "*", "rHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "*", "piBar", "*", "piHat"}]}], "==",
       "0"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "7.", " ", "Simplify", " ", "the", " ", "final", " ", "linear", " ", 
     "equation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", "logLinEq", "]"}], "\[IndentingNewLine]", "\n", 
   "\n"}]}]], "Input",
 CellChangeTimes->{
  3.9473267272722797`*^9, {3.9473274212074623`*^9, 3.94732742323135*^9}, 
   3.947329610365181*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"a990b75f-fbd3-234f-adb3-956cce978ab4"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{3.9472448376130657`*^9, 3.9472448866663303`*^9, 
  3.9472556062269306`*^9, 
  3.9472571520177994`*^9},ExpressionUUID->"47471645-8bf1-b64e-971f-\
adb6528fec4a"],

Cell[BoxData[""], "Input",ExpressionUUID->"69f768ce-3b26-b640-b21c-b0339f219c5e"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.947342097073511*^9},
 CellLabel->"",ExpressionUUID->"9e0d05d0-5fdf-944e-97f6-884be9bc4fd5"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.947265153472746*^9},
 CellLabel->"",ExpressionUUID->"1d5db560-18c8-3845-bae1-e95058242b47"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"unpatceint", " ", "households"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.943616429544197*^9, 
  3.943616484662098*^9}},ExpressionUUID->"483b27fc-4b8e-9c46-8db4-\
040fdf9ca070"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", 
   RowBox[{
   "Parameters", " ", "and", " ", "Variables", " ", "for", " ", "Impatient", 
    " ", "Households"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"{", 
      RowBox[{
      "betaI", ",", "aD", ",", "phi", ",", "eps_ct", ",", "eps_ht", ",", 
       RowBox[{"cIt", "[", "t", "]"}], ",", 
       RowBox[{"cItLag", "[", "t", "]"}], ",", 
       RowBox[{"hIt", "[", "t", "]"}], ",", 
       RowBox[{"lIt", "[", "t", "]"}], ",", 
       RowBox[{"lItLag", "[", "t", "]"}], ",", 
       RowBox[{"bIt", "[", "t", "]"}], ",", 
       RowBox[{"bItLag", "[", "t", "]"}], ",", 
       RowBox[{"rBH", "[", "t", "]"}], ",", 
       RowBox[{"rBH", "[", "tLag", "]"}], ",", 
       RowBox[{"wIt", "[", "t", "]"}], ",", 
       RowBox[{"qt", "[", "t", "]"}], ",", 
       RowBox[{"pit", "[", "t", "]"}], ",", 
       RowBox[{"mLt", "[", "t", "]"}], ",", 
       RowBox[{"hItLag", "[", "t", "]"}]}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Utility", " ", "function", " ", "for", " ", "impatient", " ", 
     "households"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uImpatient", "[", 
      RowBox[{"cIt_", ",", "cItLag_", ",", "hIt_", ",", "lIt_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "aD"}], ")"}], " ", "eps_ct", " ", 
       RowBox[{"Log", "[", "cIt", "]"}]}], "-", 
      RowBox[{"aD", " ", 
       RowBox[{"Log", "[", "cItLag", "]"}]}], "+", 
      RowBox[{"eps_ht", " ", 
       RowBox[{"Log", "[", "hIt", "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"lIt", "^", 
         RowBox[{"(", 
          RowBox[{"1", "+", "phi"}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", "phi"}], ")"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Budget", " ", "constraint", " ", "for", " ", "impatient", " ", 
     "households", " ", "in", " ", "period", " ", "t"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BCImpatient", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"cIt", "[", "t", "]"}], "+", 
      RowBox[{
       RowBox[{"qt", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"hIt", "[", "t", "]"}], "-", 
         RowBox[{"hIt", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"rBH", "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ")"}], "/", 
         RowBox[{"pit", "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"bIt", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"wIt", "[", "t", "]"}], " ", 
       RowBox[{"lIt", "[", "t", "]"}]}], "-", 
      RowBox[{"bIt", "[", "t", "]"}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Borrowing", " ", "constraint", " ", "for", " ", "impatient", " ", 
     "households", " ", "in", " ", "period", " ", "t"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BorrowingConstraint", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"rBH", "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"bIt", "[", "t", "]"}]}], "-", 
      RowBox[{
       RowBox[{"mLt", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"qt", "[", 
          RowBox[{"t", "+", "1"}], "]"}], " ", 
         RowBox[{"hIt", "[", "t", "]"}], " ", 
         RowBox[{"pit", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", "Lagrangian", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LI", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"uImpatient", "[", 
         RowBox[{
          RowBox[{"cIt", "[", "t", "]"}], ",", 
          RowBox[{"cIt", "[", 
           RowBox[{"t", "-", "1"}], "]"}], ",", 
          RowBox[{"hIt", "[", "t", "]"}], ",", 
          RowBox[{"lIt", "[", "t", "]"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{"lambdaI", "[", "t", "]"}], " ", 
         RowBox[{"BCImpatient", "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"muI", "[", "t", "]"}], " ", 
         RowBox[{"BorrowingConstraint", "[", "t", "]"}]}]}], ")"}], "+", 
      RowBox[{
       RowBox[{"betaI", "^", 
        RowBox[{"(", 
         RowBox[{"t", "+", "1"}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"uImpatient", "[", 
          RowBox[{
           RowBox[{"cIt", "[", 
            RowBox[{"t", "+", "1"}], "]"}], ",", 
           RowBox[{"cIt", "[", "t", "]"}], ",", 
           RowBox[{"hIt", "[", 
            RowBox[{"t", "+", "1"}], "]"}], ",", 
           RowBox[{"lIt", "[", 
            RowBox[{"t", "+", "1"}], "]"}]}], "]"}], "+", 
         RowBox[{
          RowBox[{"lambdaI", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"BCImpatient", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"muI", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"BorrowingConstraint", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"First", "-", 
     RowBox[{
     "order", " ", "conditions", " ", "for", " ", "impatient", " ", 
      "households"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focCtI", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LI", ",", 
        RowBox[{"cIt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "consumption", " ", 
     RowBox[{"cIt", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focHtI", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LI", ",", 
        RowBox[{"hIt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "housing", " ", 
     RowBox[{"hIt", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focLtI", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LI", ",", 
        RowBox[{"lIt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "hours", " ", "worked", " ", 
     RowBox[{"lIt", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focBtI", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LI", ",", 
        RowBox[{"bIt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "borrowing", " ", 
     RowBox[{"bIt", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Display", " ", "results"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"debugFOCs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<FOC wrt cIt[t]\>\"", "->", "focCtI"}], ",", 
       RowBox[{"\"\<FOC wrt hIt[t]\>\"", "->", "focHtI"}], ",", 
       RowBox[{"\"\<FOC wrt lIt[t]\>\"", "->", "focLtI"}], ",", 
       RowBox[{"\"\<FOC wrt bIt[t]\>\"", "->", "focBtI"}]}], "}"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Output", " ", "the", " ", "Lagrangian", " ", "and", " ", "FOCs"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Lagrangian\>\"", "->", "LI"}], ",", 
     RowBox[{"\"\<First-Order Conditions\>\"", "->", "debugFOCs"}]}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{
  3.9428556216292534`*^9, 3.9428558638346443`*^9, 3.942856329183136*^9, 
   3.9428564862004185`*^9, 3.9428566889696026`*^9, {3.942856910773079*^9, 
   3.9428569354905777`*^9}, {3.942857364787548*^9, 3.9428573898232937`*^9}, {
   3.9428577783808823`*^9, 3.9428578049808903`*^9}, 3.9428579940329285`*^9, {
   3.9428580395093536`*^9, 3.942858042871578*^9}, 3.9428591140860786`*^9, 
   3.9431155151779137`*^9, {3.9431158839568024`*^9, 3.943115919462967*^9}, {
   3.943116017131489*^9, 3.943116043165043*^9}, {3.943116203605345*^9, 
   3.943116248865116*^9}, 3.943116279396555*^9, {3.9431165276830425`*^9, 
   3.943116567202736*^9}, {3.94311672191103*^9, 3.943116753600672*^9}, {
   3.943116983151354*^9, 3.9431169998925896`*^9}, {3.9431182676864986`*^9, 
   3.943118310423565*^9}, {3.9431188651155624`*^9, 3.9431188743868217`*^9}, {
   3.9431189471438274`*^9, 3.943118963078903*^9}, {3.9431190017983513`*^9, 
   3.9431190163987827`*^9}, 3.9431844617301445`*^9, {3.943184531994499*^9, 
   3.9431845466193027`*^9}, {3.9431847557619095`*^9, 3.943184775501425*^9}, {
   3.943359097367693*^9, 3.943359119211834*^9}, 3.943368823503065*^9, 
   3.9433689041234646`*^9, 3.9433690047130775`*^9, {3.943372602202656*^9, 
   3.9433726292470894`*^9}, 3.9433731892332497`*^9, 3.943373405777813*^9, 
   3.943373880790806*^9, 3.9435298263594894`*^9, {3.943531181261368*^9, 
   3.943531227021929*^9}, 3.943533171298271*^9, {3.9435333243153496`*^9, 
   3.9435333617947254`*^9}, 3.9435362777779655`*^9, 3.9435367592692184`*^9, {
   3.9435380153508034`*^9, 3.943538038666689*^9}, {3.943548833672926*^9, 
   3.9435488363959446`*^9}, 3.9435490988596954`*^9, {3.9435491348483696`*^9, 
   3.943549140611929*^9}, {3.9435492777151756`*^9, 3.9435492934218426`*^9}, {
   3.943616506312252*^9, 3.9436165507183113`*^9}, {3.9436180500715656`*^9, 
   3.9436180530685368`*^9}, {3.945173009921896*^9, 3.945173031726755*^9}, {
   3.9451733102613754`*^9, 3.945173337662203*^9}, 3.9463751018555126`*^9, 
   3.9463802729152527`*^9, {3.946380978417076*^9, 3.9463810300157757`*^9}, 
   3.946396126499422*^9, 3.946397331734724*^9, 3.946398470666641*^9, 
   3.9463985289595127`*^9, 3.9463986259487324`*^9, {3.9464011586499176`*^9, 
   3.9464011613548775`*^9}, {3.9464016694565735`*^9, 
   3.9464017233964157`*^9}, {3.946402820333645*^9, 3.9464028291536007`*^9}, {
   3.9464035597819443`*^9, 3.946403566628748*^9}},
 CellLabel->
  "In[394]:=",ExpressionUUID->"94fcf45b-6f21-634c-b1d5-7d0ae8a5c58d"],

Cell[BoxData[""], "Input",ExpressionUUID->"b9ef39e2-d105-c74c-ae1b-589fe4deab77"],

Cell[BoxData[
 RowBox[{"\n", "\n", "\n", "\[IndentingNewLine]", 
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]}]], "Input",
 CellChangeTimes->{
  3.946400316124754*^9, 3.9464005812752533`*^9, {3.94640143677759*^9, 
   3.9464014829991436`*^9}, {3.946401823560726*^9, 3.946401836477703*^9}, 
   3.946403333041109*^9},ExpressionUUID->"8880107c-6260-f84b-9c38-\
4d69438e0d38"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", 
   RowBox[{"Define", " ", "FOC", " ", "wrt", " ", 
    RowBox[{"cIt", "[", "t", "]"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"eq1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"aD", " ", 
            RowBox[{"betaI", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}]}], ")"}], "/", 
          RowBox[{"cIt", "[", "t", "]"}]}], ")"}]}], "+", 
       RowBox[{"lambdaI", "[", "t", "]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "aD"}], ")"}], " ", "eps_ct"}], ")"}], "/", 
        RowBox[{"cIt", "[", "t", "]"}]}]}], "==", "0"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"1", ")"}], " ", "Solve", " ", "eq1", " ", "for", " ", 
     RowBox[{"lambdaI", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solLambda", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"eq1", ",", 
       RowBox[{"lambdaI", "[", "t", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Result", " ", "gives", " ", 
      RowBox[{"lambdaI", "[", "t", "]"}], " ", "in", " ", "terms", " ", "of", 
      " ", "aD"}], ",", "betaI", ",", "eps_ct", ",", 
     RowBox[{"and", " ", 
      RowBox[{"cIt", "[", "t", "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Define", " ", "other", " ", "FOCs"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focSystem", "=", 
     RowBox[{"{", 
      RowBox[{"(*", 
       RowBox[{"FOC", " ", "wrt", " ", 
        RowBox[{"hIt", "[", "t", "]"}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"eps_ht", "/", 
          RowBox[{"hIt", "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"lambdaI", "[", "t", "]"}], " ", 
          RowBox[{"qt", "[", "t", "]"}]}], "-", 
         RowBox[{
          RowBox[{"betaI", "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "t"}], ")"}]}], " ", 
          RowBox[{"lambdaI", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"qt", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"mLt", "[", "t", "]"}], " ", 
          RowBox[{"muI", "[", "t", "]"}], " ", 
          RowBox[{"pit", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"qt", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}]}], "==", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"lIt", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{
           RowBox[{"lIt", "[", "t", "]"}], "^", "phi"}]}], "-", 
         RowBox[{
          RowBox[{"lambdaI", "[", "t", "]"}], " ", 
          RowBox[{"wIt", "[", "t", "]"}]}]}], "==", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"bIt", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"lambdaI", "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"muI", "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"rBH", "[", "t", "]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betaI", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}], " ", 
            RowBox[{"lambdaI", "[", 
             RowBox[{"t", "+", "1"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rBH", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"pit", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}]}], "==", "0"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"2", ")"}], " ", "Use", " ", "time", " ", "identity"}], ",", 
     RowBox[{
      RowBox[{"lambdaI", "[", 
       RowBox[{"t", "+", "1"}], "]"}], " ", "and", " ", 
      RowBox[{"lambdaI", "[", 
       RowBox[{"t", "-", "1"}], "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lambdaNext", "=", 
     RowBox[{"solLambda", "/.", " ", 
      RowBox[{"t", "->", 
       RowBox[{"t", "+", "1"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"lambdaPrev", "=", 
     RowBox[{"solLambda", "/.", " ", 
      RowBox[{"t", "->", 
       RowBox[{"t", "-", "1"}]}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"3", ")"}], " ", "Substitute", " ", "solution", " ", "into", " ",
      "the", " ", "system", " ", "of", " ", "FOCs"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focSystemSub", "=", 
     RowBox[{
      RowBox[{"focSystem", "/.", " ", 
       RowBox[{"solLambda", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "/.", " ", 
      RowBox[{"lambdaNext", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Print", " ", "the", " ", "system", " ", "of", " ", "equations", " ", 
     "after", " ", "substitution"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<System of equations after substitution: \>\"", ",", 
      "focSystemSub"}], "]"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Solve", " ", "for", " ", "remaining", " ", "variables"}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"focSystemSub", ",", 
       RowBox[{"{", 
        RowBox[{"muI", "[", "t", "]"}], 
        RowBox[{"(*", 
         RowBox[{
         "Add", " ", "other", " ", "variables", " ", "if", " ", "needed"}], 
         "*)"}], "}"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Example", ":", 
     RowBox[{"Substitute", " ", 
      RowBox[{"muI", "[", "t", "]"}], " ", "from", " ", "FOC", " ", "wrt", 
      " ", 
      RowBox[{"bIt", "[", "t", "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"muISolution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"focSystemSub", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"muI", "[", "t", "]"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Substitute", " ", 
     RowBox[{"muI", "[", "t", "]"}], " ", "into", " ", "FOC", " ", "wrt", " ", 
     RowBox[{"hIt", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq1Sub", "=", 
     RowBox[{
      RowBox[{"focSystemSub", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/.", " ", 
      RowBox[{"muISolution", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Keep", " ", "FOC", " ", "wrt", " ", 
     RowBox[{"lIt", "[", "t", "]"}], " ", "unchanged"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq2", "=", 
     RowBox[{"focSystemSub", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Print", " ", "results"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<Equation wrt hIt[t] after elimination of muI[t]: \>\"", ",", 
      "eq1Sub"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Equation wrt lIt[t] remains: \>\"", ",", "eq2"}], "]"}], 
    ";"}], "\n", "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.942592057012724*^9, {3.942592245428005*^9, 3.94259229837319*^9}, {
   3.94259276149564*^9, 3.942592764239746*^9}, {3.9425935259046726`*^9, 
   3.942593548727476*^9}, 3.9425936374098434`*^9, {3.942594582938095*^9, 
   3.942594602603157*^9}, 3.9425946466589737`*^9, {3.9425949113557167`*^9, 
   3.9425949911134377`*^9}, 3.942595094281233*^9, {3.942595174682337*^9, 
   3.942595279071537*^9}, 3.942595447132061*^9, {3.9425956151379395`*^9, 
   3.94259563994841*^9}, 3.942595669960287*^9, {3.9425959508937435`*^9, 
   3.9425959719109993`*^9}, 3.9427690351333847`*^9, 3.9427690682198257`*^9, 
   3.9427715635525856`*^9, 3.9428545977365494`*^9, 3.9430291244111385`*^9, {
   3.9430293293032436`*^9, 3.9430293321251163`*^9}, 3.943029903411661*^9, 
   3.943029935968582*^9, {3.9430300915187435`*^9, 3.9430300983569183`*^9}, 
   3.943030165224594*^9, 3.943031018565777*^9, 3.9430310525436935`*^9, 
   3.9430315909590073`*^9, {3.943031676607229*^9, 3.943031762295637*^9}, {
   3.943032046234873*^9, 3.94303207506736*^9}, {3.943032277998928*^9, 
   3.943032328893503*^9}, 3.9430323609657345`*^9, {3.9430338379985332`*^9, 
   3.9430338777026024`*^9}, {3.9430340737475815`*^9, 3.9430340995907764`*^9}, 
   3.943034138748911*^9, 3.943034215671747*^9, 3.9430955097704773`*^9, 
   3.9433588087017574`*^9, 3.9433588506085987`*^9, 3.9433604537355385`*^9, 
   3.9433690498361454`*^9, {3.943369097716297*^9, 3.9433691157514877`*^9}, {
   3.9433691779950886`*^9, 3.9433691920949574`*^9}, {3.943369408544922*^9, 
   3.943369419957775*^9}, {3.9433694534026623`*^9, 3.9433694610976887`*^9}, {
   3.9433718095535316`*^9, 3.9433718209741173`*^9}, {3.943371942155674*^9, 
   3.943371948822159*^9}, {3.943372132182953*^9, 3.9433721356424065`*^9}, {
   3.9433723369107685`*^9, 3.9433723433940105`*^9}, {3.9433725200260067`*^9, 
   3.943372539188036*^9}, 3.9433729214440956`*^9, 3.946134979625437*^9, {
   3.946135028668358*^9, 3.9461350308236866`*^9}, {3.946380295211197*^9, 
   3.946380296539772*^9}, {3.94640043978706*^9, 3.946400483226412*^9}, 
   3.9464023612987766`*^9, {3.9464025415333214`*^9, 3.9464025643481045`*^9}, {
   3.9464031878470516`*^9, 3.946403191088213*^9}, {3.9464034240072136`*^9, 
   3.9464034490416183`*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"b0b5f86b-cc2e-e04d-b2ed-4360d9e5fb4f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "1.", " ", "Clear", " ", "and", " ", "declare", " ", "all", " ", 
    "variables"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "hIt", ",", "cIt", ",", "qt", ",", "pit", ",", "betaI", ",", "eps_ht", 
      ",", "eps_ct", ",", "aD", ",", "mLt", ",", "rBH", ",", "t"}], "]"}], 
    ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "2.", " ", "Define", " ", "the", " ", "original", " ", "equation", " ", 
      "as", " ", "F", 
      RowBox[{"(", "...", ")"}]}], "==", "0"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{
      "hIt_", ",", "cIt_", ",", "qt_", ",", "pit_", ",", "mLt_", ",", 
       "rBH_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"eps_ht", "/", "hIt"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"aD", " ", 
            RowBox[{"betaI", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}]}], "-", "eps_ct", "+", 
           RowBox[{"aD", " ", "eps_ct"}]}], ")"}], " ", "qt"}], ")"}], "/", 
       "cIt"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"betaI", "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "t"}], ")"}]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"aD", " ", 
            RowBox[{"betaI", "^", 
             RowBox[{"(", 
              RowBox[{"2", "+", "t"}], ")"}]}]}], "-", "eps_ct", "+", 
           RowBox[{"aD", " ", "eps_ct"}]}], ")"}], " ", 
         RowBox[{"qt", "[", 
          RowBox[{"1", "+", "t"}], "]"}]}], ")"}], "/", 
       RowBox[{"cIt", "[", 
        RowBox[{"1", "+", "t"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"mLt", " ", 
         RowBox[{"pit", "[", 
          RowBox[{"1", "+", "t"}], "]"}], " ", 
         RowBox[{"qt", "[", 
          RowBox[{"1", "+", "t"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"aD", " ", 
               RowBox[{"betaI", "^", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "t"}], ")"}]}]}], "-", "eps_ct", "+", 
              RowBox[{"aD", " ", "eps_ct"}]}], ")"}], "/", "cIt"}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"betaI", "^", 
               RowBox[{"(", 
                RowBox[{"1", "+", "t"}], ")"}]}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"aD", " ", 
                 RowBox[{"betaI", "^", 
                  RowBox[{"(", 
                   RowBox[{"2", "+", "t"}], ")"}]}]}], "-", "eps_ct", "+", 
                RowBox[{"aD", " ", "eps_ct"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", "rBH"}], ")"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"cIt", "[", 
               RowBox[{"1", "+", "t"}], "]"}], " ", 
              RowBox[{"pit", "[", 
               RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}]}], ")"}]}], ")"}], 
       "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", "rBH"}], ")"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "Collect", " ", "the", " ", "variables", " ", "to", " ", 
     "differentiate", " ", "with", " ", "respect", " ", "to"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{
      "hIt", ",", "cIt", ",", "qt", ",", "pit", ",", "mLt", ",", "rBH"}], 
      "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "4.", " ", "Compute", " ", "partial", " ", "derivatives", " ", "of", " ", 
     "F", " ", "at", " ", "the", " ", "steady", " ", "state"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"hIt", "->", "hIBar"}], ",", 
          RowBox[{"cIt", "->", "cIBar"}], ",", 
          RowBox[{"qt", "->", "qBar"}], ",", 
          RowBox[{"pit", "->", "piBar"}], ",", 
          RowBox[{"mLt", "->", "mLBar"}], ",", 
          RowBox[{"rBH", "->", "rBHBar"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"5.", " ", "Define", " ", "symbols", " ", "for", " ", "log"}], 
     "-", 
     RowBox[{"deviations", " ", 
      RowBox[{"(", 
       RowBox[{"d", " ", "ln", " ", "X"}], ")"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "hHatI", ",", "cHatI", ",", "qHat", ",", "piHat", ",", "mHatL", ",", 
      "rHatBH"}], "]"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "6.", " ", "Multiply", " ", "each", " ", "partial", " ", "by", " ", 
     "XBar", "*", 
     RowBox[{"(", 
      RowBox[{"hat", " ", "variable"}], ")"}], " ", "to", " ", "get", " ", 
     "the", " ", "linearized", " ", "equation"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varsBar", "=", 
     RowBox[{"{", 
      RowBox[{
      "hIBar", ",", "cIBar", ",", "qBar", ",", "piBar", ",", "mLBar", ",", 
       "rBHBar"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", "hIBar", "*", "hHatI"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", "cIBar", "*", "cHatI"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", "qBar", "*", "qHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "*", "piBar", "*", "piHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "*", "mLBar", "*", "mHatL"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "*", "rBHBar", "*", "rHatBH"}]}], "==",
       "0"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "7.", " ", "Simplify", " ", "the", " ", "final", " ", "linear", " ", 
     "equation"}], "*)"}], "\n", 
   RowBox[{"Simplify", "[", "logLinEq", "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.942592057012724*^9, {3.942592245428005*^9, 3.94259229837319*^9}, {
   3.94259276149564*^9, 3.942592764239746*^9}, {3.9425935259046726`*^9, 
   3.942593548727476*^9}, 3.9425936374098434`*^9, {3.942594582938095*^9, 
   3.942594602603157*^9}, 3.9425946466589737`*^9, {3.9425949113557167`*^9, 
   3.9425949911134377`*^9}, 3.942595094281233*^9, {3.942595174682337*^9, 
   3.942595279071537*^9}, 3.942595447132061*^9, {3.9425956151379395`*^9, 
   3.94259563994841*^9}, 3.942595669960287*^9, {3.9425959508937435`*^9, 
   3.9425959719109993`*^9}, 3.9427690351333847`*^9, 3.9427690682198257`*^9, 
   3.9427715635525856`*^9, 3.9428545977365494`*^9, 3.9430291244111385`*^9, {
   3.9430293293032436`*^9, 3.9430293321251163`*^9}, 3.943029903411661*^9, 
   3.943029935968582*^9, {3.9430300915187435`*^9, 3.9430300983569183`*^9}, 
   3.943030165224594*^9, 3.943031018565777*^9, 3.9430310525436935`*^9, 
   3.9430315909590073`*^9, {3.943031676607229*^9, 3.943031762295637*^9}, {
   3.943032046234873*^9, 3.94303207506736*^9}, {3.943032277998928*^9, 
   3.943032328893503*^9}, 3.9430323609657345`*^9, {3.9430338379985332`*^9, 
   3.9430338777026024`*^9}, {3.9430340737475815`*^9, 3.9430340995907764`*^9}, 
   3.943034138748911*^9, 3.943034215671747*^9, 3.9430955097704773`*^9, 
   3.9433588087017574`*^9, 3.9433588506085987`*^9, 3.9433604537355385`*^9, 
   3.9433690498361454`*^9, {3.943369097716297*^9, 3.9433691157514877`*^9}, {
   3.9433691779950886`*^9, 3.9433691920949574`*^9}, {3.943369408544922*^9, 
   3.943369419957775*^9}, {3.9433694534026623`*^9, 3.9433694610976887`*^9}, {
   3.9433718095535316`*^9, 3.9433718209741173`*^9}, {3.943371942155674*^9, 
   3.943371948822159*^9}, {3.943372132182953*^9, 3.9433721356424065`*^9}, {
   3.9433723369107685`*^9, 3.9433723433940105`*^9}, {3.9433725200260067`*^9, 
   3.943372539188036*^9}, 3.9433729214440956`*^9, 3.946134979625437*^9, {
   3.946135028668358*^9, 3.9461350308236866`*^9}, {3.946380295211197*^9, 
   3.946380296539772*^9}, {3.94640043978706*^9, 3.946400483226412*^9}, 
   3.9464023612987766`*^9, {3.9464025415333214`*^9, 3.9464025643481045`*^9}, {
   3.9464031878470516`*^9, 3.946403191088213*^9}, {3.9464034240072136`*^9, 
   3.9464034490416183`*^9}, 3.94734240899786*^9, 3.947342456115858*^9},
 CellLabel->
  "In[130]:=",ExpressionUUID->"5b2a032a-505e-c740-a415-a5a50f903e5d"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "1.", " ", "Clear", " ", "and", " ", "declare", " ", "all", " ", 
    "variables"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "lIt", ",", "wIt", ",", "cIt", ",", "betaI", ",", "eps_ct", ",", "aD", 
      ",", "phi", ",", "t"}], "]"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "2.", " ", "Define", " ", "the", " ", "original", " ", "equation", " ", 
      "as", " ", "F", 
      RowBox[{"(", "...", ")"}]}], "==", "0"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{"lIt_", ",", "wIt_", ",", "cIt_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"lIt", "^", "phi"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"aD", " ", 
            RowBox[{"betaI", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}]}], "-", "eps_ct", "+", 
           RowBox[{"aD", " ", "eps_ct"}]}], ")"}], " ", "wIt"}], ")"}], "/", 
       "cIt"}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "Collect", " ", "the", " ", "variables", " ", "to", " ", 
     "differentiate", " ", "with", " ", "respect", " ", "to"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{"lIt", ",", "wIt", ",", "cIt"}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "4.", " ", "Compute", " ", "partial", " ", "derivatives", " ", "of", " ", 
     "F", " ", "at", " ", "the", " ", "steady", " ", "state"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"lIt", "->", "lIBar"}], ",", 
          RowBox[{"wIt", "->", "wIBar"}], ",", 
          RowBox[{"cIt", "->", "cIBar"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"5.", " ", "Define", " ", "symbols", " ", "for", " ", "log"}], 
     "-", 
     RowBox[{"deviations", " ", 
      RowBox[{"(", 
       RowBox[{"d", " ", "ln", " ", "X"}], ")"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"lHatI", ",", "wHatI", ",", "cHatI"}], "]"}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "6.", " ", "Multiply", " ", "each", " ", "partial", " ", "by", " ", 
     "XBar", "*", 
     RowBox[{"(", 
      RowBox[{"hat", " ", "variable"}], ")"}], " ", "to", " ", "get", " ", 
     "the", " ", "linearized", " ", "equation"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varsBar", "=", 
     RowBox[{"{", 
      RowBox[{"lIBar", ",", "wIBar", ",", "cIBar"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", "lIBar", "*", "lHatI"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", "wIBar", "*", "wHatI"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", "cIBar", "*", "cHatI"}]}], "==",
       "0"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "7.", " ", "Simplify", " ", "the", " ", "final", " ", "linear", " ", 
     "equation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", "logLinEq", "]"}], "\n"}]}]], "Input",
 CellChangeTimes->{
  3.942592057012724*^9, {3.942592245428005*^9, 3.94259229837319*^9}, {
   3.94259276149564*^9, 3.942592764239746*^9}, {3.9425935259046726`*^9, 
   3.942593548727476*^9}, 3.9425936374098434`*^9, {3.942594582938095*^9, 
   3.942594602603157*^9}, 3.9425946466589737`*^9, {3.9425949113557167`*^9, 
   3.9425949911134377`*^9}, 3.942595094281233*^9, {3.942595174682337*^9, 
   3.942595279071537*^9}, 3.942595447132061*^9, {3.9425956151379395`*^9, 
   3.94259563994841*^9}, 3.942595669960287*^9, {3.9425959508937435`*^9, 
   3.9425959719109993`*^9}, 3.9427690351333847`*^9, 3.9427690682198257`*^9, 
   3.9427715635525856`*^9, 3.9428545977365494`*^9, 3.9430291244111385`*^9, {
   3.9430293293032436`*^9, 3.9430293321251163`*^9}, 3.943029903411661*^9, 
   3.943029935968582*^9, {3.9430300915187435`*^9, 3.9430300983569183`*^9}, 
   3.943030165224594*^9, 3.943031018565777*^9, 3.9430310525436935`*^9, 
   3.9430315909590073`*^9, {3.943031676607229*^9, 3.943031762295637*^9}, {
   3.943032046234873*^9, 3.94303207506736*^9}, {3.943032277998928*^9, 
   3.943032328893503*^9}, 3.9430323609657345`*^9, {3.9430338379985332`*^9, 
   3.9430338777026024`*^9}, {3.9430340737475815`*^9, 3.9430340995907764`*^9}, 
   3.943034138748911*^9, 3.943034215671747*^9, 3.9430955097704773`*^9, 
   3.9433588087017574`*^9, 3.9433588506085987`*^9, 3.9433604537355385`*^9, 
   3.9433690498361454`*^9, {3.943369097716297*^9, 3.9433691157514877`*^9}, {
   3.9433691779950886`*^9, 3.9433691920949574`*^9}, {3.943369408544922*^9, 
   3.943369419957775*^9}, {3.9433694534026623`*^9, 3.9433694610976887`*^9}, {
   3.9433718095535316`*^9, 3.9433718209741173`*^9}, {3.943371942155674*^9, 
   3.943371948822159*^9}, {3.943372132182953*^9, 3.9433721356424065`*^9}, {
   3.9433723369107685`*^9, 3.9433723433940105`*^9}, {3.9433725200260067`*^9, 
   3.943372539188036*^9}, 3.9433729214440956`*^9, 3.946134979625437*^9, {
   3.946135028668358*^9, 3.9461350308236866`*^9}, {3.946380295211197*^9, 
   3.946380296539772*^9}, {3.94640043978706*^9, 3.946400483226412*^9}, 
   3.9464023612987766`*^9, {3.9464025415333214`*^9, 3.9464025643481045`*^9}, {
   3.9464031878470516`*^9, 3.946403191088213*^9}, {3.9464034240072136`*^9, 
   3.9464034490416183`*^9}, 3.94734240899786*^9, {3.947342456115858*^9, 
   3.9473425197101955`*^9}, {3.9473429805323334`*^9, 3.9473429810118866`*^9}, 
   3.947343041703169*^9},ExpressionUUID->"0e074e25-5497-e244-8216-\
c9871e946f7c"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.942592057012724*^9, {3.942592245428005*^9, 3.94259229837319*^9}, {
   3.94259276149564*^9, 3.942592764239746*^9}, {3.9425935259046726`*^9, 
   3.942593548727476*^9}, 3.9425936374098434`*^9, {3.942594582938095*^9, 
   3.942594602603157*^9}, 3.9425946466589737`*^9, {3.9425949113557167`*^9, 
   3.9425949911134377`*^9}, 3.942595094281233*^9, {3.942595174682337*^9, 
   3.942595279071537*^9}, 3.942595447132061*^9, {3.9425956151379395`*^9, 
   3.94259563994841*^9}, 3.942595669960287*^9, {3.9425959508937435`*^9, 
   3.9425959719109993`*^9}, 3.9427690351333847`*^9, 3.9427690682198257`*^9, 
   3.9427715635525856`*^9, 3.9428545977365494`*^9, 3.9430291244111385`*^9, {
   3.9430293293032436`*^9, 3.9430293321251163`*^9}, 3.943029903411661*^9, 
   3.943029935968582*^9, {3.9430300915187435`*^9, 3.9430300983569183`*^9}, 
   3.943030165224594*^9, 3.943031018565777*^9, 3.9430310525436935`*^9, 
   3.9430315909590073`*^9, {3.943031676607229*^9, 3.943031762295637*^9}, {
   3.943032046234873*^9, 3.94303207506736*^9}, {3.943032277998928*^9, 
   3.943032328893503*^9}, 3.9430323609657345`*^9, {3.9430338379985332`*^9, 
   3.9430338777026024`*^9}, {3.9430340737475815`*^9, 3.9430340995907764`*^9}, 
   3.943034138748911*^9, 3.943034215671747*^9, 3.9430955097704773`*^9, 
   3.9433588087017574`*^9, 3.9433588506085987`*^9, 3.9433604537355385`*^9, 
   3.9433690498361454`*^9, {3.943369097716297*^9, 3.9433691157514877`*^9}, {
   3.9433691779950886`*^9, 3.9433691920949574`*^9}, {3.943369408544922*^9, 
   3.943369419957775*^9}, {3.9433694534026623`*^9, 3.9433694610976887`*^9}, {
   3.9433718095535316`*^9, 3.9433718209741173`*^9}, {3.943371942155674*^9, 
   3.943371948822159*^9}, {3.943372132182953*^9, 3.9433721356424065`*^9}, {
   3.9433723369107685`*^9, 3.9433723433940105`*^9}, {3.9433725200260067`*^9, 
   3.943372539188036*^9}, 3.9433729214440956`*^9, 3.946134979625437*^9, {
   3.946135028668358*^9, 3.9461350308236866`*^9}, {3.946380295211197*^9, 
   3.946380296539772*^9}, {3.94640043978706*^9, 3.946400483226412*^9}, 
   3.9464023612987766`*^9, {3.9464025415333214`*^9, 3.9464025643481045`*^9}, {
   3.9464031878470516`*^9, 3.946403191088213*^9}, {3.9464034240072136`*^9, 
   3.9464034490416183`*^9}, 3.94734240899786*^9, {3.947342456115858*^9, 
   3.9473425197101955`*^9}},ExpressionUUID->"a67f113d-d41d-d24a-8f3f-\
b4722fe41f74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "entrappanuer", " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Parameters", " ", "and", " ", "Variables", " ", "for", " ", 
     "Entrepreneurs"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"{", 
      RowBox[{
      "betaE", ",", "alpha", ",", "delta", ",", "xi1", ",", "xi2", ",", 
       RowBox[{"AE", "[", "t", "]"}], ",", 
       RowBox[{"wpt", "[", "t", "]"}], ",", 
       RowBox[{"wip", "[", "t", "]"}], ",", 
       RowBox[{"qt", "[", "t", "]"}], ",", 
       RowBox[{"rtE", "[", "t", "]"}], ",", 
       RowBox[{"pit", "[", "t", "]"}], ",", 
       RowBox[{"ctE", "[", "t", "]"}], ",", 
       RowBox[{"btE", "[", "t", "]"}], ",", 
       RowBox[{"kEt", "[", "t", "]"}], ",", 
       RowBox[{"uEt", "[", "t", "]"}], ",", 
       RowBox[{"mEt", "[", "t", "]"}], ",", 
       RowBox[{"LEP", "[", "t", "]"}], ",", 
       RowBox[{"LEI", "[", "t", "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Utility", " ", "function", " ", "for", " ", "entrepreneurs"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"uEntrepreneur", "[", 
      RowBox[{"ctE_", ",", "ctELag_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Log", "[", "ctE", "]"}], "-", 
      RowBox[{"alpha", " ", 
       RowBox[{"Log", "[", "ctELag", "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Production", " ", "function", " ", "for", " ", "entrepreneurs"}],
     "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"yE", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"AE", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"kE", "[", 
          RowBox[{"t", "-", "1"}], "]"}], "^", "alpha"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LEP", "[", "t", "]"}], "+", 
           RowBox[{"LEI", "[", "t", "]"}]}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"1", "-", "alpha"}], ")"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Utilization", " ", "cost", " ", "function"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FUtil", "[", "u_", "]"}], ":=", 
     RowBox[{
      RowBox[{"xi1", " ", 
       RowBox[{"(", 
        RowBox[{"u", "-", "1"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"xi2", "/", "2"}], ")"}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"u", "-", "1"}], ")"}], "^", "2"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Budget", " ", "constraint", " ", "for", " ", "entrepreneurs", " ", "in", 
     " ", "period", " ", "t"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"BCEntrepreneur", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"ctE", "[", "t", "]"}], "+", 
      RowBox[{
       RowBox[{"wpt", "[", "t", "]"}], " ", 
       RowBox[{"LEP", "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"wip", "[", "t", "]"}], " ", 
       RowBox[{"LEI", "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"rtE", "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ")"}], "/", 
         RowBox[{"pit", "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"btE", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"qt", "[", "t", "]"}], " ", 
       RowBox[{"kEt", "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"FUtil", "[", 
        RowBox[{"uEt", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"kEt", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], "-", 
      RowBox[{"yE", "[", "t", "]"}], "-", 
      RowBox[{"btE", "[", "t", "]"}], "-", 
      RowBox[{
       RowBox[{"qt", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "delta"}], ")"}], " ", 
       RowBox[{"kEt", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Borrowing", " ", "constraint", " ", "for", " ", "entrepreneurs", " ", 
     "in", " ", "period", " ", "t"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"BorrowingConstraint", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"rtE", "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"btE", "[", "t", "]"}]}], "-", 
      RowBox[{
       RowBox[{"Mt", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"qt", "[", 
          RowBox[{"t", "+", "1"}], "]"}], " ", 
         RowBox[{"pit", "[", 
          RowBox[{"t", "+", "1"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "delta"}], ")"}], " ", 
         RowBox[{"kEt", "[", "t", "]"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "Lagrangian", "*)"}], "\n", 
   RowBox[{
    RowBox[{"LE", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"betaE", "^", "t"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"uEntrepreneur", "[", 
          RowBox[{
           RowBox[{"ctE", "[", "t", "]"}], ",", 
           RowBox[{"ctE", "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], "]"}], "+", 
         RowBox[{
          RowBox[{"lambdaE", "[", "t", "]"}], " ", 
          RowBox[{"BCEntrepreneur", "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"muE", "[", "t", "]"}], " ", 
          RowBox[{"BorrowingConstraint", "[", "t", "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"betaE", "^", 
        RowBox[{"(", 
         RowBox[{"t", "+", "1"}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"uEntrepreneur", "[", 
          RowBox[{
           RowBox[{"ctE", "[", 
            RowBox[{"t", "+", "1"}], "]"}], ",", 
           RowBox[{"ctE", "[", "t", "]"}]}], "]"}], "+", 
         RowBox[{
          RowBox[{"lambdaE", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"BCEntrepreneur", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"muE", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"BorrowingConstraint", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"First", "-", 
     RowBox[{"order", " ", "conditions", " ", "for", " ", "entrepreneurs"}]}],
     "*)"}], "\n", 
   RowBox[{
    RowBox[{"focCtE", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LE", ",", 
        RowBox[{"ctE", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "consumption", " ", 
     RowBox[{"ctE", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focKEt", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LE", ",", 
        RowBox[{"kEt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "capital", " ", 
     RowBox[{"kEt", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focBtE", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LE", ",", 
        RowBox[{"btE", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "borrowing", " ", 
     RowBox[{"btE", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focUEt", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LE", ",", 
        RowBox[{"uEt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "utilization", " ", 
     RowBox[{"uEt", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Display", " ", "results"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"debugFOCs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<FOC wrt ctE[t]\>\"", "->", "focCtE"}], ",", 
       RowBox[{"\"\<FOC wrt kEt[t]\>\"", "->", "focKEt"}], ",", 
       RowBox[{"\"\<FOC wrt btE[t]\>\"", "->", "focBtE"}], ",", 
       RowBox[{"\"\<FOC wrt uEt[t]\>\"", "->", "focUEt"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Output", " ", "the", " ", "Lagrangian"}], ",", "FOCs"}], "*)"}],
    "\n", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Lagrangian\>\"", "->", "LE"}], ",", 
     RowBox[{"\"\<First-Order Conditions\>\"", "->", "debugFOCs"}]}], "}"}], 
   "\n"}]}]], "Input",
 CellChangeTimes->{
  3.942592057012724*^9, {3.942592245428005*^9, 3.94259229837319*^9}, {
   3.94259276149564*^9, 3.942592764239746*^9}, {3.9425935259046726`*^9, 
   3.942593548727476*^9}, 3.9425936374098434`*^9, {3.942594582938095*^9, 
   3.942594602603157*^9}, 3.9425946466589737`*^9, {3.9425949113557167`*^9, 
   3.9425949911134377`*^9}, 3.942595094281233*^9, {3.942595174682337*^9, 
   3.942595279071537*^9}, 3.942595447132061*^9, {3.9425956151379395`*^9, 
   3.94259563994841*^9}, 3.942595669960287*^9, {3.9425959508937435`*^9, 
   3.9425959719109993`*^9}, 3.9427690351333847`*^9, 3.9427690682198257`*^9, 
   3.9427715635525856`*^9, 3.9428545977365494`*^9, 3.9430291244111385`*^9, {
   3.9430293293032436`*^9, 3.9430293321251163`*^9}, 3.943029903411661*^9, 
   3.943029935968582*^9, {3.9430300915187435`*^9, 3.9430300983569183`*^9}, 
   3.943030165224594*^9, 3.943031018565777*^9, 3.9430310525436935`*^9, 
   3.9430315909590073`*^9, {3.943031676607229*^9, 3.943031762295637*^9}, {
   3.943032046234873*^9, 3.94303207506736*^9}, {3.943032277998928*^9, 
   3.943032328893503*^9}, 3.9430323609657345`*^9, {3.9430338379985332`*^9, 
   3.9430338777026024`*^9}, {3.9430340737475815`*^9, 3.9430340995907764`*^9}, 
   3.943034138748911*^9, 3.943034215671747*^9, 3.9430955097704773`*^9, 
   3.9433588087017574`*^9, 3.9433588506085987`*^9, 3.9433604537355385`*^9, 
   3.9433690498361454`*^9, {3.943369097716297*^9, 3.9433691157514877`*^9}, {
   3.9433691779950886`*^9, 3.9433691920949574`*^9}, {3.943369408544922*^9, 
   3.943369419957775*^9}, {3.9433694534026623`*^9, 3.9433694610976887`*^9}, {
   3.9433718095535316`*^9, 3.9433718209741173`*^9}, {3.943371942155674*^9, 
   3.943371948822159*^9}, {3.943372132182953*^9, 3.9433721356424065`*^9}, {
   3.9433723369107685`*^9, 3.9433723433940105`*^9}, {3.9433725200260067`*^9, 
   3.943372539188036*^9}, 3.9433729214440956`*^9, 3.946134979625437*^9, {
   3.946135028668358*^9, 3.9461350308236866`*^9}, {3.946380295211197*^9, 
   3.946380296539772*^9}, {3.94640043978706*^9, 3.946400483226412*^9}, 
   3.9464023612987766`*^9, {3.9464025415333214`*^9, 3.9464025643481045`*^9}, {
   3.9464031878470516`*^9, 3.946403191088213*^9}, {3.9464034240072136`*^9, 
   3.9464034490416183`*^9}, 3.94734240899786*^9, {3.947342456115858*^9, 
   3.9473425048120995`*^9}},ExpressionUUID->"24e808de-ed6a-4146-a49a-\
28e49cf93adc"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9464031981481724`*^9, 
  3.9464032115819416`*^9}},ExpressionUUID->"4129f409-7408-7d45-9299-\
8b83db08acfc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Definisikan", " ", "FOC", " ", "wrt", " ", 
    RowBox[{"c_t", "^", "E"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"eq1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"alpha", " ", 
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}]}], ")"}], "/", 
          RowBox[{"ctE", "[", "t", "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"betaE", "^", "t"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"ctE", "[", "t", "]"}]}], "+", 
          RowBox[{"lambdaE", "[", "t", "]"}]}], ")"}]}]}], "==", "0"}]}], 
    ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"1", ")"}], " ", "Pecahkan", " ", "eq1", " ", "untuk", " ", 
     RowBox[{"lambdaE", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solLambda", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"eq1", ",", 
       RowBox[{"lambdaE", "[", "t", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Hasilnya", " ", "memberi", " ", 
      RowBox[{"lambdaE", "[", "t", "]"}], " ", "dalam", " ", "fungsi", " ", 
      "alpha"}], ",", "betaE", ",", 
     RowBox[{"dan", " ", 
      RowBox[{"ctE", "[", "t", "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Misal", " ", "Anda", " ", "punya", " ", "FOC"}], "-", 
     RowBox[{
     "FOC", " ", "lain", " ", "sebagai", " ", "daftar", " ", "persamaan", " ", 
      RowBox[{"(", 
       RowBox[{"sesuaikan", " ", "sendiri"}], ")"}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focSystem", "=", 
     RowBox[{"{", 
      RowBox[{"(*", 
       RowBox[{"FOC", " ", "wrt", " ", 
        RowBox[{"kE", "[", "t", "]"}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"lambdaE", "[", "t", "]"}], " ", 
             RowBox[{"qt", "[", "t", "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "delta"}], ")"}], " ", 
             RowBox[{"Mt", "[", "t", "]"}], " ", 
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"pit", "[", 
              RowBox[{"1", "+", "t"}], "]"}], " ", 
             RowBox[{"qt", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"betaE", "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "t"}], ")"}]}], " ", 
          RowBox[{"lambdaE", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "delta"}], ")"}], " ", 
               RowBox[{"qt", "[", 
                RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}], "+", 
            RowBox[{"xi1", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"uEt", "[", 
                RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], " ", "xi2", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"uEt", "[", 
                 RowBox[{"t", "+", "1"}], "]"}]}], ")"}], "^", "2"}]}]}], 
           ")"}]}]}], "==", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"bE", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}], " ", 
            RowBox[{"lambdaE", "[", 
             RowBox[{"t", "+", "1"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"pit", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"lambdaE", "[", "t", "]"}]}], "+", 
            RowBox[{
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}], "==", 
        "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"uE", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"betaE", "^", "t"}], " ", 
         RowBox[{"kEt", "[", 
          RowBox[{"t", "-", "1"}], "]"}], " ", 
         RowBox[{"lambdaE", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"xi1", "+", 
           RowBox[{"xi2", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"uEt", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], "==", 
        "0"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"2", ")"}], " ", "Gunakan", " ", "identitas", " ", "waktu"}], 
     ",", 
     RowBox[{
      RowBox[{"misal", " ", 
       RowBox[{"lambdaE", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], "=", 
      RowBox[{
       RowBox[{"lambdaE", "[", 
        RowBox[{"t", "+", "1"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"didapat", " ", "dengan", " ", "mengganti", " ", "t"}], "->", 
          RowBox[{"t", "+", 
           RowBox[{"1", " ", "di", " ", "solLambda"}]}]}], ",", 
         RowBox[{"dsb", "."}]}], ")"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lambdaNext", "=", 
     RowBox[{"solLambda", "/.", " ", 
      RowBox[{"t", "->", 
       RowBox[{"t", "+", "1"}]}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"3", ")"}], " ", "Substitusikan", " ", "solusi", " ", "ke", " ", 
     "sistem", " ", "FOC"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focSystemSub", "=", 
     RowBox[{
      RowBox[{"focSystem", "/.", " ", 
       RowBox[{"solLambda", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "/.", " ", 
      RowBox[{"lambdaNext", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Selanjutnya", ",", 
     RowBox[{
     "Anda", " ", "bisa", " ", "gunakan", " ", "Solve", " ", "atau", " ", 
      "NSolve", " ", "untuk", " ", "menyelesaikan", " ", "sistem", " ", 
      "lengkap"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"focSystemSub", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"lambdaE", "[", "t", "]"}], ",", 
         RowBox[{"muE", "[", "t", "]"}]}], 
        RowBox[{"(*", 
         RowBox[{
         "variabel", " ", "lain", " ", "yang", " ", "ingin", " ", 
          "dipecahkan"}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{"dsb", "."}], "*)"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Definisikan", " ", "FOC", " ", "wrt", " ", 
     RowBox[{"c_t", "^", "E"}]}], "*)"}], 
   RowBox[{
    RowBox[{"eq1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"alpha", " ", 
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}]}], ")"}], "/", 
          RowBox[{"ctE", "[", "t", "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"betaE", "^", "t"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"ctE", "[", "t", "]"}]}], "+", 
          RowBox[{"lambdaE", "[", "t", "]"}]}], ")"}]}]}], "==", "0"}]}], 
    ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"1", ")"}], " ", "Pecahkan", " ", "eq1", " ", "untuk", " ", 
     RowBox[{"lambdaE", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solLambda", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"eq1", ",", 
       RowBox[{"lambdaE", "[", "t", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Hasilnya", " ", "memberi", " ", 
      RowBox[{"lambdaE", "[", "t", "]"}], " ", "dalam", " ", "fungsi", " ", 
      "alpha"}], ",", "betaE", ",", 
     RowBox[{"dan", " ", 
      RowBox[{"ctE", "[", "t", "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Misal", " ", "Anda", " ", "punya", " ", "FOC"}], "-", 
     RowBox[{
     "FOC", " ", "lain", " ", "sebagai", " ", "daftar", " ", "persamaan", " ", 
      RowBox[{"(", 
       RowBox[{"sesuaikan", " ", "sendiri"}], ")"}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focSystem", "=", 
     RowBox[{"{", 
      RowBox[{"(*", 
       RowBox[{"FOC", " ", "wrt", " ", 
        RowBox[{"kE", "[", "t", "]"}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"lambdaE", "[", "t", "]"}], " ", 
             RowBox[{"qt", "[", "t", "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "delta"}], ")"}], " ", 
             RowBox[{"Mt", "[", "t", "]"}], " ", 
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"pit", "[", 
              RowBox[{"1", "+", "t"}], "]"}], " ", 
             RowBox[{"qt", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"betaE", "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "t"}], ")"}]}], " ", 
          RowBox[{"lambdaE", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "delta"}], ")"}], " ", 
               RowBox[{"qt", "[", 
                RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}], "+", 
            RowBox[{"xi1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"uEt", "[", 
                RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], " ", "xi2", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"uEt", "[", 
                 RowBox[{"t", "+", "1"}], "]"}]}], ")"}], "^", "2"}]}]}], 
           ")"}]}]}], "==", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"bE", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}], " ", 
            RowBox[{"lambdaE", "[", 
             RowBox[{"t", "+", "1"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"pit", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"lambdaE", "[", "t", "]"}]}], "+", 
            RowBox[{
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}], "==", 
        "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"uE", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"betaE", "^", "t"}], " ", 
         RowBox[{"kEt", "[", 
          RowBox[{"t", "-", "1"}], "]"}], " ", 
         RowBox[{"lambdaE", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"xi1", "+", 
           RowBox[{"xi2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"uEt", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], "==", 
        "0"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"2", ")"}], " ", "Gunakan", " ", "identitas", " ", "waktu"}], 
     ",", 
     RowBox[{
      RowBox[{"misal", " ", 
       RowBox[{"lambdaE", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], "=", 
      RowBox[{
       RowBox[{"lambdaE", "[", 
        RowBox[{"t", "+", "1"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"didapat", " ", "dengan", " ", "mengganti", " ", "t"}], "->", 
          RowBox[{"t", "+", 
           RowBox[{"1", " ", "di", " ", "solLambda"}]}]}], ",", 
         RowBox[{"dsb", "."}]}], ")"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lambdaNext", "=", 
     RowBox[{"solLambda", "/.", " ", 
      RowBox[{"t", "->", 
       RowBox[{"t", "+", "1"}]}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"3", ")"}], " ", "Substitusikan", " ", "solusi", " ", "ke", " ", 
     "sistem", " ", "FOC"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focSystemSub", "=", 
     RowBox[{
      RowBox[{"focSystem", "/.", " ", 
       RowBox[{"solLambda", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "/.", " ", 
      RowBox[{"lambdaNext", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Cetak", " ", "sistem", " ", "persamaan", " ", "yang", " ", "baru"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<Sistem persamaan setelah substitusi: \>\"", ",", "focSystemSub"}], 
     "]"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Selanjutnya", ",", 
     RowBox[{
     "Anda", " ", "bisa", " ", "gunakan", " ", "Solve", " ", "atau", " ", 
      "NSolve", " ", "untuk", " ", "menyelesaikan", " ", "sistem", " ", 
      "lengkap"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"focSystemSub", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"lambdaE", "[", "t", "]"}], ",", 
         RowBox[{"muE", "[", "t", "]"}]}], 
        RowBox[{"(*", 
         RowBox[{
         "variabel", " ", "lain", " ", "yang", " ", "ingin", " ", 
          "dipecahkan"}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{"dsb", "."}], "*)"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.946139816861929*^9, 3.9461398521181507`*^9, {3.946140256790245*^9, 
   3.9461402839309597`*^9}, {3.9461405343897038`*^9, 3.9461405627286797`*^9}},
 CellLabel->
  "In[224]:=",ExpressionUUID->"e52c92a4-2eb6-c645-94b2-60c371363739"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{
  3.942511329185976*^9, 3.942511423550762*^9, 3.942591573184946*^9, {
   3.9425916035900593`*^9, 3.942591633542879*^9}, {3.9425918643458405`*^9, 
   3.9425918709932823`*^9}, 3.9430982526884403`*^9, {3.943106042988516*^9, 
   3.943106076844755*^9}, {3.943108704823662*^9, 3.9431087103972626`*^9}, {
   3.943358560356596*^9, 3.943358583894329*^9}, 3.943358615914463*^9, 
   3.9433587817943974`*^9, 3.943368571775612*^9, {3.9433686889968395`*^9, 
   3.943368716318613*^9}, 
   3.943368758918228*^9},ExpressionUUID->"f19b7f51-99bd-4547-9650-\
5ff8e4c33086"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Sistem", " ", "persamaan", " ", "setelah", " ", "substitusi"}], 
   "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"focSystemSub", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
               RowBox[{"qt", "[", "t", "]"}]}], ")"}], "/", 
             RowBox[{"ctE", "[", "t", "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "delta"}], ")"}], " ", 
             RowBox[{"Mt", "[", "t", "]"}], " ", 
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"pit", "[", 
              RowBox[{"1", "+", "t"}], "]"}], " ", 
             RowBox[{"qt", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "delta"}], ")"}], " ", 
                 RowBox[{"qt", "[", 
                  RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
              RowBox[{"xi1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"uEt", "[", 
                  RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"1", "/", "2"}], " ", "xi2", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"uEt", "[", 
                   RowBox[{"1", "+", "t"}], "]"}]}], ")"}], "^", "2"}]}]}], 
             ")"}]}], ")"}], "/", 
          RowBox[{"ctE", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}]}], "==", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ctE", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"pit", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"alpha", " ", "betaE"}]}], ")"}], "/", 
               RowBox[{"ctE", "[", "t", "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}], "==", 
        "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"betaE", "^", "t"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
           RowBox[{"kEt", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"xi1", "+", 
             RowBox[{"xi2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"uEt", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], ")"}], 
         "/", 
         RowBox[{"ctE", "[", "t", "]"}]}], "==", "0"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Pecahkan", " ", "persamaan", " ", "kedua", " ", "untuk", " ", 
     RowBox[{"muE", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"muESolution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"focSystemSub", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"muE", "[", "t", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Substitusikan", " ", "hasil", " ", 
     RowBox[{"muE", "[", "t", "]"}], " ", "ke", " ", "persamaan", " ", 
     "pertama"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"eq1Sub", "=", 
     RowBox[{
      RowBox[{"focSystemSub", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/.", " ", 
      RowBox[{"muESolution", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Tambahkan", " ", "persamaan", " ", "ketiga", " ", "ke", " ", "output"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"eq3", "=", 
     RowBox[{"focSystemSub", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Cetak", " ", "hasil"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<Persamaan pertama setelah eliminasi muE[t]: \>\"", ",", "eq1Sub"}], 
     "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Persamaan ketiga tetap: \>\"", ",", "eq3"}], "]"}], ";"}], 
   "\n", "\n", "\n"}]}]], "Input",
 CellChangeTimes->{{3.942508348357641*^9, 3.9425083483586407`*^9}, 
   3.9425104770787735`*^9, 3.946140941609421*^9, {3.9461411946531467`*^9, 
   3.9461412087808075`*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"e2c58ebf-4fbc-3d4b-ac91-cf15352134a5"],

Cell[BoxData[""], "Input",ExpressionUUID->"b88ee315-af2d-ad44-b33b-38496d3a52d4"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.942508439620474*^9, 3.942508439622467*^9}, 
   3.947343144267002*^9},ExpressionUUID->"4126ecf3-b2bc-c34e-b9ce-\
ab3dbe467b58"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "1.", " ", "Clear", " ", "and", " ", "declare", " ", "all", " ", 
    "variables"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "qt", ",", "ctE", ",", "Mt", ",", "pit", ",", "rtE", ",", "uEt", ",", 
      "betaE", ",", "alpha", ",", "delta", ",", "xi1", ",", "xi2", ",", "t"}],
      "]"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "2.", " ", "Define", " ", "the", " ", "original", " ", "equation", " ", 
      "as", " ", "F", 
      RowBox[{"(", "...", ")"}]}], "==", "0"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{
      "qt_", ",", "ctE_", ",", "Mt_", ",", "pit_", ",", "rtE_", ",", "uEt_"}],
       "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"betaE", "^", "t"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", "qt"}], ")"}], 
          "/", "ctE"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "delta"}], ")"}], " ", "Mt", " ", 
            RowBox[{"qt", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"betaE", " ", "ctE"}], "-", 
              RowBox[{
               RowBox[{"ctE", "[", 
                RowBox[{"1", "+", "t"}], "]"}], " ", 
               RowBox[{"pit", "[", 
                RowBox[{"1", "+", "t"}], "]"}]}], "+", 
              RowBox[{"betaE", " ", "ctE", " ", "rtE"}]}], ")"}]}], ")"}], 
          "/", 
          RowBox[{"(", 
           RowBox[{"ctE", " ", 
            RowBox[{"ctE", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "rtE"}], ")"}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"betaE", "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "t"}], ")"}]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "delta"}], ")"}], " ", 
              RowBox[{"qt", "[", 
               RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
           RowBox[{"xi1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"uEt", "[", 
               RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"1", "/", "2"}], " ", "xi2", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"uEt", "[", 
                RowBox[{"1", "+", "t"}], "]"}]}], ")"}], "^", "2"}]}]}], 
          ")"}]}], ")"}], "/", 
       RowBox[{"ctE", "[", 
        RowBox[{"1", "+", "t"}], "]"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "Collect", " ", "the", " ", "variables", " ", "to", " ", 
     "differentiate", " ", "with", " ", "respect", " ", "to"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{
      "qt", ",", "ctE", ",", "Mt", ",", "pit", ",", "rtE", ",", "uEt"}], 
      "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "4.", " ", "Compute", " ", "partial", " ", "derivatives", " ", "of", " ", 
     "F", " ", "at", " ", "the", " ", "steady", " ", "state"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"qt", "->", "qBar"}], ",", 
          RowBox[{"ctE", "->", "cEBar"}], ",", 
          RowBox[{"Mt", "->", "MBar"}], ",", 
          RowBox[{"pit", "->", "piBar"}], ",", 
          RowBox[{"rtE", "->", "rEBar"}], ",", 
          RowBox[{"uEt", "->", "uEBar"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"5.", " ", "Define", " ", "symbols", " ", "for", " ", "log"}], 
     "-", 
     RowBox[{"deviations", " ", 
      RowBox[{"(", 
       RowBox[{"d", " ", "ln", " ", "X"}], ")"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "qHat", ",", "cHatE", ",", "mHat", ",", "piHat", ",", "rHatE", ",", 
      "uHatE"}], "]"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "6.", " ", "Multiply", " ", "each", " ", "partial", " ", "by", " ", 
     "XBar", "*", 
     RowBox[{"(", 
      RowBox[{"hat", " ", "variable"}], ")"}], " ", "to", " ", "get", " ", 
     "the", " ", "linearized", " ", "equation"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varsBar", "=", 
     RowBox[{"{", 
      RowBox[{
      "qBar", ",", "cEBar", ",", "MBar", ",", "piBar", ",", "rEBar", ",", 
       "uEBar"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", "qBar", "*", "qHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", "cEBar", "*", "cHatE"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", "MBar", "*", "mHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "*", "piBar", "*", "piHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "*", "rEBar", "*", "rHatE"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "*", "uEBar", "*", "uHatE"}]}], "==",
       "0"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "7.", " ", "Simplify", " ", "the", " ", "final", " ", "linear", " ", 
     "equation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", "logLinEq", "]"}], "\n"}]}]], "Input",
 CellChangeTimes->{{3.942508439620474*^9, 3.942508439622467*^9}, 
   3.947343144267002*^9, 3.947343225841057*^9},
 CellLabel->
  "In[153]:=",ExpressionUUID->"e455865f-d51a-c546-92e4-fe2425237d2b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "1.", " ", "Clear", " ", "and", " ", "declare", " ", "all", " ", 
    "variables"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "kEt", ",", "uEt", ",", "ctE", ",", "betaE", ",", "alpha", ",", "xi1", 
      ",", "xi2", ",", "t"}], "]"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "2.", " ", "Define", " ", "the", " ", "original", " ", "equation", " ", 
      "as", " ", "F", 
      RowBox[{"(", "...", ")"}]}], "==", "0"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{"kEt_", ",", "uEt_", ",", "ctE_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"betaE", "^", "t"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
        RowBox[{"kEt", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"xi1", "+", 
          RowBox[{"xi2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "uEt"}], ")"}]}]}], ")"}]}], ")"}], "/",
       "ctE"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "Collect", " ", "the", " ", "variables", " ", "to", " ", 
     "differentiate", " ", "with", " ", "respect", " ", "to"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{"kEt", ",", "uEt", ",", "ctE"}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "4.", " ", "Compute", " ", "partial", " ", "derivatives", " ", "of", " ", 
     "F", " ", "at", " ", "the", " ", "steady", " ", "state"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"kEt", "->", "kEBar"}], ",", 
          RowBox[{"uEt", "->", "uEBar"}], ",", 
          RowBox[{"ctE", "->", "cEBar"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"5.", " ", "Define", " ", "symbols", " ", "for", " ", "log"}], 
     "-", 
     RowBox[{"deviations", " ", 
      RowBox[{"(", 
       RowBox[{"d", " ", "ln", " ", "X"}], ")"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"kHatE", ",", "uHatE", ",", "cHatE"}], "]"}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "6.", " ", "Multiply", " ", "each", " ", "partial", " ", "by", " ", 
     "XBar", "*", 
     RowBox[{"(", 
      RowBox[{"hat", " ", "variable"}], ")"}], " ", "to", " ", "get", " ", 
     "the", " ", "linearized", " ", "equation"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varsBar", "=", 
     RowBox[{"{", 
      RowBox[{"kEBar", ",", "uEBar", ",", "cEBar"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", "kEBar", "*", "kHatE"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", "uEBar", "*", "uHatE"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", "cEBar", "*", "cHatE"}]}], "==",
       "0"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "7.", " ", "Simplify", " ", "the", " ", "final", " ", "linear", " ", 
     "equation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", "logLinEq", "]"}], "\n"}]}]], "Input",
 CellChangeTimes->{{3.946985315020729*^9, 3.9469853498544445`*^9}, {
   3.9469855371680393`*^9, 3.9469855426712666`*^9}, {3.946986379214081*^9, 
   3.946986384157078*^9}, 3.9469868520171394`*^9, {3.946987699902313*^9, 
   3.9469877303491592`*^9}, 3.9469881338402653`*^9, {3.946988164224745*^9, 
   3.9469881780090294`*^9}, {3.947004166869732*^9, 3.947004204956812*^9}, {
   3.947178139271166*^9, 3.9471781409626083`*^9}, {3.9473433951528263`*^9, 
   3.947343404765833*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"0ee05957-9f4b-5148-9577-73fb4d317e3e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"CGP", " ", "Lagrange"}], "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"goods", " ", "market"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "Parameters", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"params", "=", 
    RowBox[{"{", 
     RowBox[{
     "\[Beta]", ",", "\[CapitalLambda]E", ",", "\[Kappa]", ",", "\[Delta]", 
      ",", 
      RowBox[{"Pt", "[", "t", "]"}], ",", 
      RowBox[{"Pk", "[", "t", "]"}], ",", 
      RowBox[{"xt", "[", "t", "]"}], ",", 
      RowBox[{"kt", "[", "t", "]"}], ",", 
      RowBox[{"it", "[", "t", "]"}], ",", 
      RowBox[{"kt", "[", "t", "]"}], ",", 
      RowBox[{"iqk", "[", "t", "]"}], ",", 
      RowBox[{"\[Epsilon]qk", "[", "t", "]"}], ",", 
      RowBox[{"\[Lambda]", "[", "t", "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Define", " ", 
    RowBox[{"\[CapitalDelta]xBar", "[", "t", "]"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalDelta]xBar", "[", "t_", "]"}], ":=", 
    RowBox[{
     RowBox[{"kt", "[", "t", "]"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Delta]"}], ")"}], " ", 
      RowBox[{"kt", "[", 
       RowBox[{"t", "-", "1"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Objective", " ", "function", " ", "for", " ", "CGP"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"objectiveCGP", "[", 
     RowBox[{
     "it_", ",", "\[CapitalDelta]xBar_", ",", "\[CapitalLambda]E_", ",", 
      "Pk_", ",", "Pt_"}], "]"}], ":=", 
    RowBox[{"\[CapitalLambda]E", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Pk", " ", "\[CapitalDelta]xBar"}], "-", 
       RowBox[{"Pt", " ", "it"}]}], ")"}]}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Constraint", " ", "for", " ", "CGP"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"constraintCGP", "[", "t_", "]"}], ":=", 
    RowBox[{
     RowBox[{"xt", "[", "t", "]"}], "-", 
     RowBox[{"xt", "[", 
      RowBox[{"t", "-", "1"}], "]"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"\[Kappa]", "/", "2"}], " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"iqk", "[", "t", "]"}], " ", 
             RowBox[{"\[Epsilon]qk", "[", "t", "]"}]}], "-", "1"}], ")"}], 
          "^", "2"}]}]}], ")"}], " ", 
      RowBox[{"it", "[", "t", "]"}]}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Define", " ", "Lagrangian", " ", "for", " ", "two", " ", "periods", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"t", " ", "and", " ", "t"}], "+", "1"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"L", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"objectiveCGP", "[", 
        RowBox[{
         RowBox[{"it", "[", "t", "]"}], ",", 
         RowBox[{"\[CapitalDelta]xBar", "[", "t", "]"}], ",", 
         "\[CapitalLambda]E", ",", 
         RowBox[{"Pk", "[", "t", "]"}], ",", 
         RowBox[{"Pt", "[", "t", "]"}]}], "]"}], "+", 
       RowBox[{
        RowBox[{"\[Lambda]", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"constraintCGP", "[", "t", "]"}], ")"}]}]}], ")"}], "+", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"objectiveCGP", "[", 
         RowBox[{
          RowBox[{"it", "[", 
           RowBox[{"t", "+", "1"}], "]"}], ",", 
          RowBox[{"\[CapitalDelta]xBar", "[", 
           RowBox[{"t", "+", "1"}], "]"}], ",", "\[CapitalLambda]E", ",", 
          RowBox[{"Pk", "[", 
           RowBox[{"t", "+", "1"}], "]"}], ",", 
          RowBox[{"Pt", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{"\[Lambda]", "[", 
          RowBox[{"t", "+", "1"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"constraintCGP", "[", 
           RowBox[{"t", "+", "1"}], "]"}], ")"}]}]}], ")"}]}]}]}], ";"}], 
  "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"First", "-", 
    RowBox[{"order", " ", "conditions", " ", "for", " ", "CGP"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"focIt", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"L", ",", 
       RowBox[{"it", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], 
  "        ", 
  RowBox[{"(*", 
   RowBox[{"FOC", " ", "with", " ", "respect", " ", "to", " ", 
    RowBox[{"it", "[", "t", "]"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"focXt", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"L", ",", 
       RowBox[{"xt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], 
  "        ", 
  RowBox[{"(*", 
   RowBox[{"FOC", " ", "with", " ", "respect", " ", "to", " ", 
    RowBox[{"xt", "[", "t", "]"}]}], "*)"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Debug", " ", "the", " ", "FOCs", " ", "before", " ", "solving"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"debugFOCs", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FOC wrt it[t]\>\"", "->", "focIt"}], ",", 
      RowBox[{"\"\<FOC wrt xt[t]\>\"", "->", "focXt"}]}], "}"}]}], ";"}], 
  "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Solve", " ", "FOCs", " ", "for", " ", "\[Lambda]"}], ",", 
    RowBox[{"keeping", " ", "full", " ", "expressions"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lambdaSolutions", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<Lambda wrt it[t]\>\"", "->", 
       RowBox[{"Solve", "[", 
        RowBox[{"focIt", ",", 
         RowBox[{"\[Lambda]", "[", "t", "]"}]}], "]"}]}], ",", 
      RowBox[{"\"\<Lambda wrt xt[t]\>\"", "->", 
       RowBox[{"Solve", "[", 
        RowBox[{"focXt", ",", 
         RowBox[{"\[Lambda]", "[", "t", "]"}]}], "]"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "Results", "*)"}]}], "\n", 
 RowBox[{"Print", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<Lambda Solutions\>\"", "->", "lambdaSolutions"}], "}"}], 
  "]"}], "\[IndentingNewLine]", "focIt", "\n", "focXt", \
"\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.946985315020729*^9, 3.9469853498544445`*^9}, {
   3.9469855371680393`*^9, 3.9469855426712666`*^9}, {3.946986379214081*^9, 
   3.946986384157078*^9}, 3.9469868520171394`*^9, {3.946987699902313*^9, 
   3.9469877303491592`*^9}, 3.9469881338402653`*^9, {3.946988164224745*^9, 
   3.9469881780090294`*^9}, {3.947004166869732*^9, 3.947004204956812*^9}, {
   3.947178139271166*^9, 3.9471781409626083`*^9}, 
   3.9473433951528263`*^9},ExpressionUUID->"d50ef5dd-7d10-9347-8ed7-\
e6a9098ab778"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.9427542379518967`*^9, {3.9427544965523434`*^9, 3.9427545632885056`*^9}, {
   3.946568422636217*^9, 3.9465684433856716`*^9}, 3.9465684783490505`*^9, 
   3.946568532208021*^9, {3.946568632693981*^9, 3.946568653514969*^9}, {
   3.946569857761751*^9, 3.9465698651066914`*^9}, 3.9465723397106075`*^9, 
   3.94665877743454*^9, {3.9466588743666687`*^9, 3.946658879360529*^9}, {
   3.946658937645237*^9, 3.9466589592356358`*^9}, {3.94666007926388*^9, 
   3.946660096683794*^9}, {3.946660162254713*^9, 3.946660179652712*^9}, {
   3.9466603112136536`*^9, 3.9466603652698765`*^9}, 3.9466606586495495`*^9, 
   3.946660721591772*^9, {3.9466614892396374`*^9, 3.946661517609167*^9}, {
   3.9466615581775208`*^9, 3.94666162347818*^9}, 3.9466620995132637`*^9, 
   3.946662154477379*^9, 3.946662259309641*^9, 3.946662304670412*^9, 
   3.9466641153553944`*^9},ExpressionUUID->"a5650fd1-18d4-1d4e-89f1-\
7b4f1f908005"],

Cell[BoxData[""], "Input",ExpressionUUID->"ad54bf90-5079-e447-887e-2c9f31b492f1"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{3.9469892159862976`*^9, 
  3.9469897185201645`*^9},ExpressionUUID->"9179d0fc-bd3a-474d-81a0-\
4d1659297c19"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{{3.94698950101556*^9, 3.9469895031470222`*^9}, {
  3.946989691328703*^9, 
  3.946989705939865*^9}},ExpressionUUID->"90347a46-5dbd-b54f-8f1e-\
a6938e1fe31a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Plug", " ", "in", " ", 
    RowBox[{"\[Lambda]", "[", "t", "]"}], " ", "and", " ", 
    RowBox[{"\[Lambda]", "[", 
     RowBox[{"t", "+", "1"}], "]"}], " ", "into", " ", "FOCs", " ", "and", 
    " ", "shift", " ", "time", " ", "indices"}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{"Expression", " ", "for", " ", 
    RowBox[{"\[Lambda]", "[", "t", "]"}], " ", "from", " ", "FOC", " ", "wrt",
     " ", 
    RowBox[{"it", "[", "t", "]"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"lambdaT", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", " ", "\[CapitalLambda]E", " ", 
        RowBox[{"Pt", "[", "t", "]"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", "-", "\[Kappa]", "+", 
        RowBox[{"2", " ", "\[Kappa]", " ", 
         RowBox[{"iqk", "[", "t", "]"}], " ", 
         RowBox[{"\[Epsilon]qk", "[", "t", "]"}]}], "-", 
        RowBox[{"\[Kappa]", " ", 
         RowBox[{
          RowBox[{"iqk", "[", "t", "]"}], "^", "2"}], " ", 
         RowBox[{
          RowBox[{"\[Epsilon]qk", "[", "t", "]"}], "^", "2"}]}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Shift", " ", "time", " ", "indices", " ", "up", " ", "by", " ", "1"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"lambdaTPlus1", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", " ", "\[CapitalLambda]E", " ", 
        RowBox[{"Pt", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", "-", "\[Kappa]", "+", 
        RowBox[{"2", " ", "\[Kappa]", " ", 
         RowBox[{"iqk", "[", 
          RowBox[{"t", "+", "1"}], "]"}], " ", 
         RowBox[{"\[Epsilon]qk", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], "-", 
        RowBox[{"\[Kappa]", " ", 
         RowBox[{
          RowBox[{"iqk", "[", 
           RowBox[{"t", "+", "1"}], "]"}], "^", "2"}], " ", 
         RowBox[{
          RowBox[{"\[Epsilon]qk", "[", 
           RowBox[{"t", "+", "1"}], "]"}], "^", "2"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Substitute", " ", 
     RowBox[{"\[Lambda]", "[", "t", "]"}], " ", "and", " ", 
     RowBox[{"\[Lambda]", "[", 
      RowBox[{"t", "+", "1"}], "]"}], " ", "into", " ", "the", " ", "FOCs"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"focItUpdated", "=", 
     RowBox[{"focIt", "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Lambda]", "[", "t", "]"}], "->", "lambdaT"}], ",", 
        RowBox[{
         RowBox[{"\[Lambda]", "[", 
          RowBox[{"t", "+", "1"}], "]"}], "->", "lambdaTPlus1"}]}], "}"}]}]}],
     ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focXtUpdated", "=", 
     RowBox[{"focXt", "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Lambda]", "[", "t", "]"}], "->", "lambdaT"}], ",", 
        RowBox[{
         RowBox[{"\[Lambda]", "[", 
          RowBox[{"t", "+", "1"}], "]"}], "->", "lambdaTPlus1"}]}], "}"}]}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Results", " ", "explicitly", " ", "printed"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Updated FOC wrt it[t]: \>\"", ",", "focItUpdated"}], "]"}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Updated FOC wrt xt[t]: \>\"", ",", "focXtUpdated"}], "]"}], 
    ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Updated FOC wrt it[t]\>\"", "->", "focItUpdated"}], ",", 
     RowBox[{"\"\<Updated FOC wrt xt[t]\>\"", "->", "focXtUpdated"}]}], "}"}],
    "\n"}]}]], "Input",
 CellChangeTimes->{3.946989910123577*^9},
 CellLabel->"In[98]:=",ExpressionUUID->"d48f496e-7176-4c4a-84fa-2b0987060b46"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\"\<Updated FOC wrt it[t]\>\"", "\[Rule]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[CapitalLambda]E"}], " ", 
        RowBox[{"Pt", "[", "t", "]"}]}], "+", 
       FractionBox[
        RowBox[{"2", " ", "\[CapitalLambda]E", " ", 
         RowBox[{"Pt", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            FractionBox["1", "2"], " ", "\[Kappa]", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{
                RowBox[{"iqk", "[", "t", "]"}], " ", 
                RowBox[{"\[Epsilon]qk", "[", "t", "]"}]}]}], ")"}], "2"]}]}], 
          ")"}]}], 
        RowBox[{"2", "-", "\[Kappa]", "+", 
         RowBox[{"2", " ", "\[Kappa]", " ", 
          RowBox[{"iqk", "[", "t", "]"}], " ", 
          RowBox[{"\[Epsilon]qk", "[", "t", "]"}]}], "-", 
         RowBox[{"\[Kappa]", " ", 
          SuperscriptBox[
           RowBox[{"iqk", "[", "t", "]"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"\[Epsilon]qk", "[", "t", "]"}], "2"]}]}]]}], "\[Equal]", 
      "0"}]}], ",", 
    RowBox[{"\"\<Updated FOC wrt xt[t]\>\"", "\[Rule]", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", "\[CapitalLambda]E", " ", 
         RowBox[{"Pt", "[", "t", "]"}]}], 
        RowBox[{"2", "-", "\[Kappa]", "+", 
         RowBox[{"2", " ", "\[Kappa]", " ", 
          RowBox[{"iqk", "[", "t", "]"}], " ", 
          RowBox[{"\[Epsilon]qk", "[", "t", "]"}]}], "-", 
         RowBox[{"\[Kappa]", " ", 
          SuperscriptBox[
           RowBox[{"iqk", "[", "t", "]"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"\[Epsilon]qk", "[", "t", "]"}], "2"]}]}]], "-", 
       FractionBox[
        RowBox[{"2", " ", "\[Beta]", " ", "\[CapitalLambda]E", " ", 
         RowBox[{"Pt", "[", 
          RowBox[{"1", "+", "t"}], "]"}]}], 
        RowBox[{"2", "-", "\[Kappa]", "+", 
         RowBox[{"2", " ", "\[Kappa]", " ", 
          RowBox[{"iqk", "[", 
           RowBox[{"1", "+", "t"}], "]"}], " ", 
          RowBox[{"\[Epsilon]qk", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}], "-", 
         RowBox[{"\[Kappa]", " ", 
          SuperscriptBox[
           RowBox[{"iqk", "[", 
            RowBox[{"1", "+", "t"}], "]"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"\[Epsilon]qk", "[", 
            RowBox[{"1", "+", "t"}], "]"}], "2"]}]}]]}], "\[Equal]", 
      "0"}]}]}], "}"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Stochastic", " ", "Discount", " ", "Factor", " ", "Calculation"}],
    "*)"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Define", " ", "derivatives", " ", "at", " ", "t", " ", "and", " ", "t"}],
     "+", "1"}], "*)"}], 
  RowBox[{
   RowBox[{"derivativeT", "=", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"objectiveCGP", "[", 
       RowBox[{
        RowBox[{"it", "[", "t", "]"}], ",", 
        RowBox[{"\[CapitalDelta]xBar", "[", "t", "]"}], ",", 
        "\[CapitalLambda]E", ",", 
        RowBox[{"Pk", "[", "t", "]"}], ",", 
        RowBox[{"Pt", "[", "t", "]"}]}], "]"}], ",", 
      RowBox[{"it", "[", "t", "]"}]}], "]"}]}], ";"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"derivativeTPlus1", "=", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"objectiveCGP", "[", 
       RowBox[{
        RowBox[{"it", "[", 
         RowBox[{"t", "+", "1"}], "]"}], ",", 
        RowBox[{"\[CapitalDelta]xBar", "[", 
         RowBox[{"t", "+", "1"}], "]"}], ",", "\[CapitalLambda]E", ",", 
        RowBox[{"Pk", "[", 
         RowBox[{"t", "+", "1"}], "]"}], ",", 
        RowBox[{"Pt", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], "]"}], ",", 
      RowBox[{"it", "[", 
       RowBox[{"t", "+", "1"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Calculate", " ", "stochastic", " ", "discount", " ", "factor"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"stochasticDiscountFactor", 
    RowBox[{"=[", "derivativeTPlus1/derivativeT", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "Result", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<Stochastic Discount Factor: \>\"", ",", "stochasticDiscountFactor"}], 
   "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9469965989965515`*^9, 3.946996631543125*^9}, {
   3.946996679326996*^9, 3.946996680746643*^9}, {3.9469967383488903`*^9, 
   3.9469967415651703`*^9}, 3.947000760794897*^9},
 CellLabel->
  "In[181]:=",ExpressionUUID->"16a53433-1cc7-e74a-b3e2-121a43b05c36"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{{3.9469966392186947`*^9, 3.9469966392196903`*^9}, 
   3.9469967613630085`*^9},
 CellLabel->
  "In[110]:=",ExpressionUUID->"0d88e268-8e18-e44d-b2d8-cdf7e7401492"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Define", " ", "the", " ", "equations"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"updatedFOCs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<Updated FOC wrt it[t]\>\"", "->", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[CapitalLambda]E"}], " ", 
           RowBox[{"Pt", "[", "t", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", " ", "\[CapitalLambda]E", " ", 
             RowBox[{"Pt", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{
                RowBox[{"1", "/", "2"}], " ", "\[Kappa]", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   RowBox[{
                    RowBox[{"iqk", "[", "t", "]"}], " ", 
                    RowBox[{"\[Epsilon]qk", "[", "t", "]"}]}]}], ")"}], "^", 
                 "2"}]}]}], ")"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", "-", "\[Kappa]", "+", 
             RowBox[{"2", " ", "\[Kappa]", " ", 
              RowBox[{"iqk", "[", "t", "]"}], " ", 
              RowBox[{"\[Epsilon]qk", "[", "t", "]"}]}], "-", 
             RowBox[{"\[Kappa]", " ", 
              RowBox[{
               RowBox[{"iqk", "[", "t", "]"}], "^", "2"}], " ", 
              RowBox[{
               RowBox[{"\[Epsilon]qk", "[", "t", "]"}], "^", "2"}]}]}], 
            ")"}]}]}], "==", "0"}]}], ",", 
       RowBox[{"\"\<Updated FOC wrt xt[t]\>\"", "->", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", " ", "\[CapitalLambda]E", " ", 
             RowBox[{"Pt", "[", "t", "]"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", "-", "\[Kappa]", "+", 
             RowBox[{"2", " ", "\[Kappa]", " ", 
              RowBox[{"iqk", "[", "t", "]"}], " ", 
              RowBox[{"\[Epsilon]qk", "[", "t", "]"}]}], "-", 
             RowBox[{"\[Kappa]", " ", 
              RowBox[{
               RowBox[{"iqk", "[", "t", "]"}], "^", "2"}], " ", 
              RowBox[{
               RowBox[{"\[Epsilon]qk", "[", "t", "]"}], "^", "2"}]}]}], 
            ")"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", " ", "\[Beta]", " ", "\[CapitalLambda]E", " ", 
             RowBox[{"Pt", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", "-", "\[Kappa]", "+", 
             RowBox[{"2", " ", "\[Kappa]", " ", 
              RowBox[{"iqk", "[", 
               RowBox[{"1", "+", "t"}], "]"}], " ", 
              RowBox[{"\[Epsilon]qk", "[", 
               RowBox[{"1", "+", "t"}], "]"}]}], "-", 
             RowBox[{"\[Kappa]", " ", 
              RowBox[{
               RowBox[{"iqk", "[", 
                RowBox[{"1", "+", "t"}], "]"}], "^", "2"}], " ", 
              RowBox[{
               RowBox[{"\[Epsilon]qk", "[", 
                RowBox[{"1", "+", "t"}], "]"}], "^", "2"}]}]}], ")"}]}]}], "==",
          "0"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Define", " ", "\[CapitalLambda]E"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"lambdaE", "=", 
     RowBox[{"\[CapitalLambda]E", "->", 
      RowBox[{
       RowBox[{"Pt", "[", 
        RowBox[{"t", "+", "1"}], "]"}], "/", 
       RowBox[{"Pt", "[", "t", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Substitute", " ", "\[CapitalLambda]E", " ", "directly", " ", "into", " ",
      "the", " ", "equations"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"updatedFOCsWithLambdaE", "=", 
     RowBox[{"updatedFOCs", "/.", " ", "lambdaE"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Display", " ", "the", " ", "results"}], "*)"}], 
   "\[IndentingNewLine]", "updatedFOCsWithLambdaE", "\n", 
   "\[IndentingNewLine]", "\n", "\n"}]}]], "Input",
 CellChangeTimes->{
  3.946997714031584*^9, {3.946997818668518*^9, 3.946997840825136*^9}, {
   3.9469981410677166`*^9, 3.9469981620450706`*^9}, {3.9469984739662876`*^9, 
   3.9469984868744564`*^9}, {3.9470004652612762`*^9, 
   3.9470004746943607`*^9}, {3.947000923688463*^9, 3.9470009573882008`*^9}, {
   3.9470011983600025`*^9, 3.947001200512789*^9}, {3.9470014349401226`*^9, 
   3.947001442098938*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"040b9176-9fb1-6c42-b2d6-b57a6d9f6770"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9469965989965515`*^9, 
  3.946996631543125*^9}},ExpressionUUID->"415c207e-69ac-8e4e-b60e-\
cce02daeab93"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{{3.9427549950755463`*^9, 3.942754995076544*^9}, {
   3.942856797987402*^9, 3.942856829082693*^9}, 3.943370342061611*^9, {
   3.943370944682108*^9, 3.9433709631648884`*^9}, 3.946663310553734*^9, {
   3.9466633455721016`*^9, 3.9466633610768337`*^9}, {3.946664044759159*^9, 
   3.9466640515297546`*^9}, 3.9469848351943665`*^9, 3.946999652095562*^9, 
   3.9469998303914356`*^9, 3.94699990823254*^9, {3.947086151601959*^9, 
   3.9470861627436104`*^9}},ExpressionUUID->"8331c5f9-92bc-9347-8078-\
669c615e9f37"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "1.", " ", "Clear", " ", "and", " ", "declare", " ", "all", " ", 
    "variables"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"Pt", ",", "iqk", ",", "Epsilonqk", ",", "kappa", ",", "t"}], 
     "]"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "2.", " ", "Define", " ", "the", " ", "original", " ", "equation", " ", 
      "as", " ", "F", 
      RowBox[{"(", "...", ")"}]}], "==", "0"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{"Pt_", ",", "iqk_", ",", "Epsilonqk_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Pt", "[", 
        RowBox[{"1", "+", "t"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", " ", 
         RowBox[{"Pt", "[", 
          RowBox[{"1", "+", "t"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            RowBox[{"1", "/", "2"}], " ", "kappa", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"iqk", " ", "Epsilonqk"}]}], ")"}], "^", "2"}]}]}], 
          ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", "-", "kappa", "+", 
         RowBox[{"2", " ", "kappa", " ", "iqk", " ", "Epsilonqk"}], "-", 
         RowBox[{"kappa", " ", 
          RowBox[{"iqk", "^", "2"}], " ", 
          RowBox[{"Epsilonqk", "^", "2"}]}]}], ")"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "Collect", " ", "the", " ", "variables", " ", "to", " ", 
     "differentiate", " ", "with", " ", "respect", " ", "to"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{"Pt", ",", "iqk", ",", "Epsilonqk"}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "4.", " ", "Compute", " ", "partial", " ", "derivatives", " ", "of", " ", 
     "F", " ", "at", " ", "the", " ", "steady", " ", "state"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Pt", "->", "PBar"}], ",", 
          RowBox[{"iqk", "->", "iqkBar"}], ",", 
          RowBox[{"Epsilonqk", "->", "EpsilonqkBar"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"5.", " ", "Define", " ", "symbols", " ", "for", " ", "log"}], 
     "-", 
     RowBox[{"deviations", " ", 
      RowBox[{"(", 
       RowBox[{"d", " ", "ln", " ", "X"}], ")"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"PHat", ",", "iqkHat", ",", "EpsilonqkHat"}], "]"}], ";"}], "\n",
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "6.", " ", "Multiply", " ", "each", " ", "partial", " ", "by", " ", 
     "XBar", "*", 
     RowBox[{"(", 
      RowBox[{"hat", " ", "variable"}], ")"}], " ", "to", " ", "get", " ", 
     "the", " ", "linearized", " ", "equation"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varsBar", "=", 
     RowBox[{"{", 
      RowBox[{"PBar", ",", "iqkBar", ",", "EpsilonqkBar"}], "}"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", "PBar", "*", "PHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", "iqkBar", "*", "iqkHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", "EpsilonqkBar", "*", 
        "EpsilonqkHat"}]}], "==", "0"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"7.", " ", "Display", " ", "the", " ", "log"}], "-", 
     RowBox[{"linearized", " ", "equation", " ", "explicitly"}]}], "*)"}], 
   "\[IndentingNewLine]", "logLinEq", "\n", "\n"}]}]], "Input",
 CellChangeTimes->{{3.9427549950755463`*^9, 3.942754995076544*^9}, {
   3.942856797987402*^9, 3.942856829082693*^9}, 3.943370342061611*^9, {
   3.943370944682108*^9, 3.9433709631648884`*^9}, 3.946663310553734*^9, {
   3.9466633455721016`*^9, 3.9466633610768337`*^9}, {3.946664044759159*^9, 
   3.9466640515297546`*^9}, 3.9469848351943665`*^9, 3.946999652095562*^9, 
   3.9469998303914356`*^9, 3.94699990823254*^9, {3.947086151601959*^9, 
   3.947086224151844*^9}, 3.9470862606250534`*^9, 3.94717811493816*^9, 
   3.9473435774007263`*^9, {3.9473443700896626`*^9, 3.947344437025568*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"046d3eeb-8f2b-d440-bb6b-57fa6e32ad17"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{{3.947086958770447*^9, 3.947086962421818*^9}, {
   3.9470870021950436`*^9, 3.947087005101101*^9}, 3.947087036947603*^9, 
   3.9471781003735676`*^9},ExpressionUUID->"65474464-fc4d-bb45-8abd-\
61b05ca4d665"],

Cell[BoxData[""], "Input",ExpressionUUID->"4c545160-c5fd-2b4b-a2e7-6c177e37cc74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "1.", " ", "Clear", " ", "and", " ", "declare", " ", "all", " ", 
    "variables"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "Pt", ",", "iqk", ",", "Epsilonqk", ",", "kappa", ",", "beta", ",", 
      "t"}], "]"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "2.", " ", "Define", " ", "the", " ", "original", " ", "equation", " ", 
      "as", " ", "F", 
      RowBox[{"(", "...", ")"}]}], "==", "0"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{"Pt_", ",", "iqk_", ",", "Epsilonqk_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", " ", 
         RowBox[{"Pt", "[", 
          RowBox[{"1", "+", "t"}], "]"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", "-", "kappa", "+", 
         RowBox[{"2", " ", "kappa", " ", "iqk", " ", "Epsilonqk"}], "-", 
         RowBox[{"kappa", " ", 
          RowBox[{"iqk", "^", "2"}], " ", 
          RowBox[{"Epsilonqk", "^", "2"}]}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", " ", "beta", " ", 
         RowBox[{
          RowBox[{"Pt", "[", 
           RowBox[{"1", "+", "t"}], "]"}], "^", "2"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Pt", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"2", "-", "kappa", "+", 
           RowBox[{"2", " ", "kappa", " ", 
            RowBox[{"iqk", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"Epsilonqk", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], "-", 
           RowBox[{"kappa", " ", 
            RowBox[{
             RowBox[{"iqk", "[", 
              RowBox[{"1", "+", "t"}], "]"}], "^", "2"}], " ", 
            RowBox[{
             RowBox[{"Epsilonqk", "[", 
              RowBox[{"1", "+", "t"}], "]"}], "^", "2"}]}]}], ")"}]}], 
        ")"}]}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "Collect", " ", "the", " ", "variables", " ", "to", " ", 
     "differentiate", " ", "with", " ", "respect", " ", "to"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{"Pt", ",", "iqk", ",", "Epsilonqk"}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "4.", " ", "Compute", " ", "partial", " ", "derivatives", " ", "of", " ", 
     "F", " ", "at", " ", "the", " ", "steady", " ", "state"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Pt", "->", "PBar"}], ",", 
          RowBox[{"iqk", "->", "iqkBar"}], ",", 
          RowBox[{"Epsilonqk", "->", "EpsilonqkBar"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"5.", " ", "Define", " ", "symbols", " ", "for", " ", "log"}], 
     "-", 
     RowBox[{"deviations", " ", 
      RowBox[{"(", 
       RowBox[{"d", " ", "ln", " ", "X"}], ")"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"PHat", ",", "iqkHat", ",", "EpsilonqkHat"}], "]"}], ";"}], "\n",
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "6.", " ", "Multiply", " ", "each", " ", "partial", " ", "by", " ", 
     "XBar", "*", 
     RowBox[{"(", 
      RowBox[{"hat", " ", "variable"}], ")"}], " ", "to", " ", "get", " ", 
     "the", " ", "linearized", " ", "equation"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varsBar", "=", 
     RowBox[{"{", 
      RowBox[{"PBar", ",", "iqkBar", ",", "EpsilonqkBar"}], "}"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", "PBar", "*", "PHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", "iqkBar", "*", "iqkHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", "EpsilonqkBar", "*", 
        "EpsilonqkHat"}]}], "==", "0"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"7.", " ", "Display", " ", "the", " ", "log"}], "-", 
     RowBox[{"linearized", " ", "equation", " ", "explicitly"}]}], "*)"}], 
   "\[IndentingNewLine]", "logLinEq", "\n"}]}]], "Input",
 CellChangeTimes->{3.942754716102133*^9, 3.947344833110285*^9},
 CellLabel->
  "In[197]:=",ExpressionUUID->"283b5187-a2f1-ef49-b5fd-690301eeecfb"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.9424252546658554`*^9, 
  3.942508294844681*^9},ExpressionUUID->"79788ce8-4cec-0840-aa08-\
3875ff1d3e80"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9425082690938396`*^9, 
  3.942508282245655*^9}},ExpressionUUID->"f0ade162-6b1f-0f48-a2c9-\
2be142b63af0"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"goods", " ", "retailers"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Contoh", " ", "pemecahan", " ", "fungsi", " ", "profit", " ", 
     "retailer"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Parameter", " ", "contoh"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"{", 
      RowBox[{"betaR", ",", "kappaP", ",", "iota", ",", "piStar", ",", 
       RowBox[{"epsilonU", "[", "t", "]"}], ",", 
       RowBox[{"Pt", "[", "t", "]"}], ",", 
       RowBox[{"Pw", "[", "t", "]"}], ",", 
       RowBox[{"Y", "[", "t", "]"}], ",", 
       RowBox[{"Pi", "[", "t", "]"}], ",", 
       RowBox[{"Pj", "[", "t", "]"}], ",", 
       RowBox[{"Pj", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"1.", " ", "Bagian", " ", "pendapatan"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"revenue", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Pj", "[", "t", "]"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Pj", "[", "t", "]"}], "/", 
          RowBox[{"Pt", "[", "t", "]"}]}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{"epsilonU", "[", "t", "]"}]}], ")"}]}], ")"}], "*", 
      RowBox[{"Y", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"2.", " ", "Bagian", " ", "biaya", " ", "wholesale"}], "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"costWholesale", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Pw", "[", "t", "]"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Pj", "[", "t", "]"}], "/", 
          RowBox[{"Pt", "[", "t", "]"}]}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{"epsilonU", "[", "t", "]"}]}], ")"}]}], ")"}], "*", 
      RowBox[{"Y", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "Bagian", " ", "quadratic", " ", "adjustment", " ", "cost"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"adjCost", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"kappaP", "/", "2"}], ")"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Pj", "[", "t", "]"}], "/", 
           RowBox[{"Pj", "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ")"}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"Pi", "[", 
            RowBox[{"t", "-", "1"}], "]"}], "^", "iota"}], " ", 
          RowBox[{"piStar", "^", 
           RowBox[{"(", 
            RowBox[{"1", "-", "iota"}], ")"}]}]}]}], ")"}], "^", "2"}], " ", 
      "*", 
      RowBox[{"Pj", "[", "t", "]"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Pj", "[", "t", "]"}], "/", 
          RowBox[{"Pt", "[", "t", "]"}]}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{"epsilonU", "[", "t", "]"}]}], ")"}]}], ")"}], "*", 
      RowBox[{"Y", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "4.", " ", "Fungsi", " ", "profit", " ", "total", " ", "periode", " ", 
     "t"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"profitRetail", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"revenue", "[", "t", "]"}], "-", 
      RowBox[{"costWholesale", "[", "t", "]"}], "-", 
      RowBox[{"adjCost", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
    "5.", " ", "Contoh", " ", "fungsi", " ", "objektif", " ", "dua", " ", 
     "periode"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"obj", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"revenue", "[", "t", "]"}], "-", 
        RowBox[{"costWholesale", "[", "t", "]"}], "-", 
        RowBox[{"adjCost", "[", "t", "]"}]}], ")"}], "+", 
      RowBox[{
       RowBox[{"betaR", "^", 
        RowBox[{"(", 
         RowBox[{"t", "+", "1"}], ")"}]}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"revenue", "[", 
          RowBox[{"t", "+", "1"}], "]"}], "-", 
         RowBox[{"costWholesale", "[", 
          RowBox[{"t", "+", "1"}], "]"}], "-", 
         RowBox[{"adjCost", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"6.", " ", "First"}], "-", 
     RowBox[{"order", " ", "condition", " ", "wrt", " ", 
      RowBox[{"Pj", "[", "t", "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focPjt", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"obj", ",", 
        RowBox[{"Pj", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], 
   "\[IndentingNewLine]", "focPjt", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.947087114500244*^9, 3.9470871163989105`*^9}, {
  3.9470871676026287`*^9, 3.9470871922291965`*^9}, {3.947087223790371*^9, 
  3.9470873702921944`*^9}, {3.9470874023732185`*^9, 3.947087413339325*^9}, {
  3.9470913294324627`*^9, 3.9470913359381046`*^9}, {3.94709139935532*^9, 
  3.9470914606802616`*^9}, {3.9470915357667885`*^9, 3.947091559078287*^9}, {
  3.9470916095928574`*^9, 3.947091637500084*^9}, {3.9473460120193176`*^9, 
  3.947346041941885*^9}, {3.947346107088167*^9, 3.9473461398450375`*^9}},
 CellLabel->
  "In[256]:=",ExpressionUUID->"fa04d5b8-3a30-3845-b5fc-decb17933490"],

Cell[BoxData[
 RowBox[{"\n", "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.9424252827947807`*^9, 3.9424879659349766`*^9, {3.9473471907510777`*^9, 
   3.947347191898058*^9}},ExpressionUUID->"52999333-fe05-e84a-acf1-\
fc22be5bf2ea"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.942508401042242*^9, 
  3.942508401044237*^9}},ExpressionUUID->"e44d3794-52ef-d540-95ab-\
731b5a7762cd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "1.", " ", "Clear", " ", "and", " ", "declare", " ", "all", " ", 
    "variables"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "Pj", ",", "Pt", ",", "PiVar", ",", "piStar", ",", "iota", ",", 
      "epsilonU", ",", "kappaP", ",", "betaR", ",", "Pw", ",", "Y", ",", 
      "t"}], "]"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "2.", " ", "Define", " ", "the", " ", "original", " ", "equation", " ", 
      "as", " ", "F", 
      RowBox[{"(", "...", ")"}]}], "==", "0"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{
     "Pj_", ",", "Pt_", ",", "PiVar_", ",", "epsilonU_", ",", "Pw_", ",", 
      "Y_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Pj", "/", "Pt"}], ")"}], "^", 
       RowBox[{"-", "epsilonU"}]}], " ", "Y"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"kappaP", " ", "Pj", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"piStar", "^", 
             RowBox[{"(", 
              RowBox[{"1", "-", "iota"}], ")"}]}]}], " ", 
           RowBox[{"PiVar", "^", "iota"}]}], "+", 
          RowBox[{"Pj", "/", "Pj"}]}], ")"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Pj", "/", "Pt"}], ")"}], "^", 
         RowBox[{"-", "epsilonU"}]}], " ", "Y"}], ")"}], "/", "Pj"}], "-", 
     RowBox[{
      RowBox[{"1", "/", "2"}], " ", "kappaP", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"piStar", "^", 
            RowBox[{"(", 
             RowBox[{"1", "-", "iota"}], ")"}]}]}], " ", 
          RowBox[{"PiVar", "^", "iota"}]}], "+", 
         RowBox[{"Pj", "/", "Pj"}]}], ")"}], "^", "2"}]}]}]}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Pj", "/", "Pt"}], ")"}], "^", 
       RowBox[{"-", "epsilonU"}]}], " ", "Y"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"epsilonU", " ", "Pj", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Pj", "/", "Pt"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "-", "epsilonU"}], ")"}]}], " ", "Y"}], ")"}], 
      "/", "Pt"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"kappaP", " ", "epsilonU", " ", "Pj", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"piStar", "^", 
              RowBox[{"(", 
               RowBox[{"1", "-", "iota"}], ")"}]}]}], " ", 
            RowBox[{"PiVar", "^", "iota"}]}], "+", 
           RowBox[{"Pj", "/", "Pj"}]}], ")"}], "^", "2"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Pj", "/", "Pt"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "-", "epsilonU"}], ")"}]}], " ", "Y"}], ")"}], 
      "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", "Pt"}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"epsilonU", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Pj", "/", "Pt"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "-", "epsilonU"}], ")"}]}], " ", "Pw", " ", 
        "Y"}], ")"}], "/", "Pt"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"betaR", " ", "kappaP", " ", 
        RowBox[{"Pj", "^", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"piStar", "^", 
             RowBox[{"(", 
              RowBox[{"1", "-", "iota"}], ")"}]}]}], " ", 
           RowBox[{"PiVar", "^", "iota"}]}], "+", 
          RowBox[{"Pj", "/", "Pj"}]}], ")"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Pj", "/", "Pt"}], ")"}], "^", 
         RowBox[{"-", "epsilonU"}]}], " ", "Y"}], ")"}], "/", 
      RowBox[{"Pj", "^", "2"}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "Print", " ", "the", " ", "function", " ", "before", " ", 
     "differentiation", " ", "to", " ", "ensure", " ", 
     RowBox[{"it", "'"}], "s", " ", "nonzero"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Function F before differentiation: \>\"", ",", 
      RowBox[{"F", "[", 
       RowBox[{
       "Pj", ",", "Pt", ",", "PiVar", ",", "epsilonU", ",", "Pw", ",", "Y"}], 
       "]"}]}], "]"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "4.", " ", "Collect", " ", "the", " ", "variables", " ", "to", " ", 
     "differentiate", " ", "with", " ", "respect", " ", "to"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{
      "Pj", ",", "Pt", ",", "PiVar", ",", "epsilonU", ",", "Pw", ",", "Y"}], 
      "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "5.", " ", "Compute", " ", "partial", " ", "derivatives", " ", "of", " ", 
     "F", " ", "at", " ", "the", " ", "steady", " ", "state"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Pj", "->", "PjBar"}], ",", 
          RowBox[{"Pt", "->", "PBar"}], ",", 
          RowBox[{"PiVar", "->", "PiBar"}], ",", 
          RowBox[{"epsilonU", "->", "epsilonUBar"}], ",", 
          RowBox[{"Pw", "->", "PwBar"}], ",", 
          RowBox[{"Y", "->", "YBar"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "6.", " ", "Print", " ", "Partial", " ", "Derivatives", " ", "to", " ", 
     "ensure", " ", "they", " ", "are", " ", "nonzero"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Partial Derivatives: \>\"", ",", "partials"}], "]"}], ";"}],
    "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"7.", " ", "Define", " ", "symbols", " ", "for", " ", "log"}], 
     "-", 
     RowBox[{"deviations", " ", 
      RowBox[{"(", 
       RowBox[{"d", " ", "ln", " ", "X"}], ")"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "PjHat", ",", "PHat", ",", "PiHat", ",", "epsilonUHat", ",", "PwHat", 
      ",", "YHat"}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "8.", " ", "Multiply", " ", "each", " ", "partial", " ", "by", " ", 
     "XBar", "*", 
     RowBox[{"(", 
      RowBox[{"hat", " ", "variable"}], ")"}], " ", "to", " ", "get", " ", 
     "the", " ", "linearized", " ", "equation"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"varsBar", "=", 
     RowBox[{"{", 
      RowBox[{
      "PjBar", ",", "PBar", ",", "PiBar", ",", "epsilonUBar", ",", "PwBar", 
       ",", "YBar"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", "PjBar", "*", "PjHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", "PBar", "*", "PHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", "PiBar", "*", "PiHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "*", "epsilonUBar", "*", 
        "epsilonUHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "*", "PwBar", "*", "PwHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "*", "YBar", "*", "YHat"}]}], "==", 
      "0"}]}], ";"}], "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"10.", " ", "Display", " ", "the", " ", "log"}], "-", 
     RowBox[{"linearized", " ", "equation", " ", "explicitly"}]}], "*)"}], 
   "\n", 
   RowBox[{"sim", "=", 
    RowBox[{"Simplify", "[", "logLinEq", "]"}]}], "\n", "sim", " ", 
   "\[IndentingNewLine]", "\n"}]}]], "Input",
 CellChangeTimes->{
  3.942425871529419*^9, 3.942426101584881*^9, 3.9424261402649555`*^9, 
   3.9473466087112083`*^9, {3.947346779662201*^9, 3.947346796649639*^9}, 
   3.947346964656801*^9, {3.9473470205344906`*^9, 3.9473470595561905`*^9}, 
   3.9473471027397194`*^9},
 CellLabel->
  "In[322]:=",ExpressionUUID->"28629b7d-e028-5846-af8b-9f2b85a1dc47"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Function F before differentiation: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", "kappaP", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{
         SuperscriptBox["piStar", 
          RowBox[{"1", "-", "iota"}]], " ", 
         SuperscriptBox["PiVar", "iota"]}]}], ")"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["Pj", "Pt"], ")"}], 
      RowBox[{"-", "epsilonU"}]], " ", "Y"}], "-", 
    RowBox[{"kappaP", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{
        SuperscriptBox["piStar", 
         RowBox[{"1", "-", "iota"}]], " ", 
        SuperscriptBox["PiVar", "iota"]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["Pj", "Pt"], ")"}], 
      RowBox[{"-", "epsilonU"}]], " ", "Y"}]}]}],
  SequenceForm[
  "Function F before differentiation: ", 
   Rational[-1, 2] $CellContext`kappaP (
      1 - $CellContext`piStar^(
        1 - $CellContext`iota) $CellContext`PiVar^$CellContext`iota)^2 + \
($CellContext`Pj/$CellContext`Pt)^(-$CellContext`epsilonU) $CellContext`Y - \
$CellContext`kappaP (
    1 - $CellContext`piStar^(
      1 - $CellContext`iota) $CellContext`PiVar^$CellContext`iota) \
($CellContext`Pj/$CellContext`Pt)^(-$CellContext`epsilonU) $CellContext`Y],
  Editable->False]], "Print",
 CellChangeTimes->{3.9473472226652184`*^9},
 CellLabel->
  "During evaluation of \
In[322]:=",ExpressionUUID->"266276f2-886f-1147-ad11-3efe338cb8d1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Partial Derivatives: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"epsilonUBar", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["PjBar", "PBar"], ")"}], 
          RowBox[{
           RowBox[{"-", "1"}], "-", "epsilonUBar"}]], " ", "YBar"}], 
        "PBar"]}], "+", 
      FractionBox[
       RowBox[{"epsilonUBar", " ", "kappaP", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           SuperscriptBox["PiBar", "iota"], " ", 
           SuperscriptBox["piStar", 
            RowBox[{"1", "-", "iota"}]]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["PjBar", "PBar"], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "-", "epsilonUBar"}]], " ", "YBar"}], "PBar"]}],
      ",", 
     RowBox[{
      FractionBox[
       RowBox[{"epsilonUBar", " ", "PjBar", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["PjBar", "PBar"], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "-", "epsilonUBar"}]], " ", "YBar"}], 
       SuperscriptBox["PBar", "2"]], "-", 
      FractionBox[
       RowBox[{"epsilonUBar", " ", "kappaP", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           SuperscriptBox["PiBar", "iota"], " ", 
           SuperscriptBox["piStar", 
            RowBox[{"1", "-", "iota"}]]}]}], ")"}], " ", "PjBar", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["PjBar", "PBar"], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "-", "epsilonUBar"}]], " ", "YBar"}], 
       SuperscriptBox["PBar", "2"]]}], ",", 
     RowBox[{
      RowBox[{"iota", " ", "kappaP", " ", 
       SuperscriptBox["PiBar", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "iota"}]], " ", 
       SuperscriptBox["piStar", 
        RowBox[{"1", "-", "iota"}]], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox["PiBar", "iota"], " ", 
          SuperscriptBox["piStar", 
           RowBox[{"1", "-", "iota"}]]}]}], ")"}]}], "+", 
      RowBox[{"iota", " ", "kappaP", " ", 
       SuperscriptBox["PiBar", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "iota"}]], " ", 
       SuperscriptBox["piStar", 
        RowBox[{"1", "-", "iota"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["PjBar", "PBar"], ")"}], 
        RowBox[{"-", "epsilonUBar"}]], " ", "YBar"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["PjBar", "PBar"], ")"}], 
         RowBox[{"-", "epsilonUBar"}]]}], " ", "YBar", " ", 
       RowBox[{"Log", "[", 
        FractionBox["PjBar", "PBar"], "]"}]}], "+", 
      RowBox[{"kappaP", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox["PiBar", "iota"], " ", 
          SuperscriptBox["piStar", 
           RowBox[{"1", "-", "iota"}]]}]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["PjBar", "PBar"], ")"}], 
        RowBox[{"-", "epsilonUBar"}]], " ", "YBar", " ", 
       RowBox[{"Log", "[", 
        FractionBox["PjBar", "PBar"], "]"}]}]}], ",", "0", ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["PjBar", "PBar"], ")"}], 
       RowBox[{"-", "epsilonUBar"}]], "-", 
      RowBox[{"kappaP", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox["PiBar", "iota"], " ", 
          SuperscriptBox["piStar", 
           RowBox[{"1", "-", "iota"}]]}]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["PjBar", "PBar"], ")"}], 
        RowBox[{"-", "epsilonUBar"}]]}]}]}], "}"}]}],
  SequenceForm[
  "Partial Derivatives: ", {-$CellContext`epsilonUBar $CellContext`PBar^(-1) \
($CellContext`PBar^(-1) $CellContext`PjBar)^(-1 - $CellContext`epsilonUBar) \
$CellContext`YBar + $CellContext`epsilonUBar $CellContext`kappaP \
$CellContext`PBar^(-1) (
      1 - $CellContext`PiBar^$CellContext`iota $CellContext`piStar^(
        1 - $CellContext`iota)) ($CellContext`PBar^(-1) \
$CellContext`PjBar)^(-1 - $CellContext`epsilonUBar) $CellContext`YBar, \
$CellContext`epsilonUBar $CellContext`PBar^(-2) $CellContext`PjBar \
($CellContext`PBar^(-1) $CellContext`PjBar)^(-1 - $CellContext`epsilonUBar) \
$CellContext`YBar - $CellContext`epsilonUBar $CellContext`kappaP \
$CellContext`PBar^(-2) (
     1 - $CellContext`PiBar^$CellContext`iota $CellContext`piStar^(
       1 - $CellContext`iota)) $CellContext`PjBar ($CellContext`PBar^(-1) \
$CellContext`PjBar)^(-1 - $CellContext`epsilonUBar) $CellContext`YBar, \
$CellContext`iota $CellContext`kappaP $CellContext`PiBar^(-1 + \
$CellContext`iota) $CellContext`piStar^(1 - $CellContext`iota) (
      1 - $CellContext`PiBar^$CellContext`iota $CellContext`piStar^(
        1 - $CellContext`iota)) + $CellContext`iota $CellContext`kappaP \
$CellContext`PiBar^(-1 + $CellContext`iota) $CellContext`piStar^(
       1 - $CellContext`iota) ($CellContext`PBar^(-1) \
$CellContext`PjBar)^(-$CellContext`epsilonUBar) $CellContext`YBar, \
-($CellContext`PBar^(-1) $CellContext`PjBar)^(-$CellContext`epsilonUBar) \
$CellContext`YBar 
     Log[$CellContext`PBar^(-1) $CellContext`PjBar] + $CellContext`kappaP (
      1 - $CellContext`PiBar^$CellContext`iota $CellContext`piStar^(
        1 - $CellContext`iota)) ($CellContext`PBar^(-1) \
$CellContext`PjBar)^(-$CellContext`epsilonUBar) $CellContext`YBar 
     Log[$CellContext`PBar^(-1) $CellContext`PjBar], 
    0, ($CellContext`PBar^(-1) \
$CellContext`PjBar)^(-$CellContext`epsilonUBar) - $CellContext`kappaP (
     1 - $CellContext`PiBar^$CellContext`iota $CellContext`piStar^(
       1 - $CellContext`iota)) ($CellContext`PBar^(-1) \
$CellContext`PjBar)^(-$CellContext`epsilonUBar)}],
  Editable->False]], "Print",
 CellChangeTimes->{3.947347222672167*^9},
 CellLabel->
  "During evaluation of \
In[322]:=",ExpressionUUID->"0f6d1057-7fe5-9d45-9b55-0d658d31c615"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["piStar", 
    RowBox[{"-", "iota"}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["PjBar", "PBar"], ")"}], 
    RowBox[{"-", "epsilonUBar"}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"iota", " ", "kappaP", " ", 
      SuperscriptBox["PiBar", "iota"], " ", "PiHat", " ", "piStar", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["PiBar", "iota"], " ", "piStar", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["PjBar", "PBar"], ")"}], "epsilonUBar"]}], "-", 
        RowBox[{
         SuperscriptBox["piStar", "iota"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox["PjBar", "PBar"], ")"}], "epsilonUBar"], "+", 
           "YBar"}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["piStar", "iota"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["piStar", "iota"]}], "+", 
        RowBox[{"kappaP", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["PiBar", "iota"]}], " ", "piStar"}], "+", 
           SuperscriptBox["piStar", "iota"]}], ")"}]}]}], ")"}], " ", "YBar", 
      " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"epsilonUBar", " ", 
         RowBox[{"(", 
          RowBox[{"PHat", "-", "PjHat"}], ")"}]}], "+", "YHat"}], ")"}]}], 
     "-", 
     RowBox[{"epsilonUBar", " ", "epsilonUHat", " ", 
      SuperscriptBox["piStar", "iota"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["piStar", "iota"]}], "+", 
        RowBox[{"kappaP", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["PiBar", "iota"]}], " ", "piStar"}], "+", 
           SuperscriptBox["piStar", "iota"]}], ")"}]}]}], ")"}], " ", "YBar", 
      " ", 
      RowBox[{"Log", "[", 
       FractionBox["PjBar", "PBar"], "]"}]}]}], ")"}]}], "\[Equal]", 
  "0"}]], "Output",
 CellChangeTimes->{3.9473472226801434`*^9},
 CellLabel->
  "Out[332]=",ExpressionUUID->"773b9cec-893a-3549-949e-e610be901258"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["piStar", 
    RowBox[{"-", "iota"}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["PjBar", "PBar"], ")"}], 
    RowBox[{"-", "epsilonUBar"}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"iota", " ", "kappaP", " ", 
      SuperscriptBox["PiBar", "iota"], " ", "PiHat", " ", "piStar", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["PiBar", "iota"], " ", "piStar", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["PjBar", "PBar"], ")"}], "epsilonUBar"]}], "-", 
        RowBox[{
         SuperscriptBox["piStar", "iota"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox["PjBar", "PBar"], ")"}], "epsilonUBar"], "+", 
           "YBar"}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["piStar", "iota"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["piStar", "iota"]}], "+", 
        RowBox[{"kappaP", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["PiBar", "iota"]}], " ", "piStar"}], "+", 
           SuperscriptBox["piStar", "iota"]}], ")"}]}]}], ")"}], " ", "YBar", 
      " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"epsilonUBar", " ", 
         RowBox[{"(", 
          RowBox[{"PHat", "-", "PjHat"}], ")"}]}], "+", "YHat"}], ")"}]}], 
     "-", 
     RowBox[{"epsilonUBar", " ", "epsilonUHat", " ", 
      SuperscriptBox["piStar", "iota"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["piStar", "iota"]}], "+", 
        RowBox[{"kappaP", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["PiBar", "iota"]}], " ", "piStar"}], "+", 
           SuperscriptBox["piStar", "iota"]}], ")"}]}]}], ")"}], " ", "YBar", 
      " ", 
      RowBox[{"Log", "[", 
       FractionBox["PjBar", "PBar"], "]"}]}]}], ")"}]}], "\[Equal]", 
  "0"}]], "Output",
 CellChangeTimes->{3.947347222690117*^9},
 CellLabel->
  "Out[333]=",ExpressionUUID->"8ae5cdf6-1190-4f40-9152-a68e03d827b8"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.942508459698223*^9},
 NumberMarks->False,ExpressionUUID->"e55264a3-3c28-884f-aa83-8e502c7364cc"],

Cell[BoxData[
 RowBox[{"\n", "\n"}]], "Input",
 CellChangeTimes->{{3.9425084730478153`*^9, 3.942508473048811*^9}, 
   3.94734526561899*^9, {3.9473454472950974`*^9, 3.94734546079821*^9}, {
   3.9473455389445477`*^9, 3.947345559212368*^9}, 
   3.9473464702379875`*^9},ExpressionUUID->"53dfc11f-fccd-cd48-934d-\
0bdae6dc2306"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.942508490141901*^9},
 NumberMarks->False,ExpressionUUID->"4872fec1-2e2d-8f47-88e7-ab3bbb9b5585"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.942508502797901*^9, 
  3.9425085027990284`*^9}},ExpressionUUID->"4cec27a2-cefe-5d4d-80b5-\
b6621fdb0cf4"],

Cell[BoxData[""], "Input",ExpressionUUID->"7ac59aaa-0927-bb4e-a803-639587cde41b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9424200456002064`*^9, 3.942420045601204*^9}, 
   3.9424203234497356`*^9},ExpressionUUID->"924a110a-67bc-4749-9189-\
169660317c54"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9425082473900776`*^9, 
  3.9425082473911057`*^9}},ExpressionUUID->"65b3d420-0425-f249-80e5-\
5dc6a13ce3c4"],

Cell[BoxData[""], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"c41eee93-8b45-4c47-8d30-e7d8dc6d4ab1"],

Cell[BoxData[""], "Input",ExpressionUUID->"4b97082b-f52c-d940-8b60-cf5f1725bfda"]
},
WindowSize->{1380.75, 765.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"14.1 for Microsoft Windows (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"cbc78bb6-c411-c243-8fb9-e034a4f1496b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 5081, 70, 47, "Input",ExpressionUUID->"f9fb2cec-0218-1946-a7a4-614cfc63c79f"],
Cell[5638, 92, 81, 0, 28, "Input",ExpressionUUID->"93063096-b854-5642-83fe-da57c1f294a1"],
Cell[5722, 94, 81, 0, 28, "Input",ExpressionUUID->"0708fca9-59ce-8847-af89-18fc69779938"],
Cell[CellGroupData[{
Cell[5828, 98, 6342, 176, 446, "Input",ExpressionUUID->"9ace75de-4978-4347-8abf-940e21a736de"],
Cell[CellGroupData[{
Cell[12195, 278, 506, 10, 22, "Print",ExpressionUUID->"3180c1ab-5e0d-ca40-9394-5e86f56408d7"],
Cell[12704, 290, 428, 9, 22, "Print",ExpressionUUID->"cba57453-8210-be49-9e99-e7c7a95b445f"]
}, Open  ]]
}, Open  ]],
Cell[13159, 303, 1339, 35, 180, "Input",ExpressionUUID->"6cbdf14f-fcad-b24a-9b64-6f911cd48fed"],
Cell[CellGroupData[{
Cell[14523, 342, 301, 6, 66, "Input",ExpressionUUID->"4978f1f1-0572-b84b-b184-a61a2eb98030"],
Cell[CellGroupData[{
Cell[14849, 352, 402, 8, 22, "Print",ExpressionUUID->"3b40c5c1-cbf0-244a-912a-65c58f9ab2e4"],
Cell[15254, 362, 356, 8, 22, "Print",ExpressionUUID->"3dd3e17b-7b29-3d40-970d-7f04b4476b62"]
}, Open  ]]
}, Open  ]],
Cell[15637, 374, 4607, 133, 370, "Input",ExpressionUUID->"aec07186-9953-eb4b-a898-e758c5d4aabf"],
Cell[20247, 509, 9571, 273, 548, "Input",ExpressionUUID->"dc40e394-a162-e344-af1c-469b5ff19c55"],
Cell[29821, 784, 335, 5, 28, "Input",ExpressionUUID->"5a156fc5-2eb4-7e48-b51d-4ec8fa2678b1"],
Cell[30159, 791, 404, 6, 47, "Input",ExpressionUUID->"f6161ecb-49e3-0c4a-ab4f-763494e1bca1"],
Cell[CellGroupData[{
Cell[30588, 801, 385, 6, 28, "Input",ExpressionUUID->"184313ad-6fee-e246-a53e-3bc49837b331"],
Cell[30976, 809, 328, 7, 22, "Print",ExpressionUUID->"bd798fe7-18dc-194b-9c9c-5302cebc1728"]
}, Open  ]],
Cell[31319, 819, 174, 3, 47, "Input",ExpressionUUID->"3224bd35-aa5b-8741-8dba-9ef0919b61c3"],
Cell[31496, 824, 4917, 139, 446, "Input",ExpressionUUID->"a990b75f-fbd3-234f-adb3-956cce978ab4"],
Cell[36416, 965, 207, 4, 47, "Input",ExpressionUUID->"47471645-8bf1-b64e-971f-adb6528fec4a"],
Cell[36626, 971, 81, 0, 28, "Input",ExpressionUUID->"69f768ce-3b26-b640-b21c-b0339f219c5e"],
Cell[36710, 973, 139, 2, 28, "Input",ExpressionUUID->"9e0d05d0-5fdf-944e-97f6-884be9bc4fd5"],
Cell[36852, 977, 139, 2, 28, "Input",ExpressionUUID->"1d5db560-18c8-3845-bae1-e95058242b47"],
Cell[36994, 981, 228, 5, 28, "Input",ExpressionUUID->"483b27fc-4b8e-9c46-8db4-040fdf9ca070"],
Cell[37225, 988, 10164, 247, 541, "Input",ExpressionUUID->"94fcf45b-6f21-634c-b1d5-7d0ae8a5c58d"],
Cell[47392, 1237, 81, 0, 28, "Input",ExpressionUUID->"b9ef39e2-d105-c74c-ae1b-589fe4deab77"],
Cell[47476, 1239, 379, 7, 104, "Input",ExpressionUUID->"8880107c-6260-f84b-9c38-4d69438e0d38"],
Cell[47858, 1248, 9984, 243, 751, "Input",ExpressionUUID->"b0b5f86b-cc2e-e04d-b2ed-4360d9e5fb4f"],
Cell[57845, 1493, 9147, 222, 408, "Input",ExpressionUUID->"5b2a032a-505e-c740-a415-a5a50f903e5d"],
Cell[66995, 1717, 6423, 146, 427, "Input",ExpressionUUID->"0e074e25-5497-e244-8216-c9871e946f7c"],
Cell[73421, 1865, 2382, 33, 28, "Input",ExpressionUUID->"a67f113d-d41d-d24a-8f3f-b4722fe41f74"],
Cell[75806, 1900, 11150, 279, 732, "Input",ExpressionUUID->"24e808de-ed6a-4146-a49a-28e49cf93adc"],
Cell[86959, 2181, 156, 3, 28, "Input",ExpressionUUID->"4129f409-7408-7d45-9299-8b83db08acfc"],
Cell[87118, 2186, 15665, 435, 1036, "Input",ExpressionUUID->"e52c92a4-2eb6-c645-94b2-60c371363739"],
Cell[102786, 2623, 602, 10, 47, "Input",ExpressionUUID->"f19b7f51-99bd-4547-9650-5ff8e4c33086"],
Cell[103391, 2635, 6383, 178, 427, "Input",ExpressionUUID->"e2c58ebf-4fbc-3d4b-ac91-cf15352134a5"],
Cell[109777, 2815, 81, 0, 28, "Input",ExpressionUUID->"b88ee315-af2d-ad44-b33b-38496d3a52d4"],
Cell[109861, 2817, 175, 3, 28, "Input",ExpressionUUID->"4126ecf3-b2bc-c34e-b9ce-ab3dbe467b58"],
Cell[110039, 2822, 7112, 198, 446, "Input",ExpressionUUID->"e455865f-d51a-c546-92e4-fe2425237d2b"],
Cell[117154, 3022, 4645, 125, 408, "Input",ExpressionUUID->"0ee05957-9f4b-5148-9577-73fb4d317e3e"],
Cell[121802, 3149, 6958, 193, 637, "Input",ExpressionUUID->"d50ef5dd-7d10-9347-8ed7-e6a9098ab778"],
Cell[128763, 3344, 949, 14, 28, "Input",ExpressionUUID->"a5650fd1-18d4-1d4e-89f1-7b4f1f908005"],
Cell[129715, 3360, 81, 0, 28, "Input",ExpressionUUID->"ad54bf90-5079-e447-887e-2c9f31b492f1"],
Cell[129799, 3362, 156, 3, 47, "Input",ExpressionUUID->"9179d0fc-bd3a-474d-81a0-4d1659297c19"],
Cell[129958, 3367, 204, 4, 47, "Input",ExpressionUUID->"90347a46-5dbd-b54f-8f1e-a6938e1fe31a"],
Cell[130165, 3373, 3849, 101, 313, "Input",ExpressionUUID->"d48f496e-7176-4c4a-84fa-2b0987060b46"],
Cell[134017, 3476, 4748, 125, 292, "Input",ExpressionUUID->"16a53433-1cc7-e74a-b3e2-121a43b05c36"],
Cell[138768, 3603, 209, 4, 47, "Input",ExpressionUUID->"0d88e268-8e18-e44d-b2d8-cdf7e7401492"],
Cell[138980, 3609, 4596, 111, 351, "Input",ExpressionUUID->"040b9176-9fb1-6c42-b2d6-b57a6d9f6770"],
Cell[143579, 3722, 154, 3, 28, "Input",ExpressionUUID->"415c207e-69ac-8e4e-b60e-cce02daeab93"],
Cell[143736, 3727, 552, 8, 47, "Input",ExpressionUUID->"8331c5f9-92bc-9347-8078-669c615e9f37"],
Cell[144291, 3737, 5106, 134, 427, "Input",ExpressionUUID->"046d3eeb-8f2b-d440-bb6b-57fa6e32ad17"],
Cell[149400, 3873, 253, 4, 47, "Input",ExpressionUUID->"65474464-fc4d-bb45-8abd-61b05ca4d665"],
Cell[149656, 3879, 81, 0, 28, "Input",ExpressionUUID->"4c545160-c5fd-2b4b-a2e7-6c177e37cc74"],
Cell[149740, 3881, 5032, 138, 427, "Input",ExpressionUUID->"283b5187-a2f1-ef49-b5fd-690301eeecfb"],
Cell[154775, 4021, 152, 3, 28, "Input",ExpressionUUID->"79788ce8-4cec-0840-aa08-3875ff1d3e80"],
Cell[154930, 4026, 154, 3, 28, "Input",ExpressionUUID->"f0ade162-6b1f-0f48-a2c9-2be142b63af0"],
Cell[155087, 4031, 5841, 157, 522, "Input",ExpressionUUID->"fa04d5b8-3a30-3845-b5fc-decb17933490"],
Cell[160931, 4190, 266, 5, 85, "Input",ExpressionUUID->"52999333-fe05-e84a-acf1-fc22be5bf2ea"],
Cell[161200, 4197, 152, 3, 28, "Input",ExpressionUUID->"e44d3794-52ef-d540-95ab-731b5a7762cd"],
Cell[CellGroupData[{
Cell[161377, 4204, 8993, 251, 675, "Input",ExpressionUUID->"28629b7d-e028-5846-af8b-9f2b85a1dc47"],
Cell[CellGroupData[{
Cell[170395, 4459, 1601, 44, 36, "Print",ExpressionUUID->"266276f2-886f-1147-ad11-3efe338cb8d1"],
Cell[171999, 4505, 6129, 151, 167, "Print",ExpressionUUID->"0f6d1057-7fe5-9d45-9b55-0d658d31c615"]
}, Open  ]],
Cell[178143, 4659, 2250, 67, 121, "Output",ExpressionUUID->"773b9cec-893a-3549-949e-e610be901258"],
Cell[180396, 4728, 2248, 67, 165, "Output",ExpressionUUID->"8ae5cdf6-1190-4f40-9152-a68e03d827b8"]
}, Open  ]],
Cell[182659, 4798, 144, 2, 28, "Input",ExpressionUUID->"e55264a3-3c28-884f-aa83-8e502c7364cc"],
Cell[182806, 4802, 323, 6, 66, "Input",ExpressionUUID->"53dfc11f-fccd-cd48-934d-0bdae6dc2306"],
Cell[183132, 4810, 144, 2, 28, "Input",ExpressionUUID->"4872fec1-2e2d-8f47-88e7-ab3bbb9b5585"],
Cell[183279, 4814, 154, 3, 28, "Input",ExpressionUUID->"4cec27a2-cefe-5d4d-80b5-b6621fdb0cf4"],
Cell[183436, 4819, 81, 0, 28, "Input",ExpressionUUID->"7ac59aaa-0927-bb4e-a803-639587cde41b"],
Cell[183520, 4821, 179, 3, 28, "Input",ExpressionUUID->"924a110a-67bc-4749-9189-169660317c54"],
Cell[183702, 4826, 156, 3, 28, "Input",ExpressionUUID->"65b3d420-0425-f249-80e5-5dc6a13ce3c4"],
Cell[183861, 4831, 104, 1, 28, "Input",ExpressionUUID->"c41eee93-8b45-4c47-8d30-e7d8dc6d4ab1"],
Cell[183968, 4834, 81, 0, 28, "Input",ExpressionUUID->"4b97082b-f52c-d940-8b60-cf5f1725bfda"]
}
]
*)

