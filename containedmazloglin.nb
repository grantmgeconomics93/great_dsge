(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     62656,       1516]
NotebookOptionsPosition[     58555,       1461]
NotebookOutlinePosition[     58958,       1477]
CellTagsIndexPosition[     58915,       1474]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.9424097710067005`*^9, 3.9424097735303288`*^9}, 
   3.942409986837412*^9, {3.942410224952446*^9, 3.942410250698843*^9}, 
   3.942414205266445*^9, 3.9424171668779297`*^9, 3.942419692092272*^9, 
   3.9424204177254696`*^9, 3.9424204789909916`*^9, {3.942420720045725*^9, 
   3.942420728957245*^9}, {3.9424208281063786`*^9, 3.9424208471915607`*^9}, {
   3.942420880106722*^9, 3.942420886782583*^9}, 3.9424222361942863`*^9, {
   3.942423052980547*^9, 3.9424230739505024`*^9}, 3.942423164222044*^9, 
   3.9424232036387615`*^9, {3.9424232833174133`*^9, 3.942423307845436*^9}, {
   3.942423342657379*^9, 3.942423370843012*^9}, {3.9424235561691933`*^9, 
   3.942423573217308*^9}, 3.9424237825038567`*^9, 3.942423914171425*^9, 
   3.94248768227162*^9, 3.942502868082756*^9, 3.942503100647709*^9, 
   3.942503140525156*^9, 3.9425046010225945`*^9, {3.9425052399102135`*^9, 
   3.9425052421572056`*^9}, {3.9425064032796345`*^9, 3.9425064272894344`*^9}, 
   3.94250658942535*^9, 3.9425067828417664`*^9, 3.942506854326124*^9, {
   3.9425079465509777`*^9, 3.94250799672328*^9}, 3.9425081754514484`*^9, 
   3.942510581203039*^9, {3.942511009251314*^9, 3.942511017852148*^9}, {
   3.942511221733576*^9, 3.9425112586265945`*^9}, 3.9425117108579197`*^9, 
   3.9425117602628727`*^9, {3.942511856447809*^9, 3.9425119345891457`*^9}, 
   3.9425122263945293`*^9, {3.942512955427664*^9, 3.9425129698917313`*^9}, {
   3.94251301365139*^9, 3.9425130307669353`*^9}, {3.942513108585476*^9, 
   3.942513112112303*^9}, {3.9425135466473694`*^9, 3.942513556385315*^9}, {
   3.942513868974186*^9, 3.942513921787203*^9}, {3.9425139580605755`*^9, 
   3.9425139700600357`*^9}, 3.9425140419308376`*^9, {3.942514134970972*^9, 
   3.9425141648856773`*^9}, {3.9425141998729115`*^9, 
   3.9425142444404106`*^9}, {3.9425142927988625`*^9, 3.942514303916441*^9}, {
   3.9425148598096733`*^9, 3.9425148712374344`*^9}, {3.942514910480751*^9, 
   3.942514917020756*^9}, {3.942514973867367*^9, 3.9425150148147144`*^9}, 
   3.9425161769270763`*^9, 3.9425162112263985`*^9, {3.9425166428949184`*^9, 
   3.942516672205147*^9}, {3.942517042567255*^9, 3.9425170621009064`*^9}, {
   3.9425171674338245`*^9, 3.9425171874190807`*^9}, 3.942517223580761*^9, 
   3.9425173582750072`*^9, 3.942517406842678*^9, {3.9425176475276356`*^9, 
   3.942517664750183*^9}, {3.942517718150387*^9, 3.942517744371004*^9}, {
   3.9425178154654617`*^9, 3.942517834731922*^9}, 3.942517913433714*^9, 
   3.942518014903372*^9, {3.9425881118939304`*^9, 3.942588226554573*^9}, {
   3.9425896390154*^9, 3.942589660098751*^9}, {3.9425905522714367`*^9, 
   3.942590594677908*^9}, {3.9425911684561577`*^9, 3.9425911698701305`*^9}, 
   3.942751573759756*^9, 3.942751621808159*^9, 3.9427516680874004`*^9, {
   3.9427517329189034`*^9, 3.9427517351424484`*^9}, {3.9427519255838013`*^9, 
   3.9427519869494553`*^9}, 3.9427520332742233`*^9, 3.942752333177307*^9, {
   3.942752770986908*^9, 3.9427527730965176`*^9}, {3.94275302368054*^9, 
   3.942753025683384*^9}, {3.9428474340546665`*^9, 3.9428474362622166`*^9}, {
   3.9428483214733906`*^9, 3.942848362170891*^9}, 3.9428484049196663`*^9, 
   3.942848454450346*^9, {3.9428490839405823`*^9, 3.942849160084255*^9}, {
   3.942849213918829*^9, 3.942849287185663*^9}, {3.9428493507735596`*^9, 
   3.942849353695465*^9}, 3.9428493846297016`*^9, {3.942850052822735*^9, 
   3.9428500750204296`*^9}, {3.9428501420583496`*^9, 
   3.9428501459492645`*^9}, {3.9428503972435436`*^9, 
   3.9428504100488663`*^9}, {3.942853049260662*^9, 3.9428530504676895`*^9}, {
   3.942853092458111*^9, 3.9428531192472134`*^9}, {3.942853353568598*^9, 
   3.9428533545898075`*^9}, {3.9428533987449627`*^9, 
   3.9428534229557915`*^9}, {3.9429231648091373`*^9, 3.942923166138708*^9}, {
   3.9429246809890385`*^9, 3.942924683690712*^9}, {3.9429247321913033`*^9, 
   3.942924732889475*^9}, {3.9429254250561047`*^9, 3.9429254513153687`*^9}, 
   3.9429254838702602`*^9, {3.9429255434986267`*^9, 3.942925560423479*^9}, {
   3.942925616054928*^9, 3.942925642339443*^9}, {3.9429261874701004`*^9, 
   3.9429262104446373`*^9}, {3.942926484765465*^9, 3.942926497715992*^9}, {
   3.94292658112232*^9, 3.9429265839319725`*^9}, {3.9429267900613174`*^9, 
   3.9429267947414474`*^9}, 3.9429268487589626`*^9, {3.94293422696509*^9, 
   3.9429342288360386`*^9}, {3.9429343606643944`*^9, 
   3.9429343661244335`*^9}, {3.942934751577406*^9, 3.9429347571734104`*^9}, {
   3.9429348102113075`*^9, 3.942934825030098*^9}, 3.9429349712800045`*^9, {
   3.942935395628916*^9, 3.9429354119468803`*^9}, {3.942935638691334*^9, 
   3.9429356840764217`*^9}, 3.9429360778661404`*^9, {3.9429361132493095`*^9, 
   3.9429361676882057`*^9}, {3.942936520458252*^9, 3.942936526243181*^9}, {
   3.9429461492206955`*^9, 3.9429461723246975`*^9}, {3.943008575399826*^9, 
   3.943008584860981*^9}, {3.943012952041334*^9, 3.9430129533912315`*^9}, {
   3.9430272878138313`*^9, 3.9430272905139027`*^9}, 3.943106855318901*^9, {
   3.943373167306566*^9, 
   3.943373172855282*^9}},ExpressionUUID->"f9fb2cec-0218-1946-a7a4-\
614cfc63c79f"],

Cell[BoxData[""], "Input",ExpressionUUID->"93063096-b854-5642-83fe-da57c1f294a1"],

Cell[BoxData[""], "Input",ExpressionUUID->"0708fca9-59ce-8847-af89-18fc69779938"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"patient", " ", "households", " ", "Lagrange"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "Parameters", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"params", "=", 
    RowBox[{"{", 
     RowBox[{
     "betaP", ",", "alpha", ",", "xiP", ",", "epsilonP", ",", "phi", ",", 
      "qh", ",", 
      RowBox[{"wt", "[", "t", "]"}], ",", 
      RowBox[{"rt", "[", "t", "]"}], ",", 
      RowBox[{"pit", "[", "t", "]"}], ",", 
      RowBox[{"cp", "[", "t", "]"}], ",", 
      RowBox[{"dp", "[", "t", "]"}], ",", 
      RowBox[{"hp", "[", "t", "]"}]}], "}"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Utility", " ", "function", " ", "for", " ", "patient", " ", 
    "households"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uPatient", "[", 
     RowBox[{"cp_", ",", "cpLag_", ",", "hp_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "alpha"}], ")"}], " ", "xiP", " ", 
      RowBox[{"Log", "[", 
       RowBox[{"cp", "-", 
        RowBox[{"a", " ", "cpLag"}]}], "]"}]}], "+", 
     RowBox[{"epsilonP", " ", 
      RowBox[{"Log", "[", "hp", "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"hp", "^", 
        RowBox[{"(", 
         RowBox[{"1", "+", "phi"}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", "phi"}], ")"}]}]}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Budget", " ", "constraint", " ", "for", " ", "patient", " ", "households",
     " ", "in", " ", "period", " ", "t"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BCPatient", "[", "t_", "]"}], ":=", 
    RowBox[{
     RowBox[{"cp", "[", "t", "]"}], "+", 
     RowBox[{"qh", " ", 
      RowBox[{"hp", "[", "t", "]"}]}], "+", 
     RowBox[{"dp", "[", "t", "]"}], "-", 
     RowBox[{
      RowBox[{"wt", "[", "t", "]"}], " ", 
      RowBox[{"hp", "[", "t", "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"rt", "[", 
           RowBox[{"t", "-", "1"}], "]"}]}], ")"}], "/", 
        RowBox[{"pit", "[", "t", "]"}]}], ")"}], " ", 
      RowBox[{"dp", "[", 
       RowBox[{"t", "-", "1"}], "]"}]}]}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Define", " ", "Lagrangian", " ", "for", " ", "two", " ", "periods", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"t", " ", "and", " ", "t"}], "+", "1"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LP", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"uPatient", "[", 
        RowBox[{
         RowBox[{"cp", "[", "t", "]"}], ",", 
         RowBox[{"cp", "[", 
          RowBox[{"t", "-", "1"}], "]"}], ",", 
         RowBox[{"hp", "[", "t", "]"}]}], "]"}], "+", 
       RowBox[{
        RowBox[{"lambdaP", "[", "t", "]"}], "*", 
        RowBox[{"BCPatient", "[", "t", "]"}]}]}], ")"}], "+", 
     RowBox[{
      RowBox[{"betaP", "^", 
       RowBox[{"(", 
        RowBox[{"t", "+", "1"}], ")"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"uPatient", "[", 
         RowBox[{
          RowBox[{"cp", "[", 
           RowBox[{"t", "+", "1"}], "]"}], ",", 
          RowBox[{"cp", "[", "t", "]"}], ",", 
          RowBox[{"hp", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{"lambdaP", "[", 
          RowBox[{"t", "+", "1"}], "]"}], "*", 
         RowBox[{"BCPatient", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}]}], ")"}]}]}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"First", "-", 
    RowBox[{
    "order", " ", "conditions", " ", "for", " ", "patient", " ", 
     "households"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"focPCt", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"LP", ",", 
       RowBox[{"cp", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], 
  "        ", 
  RowBox[{"(*", 
   RowBox[{"FOC", " ", "with", " ", "respect", " ", "to", " ", 
    RowBox[{"cp", "[", "t", "]"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"focPHt", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"LP", ",", 
       RowBox[{"hp", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], 
  "        ", 
  RowBox[{"(*", 
   RowBox[{"FOC", " ", "with", " ", "respect", " ", "to", " ", 
    RowBox[{"hp", "[", "t", "]"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"focPdP", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"LP", ",", 
       RowBox[{"dp", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], 
  "        ", 
  RowBox[{"(*", 
   RowBox[{"FOC", " ", "with", " ", "respect", " ", "to", " ", 
    RowBox[{"dp", "[", "t", "]"}]}], "*)"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Debug", " ", "the", " ", "FOCs", " ", "before", " ", "solving"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"debugFOCs", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FOC wrt cp[t]\>\"", "->", "focPCt"}], ",", 
      RowBox[{"\"\<FOC wrt hp[t]\>\"", "->", "focPHt"}], ",", 
      RowBox[{"\"\<FOC wrt dp[t]\>\"", "->", "focPdP"}]}], "}"}]}], ";"}], 
  "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Solve", " ", "FOCs", " ", "for", " ", "lambda"}], ",", 
    RowBox[{"keeping", " ", "full", " ", "expressions"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lambdaSolutions", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<Lambda wrt cp[t]\>\"", "->", 
       RowBox[{"Solve", "[", 
        RowBox[{"focPCt", ",", 
         RowBox[{"lambdaP", "[", "t", "]"}]}], "]"}]}], ",", 
      RowBox[{"\"\<Lambda wrt hp[t]\>\"", "->", 
       RowBox[{"Solve", "[", 
        RowBox[{"focPHt", ",", 
         RowBox[{"lambdaP", "[", "t", "]"}]}], "]"}]}], ",", 
      RowBox[{"\"\<Lambda wrt dp[t]\>\"", "->", 
       RowBox[{"Solve", "[", 
        RowBox[{"focPdP", ",", 
         RowBox[{"lambdaP", "[", "t", "]"}]}], "]"}]}]}], "}"}]}], ";"}], 
  "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", "Results", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{"\"\<Lambda Solutions\>\"", "->", "lambdaSolutions"}], 
  "}"}], "\n"}], "Input",
 CellChangeTimes->{{3.942591478649725*^9, 3.942591478649725*^9}, 
   3.9425915249837914`*^9, {3.942591893611925*^9, 3.9425919125734234`*^9}, 
   3.9425920148237686`*^9, {3.9431068767277374`*^9, 3.9431068801445446`*^9}, {
   3.943373150584465*^9, 3.943373154683838*^9}, 3.943530733499941*^9, {
   3.9435311122916813`*^9, 3.9435311485272903`*^9}, {3.9436169128066196`*^9, 
   3.943616924451643*^9}, {3.943617362437744*^9, 3.943617382325964*^9}, {
   3.9436179521460266`*^9, 3.943617955790903*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"9ace75de-4978-4347-8abf-940e21a736de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Updated", " ", "Lambda", " ", "Solutions"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"lambdaSolutions", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<Lambda wrt cp[t]\>\"", "->", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"lambdaP", "[", "t", "]"}], "->", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "alpha"}], ")"}], " ", "xiP", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"a", "^", "2"}], " ", "betaP", " ", 
                 RowBox[{"cp", "[", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "-", 
                RowBox[{"a", " ", 
                 RowBox[{"cp", "[", "t", "]"}]}], "-", 
                RowBox[{"a", " ", "betaP", " ", 
                 RowBox[{"cp", "[", "t", "]"}]}], "+", 
                RowBox[{"cp", "[", 
                 RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a", " ", 
                 RowBox[{"cp", "[", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "-", 
                RowBox[{"cp", "[", "t", "]"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a", " ", 
                 RowBox[{"cp", "[", "t", "]"}]}], "-", 
                RowBox[{"cp", "[", 
                 RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], ")"}]}]}], "}"}], 
         "}"}]}], ",", 
       RowBox[{"\"\<Lambda wrt hp[t]\>\"", "->", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"lambdaP", "[", "t", "]"}], "->", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "epsilonP"}], "+", 
              RowBox[{
               RowBox[{"hp", "[", "t", "]"}], "^", 
               RowBox[{"(", 
                RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"hp", "[", "t", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"qh", "-", 
                RowBox[{"wt", "[", "t", "]"}]}], ")"}]}], ")"}]}]}], "}"}], 
         "}"}]}], ",", 
       RowBox[{"\"\<Lambda wrt dp[t]\>\"", "->", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"lambdaP", "[", "t", "]"}], "->", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"betaP", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "epsilonP"}], "+", 
                RowBox[{
                 RowBox[{"hp", "[", 
                  RowBox[{"1", "+", "t"}], "]"}], "^", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"rt", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"hp", "[", 
               RowBox[{"1", "+", "t"}], "]"}], " ", 
              RowBox[{"pit", "[", 
               RowBox[{"1", "+", "t"}], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"qh", "-", 
                RowBox[{"wt", "[", 
                 RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], ")"}]}]}], "}"}], 
         "}"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"First", "-", 
     RowBox[{"Order", " ", "Conditions", " ", "with", " ", 
      RowBox[{"lambdaP", "[", "t", "]"}], " ", "eliminated"}]}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Substitute", " ", 
      RowBox[{"lambdaP", "[", "t", "]"}], " ", "into", " ", 
      RowBox[{"dp", "[", "t", "]"}]}], ",", 
     RowBox[{"cp", "[", "t", "]"}], ",", 
     RowBox[{"and", " ", 
      RowBox[{"hp", "[", "t", "]"}], " ", "FOCs"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focSubstituted", "=", 
     RowBox[{"{", 
      RowBox[{"(*", 
       RowBox[{"FOC", " ", "wrt", " ", 
        RowBox[{"cp", "[", "t", "]"}], " ", "with", " ", 
        RowBox[{"lambdaP", "[", "t", "]"}], " ", "substituted"}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "alpha"}], ")"}], " ", "xiP", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"a", "^", "2"}], " ", "betaP", " ", 
               RowBox[{"cp", "[", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "-", 
              RowBox[{"a", " ", 
               RowBox[{"cp", "[", "t", "]"}]}], "-", 
              RowBox[{"a", " ", "betaP", " ", 
               RowBox[{"cp", "[", "t", "]"}]}], "+", 
              RowBox[{"cp", "[", 
               RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"a", " ", 
               RowBox[{"cp", "[", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "-", 
              RowBox[{"cp", "[", "t", "]"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"a", " ", 
               RowBox[{"cp", "[", "t", "]"}]}], "-", 
              RowBox[{"cp", "[", 
               RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], ")"}]}], ")"}], "==", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "epsilonP"}], "+", 
            RowBox[{
             RowBox[{"hp", "[", "t", "]"}], "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"hp", "[", "t", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"qh", "-", 
              RowBox[{"wt", "[", "t", "]"}]}], ")"}]}], ")"}]}], ")"}]}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"hp", "[", "t", "]"}], " ", "with", " ", 
         RowBox[{"lambdaP", "[", "t", "]"}], " ", "substituted"}], "*)"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "epsilonP"}], "+", 
            RowBox[{
             RowBox[{"hp", "[", "t", "]"}], "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"hp", "[", "t", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"qh", "-", 
              RowBox[{"wt", "[", "t", "]"}]}], ")"}]}], ")"}]}], ")"}], "==", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"betaP", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "epsilonP"}], "+", 
              RowBox[{
               RowBox[{"hp", "[", 
                RowBox[{"1", "+", "t"}], "]"}], "^", 
               RowBox[{"(", 
                RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rt", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"hp", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"pit", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"qh", "-", 
              RowBox[{"wt", "[", 
               RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], ")"}]}], ")"}]}], 
       ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"dp", "[", "t", "]"}], " ", "with", " ", 
         RowBox[{"lambdaP", "[", "t", "]"}], " ", "substituted"}], "*)"}], 
       RowBox[{
        RowBox[{"dp", "[", "t", "]"}], "==", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"betaP", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "epsilonP"}], "+", 
              RowBox[{
               RowBox[{"hp", "[", 
                RowBox[{"1", "+", "t"}], "]"}], "^", 
               RowBox[{"(", 
                RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rt", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"hp", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"pit", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"qh", "-", 
              RowBox[{"wt", "[", 
               RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], ")"}]}], ")"}]}]}], 
      "\n", "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Solve", " ", "for", " ", 
      RowBox[{"cp", "[", "t", "]"}]}], ",", 
     RowBox[{"hp", "[", "t", "]"}], ",", 
     RowBox[{"and", " ", 
      RowBox[{"dp", "[", "t", "]"}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"solutions", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"focSubstituted", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cp", "[", "t", "]"}], ",", 
         RowBox[{"hp", "[", "t", "]"}], ",", 
         RowBox[{"dp", "[", "t", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Display", " ", "the", " ", "solutions"}], "*)"}], "\n", 
   RowBox[{"{", 
    RowBox[{"\"\<Solutions for cp[t], hp[t], dp[t]\>\"", "->", "solutions"}], 
    "}"}], "\n"}]}]], "Input",
 CellChangeTimes->{{3.9435308262466354`*^9, 3.9435308504180183`*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"b7a511ea-a296-6f41-a45a-13f2bb0b1e10"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"unpatceint", " ", "households"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.943616429544197*^9, 
  3.943616484662098*^9}},ExpressionUUID->"483b27fc-4b8e-9c46-8db4-\
040fdf9ca070"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
  "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Parameters", " ", "and", " ", "Variables", " ", "for", " ", "Impatient", 
    " ", "Households"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"params", "=", 
    RowBox[{"{", 
     RowBox[{
     "betaI", ",", "epsilonI", ",", "epsilonH", ",", "phi", ",", "qh", ",", 
      RowBox[{"wt", "[", "t", "]"}], ",", 
      RowBox[{"rh", "[", "t", "]"}], ",", 
      RowBox[{"pit", "[", "t", "]"}], ",", 
      RowBox[{"ci", "[", "t", "]"}], ",", 
      RowBox[{"bi", "[", "t", "]"}], ",", 
      RowBox[{"hi", "[", "t", "]"}], ",", 
      RowBox[{"mi", "[", "t", "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Utility", " ", "function", " ", "for", " ", "impatient", " ", 
    "households"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uImpatient", "[", 
     RowBox[{"ci_", ",", "hi_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"epsilonI", " ", 
      RowBox[{"Log", "[", "ci", "]"}]}], "+", 
     RowBox[{"epsilonH", " ", 
      RowBox[{"Log", "[", "hi", "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"hi", "^", 
        RowBox[{"(", 
         RowBox[{"1", "+", "phi"}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", "phi"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Budget", " ", "constraint", " ", "for", " ", "impatient", " ", 
    "households", " ", "in", " ", "period", " ", "t"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BCImpatient", "[", "t_", "]"}], ":=", 
    RowBox[{
     RowBox[{"ci", "[", "t", "]"}], "+", 
     RowBox[{"qh", " ", 
      RowBox[{"hi", "[", "t", "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"rh", "[", 
           RowBox[{"t", "-", "1"}], "]"}]}], ")"}], "/", 
        RowBox[{"pit", "[", "t", "]"}]}], ")"}], " ", 
      RowBox[{"bi", "[", 
       RowBox[{"t", "-", "1"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"wt", "[", "t", "]"}], " ", 
      RowBox[{"hi", "[", "t", "]"}]}], "-", 
     RowBox[{"bi", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Borrowing", " ", "constraint", " ", "explicitly", " ", "plugged", " ", 
     "in", " ", "for", " ", "period", " ", "t", " ", "and", " ", "t"}], "+", 
    "1"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BorrowingConstraint", "[", "t_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"mi", "[", "t", "]"}], " ", "qh", " ", 
     RowBox[{"hi", "[", 
      RowBox[{"t", "+", "1"}], "]"}]}], "-", 
    RowBox[{"bi", "[", "t", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BorrowingConstraint", "[", 
     RowBox[{"t", "+", "1"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"mi", "[", 
       RowBox[{"t", "+", "1"}], "]"}], " ", "qh", " ", 
      RowBox[{"hi", "[", 
       RowBox[{"t", "+", "2"}], "]"}]}], "-", 
     RowBox[{"bi", "[", 
      RowBox[{"t", "+", "1"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Define", " ", "the", " ", "Lagrangian", " ", "for", " ", "two", " ", 
    "periods", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"t", " ", "and", " ", "t"}], "+", "1"}], ")"}], " ", "with", 
    " ", "borrowing", " ", "constraints", " ", "plugged", " ", "in"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LI", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"betaI", "^", "t"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"uImpatient", "[", 
         RowBox[{
          RowBox[{"ci", "[", "t", "]"}], ",", 
          RowBox[{"hi", "[", "t", "]"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{"lambdaI", "[", "t", "]"}], " ", 
         RowBox[{"BCImpatient", "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"muI", "[", "t", "]"}], " ", 
         RowBox[{"BorrowingConstraint", "[", "t", "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"betaI", "^", 
       RowBox[{"(", 
        RowBox[{"t", "+", "1"}], ")"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"uImpatient", "[", 
         RowBox[{
          RowBox[{"ci", "[", 
           RowBox[{"t", "+", "1"}], "]"}], ",", 
          RowBox[{"hi", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{"lambdaI", "[", 
          RowBox[{"t", "+", "1"}], "]"}], " ", 
         RowBox[{"BCImpatient", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"muI", "[", 
          RowBox[{"t", "+", "1"}], "]"}], " ", 
         RowBox[{"BorrowingConstraint", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}]}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"First", "-", 
    RowBox[{
    "order", " ", "conditions", " ", "for", " ", "impatient", " ", 
     "households", " ", 
     RowBox[{"(", 
      RowBox[{"at", " ", "time", " ", "t"}], ")"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"focCI", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"LI", ",", 
       RowBox[{"ci", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], 
  "         ", 
  RowBox[{"(*", 
   RowBox[{"FOC", " ", "wrt", " ", 
    RowBox[{"ci", "[", "t", "]"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"focHI", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"LI", ",", 
       RowBox[{"hi", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], 
  "         ", 
  RowBox[{"(*", 
   RowBox[{"FOC", " ", "wrt", " ", 
    RowBox[{"hi", "[", "t", "]"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"focBI", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"LI", ",", 
       RowBox[{"bi", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], 
  "         ", 
  RowBox[{"(*", 
   RowBox[{"FOC", " ", "wrt", " ", 
    RowBox[{"bi", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"Display", " ", "the", " ", "results"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"debugFOCs", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FOC wrt ci[t]\>\"", "->", "focCI"}], ",", 
      RowBox[{"\"\<FOC wrt hi[t]\>\"", "->", "focHI"}], ",", 
      RowBox[{"\"\<FOC wrt bi[t]\>\"", "->", "focBI"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Output", " ", "the", " ", "Lagrangian", " ", "and", " ", "First"}], "-", 
    RowBox[{"Order", " ", "Conditions"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{
    "\"\<Lagrangian with Borrowing Constraints Plugged In\>\"", "->", "LI"}], 
    ",", 
    RowBox[{"\"\<First-Order Conditions\>\"", "->", "debugFOCs"}]}], "}"}], 
  "\n", "\n", "\n", 
  RowBox[{"(*", " ", "entrapnuers", "**)"}]}], "\n"}], "Input",
 CellChangeTimes->{
  3.9428556216292534`*^9, 3.9428558638346443`*^9, 3.942856329183136*^9, 
   3.9428564862004185`*^9, 3.9428566889696026`*^9, {3.942856910773079*^9, 
   3.9428569354905777`*^9}, {3.942857364787548*^9, 3.9428573898232937`*^9}, {
   3.9428577783808823`*^9, 3.9428578049808903`*^9}, 3.9428579940329285`*^9, {
   3.9428580395093536`*^9, 3.942858042871578*^9}, 3.9428591140860786`*^9, 
   3.9431155151779137`*^9, {3.9431158839568024`*^9, 3.943115919462967*^9}, {
   3.943116017131489*^9, 3.943116043165043*^9}, {3.943116203605345*^9, 
   3.943116248865116*^9}, 3.943116279396555*^9, {3.9431165276830425`*^9, 
   3.943116567202736*^9}, {3.94311672191103*^9, 3.943116753600672*^9}, {
   3.943116983151354*^9, 3.9431169998925896`*^9}, {3.9431182676864986`*^9, 
   3.943118310423565*^9}, {3.9431188651155624`*^9, 3.9431188743868217`*^9}, {
   3.9431189471438274`*^9, 3.943118963078903*^9}, {3.9431190017983513`*^9, 
   3.9431190163987827`*^9}, 3.9431844617301445`*^9, {3.943184531994499*^9, 
   3.9431845466193027`*^9}, {3.9431847557619095`*^9, 3.943184775501425*^9}, {
   3.943359097367693*^9, 3.943359119211834*^9}, 3.943368823503065*^9, 
   3.9433689041234646`*^9, 3.9433690047130775`*^9, {3.943372602202656*^9, 
   3.9433726292470894`*^9}, 3.9433731892332497`*^9, 3.943373405777813*^9, 
   3.943373880790806*^9, 3.9435298263594894`*^9, {3.943531181261368*^9, 
   3.943531227021929*^9}, 3.943533171298271*^9, {3.9435333243153496`*^9, 
   3.9435333617947254`*^9}, 3.9435362777779655`*^9, 3.9435367592692184`*^9, {
   3.9435380153508034`*^9, 3.943538038666689*^9}, {3.943548833672926*^9, 
   3.9435488363959446`*^9}, 3.9435490988596954`*^9, {3.9435491348483696`*^9, 
   3.943549140611929*^9}, {3.9435492777151756`*^9, 3.9435492934218426`*^9}, {
   3.943616506312252*^9, 3.9436165507183113`*^9}, {3.9436180500715656`*^9, 
   3.9436180530685368`*^9}, {3.945173009921896*^9, 3.945173031726755*^9}, {
   3.9451733102613754`*^9, 
   3.945173337662203*^9}},ExpressionUUID->"94fcf45b-6f21-634c-b1d5-\
7d0ae8a5c58d"],

Cell[BoxData[""], "Input",ExpressionUUID->"b9ef39e2-d105-c74c-ae1b-589fe4deab77"],

Cell[BoxData[""], "Input",ExpressionUUID->"8880107c-6260-f84b-9c38-4d69438e0d38"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.9435427532511272`*^9, 3.9435429266061287`*^9, {3.9435432530352726`*^9, 
   3.9435432582597523`*^9}, 3.943546371123556*^9, {3.943546402142988*^9, 
   3.9435464439195156`*^9}, {3.9435465354834595`*^9, 3.9435465479634457`*^9}, 
   3.94354773585849*^9, 3.9435477961966763`*^9, {3.94354797071694*^9, 
   3.9435480368908195`*^9}, {3.9435482664194775`*^9, 3.943548308045862*^9}, {
   3.943548775090723*^9, 3.9435487878883495`*^9}, 3.943630160916479*^9, {
   3.94363301255171*^9, 3.9436330350480175`*^9}, 3.9436331200540714`*^9, 
   3.9436331769290695`*^9, 3.9436332378605556`*^9, 3.943633372899292*^9, 
   3.9436335299484825`*^9, 3.943633640779604*^9, {3.9436351588234386`*^9, 
   3.943635196260168*^9}, 3.9436372985053406`*^9, 3.9436373545998974`*^9, 
   3.9436373944025383`*^9, {3.943638520979418*^9, 3.9436385408744755`*^9}, 
   3.945173040038164*^9, {3.9451733636029663`*^9, 
   3.9451733650049973`*^9}},ExpressionUUID->"cd875cfb-76b3-1744-b64e-\
f93d3963fe15"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", "\n", "\n", "\n", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"Tetapkan", " ", "parameter"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Example", " ", "of", " ", "rational", " ", "parameters"}], 
    "*)"}], 
   RowBox[{
    RowBox[{"alpha", "=", 
     RowBox[{"33", "/", "100"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"betaE", "=", 
     RowBox[{"975", "/", "1000"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"delta", "=", 
     RowBox[{"25", "/", "1000"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"xi1", "=", 
     RowBox[{"54", "/", "1000"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"xi2", "=", 
     RowBox[{"546", "/", "100000"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"{", 
      RowBox[{
      "betaE", ",", "alpha", ",", "delta", ",", "xi1", ",", "xi2", ",", 
       RowBox[{"AE", "[", "t", "]"}], ",", 
       RowBox[{"wt", "[", "t", "]"}], ",", 
       RowBox[{"qt", "[", "t", "]"}], ",", 
       RowBox[{"rtE", "[", "t", "]"}], ",", 
       RowBox[{"pit", "[", "t", "]"}], ",", 
       RowBox[{"ctE", "[", "t", "]"}], ",", 
       RowBox[{"btE", "[", "t", "]"}], ",", 
       RowBox[{"kEt", "[", "t", "]"}], ",", 
       RowBox[{"uEt", "[", "t", "]"}], ",", 
       RowBox[{"mEt", "[", "t", "]"}], ",", 
       RowBox[{"lambdaE", "[", "t", "]"}], ",", 
       RowBox[{"lambdaE", "[", 
        RowBox[{"t", "+", "1"}], "]"}], ",", 
       RowBox[{"muE", "[", "t", "]"}], ",", 
       RowBox[{"muE", "[", 
        RowBox[{"t", "+", "1"}], "]"}], ",", 
       RowBox[{"lEt", "[", "t", "]"}], ",", 
       RowBox[{"lEt", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"uEntrepreneur", "[", 
      RowBox[{"ctE_", ",", "ctELag_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "alpha"}], ")"}], " ", 
       RowBox[{"Log", "[", "ctE", "]"}]}], "-", 
      RowBox[{"alpha", " ", 
       RowBox[{"Log", "[", "ctELag", "]"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"yE", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"AE", "[", "t", "]"}], " ", 
      RowBox[{
       RowBox[{"kEt", "[", 
        RowBox[{"t", "-", "1"}], "]"}], "^", 
       RowBox[{"(", "alpha", ")"}]}], " ", 
      RowBox[{
       RowBox[{"uEt", "[", "t", "]"}], "^", 
       RowBox[{"(", 
        RowBox[{"1", "-", "alpha"}], ")"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FUtil", "[", "u_", "]"}], ":=", 
     RowBox[{
      RowBox[{"xi1", " ", 
       RowBox[{"(", 
        RowBox[{"u", "-", "1"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"xi2", "/", "2"}], ")"}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"u", "-", "1"}], ")"}], "^", "2"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BCEntrepreneur", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"ctE", "[", "t", "]"}], "+", 
      RowBox[{
       RowBox[{"wt", "[", "t", "]"}], " ", 
       RowBox[{"lEt", "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"rtE", "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ")"}], "/", 
         RowBox[{"pit", "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"btE", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"qt", "[", "t", "]"}], " ", 
       RowBox[{"kEt", "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"FUtil", "[", 
        RowBox[{"uEt", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"kEt", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], "-", 
      RowBox[{"yE", "[", "t", "]"}], "-", 
      RowBox[{"btE", "[", "t", "]"}], "-", 
      RowBox[{
       RowBox[{"qt", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "delta"}], ")"}], " ", 
       RowBox[{"kEt", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BorrowingConstraint", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"mEt", "[", "t", "]"}], " ", 
       RowBox[{"qt", "[", "t", "]"}], " ", 
       RowBox[{"kEt", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], "-", 
      RowBox[{"btE", "[", "t", "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"BorrowingConstraint", "[", 
      RowBox[{"t", "+", "1"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"mEt", "[", 
        RowBox[{"t", "+", "1"}], "]"}], " ", 
       RowBox[{"qt", "[", 
        RowBox[{"t", "+", "1"}], "]"}], " ", 
       RowBox[{"kEt", "[", 
        RowBox[{"t", "+", "2"}], "]"}]}], "-", 
      RowBox[{"btE", "[", 
       RowBox[{"t", "+", "1"}], "]"}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"computeFOCs", "[", "constraintsBinding_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "LE", ",", "focCtE", ",", "focKEt", ",", "focBtE", ",", "focUEt", ",",
          "system", ",", "sol"}], "}"}], ",", 
       RowBox[{
        RowBox[{"LE", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"uEntrepreneur", "[", 
             RowBox[{
              RowBox[{"ctE", "[", "t", "]"}], ",", 
              RowBox[{"ctE", "[", 
               RowBox[{"t", "-", "1"}], "]"}]}], "]"}], "+", 
            RowBox[{
             RowBox[{"lambdaE", "[", "t", "]"}], " ", 
             RowBox[{"BCEntrepreneur", "[", "t", "]"}]}], "+", 
            RowBox[{
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"BorrowingConstraint", "[", "t", "]"}]}]}], ")"}], "+", 
          RowBox[{
           RowBox[{"betaE", "^", 
            RowBox[{"(", 
             RowBox[{"t", "+", "1"}], ")"}]}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"uEntrepreneur", "[", 
              RowBox[{
               RowBox[{"ctE", "[", 
                RowBox[{"t", "+", "1"}], "]"}], ",", 
               RowBox[{"ctE", "[", "t", "]"}]}], "]"}], "+", 
             RowBox[{
              RowBox[{"lambdaE", "[", 
               RowBox[{"t", "+", "1"}], "]"}], " ", 
              RowBox[{"BCEntrepreneur", "[", 
               RowBox[{"t", "+", "1"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"muE", "[", 
               RowBox[{"t", "+", "1"}], "]"}], " ", 
              RowBox[{"BorrowingConstraint", "[", 
               RowBox[{"t", "+", "1"}], "]"}]}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"focCtE", "=", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"LE", ",", 
            RowBox[{"ctE", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"focKEt", "=", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"LE", ",", 
            RowBox[{"kEt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"focBtE", "=", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"LE", ",", 
            RowBox[{"btE", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"focUEt", "=", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"LE", ",", 
            RowBox[{"uEt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"constraintsBinding", ",", 
          RowBox[{"system", "=", 
           RowBox[{"{", 
            RowBox[{
            "focCtE", ",", "focKEt", ",", "focBtE", ",", "focUEt", ",", 
             RowBox[{
              RowBox[{"BorrowingConstraint", "[", "t", "]"}], "==", "0"}], 
             ",", 
             RowBox[{
              RowBox[{"BorrowingConstraint", "[", 
               RowBox[{"t", "+", "1"}], "]"}], "==", "0"}], ",", 
             RowBox[{
              RowBox[{"muE", "[", "t", "]"}], ">=", "0"}], ",", 
             RowBox[{
              RowBox[{"muE", "[", 
               RowBox[{"t", "+", "1"}], "]"}], ">=", "0"}], ",", 
             RowBox[{
              RowBox[{"ctE", "[", "t", "]"}], ">=", "0"}], ",", 
             RowBox[{
              RowBox[{"ctE", "[", 
               RowBox[{"t", "+", "1"}], "]"}], ">=", "0"}], ",", 
             RowBox[{
              RowBox[{"kEt", "[", "t", "]"}], ">=", "0"}], ",", 
             RowBox[{
              RowBox[{"kEt", "[", 
               RowBox[{"t", "+", "1"}], "]"}], ">=", "0"}]}], "}"}]}], ",", 
          RowBox[{"system", "=", 
           RowBox[{"{", 
            RowBox[{"focCtE", ",", "focKEt", ",", "focBtE", ",", "focUEt"}], 
            "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"sol", "=", 
         RowBox[{"NSolve", "[", 
          RowBox[{"system", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ctE", "[", "t", "]"}], ",", 
             RowBox[{"ctE", "[", 
              RowBox[{"t", "+", "1"}], "]"}], ",", 
             RowBox[{"kEt", "[", "t", "]"}], ",", 
             RowBox[{"kEt", "[", 
              RowBox[{"t", "+", "1"}], "]"}], ",", 
             RowBox[{"btE", "[", "t", "]"}], ",", 
             RowBox[{"btE", "[", 
              RowBox[{"t", "+", "1"}], "]"}], ",", 
             RowBox[{"uEt", "[", "t", "]"}], ",", 
             RowBox[{"uEt", "[", 
              RowBox[{"t", "+", "1"}], "]"}], ",", 
             RowBox[{"muE", "[", "t", "]"}], ",", 
             RowBox[{"muE", "[", 
              RowBox[{"t", "+", "1"}], "]"}], ",", 
             RowBox[{"lambdaE", "[", "t", "]"}], ",", 
             RowBox[{"lambdaE", "[", 
              RowBox[{"t", "+", "1"}], "]"}], ",", 
             RowBox[{"mEt", "[", "t", "]"}], ",", 
             RowBox[{"mEt", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "}"}], ",", "Reals"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "sol", "]"}], ";"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"maxIterations", "=", "4"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"iteration", "=", "0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"constraintsBinding", "=", "True"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"done", "=", "False"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"While", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"!", "done"}], "&&", 
       RowBox[{"iteration", "<", "maxIterations"}]}], ",", 
      RowBox[{
       RowBox[{"iteration", "++"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Iteration: \>\"", ",", "iteration", ",", 
         "\"\<, constraintsBinding: \>\"", ",", "constraintsBinding"}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"solutions", "=", 
        RowBox[{"computeFOCs", "[", "constraintsBinding", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"solutions", "===", 
           RowBox[{"{", "}"}]}], "||", 
          RowBox[{
           RowBox[{"Length", "[", "solutions", "]"}], "==", "0"}]}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<No solution found. Stopping.\>\"", "]"}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"done", "=", "True"}]}], ",", 
         RowBox[{
          RowBox[{"sol", "=", 
           RowBox[{"solutions", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"KeyExistsQ", "[", 
              RowBox[{"sol", ",", 
               RowBox[{"muE", "[", "t", "]"}]}], "]"}], "&&", 
             RowBox[{"KeyExistsQ", "[", 
              RowBox[{"sol", ",", 
               RowBox[{"muE", "[", 
                RowBox[{"t", "+", "1"}], "]"}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"muTVal", "=", 
              RowBox[{"sol", "[", 
               RowBox[{"muE", "[", "t", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"muT1Val", "=", 
              RowBox[{"sol", "[", 
               RowBox[{"muE", "[", 
                RowBox[{"t", "+", "1"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"NumericQ", "[", "muTVal", "]"}], "&&", 
                RowBox[{"NumericQ", "[", "muT1Val", "]"}]}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"muTVal", "<", "0"}], "||", 
                  RowBox[{"muT1Val", "<", "0"}]}], ",", 
                 RowBox[{
                  RowBox[{
                  "Print", "[", 
                   "\"\<Negative mu found. Dropping constraints next \
iteration.\>\"", "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"constraintsBinding", "=", "False"}]}], ",", 
                 RowBox[{
                  RowBox[{
                  "Print", "[", "\"\<No negative mu found. Done.\>\"", "]"}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"done", "=", "True"}]}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                "Print", "[", 
                 "\"\<Multipliers not numeric. Cannot check. Stopping.\>\"", 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"done", "=", "True"}]}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
             "Print", "[", 
              "\"\<No muE found in solution. Cannot proceed.\>\"", "]"}], ";",
              "\[IndentingNewLine]", 
             RowBox[{"done", "=", "True"}]}]}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<--------------------------------------------------\>\"", "]"}], 
       ";"}]}], "]"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<Completed after \>\"", ",", "iteration", ",", 
      "\"\< iterations.\>\""}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ValueQ", "[", "sol", "]"}], ",", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Final solution used:\\n\>\"", ",", "sol"}], "]"}], 
       ";"}]}], "]"}], ";"}], "\n", "\n", "\n"}]}]], "Input",
 CellChangeTimes->{
  3.9435391575395813`*^9, {3.9435398858663692`*^9, 3.9435398880281487`*^9}, {
   3.943540897605055*^9, 3.9435408998576202`*^9}, 3.9435413904551544`*^9, 
   3.9435414439057255`*^9, {3.9435415242358646`*^9, 3.943541540439226*^9}, {
   3.943541758168503*^9, 3.9435417807406597`*^9}, 3.943541851143875*^9, {
   3.943542595518465*^9, 3.9435426131600018`*^9}, 3.9436360776457767`*^9, 
   3.9436368456848392`*^9, 3.943637052357706*^9, {3.9436371068257103`*^9, 
   3.943637172743126*^9}, {3.943637222975971*^9, 3.9436372395308533`*^9}, 
   3.943638475964142*^9, {3.9436391725025864`*^9, 3.943639188669359*^9}, 
   3.945187564517645*^9, {3.945187625629862*^9, 3.9451876378156166`*^9}, {
   3.9451876710446587`*^9, 3.945187683542963*^9}, {3.9451887001858025`*^9, 
   3.9451887224526997`*^9}, {3.945189909935627*^9, 3.945189933091503*^9}, {
   3.945191613455288*^9, 3.945191622945223*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"c726674b-7a0c-5d4a-acbc-410be457c818"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Iteration: \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\", constraintsBinding: \"\>", "\[InvisibleSpace]",
    "True"}],
  SequenceForm["Iteration: ", 1, ", constraintsBinding: ", True],
  Editable->False]], "Print",
 CellChangeTimes->{3.9451921695432606`*^9},
 CellLabel->
  "During evaluation of \
In[171]:=",ExpressionUUID->"33896bdb-232e-3940-b2f3-5cd664b9994f"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.9451924905189514`*^9},
 CellLabel->
  "Out[189]=",ExpressionUUID->"021a6caa-46ce-1c43-888a-936c462129f4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Completed after \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\" iterations.\"\>"}],
  SequenceForm["Completed after ", 1, " iterations."],
  Editable->False]], "Print",
 CellChangeTimes->{3.9451924905209846`*^9},
 CellLabel->
  "During evaluation of \
In[171]:=",ExpressionUUID->"951ea893-abd2-ac40-9eb2-763eb655760a"]
}, Open  ]],

Cell[BoxData[""], "Input",ExpressionUUID->"7b2a829e-ed40-f842-8011-ce05951bd9e7"],

Cell[BoxData[
 RowBox[{"\n", "\n", "\n", "\n", "\n", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.943095601752617*^9, 3.943095697141567*^9, 3.9430957629971123`*^9, 
   3.943096566655285*^9, 3.9430967132819386`*^9, {3.943096852840805*^9, 
   3.9430969113997536`*^9}, {3.943097135234783*^9, 3.9430971485822105`*^9}, {
   3.943097392295368*^9, 3.9430974558105164`*^9}, {3.9430979666947784`*^9, 
   3.9430980501377277`*^9}, {3.943099255998207*^9, 3.9430992886727295`*^9}, 
   3.943099691497591*^9, 3.943099724687374*^9, {3.9430998163229694`*^9, 
   3.943099823741455*^9}, {3.9430998940161934`*^9, 3.9430999028278637`*^9}, {
   3.9431003339566326`*^9, 3.943100365656416*^9}, {3.943100493522726*^9, 
   3.943100520782074*^9}, {3.9431006936542053`*^9, 3.943100799985262*^9}, 
   3.943100953703394*^9, {3.9431010658345833`*^9, 3.943101068541857*^9}, {
   3.9431011426786804`*^9, 3.943101179042753*^9}, {3.9431012364982014`*^9, 
   3.9431012580561256`*^9}, {3.943104283266983*^9, 3.943104311273609*^9}, {
   3.9431070075225353`*^9, 3.943107040517599*^9}, {3.9431078798456097`*^9, 
   3.9431078996630783`*^9}, 3.943108759212618*^9, {3.9431088630641766`*^9, 
   3.94310892820677*^9}, 3.9431090126656437`*^9, 3.943109046509821*^9, {
   3.943109174091522*^9, 3.943109185106674*^9}, {3.9431092189817467`*^9, 
   3.943109235959654*^9}, {3.9431092714814396`*^9, 3.943109287079174*^9}, {
   3.943109321455227*^9, 3.943109354938328*^9}, {3.9431095781482906`*^9, 
   3.943109613581402*^9}, {3.9431100943964844`*^9, 3.9431101167707806`*^9}, 
   3.9431102102724895`*^9, 3.9431102995618744`*^9, {3.9431154447643604`*^9, 
   3.943115473781189*^9}, 3.943373905221323*^9, 3.943373963588621*^9, 
   3.9433740679241104`*^9, 3.943376214339369*^9, 3.943376271511257*^9, 
   3.9433779924840546`*^9, {3.943378027126297*^9, 3.9433780299277725`*^9}, {
   3.9433787812198334`*^9, 3.9433788189605427`*^9}, {3.9433789468138123`*^9, 
   3.9433789597277336`*^9}, 3.94337922534461*^9, 3.9433793210569305`*^9, 
   3.9434651315112514`*^9, {3.943465236511921*^9, 3.943465238672451*^9}, 
   3.9435297499109097`*^9, 3.9436311971124306`*^9, 3.943632190713873*^9, 
   3.9436329035958595`*^9},
 CellLabel->"",ExpressionUUID->"ddc54769-112f-9f42-b0b6-fc47d2bfdba2"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9433733816534367`*^9, 3.9433733838197327`*^9}, 
   3.943373815652109*^9, 
   3.943373865325348*^9},ExpressionUUID->"768c9a75-a0a8-7c43-b5d2-\
faa201975555"],

Cell[BoxData[
 RowBox[{"\n", "\n", "\n"}]], "Input",
 CellChangeTimes->{
  3.942592057012724*^9, {3.942592245428005*^9, 3.94259229837319*^9}, {
   3.94259276149564*^9, 3.942592764239746*^9}, {3.9425935259046726`*^9, 
   3.942593548727476*^9}, 3.9425936374098434`*^9, {3.942594582938095*^9, 
   3.942594602603157*^9}, 3.9425946466589737`*^9, {3.9425949113557167`*^9, 
   3.9425949911134377`*^9}, 3.942595094281233*^9, {3.942595174682337*^9, 
   3.942595279071537*^9}, 3.942595447132061*^9, {3.9425956151379395`*^9, 
   3.94259563994841*^9}, 3.942595669960287*^9, {3.9425959508937435`*^9, 
   3.9425959719109993`*^9}, 3.9427690351333847`*^9, 3.9427690682198257`*^9, 
   3.9427715635525856`*^9, 3.9428545977365494`*^9, 3.9430291244111385`*^9, {
   3.9430293293032436`*^9, 3.9430293321251163`*^9}, 3.943029903411661*^9, 
   3.943029935968582*^9, {3.9430300915187435`*^9, 3.9430300983569183`*^9}, 
   3.943030165224594*^9, 3.943031018565777*^9, 3.9430310525436935`*^9, 
   3.9430315909590073`*^9, {3.943031676607229*^9, 3.943031762295637*^9}, {
   3.943032046234873*^9, 3.94303207506736*^9}, {3.943032277998928*^9, 
   3.943032328893503*^9}, 3.9430323609657345`*^9, {3.9430338379985332`*^9, 
   3.9430338777026024`*^9}, {3.9430340737475815`*^9, 3.9430340995907764`*^9}, 
   3.943034138748911*^9, 3.943034215671747*^9, 3.9430955097704773`*^9, 
   3.9433588087017574`*^9, 3.9433588506085987`*^9, 3.9433604537355385`*^9, 
   3.9433690498361454`*^9, {3.943369097716297*^9, 3.9433691157514877`*^9}, {
   3.9433691779950886`*^9, 3.9433691920949574`*^9}, {3.943369408544922*^9, 
   3.943369419957775*^9}, {3.9433694534026623`*^9, 3.9433694610976887`*^9}, {
   3.9433718095535316`*^9, 3.9433718209741173`*^9}, {3.943371942155674*^9, 
   3.943371948822159*^9}, {3.943372132182953*^9, 3.9433721356424065`*^9}, {
   3.9433723369107685`*^9, 3.9433723433940105`*^9}, {3.9433725200260067`*^9, 
   3.943372539188036*^9}, 
   3.9433729214440956`*^9},ExpressionUUID->"b0b5f86b-cc2e-e04d-b2ed-\
4360d9e5fb4f"],

Cell[BoxData[""], "Input",ExpressionUUID->"e52c92a4-2eb6-c645-94b2-60c371363739"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{
  3.942511329185976*^9, 3.942511423550762*^9, 3.942591573184946*^9, {
   3.9425916035900593`*^9, 3.942591633542879*^9}, {3.9425918643458405`*^9, 
   3.9425918709932823`*^9}, 3.9430982526884403`*^9, {3.943106042988516*^9, 
   3.943106076844755*^9}, {3.943108704823662*^9, 3.9431087103972626`*^9}, {
   3.943358560356596*^9, 3.943358583894329*^9}, 3.943358615914463*^9, 
   3.9433587817943974`*^9, 3.943368571775612*^9, {3.9433686889968395`*^9, 
   3.943368716318613*^9}, 
   3.943368758918228*^9},ExpressionUUID->"f19b7f51-99bd-4547-9650-\
5ff8e4c33086"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{{3.942508348357641*^9, 3.9425083483586407`*^9}, 
   3.9425104770787735`*^9},ExpressionUUID->"e2c58ebf-4fbc-3d4b-ac91-\
cf15352134a5"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.942508439620474*^9, 
  3.942508439622467*^9}},ExpressionUUID->"4126ecf3-b2bc-c34e-b9ce-\
ab3dbe467b58"],

Cell[BoxData[
 RowBox[{"\n", "\n"}]], "Input",
 CellChangeTimes->{
  3.9427542379518967`*^9, {3.9427544965523434`*^9, 
   3.9427545632885056`*^9}},ExpressionUUID->"a5650fd1-18d4-1d4e-89f1-\
7b4f1f908005"],

Cell[BoxData[""], "Input",ExpressionUUID->"ad54bf90-5079-e447-887e-2c9f31b492f1"],

Cell[BoxData[
 RowBox[{"\n", "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.9427549950755463`*^9, 3.942754995076544*^9}, {
   3.942856797987402*^9, 3.942856829082693*^9}, 3.943370342061611*^9, {
   3.943370944682108*^9, 
   3.9433709631648884`*^9}},ExpressionUUID->"8331c5f9-92bc-9347-8078-\
669c615e9f37"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.942754716102133*^9},
 CellLabel->"",ExpressionUUID->"283b5187-a2f1-ef49-b5fd-690301eeecfb"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.9424252546658554`*^9, 
  3.942508294844681*^9},ExpressionUUID->"79788ce8-4cec-0840-aa08-\
3875ff1d3e80"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9425082690938396`*^9, 
  3.942508282245655*^9}},ExpressionUUID->"f0ade162-6b1f-0f48-a2c9-\
2be142b63af0"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{3.9424252827947807`*^9, 
  3.9424879659349766`*^9},ExpressionUUID->"52999333-fe05-e84a-acf1-\
fc22be5bf2ea"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.942508401042242*^9, 
  3.942508401044237*^9}},ExpressionUUID->"e44d3794-52ef-d540-95ab-\
731b5a7762cd"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.942425871529419*^9, 3.942426101584881*^9, 
  3.9424261402649555`*^9},ExpressionUUID->"28629b7d-e028-5846-af8b-\
9f2b85a1dc47"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.942508459698223*^9},
 NumberMarks->False,ExpressionUUID->"e55264a3-3c28-884f-aa83-8e502c7364cc"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9425084730478153`*^9, 
  3.942508473048811*^9}},ExpressionUUID->"53dfc11f-fccd-cd48-934d-\
0bdae6dc2306"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.942508490141901*^9},
 NumberMarks->False,ExpressionUUID->"4872fec1-2e2d-8f47-88e7-ab3bbb9b5585"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.942508502797901*^9, 
  3.9425085027990284`*^9}},ExpressionUUID->"4cec27a2-cefe-5d4d-80b5-\
b6621fdb0cf4"],

Cell[BoxData[""], "Input",ExpressionUUID->"7ac59aaa-0927-bb4e-a803-639587cde41b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9424200456002064`*^9, 3.942420045601204*^9}, 
   3.9424203234497356`*^9},ExpressionUUID->"924a110a-67bc-4749-9189-\
169660317c54"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9425082473900776`*^9, 
  3.9425082473911057`*^9}},ExpressionUUID->"65b3d420-0425-f249-80e5-\
5dc6a13ce3c4"],

Cell[BoxData[""], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"c41eee93-8b45-4c47-8d30-e7d8dc6d4ab1"],

Cell[BoxData[""], "Input",ExpressionUUID->"4b97082b-f52c-d940-8b60-cf5f1725bfda"]
},
WindowSize->{1380.75, 765.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.1 for Microsoft Windows (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"cbc78bb6-c411-c243-8fb9-e034a4f1496b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 5081, 70, 47, "Input",ExpressionUUID->"f9fb2cec-0218-1946-a7a4-614cfc63c79f"],
Cell[5638, 92, 81, 0, 28, "Input",ExpressionUUID->"93063096-b854-5642-83fe-da57c1f294a1"],
Cell[5722, 94, 81, 0, 28, "Input",ExpressionUUID->"0708fca9-59ce-8847-af89-18fc69779938"],
Cell[5806, 96, 7031, 200, 541, "Input",ExpressionUUID->"9ace75de-4978-4347-8abf-940e21a736de"],
Cell[12840, 298, 10168, 274, 389, "Input",ExpressionUUID->"b7a511ea-a296-6f41-a45a-13f2bb0b1e10"],
Cell[23011, 574, 228, 5, 28, "Input",ExpressionUUID->"483b27fc-4b8e-9c46-8db4-040fdf9ca070"],
Cell[23242, 581, 9125, 244, 637, "Input",ExpressionUUID->"94fcf45b-6f21-634c-b1d5-7d0ae8a5c58d"],
Cell[32370, 827, 81, 0, 28, "Input",ExpressionUUID->"b9ef39e2-d105-c74c-ae1b-589fe4deab77"],
Cell[32454, 829, 81, 0, 28, "Input",ExpressionUUID->"8880107c-6260-f84b-9c38-4d69438e0d38"],
Cell[32538, 831, 1009, 15, 28, "Input",ExpressionUUID->"cd875cfb-76b3-1744-b64e-f93d3963fe15"],
Cell[CellGroupData[{
Cell[33572, 850, 15636, 403, 1169, "Input",ExpressionUUID->"c726674b-7a0c-5d4a-acbc-410be457c818"],
Cell[49211, 1255, 432, 10, 22, "Print",ExpressionUUID->"33896bdb-232e-3940-b2f3-5cd664b9994f"],
Cell[49646, 1267, 162, 3, 32, "Output",ExpressionUUID->"021a6caa-46ce-1c43-888a-936c462129f4"],
Cell[49811, 1272, 383, 9, 22, "Print",ExpressionUUID->"951ea893-abd2-ac40-9eb2-763eb655760a"]
}, Open  ]],
Cell[50209, 1284, 81, 0, 28, "Input",ExpressionUUID->"7b2a829e-ed40-f842-8011-ce05951bd9e7"],
Cell[50293, 1286, 2231, 31, 142, "Input",ExpressionUUID->"ddc54769-112f-9f42-b0b6-fc47d2bfdba2"],
Cell[52527, 1319, 205, 4, 28, "Input",ExpressionUUID->"768c9a75-a0a8-7c43-b5d2-faa201975555"],
Cell[52735, 1325, 1986, 29, 85, "Input",ExpressionUUID->"b0b5f86b-cc2e-e04d-b2ed-4360d9e5fb4f"],
Cell[54724, 1356, 81, 0, 28, "Input",ExpressionUUID->"e52c92a4-2eb6-c645-94b2-60c371363739"],
Cell[54808, 1358, 602, 10, 47, "Input",ExpressionUUID->"f19b7f51-99bd-4547-9650-5ff8e4c33086"],
Cell[55413, 1370, 181, 3, 47, "Input",ExpressionUUID->"e2c58ebf-4fbc-3d4b-ac91-cf15352134a5"],
Cell[55597, 1375, 152, 3, 28, "Input",ExpressionUUID->"4126ecf3-b2bc-c34e-b9ce-ab3dbe467b58"],
Cell[55752, 1380, 204, 5, 66, "Input",ExpressionUUID->"a5650fd1-18d4-1d4e-89f1-7b4f1f908005"],
Cell[55959, 1387, 81, 0, 28, "Input",ExpressionUUID->"ad54bf90-5079-e447-887e-2c9f31b492f1"],
Cell[56043, 1389, 339, 6, 85, "Input",ExpressionUUID->"8331c5f9-92bc-9347-8078-669c615e9f37"],
Cell[56385, 1397, 139, 2, 28, "Input",ExpressionUUID->"283b5187-a2f1-ef49-b5fd-690301eeecfb"],
Cell[56527, 1401, 152, 3, 28, "Input",ExpressionUUID->"79788ce8-4cec-0840-aa08-3875ff1d3e80"],
Cell[56682, 1406, 154, 3, 28, "Input",ExpressionUUID->"f0ade162-6b1f-0f48-a2c9-2be142b63af0"],
Cell[56839, 1411, 156, 3, 47, "Input",ExpressionUUID->"52999333-fe05-e84a-acf1-fc22be5bf2ea"],
Cell[56998, 1416, 152, 3, 28, "Input",ExpressionUUID->"e44d3794-52ef-d540-95ab-731b5a7762cd"],
Cell[57153, 1421, 174, 3, 28, "Input",ExpressionUUID->"28629b7d-e028-5846-af8b-9f2b85a1dc47"],
Cell[57330, 1426, 144, 2, 28, "Input",ExpressionUUID->"e55264a3-3c28-884f-aa83-8e502c7364cc"],
Cell[57477, 1430, 154, 3, 28, "Input",ExpressionUUID->"53dfc11f-fccd-cd48-934d-0bdae6dc2306"],
Cell[57634, 1435, 144, 2, 28, "Input",ExpressionUUID->"4872fec1-2e2d-8f47-88e7-ab3bbb9b5585"],
Cell[57781, 1439, 154, 3, 28, "Input",ExpressionUUID->"4cec27a2-cefe-5d4d-80b5-b6621fdb0cf4"],
Cell[57938, 1444, 81, 0, 28, "Input",ExpressionUUID->"7ac59aaa-0927-bb4e-a803-639587cde41b"],
Cell[58022, 1446, 179, 3, 28, "Input",ExpressionUUID->"924a110a-67bc-4749-9189-169660317c54"],
Cell[58204, 1451, 156, 3, 28, "Input",ExpressionUUID->"65b3d420-0425-f249-80e5-5dc6a13ce3c4"],
Cell[58363, 1456, 104, 1, 28, "Input",ExpressionUUID->"c41eee93-8b45-4c47-8d30-e7d8dc6d4ab1"],
Cell[58470, 1459, 81, 0, 28, "Input",ExpressionUUID->"4b97082b-f52c-d940-8b60-cf5f1725bfda"]
}
]
*)

