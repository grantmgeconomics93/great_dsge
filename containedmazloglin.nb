(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    277693,       7362]
NotebookOptionsPosition[    270349,       7264]
NotebookOutlinePosition[    270801,       7281]
CellTagsIndexPosition[    270758,       7278]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.9424097710067005`*^9, 3.9424097735303288`*^9}, 
   3.942409986837412*^9, {3.942410224952446*^9, 3.942410250698843*^9}, 
   3.942414205266445*^9, 3.9424171668779297`*^9, 3.942419692092272*^9, 
   3.9424204177254696`*^9, 3.9424204789909916`*^9, {3.942420720045725*^9, 
   3.942420728957245*^9}, {3.9424208281063786`*^9, 3.9424208471915607`*^9}, {
   3.942420880106722*^9, 3.942420886782583*^9}, 3.9424222361942863`*^9, {
   3.942423052980547*^9, 3.9424230739505024`*^9}, 3.942423164222044*^9, 
   3.9424232036387615`*^9, {3.9424232833174133`*^9, 3.942423307845436*^9}, {
   3.942423342657379*^9, 3.942423370843012*^9}, {3.9424235561691933`*^9, 
   3.942423573217308*^9}, 3.9424237825038567`*^9, 3.942423914171425*^9, 
   3.94248768227162*^9, 3.942502868082756*^9, 3.942503100647709*^9, 
   3.942503140525156*^9, 3.9425046010225945`*^9, {3.9425052399102135`*^9, 
   3.9425052421572056`*^9}, {3.9425064032796345`*^9, 3.9425064272894344`*^9}, 
   3.94250658942535*^9, 3.9425067828417664`*^9, 3.942506854326124*^9, {
   3.9425079465509777`*^9, 3.94250799672328*^9}, 3.9425081754514484`*^9, 
   3.942510581203039*^9, {3.942511009251314*^9, 3.942511017852148*^9}, {
   3.942511221733576*^9, 3.9425112586265945`*^9}, 3.9425117108579197`*^9, 
   3.9425117602628727`*^9, {3.942511856447809*^9, 3.9425119345891457`*^9}, 
   3.9425122263945293`*^9, {3.942512955427664*^9, 3.9425129698917313`*^9}, {
   3.94251301365139*^9, 3.9425130307669353`*^9}, {3.942513108585476*^9, 
   3.942513112112303*^9}, {3.9425135466473694`*^9, 3.942513556385315*^9}, {
   3.942513868974186*^9, 3.942513921787203*^9}, {3.9425139580605755`*^9, 
   3.9425139700600357`*^9}, 3.9425140419308376`*^9, {3.942514134970972*^9, 
   3.9425141648856773`*^9}, {3.9425141998729115`*^9, 
   3.9425142444404106`*^9}, {3.9425142927988625`*^9, 3.942514303916441*^9}, {
   3.9425148598096733`*^9, 3.9425148712374344`*^9}, {3.942514910480751*^9, 
   3.942514917020756*^9}, {3.942514973867367*^9, 3.9425150148147144`*^9}, 
   3.9425161769270763`*^9, 3.9425162112263985`*^9, {3.9425166428949184`*^9, 
   3.942516672205147*^9}, {3.942517042567255*^9, 3.9425170621009064`*^9}, {
   3.9425171674338245`*^9, 3.9425171874190807`*^9}, 3.942517223580761*^9, 
   3.9425173582750072`*^9, 3.942517406842678*^9, {3.9425176475276356`*^9, 
   3.942517664750183*^9}, {3.942517718150387*^9, 3.942517744371004*^9}, {
   3.9425178154654617`*^9, 3.942517834731922*^9}, 3.942517913433714*^9, 
   3.942518014903372*^9, {3.9425881118939304`*^9, 3.942588226554573*^9}, {
   3.9425896390154*^9, 3.942589660098751*^9}, {3.9425905522714367`*^9, 
   3.942590594677908*^9}, {3.9425911684561577`*^9, 3.9425911698701305`*^9}, 
   3.942751573759756*^9, 3.942751621808159*^9, 3.9427516680874004`*^9, {
   3.9427517329189034`*^9, 3.9427517351424484`*^9}, {3.9427519255838013`*^9, 
   3.9427519869494553`*^9}, 3.9427520332742233`*^9, 3.942752333177307*^9, {
   3.942752770986908*^9, 3.9427527730965176`*^9}, {3.94275302368054*^9, 
   3.942753025683384*^9}, {3.9428474340546665`*^9, 3.9428474362622166`*^9}, {
   3.9428483214733906`*^9, 3.942848362170891*^9}, 3.9428484049196663`*^9, 
   3.942848454450346*^9, {3.9428490839405823`*^9, 3.942849160084255*^9}, {
   3.942849213918829*^9, 3.942849287185663*^9}, {3.9428493507735596`*^9, 
   3.942849353695465*^9}, 3.9428493846297016`*^9, {3.942850052822735*^9, 
   3.9428500750204296`*^9}, {3.9428501420583496`*^9, 
   3.9428501459492645`*^9}, {3.9428503972435436`*^9, 
   3.9428504100488663`*^9}, {3.942853049260662*^9, 3.9428530504676895`*^9}, {
   3.942853092458111*^9, 3.9428531192472134`*^9}, {3.942853353568598*^9, 
   3.9428533545898075`*^9}, {3.9428533987449627`*^9, 
   3.9428534229557915`*^9}, {3.9429231648091373`*^9, 3.942923166138708*^9}, {
   3.9429246809890385`*^9, 3.942924683690712*^9}, {3.9429247321913033`*^9, 
   3.942924732889475*^9}, {3.9429254250561047`*^9, 3.9429254513153687`*^9}, 
   3.9429254838702602`*^9, {3.9429255434986267`*^9, 3.942925560423479*^9}, {
   3.942925616054928*^9, 3.942925642339443*^9}, {3.9429261874701004`*^9, 
   3.9429262104446373`*^9}, {3.942926484765465*^9, 3.942926497715992*^9}, {
   3.94292658112232*^9, 3.9429265839319725`*^9}, {3.9429267900613174`*^9, 
   3.9429267947414474`*^9}, 3.9429268487589626`*^9, {3.94293422696509*^9, 
   3.9429342288360386`*^9}, {3.9429343606643944`*^9, 
   3.9429343661244335`*^9}, {3.942934751577406*^9, 3.9429347571734104`*^9}, {
   3.9429348102113075`*^9, 3.942934825030098*^9}, 3.9429349712800045`*^9, {
   3.942935395628916*^9, 3.9429354119468803`*^9}, {3.942935638691334*^9, 
   3.9429356840764217`*^9}, 3.9429360778661404`*^9, {3.9429361132493095`*^9, 
   3.9429361676882057`*^9}, {3.942936520458252*^9, 3.942936526243181*^9}, {
   3.9429461492206955`*^9, 3.9429461723246975`*^9}, {3.943008575399826*^9, 
   3.943008584860981*^9}, {3.943012952041334*^9, 3.9430129533912315`*^9}, {
   3.9430272878138313`*^9, 3.9430272905139027`*^9}, 3.943106855318901*^9, {
   3.943373167306566*^9, 
   3.943373172855282*^9}},ExpressionUUID->"f9fb2cec-0218-1946-a7a4-\
614cfc63c79f"],

Cell[BoxData[""], "Input",ExpressionUUID->"93063096-b854-5642-83fe-da57c1f294a1"],

Cell[BoxData[""], "Input",ExpressionUUID->"0708fca9-59ce-8847-af89-18fc69779938"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"patient", " ", "households", " ", "Lagrange"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "Parameters", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"params", "=", 
    RowBox[{"{", 
     RowBox[{
     "betaP", ",", "alpha", ",", "xiP", ",", "epsilonP", ",", "phi", ",", 
      "qh", ",", 
      RowBox[{"wt", "[", "t", "]"}], ",", 
      RowBox[{"rt", "[", "t", "]"}], ",", 
      RowBox[{"pit", "[", "t", "]"}], ",", 
      RowBox[{"cp", "[", "t", "]"}], ",", 
      RowBox[{"dp", "[", "t", "]"}], ",", 
      RowBox[{"hp", "[", "t", "]"}], ",", 
      RowBox[{"lambdaP", "[", "t", "]"}]}], "}"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Utility", " ", "function", " ", "for", " ", "patient", " ", 
    "households"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uPatient", "[", 
     RowBox[{"cp_", ",", "cpLag_", ",", "hp_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "alpha"}], ")"}], " ", "xiP", " ", 
      RowBox[{"Log", "[", 
       RowBox[{"cp", "-", 
        RowBox[{"a", " ", "cpLag"}]}], "]"}]}], "+", 
     RowBox[{"epsilonP", " ", 
      RowBox[{"Log", "[", "hp", "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"hp", "^", 
        RowBox[{"(", 
         RowBox[{"1", "+", "phi"}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", "phi"}], ")"}]}]}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Budget", " ", "constraint", " ", "for", " ", "patient", " ", "households",
     " ", "in", " ", "period", " ", "t"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BCPatient", "[", "t_", "]"}], ":=", 
    RowBox[{
     RowBox[{"cp", "[", "t", "]"}], "+", 
     RowBox[{"qh", " ", 
      RowBox[{"hp", "[", "t", "]"}]}], "+", 
     RowBox[{"dp", "[", "t", "]"}], "-", 
     RowBox[{
      RowBox[{"wt", "[", "t", "]"}], " ", 
      RowBox[{"hp", "[", "t", "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"rt", "[", 
           RowBox[{"t", "-", "1"}], "]"}]}], ")"}], "/", 
        RowBox[{"pit", "[", "t", "]"}]}], ")"}], " ", 
      RowBox[{"dp", "[", 
       RowBox[{"t", "-", "1"}], "]"}]}]}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Define", " ", "Lagrangian", " ", "for", " ", "two", " ", "periods", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"t", " ", "and", " ", "t"}], "+", "1"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LP", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"uPatient", "[", 
        RowBox[{
         RowBox[{"cp", "[", "t", "]"}], ",", 
         RowBox[{"cp", "[", 
          RowBox[{"t", "-", "1"}], "]"}], ",", 
         RowBox[{"hp", "[", "t", "]"}]}], "]"}], "+", 
       RowBox[{
        RowBox[{"lambdaP", "[", "t", "]"}], "*", 
        RowBox[{"BCPatient", "[", "t", "]"}]}]}], ")"}], "+", 
     RowBox[{
      RowBox[{"betaP", "^", 
       RowBox[{"(", 
        RowBox[{"t", "+", "1"}], ")"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"uPatient", "[", 
         RowBox[{
          RowBox[{"cp", "[", 
           RowBox[{"t", "+", "1"}], "]"}], ",", 
          RowBox[{"cp", "[", "t", "]"}], ",", 
          RowBox[{"hp", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{"lambdaP", "[", 
          RowBox[{"t", "+", "1"}], "]"}], "*", 
         RowBox[{"BCPatient", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}]}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"First", "-", 
    RowBox[{
    "order", " ", "conditions", " ", "for", " ", "patient", " ", 
     "households"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"focPCt", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"LP", ",", 
       RowBox[{"cp", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], 
  "        ", 
  RowBox[{"(*", 
   RowBox[{"FOC", " ", "with", " ", "respect", " ", "to", " ", 
    RowBox[{"cp", "[", "t", "]"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"focPHt", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"LP", ",", 
       RowBox[{"hp", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], 
  "        ", 
  RowBox[{"(*", 
   RowBox[{"FOC", " ", "with", " ", "respect", " ", "to", " ", 
    RowBox[{"hp", "[", "t", "]"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"focPdP", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"LP", ",", 
       RowBox[{"dp", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], 
  "        ", 
  RowBox[{"(*", 
   RowBox[{"FOC", " ", "with", " ", "respect", " ", "to", " ", 
    RowBox[{"dp", "[", "t", "]"}]}], "*)"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Debug", " ", "the", " ", "FOCs", " ", "before", " ", "solving"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"debugFOCs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<FOC wrt cp[t]\>\"", "->", "focPCt"}], ",", 
     RowBox[{"\"\<FOC wrt hp[t]\>\"", "->", "focPHt"}], ",", 
     RowBox[{"\"\<FOC wrt dp[t]\>\"", "->", "focPdP"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", "debugFOCs", "\n"}], "Input",
 CellChangeTimes->{{3.942591478649725*^9, 3.942591478649725*^9}, 
   3.9425915249837914`*^9, {3.942591893611925*^9, 3.9425919125734234`*^9}, 
   3.9425920148237686`*^9, {3.9431068767277374`*^9, 3.9431068801445446`*^9}, {
   3.943373150584465*^9, 3.943373154683838*^9}, 3.943530733499941*^9, {
   3.9435311122916813`*^9, 3.9435311485272903`*^9}, {3.9436169128066196`*^9, 
   3.943616924451643*^9}, {3.943617362437744*^9, 3.943617382325964*^9}, {
   3.9436179521460266`*^9, 3.943617955790903*^9}, {3.9453529856666317`*^9, 
   3.9453530067840347`*^9}, {3.945361819427248*^9, 3.9453618221393833`*^9}, {
   3.9466612675401*^9, 3.9466612786488857`*^9}, {3.9466613158820724`*^9, 
   3.94666132181089*^9}, 3.9471762973235054`*^9, {3.94717643434391*^9, 
   3.9471764402908535`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"9ace75de-4978-4347-8abf-940e21a736de"],

Cell[CellGroupData[{

Cell[BoxData[""], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.9453530115724983`*^9, {3.9453567033453445`*^9, 3.945356704812771*^9}, {
   3.9453567451134853`*^9, 3.945356790620058*^9}, 3.945361873726124*^9, 
   3.945444393223093*^9, 3.9466611651340885`*^9, 3.9466612297905045`*^9, 
   3.946661287221405*^9, 3.9466613275977764`*^9, 3.9471763760931816`*^9, {
   3.947176416060137*^9, 
   3.9471764208432503`*^9}},ExpressionUUID->"3180c1ab-5e0d-ca40-9394-\
5e86f56408d7"],

Cell[BoxData[""], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.9453530115724983`*^9, {3.9453567033453445`*^9, 3.945356704812771*^9}, {
   3.9453567451134853`*^9, 3.945356790620058*^9}, 3.945361873726124*^9, 
   3.945444393223093*^9, 3.9466611651340885`*^9, 3.9466612297905045`*^9, 
   3.946661287221405*^9, 
   3.947176360899105*^9},ExpressionUUID->"cba57453-8210-be49-9e99-\
e7c7a95b445f"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Define", " ", "the", " ", "equation"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"eq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"epsilonP", "/", 
         RowBox[{"hp", "[", "t", "]"}]}], ")"}], "-", 
       RowBox[{
        RowBox[{"hp", "[", "t", "]"}], "^", "phi"}], "+", 
       RowBox[{
        RowBox[{"lambdaP", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"qh", "-", 
          RowBox[{"wt", "[", "t", "]"}]}], ")"}]}]}], "==", "0"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Solve", " ", "for", " ", 
     RowBox[{"lambdaP", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"lambdaSolution", "=", 
    RowBox[{"Solve", "[", 
     RowBox[{"eq", ",", 
      RowBox[{"lambdaP", "[", "t", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Output", " ", "the", " ", "solution"}], "*)"}], "\n", 
   "lambdaSolution", "\[IndentingNewLine]", "\n"}]}]], "Input",
 CellChangeTimes->{{3.9471770066521263`*^9, 3.947177006654125*^9}, {
   3.9471771841496162`*^9, 3.9471772197199135`*^9}, {3.947177358902153*^9, 
   3.947177397399147*^9}, 3.947177812835148*^9},
 CellLabel->"In[56]:=",ExpressionUUID->"6cbdf14f-fcad-b24a-9b64-6f911cd48fed"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", "\n"}]], "Input",
 CellChangeTimes->{{3.9471770066521263`*^9, 3.947177006654125*^9}, {
   3.9471771841496162`*^9, 3.9471772197199135`*^9}, {3.947177358902153*^9, 
   3.947177397399147*^9}, 
   3.947177812835148*^9},ExpressionUUID->"4978f1f1-0572-b84b-b184-\
a61a2eb98030"],

Cell[CellGroupData[{

Cell[BoxData[""], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.9453530115724983`*^9, {3.9453567033453445`*^9, 3.945356704812771*^9}, {
   3.9453567451134853`*^9, 3.945356790620058*^9}, 3.945361873726124*^9, 
   3.945444393223093*^9, 3.9466611651340885`*^9, 3.9466612297905045`*^9, 
   3.947176336343334*^9},ExpressionUUID->"3b40c5c1-cbf0-244a-912a-\
65c58f9ab2e4"],

Cell[BoxData[""], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.9453530115724983`*^9, {3.9453567033453445`*^9, 3.945356704812771*^9}, {
   3.9453567451134853`*^9, 3.945356790620058*^9}, 3.945361873726124*^9, 
   3.945444393223093*^9, 
   3.9466611651340885`*^9},ExpressionUUID->"3dd3e17b-7b29-3d40-970d-\
7f04b4476b62"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Define", " ", "the", " ", "equations"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"eq1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "alpha"}], ")"}], " ", "xiP"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "a"}], " ", 
           RowBox[{"cp", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
          RowBox[{"cp", "[", "t", "]"}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "alpha"}], ")"}], " ", 
          RowBox[{"betaP", "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "t"}], ")"}]}], " ", "xiP"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "a"}], " ", 
           RowBox[{"cp", "[", "t", "]"}]}], "+", 
          RowBox[{"cp", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
       RowBox[{"lambdaP", "[", "t", "]"}]}], "==", "0"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"eq2", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"lambdaP", "[", "t", "]"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"betaP", "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "t"}], ")"}]}], " ", 
          RowBox[{"lambdaP", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"rt", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
        RowBox[{"pit", "[", 
         RowBox[{"1", "+", "t"}], "]"}]}]}], "==", "0"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Define", " ", "substitution", " ", "rules", " ", "for", " ", 
     RowBox[{"lambda", "[", "t", "]"}], " ", "and", " ", 
     RowBox[{"lambda", "[", 
      RowBox[{"t", "+", "1"}], "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"lambdaRule", "=", 
     RowBox[{
      RowBox[{"lambdaP", "[", "t", "]"}], "->", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "epsilonP"}], "+", 
         RowBox[{
          RowBox[{"hp", "[", "t", "]"}], "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"hp", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"qh", "-", 
           RowBox[{"wt", "[", "t", "]"}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"lambdaFutureRule", "=", 
     RowBox[{
      RowBox[{"lambdaP", "[", 
       RowBox[{"t", "+", "1"}], "]"}], "->", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "epsilonP"}], "+", 
         RowBox[{
          RowBox[{"hp", "[", 
           RowBox[{"t", "+", "1"}], "]"}], "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"hp", "[", 
          RowBox[{"t", "+", "1"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"qh", "-", 
           RowBox[{"wt", "[", 
            RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Substitute", " ", "the", " ", "lambda", " ", "expressions", " ", "into", 
     " ", "the", " ", "equations"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"eq1Substituted", "=", 
     RowBox[{"eq1", "/.", " ", "lambdaRule"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"eq2Substituted", "=", 
     RowBox[{"eq2", "/.", " ", 
      RowBox[{"{", 
       RowBox[{"lambdaRule", ",", "lambdaFutureRule"}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Simplify", " ", "the", " ", "resulting", " ", "equations"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"eq1Simplified", "=", 
     RowBox[{"Simplify", "[", "eq1Substituted", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"eq2Simplified", "=", 
     RowBox[{"Simplify", "[", "eq2Substituted", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Output", " ", "the", " ", "final", " ", "equations"}], "*)"}], "\n", 
   RowBox[{"{", 
    RowBox[{"eq1Simplified", ",", "eq2Simplified"}], "}"}], "\n"}]}]], "Input",
 CellChangeTimes->{3.9471778347934628`*^9},
 CellLabel->"In[70]:=",ExpressionUUID->"aec07186-9953-eb4b-a898-e758c5d4aabf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "alpha"}], ")"}], " ", "xiP"}], 
       RowBox[{
        RowBox[{"a", " ", 
         RowBox[{"cp", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "-", 
        RowBox[{"cp", "[", "t", "]"}]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "epsilonP"}], "+", 
        SuperscriptBox[
         RowBox[{"hp", "[", "t", "]"}], 
         RowBox[{"1", "+", "phi"}]]}], 
       RowBox[{
        RowBox[{"hp", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"qh", "-", 
          RowBox[{"wt", "[", "t", "]"}]}], ")"}]}]]}], "\[Equal]", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "alpha"}], ")"}], " ", 
       SuperscriptBox["betaP", 
        RowBox[{"1", "+", "t"}]], " ", "xiP"}], 
      RowBox[{
       RowBox[{"a", " ", 
        RowBox[{"cp", "[", "t", "]"}]}], "-", 
       RowBox[{"cp", "[", 
        RowBox[{"1", "+", "t"}], "]"}]}]]}], ",", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"-", "epsilonP"}], "+", 
        SuperscriptBox[
         RowBox[{"hp", "[", "t", "]"}], 
         RowBox[{"1", "+", "phi"}]]}], 
       RowBox[{
        RowBox[{"hp", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"qh", "-", 
          RowBox[{"wt", "[", "t", "]"}]}], ")"}]}]], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["betaP", 
         RowBox[{"1", "+", "t"}]], " ", 
        RowBox[{"(", 
         RowBox[{"epsilonP", "-", 
          SuperscriptBox[
           RowBox[{"hp", "[", 
            RowBox[{"1", "+", "t"}], "]"}], 
           RowBox[{"1", "+", "phi"}]]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"rt", "[", "t", "]"}]}], ")"}]}], 
       RowBox[{
        RowBox[{"hp", "[", 
         RowBox[{"1", "+", "t"}], "]"}], " ", 
        RowBox[{"pit", "[", 
         RowBox[{"1", "+", "t"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"qh", "-", 
          RowBox[{"wt", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}]]}], "\[Equal]", "0"}]}], 
   "}"}], "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"1", ")"}], " ", "Clear", " ", "and", " ", "declare", " ", "all", 
    " ", "variables", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "so", " ", "they", " ", "are", " ", "treated", " ", "purely", " ", "as",
        " ", "symbols"}], ")"}], "."}]}], "*)"}], 
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"cp1", ",", "cpt", ",", "cp2", ",", "hp", ",", "w"}], "]"}], 
   ";"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "alpha", ",", "xiP", ",", "a", ",", "cpBar", ",", "hpBar", ",", "wBar", ",",
      "qh", ",", "epsilonP", ",", "betaP", ",", "phi", ",", "t"}], "]"}], 
   ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"Optionally", ",", 
    RowBox[{
     RowBox[{"load", " ", "them", " ", "as", " ", 
      RowBox[{"symbols", ":", 
       RowBox[{"Symbol", "/@", 
        RowBox[{"{", 
         RowBox[{"\"\<cp1\>\"", ",", "\"\<cpt\>\"", ",", "\"\<cp2\>\"", 
          ",", "\"\<hp\>\"", ",", "\"\<w\>\"", ",", "\"\<alpha\>\"", 
          ",", "\"\<xiP\>\"", ",", "\"\<a\>\"", ",", "\"\<cpBar\>\"", 
          ",", "\"\<hpBar\>\"", ",", "\"\<wBar\>\"", ",", "\"\<qh\>\"", 
          ",", "\"\<epsilonP\>\"", ",", "\"\<betaP\>\"", ",", "\"\<phi\>\"", 
          ",", "\"\<t\>\""}], "}"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"But", " ", 
      RowBox[{"simply", "'"}], 
      RowBox[{"ClearAll", "'"}], " ", "is", " ", "typically", " ", 
      RowBox[{"enough", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"2", ")"}], " ", "Define", " ", "the", " ", "original", " ", 
     "equation", " ", "as", " ", "F", 
     RowBox[{"(", "...", ")"}]}], "==", "0."}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{"cp1_", ",", "cpt_", ",", "cp2_", ",", "hp_", ",", "w_"}], "]"}],
     ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "alpha"}], ")"}], " ", "xiP"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", " ", "cp1"}], "-", "cpt"}], ")"}]}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "epsilonP"}], "+", 
         RowBox[{"hp", "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"hp", " ", 
         RowBox[{"(", 
          RowBox[{"qh", "-", "w"}], ")"}]}], ")"}]}], ")"}], "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "alpha"}], ")"}], " ", 
         RowBox[{"betaP", "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "t"}], ")"}]}], " ", "xiP"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", "cpt"}], "-", "cp2"}], ")"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"3", ")"}], " ", "Collect", " ", "the", " ", "variables", " ", 
    RowBox[{"we", "'"}], "ll", " ", "differentiate", " ", "with", " ", 
    "respect", " ", 
    RowBox[{"to", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vars", "=", 
    RowBox[{"{", 
     RowBox[{"cp1", ",", "cpt", ",", "cp2", ",", "hp", ",", "w"}], "}"}]}], 
   ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"4", ")"}], " ", "Compute", " ", "partial", " ", "derivatives", " ",
      "of", " ", "F", " ", "at", " ", "the", " ", "steady", " ", 
     RowBox[{"state", ".", "The"}], " ", "replacement", " ", "forces", " ", 
     "each", " ", "variable", " ", "to", " ", "be", " ", "its", " ", 
     "steady"}], "\[Hyphen]", 
    RowBox[{"state", " ", "value", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"cpBar", ",", "hpBar", ",", 
        RowBox[{"etc", "."}]}], ")"}], "."}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"partials", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"F", "@@", "vars"}], ",", 
         RowBox[{"vars", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cp1", "->", "cpBar"}], ",", 
         RowBox[{"cpt", "->", "cpBar"}], ",", 
         RowBox[{"cp2", "->", "cpBar"}], ",", 
         RowBox[{"hp", "->", "hpBar"}], ",", 
         RowBox[{"w", "->", "wBar"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"5", ")"}], " ", "Define", " ", "symbols", " ", "for", " ", 
     "log"}], "\[Hyphen]", 
    RowBox[{"deviations", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d", " ", "ln", " ", "X"}], ")"}], "."}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"cHat1", ",", "cHatT", ",", "cHat2", ",", "hHat", ",", "wHat"}], 
    "]"}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"6", ")"}], " ", "Multiply", " ", "each", " ", "partial", " ", 
     "by", " ", "XBar", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"hat", " ", "variable"}], ")"}], ".", "This"}], " ", "yields", 
     " ", "the", " ", "linearized", " ", "equation", " ", "F"}], "=", 
    RowBox[{"0", " ", "in", " ", "terms", " ", "of", " ", 
     RowBox[{"hats", "."}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varsBar", "=", 
   RowBox[{"{", 
    RowBox[{"cpBar", ",", "cpBar", ",", "cpBar", ",", "hpBar", ",", "wBar"}], 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEq", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", "cpBar", "*", "cHat1"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", "cpBar", "*", "cHatT"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "*", "cpBar", "*", "cHat2"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "*", "hpBar", "*", "hHat"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "*", "wBar", "*", "wHat"}]}], "==", 
     "0"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"7", ")"}], " ", "Simplify", " ", "the", " ", "final", " ", 
    "linear", " ", 
    RowBox[{"equation", "."}]}], "*)"}]}], "\n", 
 RowBox[{"Simplify", "[", "logLinEq", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Replace", " ", "steady", " ", "state", " ", "variables", " ", "with", " ",
     "1", " ", "to", " ", "eliminate", " ", "them"}], "*)"}], 
  RowBox[{
   RowBox[{"logLinEqNoBar", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"logLinEq", "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"cpBar", "->", "1"}], ",", 
        RowBox[{"hpBar", "->", "1"}], ",", 
        RowBox[{"wBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}]}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Define", " ", "substitution", " ", "rules", " ", "to", " ", "reintroduce",
     " ", "time", " ", "indices"}], "*)"}], 
  RowBox[{
   RowBox[{"timeSubs", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"cHat1", "->", 
       RowBox[{"cHat", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], ",", 
      RowBox[{"cHatT", "->", 
       RowBox[{"cHat", "[", "t", "]"}]}], ",", 
      RowBox[{"cHat2", "->", 
       RowBox[{"cHat", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], ",", 
      RowBox[{"hHat", "->", 
       RowBox[{"hHat", "[", "t", "]"}]}], ",", 
      RowBox[{"wHat", "->", 
       RowBox[{"wHat", "[", "t", "]"}]}], ",", 
      RowBox[{
       RowBox[{"betaP", "^", 
        RowBox[{"(", 
         RowBox[{"1", "+", "t"}], ")"}]}], "->", 
       RowBox[{"betaP", "^", 
        RowBox[{"(", 
         RowBox[{"t", "+", "1"}], ")"}]}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Apply", " ", "the", " ", "substitution", " ", "to", " ", "the", " ", 
     "log"}], "-", 
    RowBox[{"linearized", " ", "equation"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqTimeIndexed", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], 
  "\[IndentingNewLine]", "\n"}], "\[IndentingNewLine]", "eqTimeIndexed", "\n", 
 RowBox[{"ful", "=", 
  RowBox[{
  "FullSimplify", "[", "eqTimeIndexed", 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9472605060053177`*^9, 3.9472605107869415`*^9}, {
   3.9472605593338985`*^9, 3.947260564568186*^9}, {3.9472627523949776`*^9, 
   3.9472627563084297`*^9}, 3.947263042091564*^9, {3.9476129373485565`*^9, 
   3.947612939510252*^9}, {3.9476132526794376`*^9, 3.9476132613216953`*^9}, {
   3.9476132917043533`*^9, 3.9476132994810257`*^9}, {3.947689046932955*^9, 
   3.947689049203066*^9}, {3.947689131070076*^9, 3.947689139681988*^9}, 
   3.947690286768343*^9, {3.9479488066840305`*^9, 3.947948848141241*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"dc40e394-a162-e344-af1c-469b5ff19c55"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9472605060053177`*^9, 3.9472605107869415`*^9}, {
   3.9472605593338985`*^9, 3.947260564568186*^9}, {3.9472627523949776`*^9, 
   3.9472627563084297`*^9}, 3.947263042091564*^9, {3.9472639555408535`*^9, 
   3.9472639825124454`*^9}},ExpressionUUID->"5a156fc5-2eb4-7e48-b51d-\
4ec8fa2678b1"],

Cell[BoxData[""], "Input",ExpressionUUID->"67031162-bd98-8f49-8550-4b19913fb9a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "1.", " ", "Clear", " ", "and", " ", "declare", " ", "all", " ", 
    "variables", " ", "as", " ", 
    RowBox[{"symbols", "."}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "hpT", ",", "wtT", ",", "hpT1", ",", "wtT1", ",", "pitT1", ",", "rtT", ",",
       "epsilonP", ",", "phi", ",", "qh", ",", "betaP", ",", "t"}], "]"}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "hpBar", ",", "wtBar", ",", "hpBar1", ",", "wtBar1", ",", "pitBar1", ",",
       "rtBar"}], "]"}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"Optionally", ",", 
     RowBox[{
      RowBox[{"load", " ", "them", " ", "as", " ", 
       RowBox[{"symbols", ":", 
        RowBox[{"Symbol", "/@", 
         RowBox[{"{", 
          
          RowBox[{"\"\<hpT\>\"", ",", "\"\<wtT\>\"", ",", "\"\<hpT1\>\"", 
           ",", "\"\<wtT1\>\"", ",", "\"\<pitT1\>\"", ",", "\"\<rtT\>\"", 
           ",", "\"\<epsilonP\>\"", ",", "\"\<phi\>\"", ",", "\"\<qh\>\"", 
           ",", "\"\<betaP\>\"", ",", "\"\<t\>\"", ",", "\"\<hpBar\>\"", 
           ",", "\"\<wtBar\>\"", ",", "\"\<hpBar1\>\"", ",", "\"\<wtBar1\>\"",
            ",", "\"\<pitBar1\>\"", ",", "\"\<rtBar\>\""}], "}"}]}]}]}], 
      ";"}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "2.", " ", "Define", " ", "the", " ", "original", " ", "equation", " ", 
      "as", " ", "F", 
      RowBox[{"(", "...", ")"}]}], "==", "0."}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{
      "hpT_", ",", "wtT_", ",", "hpT1_", ",", "wtT1_", ",", "pitT1_", ",", 
       "rtT_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "epsilonP"}], "+", 
         RowBox[{"hpT", "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"hpT", "*", 
         RowBox[{"(", 
          RowBox[{"qh", "-", "wtT"}], ")"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"betaP", "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "t"}], ")"}]}], "*", 
         RowBox[{"(", 
          RowBox[{"epsilonP", "-", 
           RowBox[{"hpT1", "^", 
            RowBox[{"(", 
             RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"1", "+", "rtT"}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"hpT1", "*", "pitT1", "*", 
         RowBox[{"(", 
          RowBox[{"qh", "-", "wtT1"}], ")"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "Specify", " ", "the", " ", "list", " ", "of", " ", 
     "variables", " ", "to", " ", "differentiate", " ", "with", " ", 
     "respect", " ", 
     RowBox[{"to", "."}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{
      "hpT", ",", "wtT", ",", "hpT1", ",", "wtT1", ",", "pitT1", ",", "rtT"}],
       "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "4.", " ", "Compute", " ", "the", " ", "partial", " ", "derivatives", " ",
       "of", " ", "F", " ", "with", " ", "respect", " ", "to", " ", "each", " ",
       "variable"}], ",", 
     RowBox[{"evaluating", " ", "at", " ", "the", " ", "steady", " ", 
      RowBox[{"state", ".", "Here"}], " ", "we", " ", "use", " ", "different",
       " ", "steady", " ", "state", " ", 
      RowBox[{"names", ":", "hpT"}]}], ",", 
     RowBox[{"wtT", " ", "at", " ", "time", " ", "t"}], ",", 
     RowBox[{"and", " ", "hpT1"}], ",", "wtT1", ",", 
     RowBox[{
      RowBox[{"pitT1", " ", "at", " ", "time", " ", "t"}], "+", "1"}], ",", 
     RowBox[{"with", " ", "rtT", " ", "at", " ", "time", " ", 
      RowBox[{"t", "."}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"hpT", "->", "hpBar"}], ",", 
          RowBox[{"wtT", "->", "wtBar"}], ",", 
          RowBox[{"hpT1", "->", "hpBar1"}], ",", 
          RowBox[{"wtT1", "->", "wtBar1"}], ",", 
          RowBox[{"pitT1", "->", "pitBar1"}], ",", 
          RowBox[{"rtT", "->", "rtBar"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"5.", " ", "Define", " ", "symbols", " ", "for", " ", "log"}], "-", 
     RowBox[{"deviations", "."}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "hHatT", ",", "wtHatT", ",", "hHatT1", ",", "wtHatT1", ",", "pitHatT1", ",",
       "rtHatT"}], "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "6.", " ", "Multiply", " ", "each", " ", "partial", " ", "derivative", " ",
       "by", " ", "the", " ", "steady", " ", "state", " ", "value", " ", "of",
       " ", "its", " ", "variable", " ", "and", " ", "the", " ", 
      "corresponding", " ", "log"}], "-", 
     RowBox[{"deviation", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", " ", "ln", " ", "X"}], ")"}], ".", "This"}], " ", 
      "gives", " ", "the", " ", "linearized", " ", 
      RowBox[{"equation", "."}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"varsBar", "=", 
     RowBox[{"{", 
      RowBox[{
      "hpBar", ",", "wtBar", ",", "hpBar1", ",", "wtBar1", ",", "pitBar1", ",",
        "rtBar"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", "hpBar", "*", "hHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", "wtBar", "*", "wtHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", "hpBar1", "*", "hHatT1"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "*", "wtBar1", "*", "wtHatT1"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "*", "pitBar1", "*", "pitHatT1"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "*", "rtBar", "*", "rtHatT"}]}], "==",
       "0"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"7.", " ", "Simplify", " ", "the", " ", "final", " ", "linear", " ", 
     RowBox[{"equation", "."}]}], "*)"}], "\n", 
   RowBox[{"simplifiedLogLinEq", "=", 
    RowBox[{"Simplify", "[", "logLinEq", "]"}]}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Optionally", ",", 
     RowBox[{
     "replace", " ", "steady", " ", "state", " ", "values", " ", "with", " ", 
      "1", " ", "to", " ", "eliminate", " ", 
      RowBox[{"them", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEqNoBar", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"simplifiedLogLinEq", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"hpBar", "->", "1"}], ",", 
         RowBox[{"wtBar", "->", "1"}], ",", 
         RowBox[{"hpBar1", "->", "1"}], ",", 
         RowBox[{"wtBar1", "->", "1"}], ",", 
         RowBox[{"pitBar1", "->", "1"}], ",", 
         RowBox[{"rtBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "8.", " ", "Define", " ", "substitution", " ", "rules", " ", "to", " ", 
     "reintroduce", " ", "time", " ", 
     RowBox[{"indices", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"timeSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"hHatT", "->", 
        RowBox[{"hHat", "[", "t", "]"}]}], ",", 
       RowBox[{"wtHatT", "->", 
        RowBox[{"wtHat", "[", "t", "]"}]}], ",", 
       RowBox[{"hHatT1", "->", 
        RowBox[{"hHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"wtHatT1", "->", 
        RowBox[{"wtHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"pitHatT1", "->", 
        RowBox[{"pitHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"rtHatT", "->", 
        RowBox[{"rtHat", "[", "t", "]"}]}], ",", 
       RowBox[{
        RowBox[{"betaP", "^", 
         RowBox[{"(", 
          RowBox[{"1", "+", "t"}], ")"}]}], "->", 
        RowBox[{"betaP", "^", 
         RowBox[{"(", 
          RowBox[{"t", "+", "1"}], ")"}]}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"eqTimeIndexed", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"Finally", ",", 
     RowBox[{
      RowBox[{
      "output", " ", "both", " ", "the", " ", "version", " ", "without", " ", 
       "time", " ", "indices", " ", "and", " ", "the", " ", "time"}], "-", 
      RowBox[{"indexed", " ", 
       RowBox[{"version", ":"}]}]}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"final", "=", 
    RowBox[{"FullSimplify", "[", "eqTimeIndexed", "]"}]}], "\[IndentingNewLine]",
    "final", "\[IndentingNewLine]", "\n"}]}]], "Input",
 CellChangeTimes->{
  3.947605634796274*^9, 3.9476056662585087`*^9, {3.947689883073887*^9, 
   3.9476898935314236`*^9}, {3.9476899422928123`*^9, 3.9476899665633545`*^9}, 
   3.9476900275814705`*^9, {3.947690175922682*^9, 3.947690179372404*^9}, 
   3.9479498275351105`*^9, {3.9479498757882633`*^9, 3.947949938067442*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"1d324b32-3e60-a146-b5b4-6a3a4bd7b1e8"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.947342097073511*^9},
 CellLabel->"",ExpressionUUID->"9e0d05d0-5fdf-944e-97f6-884be9bc4fd5"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.947265153472746*^9},
 CellLabel->"",ExpressionUUID->"1d5db560-18c8-3845-bae1-e95058242b47"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"unpatceint", " ", "households"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.943616429544197*^9, 
  3.943616484662098*^9}},ExpressionUUID->"483b27fc-4b8e-9c46-8db4-\
040fdf9ca070"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", 
   RowBox[{
   "Parameters", " ", "and", " ", "Variables", " ", "for", " ", "Impatient", " ",
     "Households"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"{", 
      RowBox[{"betaI", ",", "aD", ",", "phi", ",", "eps_ct", ",", "eps_ht", ",", 
       RowBox[{"cIt", "[", "t", "]"}], ",", 
       RowBox[{"cItLag", "[", "t", "]"}], ",", 
       RowBox[{"hIt", "[", "t", "]"}], ",", 
       RowBox[{"lIt", "[", "t", "]"}], ",", 
       RowBox[{"lItLag", "[", "t", "]"}], ",", 
       RowBox[{"bIt", "[", "t", "]"}], ",", 
       RowBox[{"bItLag", "[", "t", "]"}], ",", 
       RowBox[{"rBH", "[", "t", "]"}], ",", 
       RowBox[{"rBH", "[", "tLag", "]"}], ",", 
       RowBox[{"wIt", "[", "t", "]"}], ",", 
       RowBox[{"qt", "[", "t", "]"}], ",", 
       RowBox[{"pit", "[", "t", "]"}], ",", 
       RowBox[{"mLt", "[", "t", "]"}], ",", 
       RowBox[{"hItLag", "[", "t", "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Utility", " ", "function", " ", "for", " ", "impatient", " ", 
     "households"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uImpatient", "[", 
      RowBox[{"cIt_", ",", "cItLag_", ",", "hIt_", ",", "lIt_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "aD"}], ")"}], " ", "eps_ct", " ", 
       RowBox[{"Log", "[", "cIt", "]"}]}], "-", 
      RowBox[{"aD", " ", 
       RowBox[{"Log", "[", "cItLag", "]"}]}], "+", 
      RowBox[{"eps_ht", " ", 
       RowBox[{"Log", "[", "hIt", "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"lIt", "^", 
         RowBox[{"(", 
          RowBox[{"1", "+", "phi"}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", "phi"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Budget", " ", "constraint", " ", "for", " ", "impatient", " ", 
     "households", " ", "in", " ", "period", " ", "t"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BCImpatient", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"cIt", "[", "t", "]"}], "+", 
      RowBox[{
       RowBox[{"qt", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"hIt", "[", "t", "]"}], "-", 
         RowBox[{"hIt", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"rBH", "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ")"}], "/", 
         RowBox[{"pit", "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"bIt", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"wIt", "[", "t", "]"}], " ", 
       RowBox[{"lIt", "[", "t", "]"}]}], "-", 
      RowBox[{"bIt", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Borrowing", " ", "constraint", " ", "for", " ", "impatient", " ", 
     "households", " ", "in", " ", "period", " ", "t"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BorrowingConstraint", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"rBH", "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"bIt", "[", "t", "]"}]}], "-", 
      RowBox[{
       RowBox[{"mLt", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"qt", "[", 
          RowBox[{"t", "+", "1"}], "]"}], " ", 
         RowBox[{"hIt", "[", "t", "]"}], " ", 
         RowBox[{"pit", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "Lagrangian", "*)"}], "\n", 
   RowBox[{
    RowBox[{"LI", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"uImpatient", "[", 
         RowBox[{
          RowBox[{"cIt", "[", "t", "]"}], ",", 
          RowBox[{"cIt", "[", 
           RowBox[{"t", "-", "1"}], "]"}], ",", 
          RowBox[{"hIt", "[", "t", "]"}], ",", 
          RowBox[{"lIt", "[", "t", "]"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{"lambdaI", "[", "t", "]"}], " ", 
         RowBox[{"BCImpatient", "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"muI", "[", "t", "]"}], " ", 
         RowBox[{"BorrowingConstraint", "[", "t", "]"}]}]}], ")"}], "+", 
      RowBox[{
       RowBox[{"betaI", "^", 
        RowBox[{"(", 
         RowBox[{"t", "+", "1"}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"uImpatient", "[", 
          RowBox[{
           RowBox[{"cIt", "[", 
            RowBox[{"t", "+", "1"}], "]"}], ",", 
           RowBox[{"cIt", "[", "t", "]"}], ",", 
           RowBox[{"hIt", "[", 
            RowBox[{"t", "+", "1"}], "]"}], ",", 
           RowBox[{"lIt", "[", 
            RowBox[{"t", "+", "1"}], "]"}]}], "]"}], "+", 
         RowBox[{
          RowBox[{"lambdaI", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"BCImpatient", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"muI", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"BorrowingConstraint", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"First", "-", 
     RowBox[{
     "order", " ", "conditions", " ", "for", " ", "impatient", " ", 
      "households"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focCtI", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LI", ",", 
        RowBox[{"cIt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "consumption", " ", 
     RowBox[{"cIt", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focHtI", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LI", ",", 
        RowBox[{"hIt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "housing", " ", 
     RowBox[{"hIt", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focLtI", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LI", ",", 
        RowBox[{"lIt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "hours", " ", "worked", " ", 
     RowBox[{"lIt", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focBtI", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LI", ",", 
        RowBox[{"bIt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "borrowing", " ", 
     RowBox[{"bIt", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Display", " ", "results"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"debugFOCs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<FOC wrt cIt[t]\>\"", "->", "focCtI"}], ",", 
       RowBox[{"\"\<FOC wrt hIt[t]\>\"", "->", "focHtI"}], ",", 
       RowBox[{"\"\<FOC wrt lIt[t]\>\"", "->", "focLtI"}], ",", 
       RowBox[{"\"\<FOC wrt bIt[t]\>\"", "->", "focBtI"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Output", " ", "the", " ", "Lagrangian", " ", "and", " ", "FOCs"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Lagrangian\>\"", "->", "LI"}], ",", 
     RowBox[{"\"\<First-Order Conditions\>\"", "->", "debugFOCs"}]}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{
  3.9428556216292534`*^9, 3.9428558638346443`*^9, 3.942856329183136*^9, 
   3.9428564862004185`*^9, 3.9428566889696026`*^9, {3.942856910773079*^9, 
   3.9428569354905777`*^9}, {3.942857364787548*^9, 3.9428573898232937`*^9}, {
   3.9428577783808823`*^9, 3.9428578049808903`*^9}, 3.9428579940329285`*^9, {
   3.9428580395093536`*^9, 3.942858042871578*^9}, 3.9428591140860786`*^9, 
   3.9431155151779137`*^9, {3.9431158839568024`*^9, 3.943115919462967*^9}, {
   3.943116017131489*^9, 3.943116043165043*^9}, {3.943116203605345*^9, 
   3.943116248865116*^9}, 3.943116279396555*^9, {3.9431165276830425`*^9, 
   3.943116567202736*^9}, {3.94311672191103*^9, 3.943116753600672*^9}, {
   3.943116983151354*^9, 3.9431169998925896`*^9}, {3.9431182676864986`*^9, 
   3.943118310423565*^9}, {3.9431188651155624`*^9, 3.9431188743868217`*^9}, {
   3.9431189471438274`*^9, 3.943118963078903*^9}, {3.9431190017983513`*^9, 
   3.9431190163987827`*^9}, 3.9431844617301445`*^9, {3.943184531994499*^9, 
   3.9431845466193027`*^9}, {3.9431847557619095`*^9, 3.943184775501425*^9}, {
   3.943359097367693*^9, 3.943359119211834*^9}, 3.943368823503065*^9, 
   3.9433689041234646`*^9, 3.9433690047130775`*^9, {3.943372602202656*^9, 
   3.9433726292470894`*^9}, 3.9433731892332497`*^9, 3.943373405777813*^9, 
   3.943373880790806*^9, 3.9435298263594894`*^9, {3.943531181261368*^9, 
   3.943531227021929*^9}, 3.943533171298271*^9, {3.9435333243153496`*^9, 
   3.9435333617947254`*^9}, 3.9435362777779655`*^9, 3.9435367592692184`*^9, {
   3.9435380153508034`*^9, 3.943538038666689*^9}, {3.943548833672926*^9, 
   3.9435488363959446`*^9}, 3.9435490988596954`*^9, {3.9435491348483696`*^9, 
   3.943549140611929*^9}, {3.9435492777151756`*^9, 3.9435492934218426`*^9}, {
   3.943616506312252*^9, 3.9436165507183113`*^9}, {3.9436180500715656`*^9, 
   3.9436180530685368`*^9}, {3.945173009921896*^9, 3.945173031726755*^9}, {
   3.9451733102613754`*^9, 3.945173337662203*^9}, 3.9463751018555126`*^9, 
   3.9463802729152527`*^9, {3.946380978417076*^9, 3.9463810300157757`*^9}, 
   3.946396126499422*^9, 3.946397331734724*^9, 3.946398470666641*^9, 
   3.9463985289595127`*^9, 3.9463986259487324`*^9, {3.9464011586499176`*^9, 
   3.9464011613548775`*^9}, {3.9464016694565735`*^9, 
   3.9464017233964157`*^9}, {3.946402820333645*^9, 3.9464028291536007`*^9}, {
   3.9464035597819443`*^9, 3.946403566628748*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"94fcf45b-6f21-634c-b1d5-7d0ae8a5c58d"],

Cell[BoxData[""], "Input",ExpressionUUID->"b9ef39e2-d105-c74c-ae1b-589fe4deab77"],

Cell[BoxData[
 RowBox[{"\n", "\n", "\n", "\[IndentingNewLine]", 
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]}]], "Input",
 CellChangeTimes->{
  3.946400316124754*^9, 3.9464005812752533`*^9, {3.94640143677759*^9, 
   3.9464014829991436`*^9}, {3.946401823560726*^9, 3.946401836477703*^9}, 
   3.946403333041109*^9},ExpressionUUID->"8880107c-6260-f84b-9c38-\
4d69438e0d38"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", 
   RowBox[{"Define", " ", "FOC", " ", "wrt", " ", 
    RowBox[{"cIt", "[", "t", "]"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"eq1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"aD", " ", 
            RowBox[{"betaI", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}]}], ")"}], "/", 
          RowBox[{"cIt", "[", "t", "]"}]}], ")"}]}], "+", 
       RowBox[{"lambdaI", "[", "t", "]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "aD"}], ")"}], " ", "eps_ct"}], ")"}], "/", 
        RowBox[{"cIt", "[", "t", "]"}]}]}], "==", "0"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"1", ")"}], " ", "Solve", " ", "eq1", " ", "for", " ", 
     RowBox[{"lambdaI", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solLambda", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"eq1", ",", 
       RowBox[{"lambdaI", "[", "t", "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Result", " ", "gives", " ", 
      RowBox[{"lambdaI", "[", "t", "]"}], " ", "in", " ", "terms", " ", "of", 
      " ", "aD"}], ",", "betaI", ",", "eps_ct", ",", 
     RowBox[{"and", " ", 
      RowBox[{"cIt", "[", "t", "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Define", " ", "other", " ", "FOCs"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focSystem", "=", 
     RowBox[{"{", 
      RowBox[{"(*", 
       RowBox[{"FOC", " ", "wrt", " ", 
        RowBox[{"hIt", "[", "t", "]"}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"eps_ht", "/", 
          RowBox[{"hIt", "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"lambdaI", "[", "t", "]"}], " ", 
          RowBox[{"qt", "[", "t", "]"}]}], "-", 
         RowBox[{
          RowBox[{"betaI", "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "t"}], ")"}]}], " ", 
          RowBox[{"lambdaI", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"qt", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"mLt", "[", "t", "]"}], " ", 
          RowBox[{"muI", "[", "t", "]"}], " ", 
          RowBox[{"pit", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"qt", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}]}], "==", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"lIt", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{
           RowBox[{"lIt", "[", "t", "]"}], "^", "phi"}]}], "-", 
         RowBox[{
          RowBox[{"lambdaI", "[", "t", "]"}], " ", 
          RowBox[{"wIt", "[", "t", "]"}]}]}], "==", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"bIt", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"lambdaI", "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"muI", "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"rBH", "[", "t", "]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betaI", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}], " ", 
            RowBox[{"lambdaI", "[", 
             RowBox[{"t", "+", "1"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rBH", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"pit", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}]}], "==", "0"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"2", ")"}], " ", "Use", " ", "time", " ", "identity"}], ",", 
     RowBox[{
      RowBox[{"lambdaI", "[", 
       RowBox[{"t", "+", "1"}], "]"}], " ", "and", " ", 
      RowBox[{"lambdaI", "[", 
       RowBox[{"t", "-", "1"}], "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lambdaNext", "=", 
     RowBox[{"solLambda", "/.", " ", 
      RowBox[{"t", "->", 
       RowBox[{"t", "+", "1"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"lambdaPrev", "=", 
     RowBox[{"solLambda", "/.", " ", 
      RowBox[{"t", "->", 
       RowBox[{"t", "-", "1"}]}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"3", ")"}], " ", "Substitute", " ", "solution", " ", "into", " ",
      "the", " ", "system", " ", "of", " ", "FOCs"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focSystemSub", "=", 
     RowBox[{
      RowBox[{"focSystem", "/.", " ", 
       RowBox[{"solLambda", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "/.", " ", 
      RowBox[{"lambdaNext", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Print", " ", "the", " ", "system", " ", "of", " ", "equations", " ", 
     "after", " ", "substitution"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<System of equations after substitution: \>\"", ",", 
      "focSystemSub"}], "]"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Solve", " ", "for", " ", "remaining", " ", "variables"}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"focSystemSub", ",", 
       RowBox[{"{", 
        RowBox[{"muI", "[", "t", "]"}], 
        RowBox[{"(*", 
         RowBox[{
         "Add", " ", "other", " ", "variables", " ", "if", " ", "needed"}], 
         "*)"}], "}"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Example", ":", 
     RowBox[{"Substitute", " ", 
      RowBox[{"muI", "[", "t", "]"}], " ", "from", " ", "FOC", " ", "wrt", " ", 
      RowBox[{"bIt", "[", "t", "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"muISolution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"focSystemSub", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"muI", "[", "t", "]"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Substitute", " ", 
     RowBox[{"muI", "[", "t", "]"}], " ", "into", " ", "FOC", " ", "wrt", " ", 
     RowBox[{"hIt", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq1Sub", "=", 
     RowBox[{
      RowBox[{"focSystemSub", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/.", " ", 
      RowBox[{"muISolution", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Keep", " ", "FOC", " ", "wrt", " ", 
     RowBox[{"lIt", "[", "t", "]"}], " ", "unchanged"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq2", "=", 
     RowBox[{"focSystemSub", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Print", " ", "results"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Equation wrt hIt[t] after elimination of muI[t]: \>\"", ",",
       "eq1Sub"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Equation wrt lIt[t] remains: \>\"", ",", "eq2"}], "]"}], 
    ";"}], "\n", "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.942592057012724*^9, {3.942592245428005*^9, 3.94259229837319*^9}, {
   3.94259276149564*^9, 3.942592764239746*^9}, {3.9425935259046726`*^9, 
   3.942593548727476*^9}, 3.9425936374098434`*^9, {3.942594582938095*^9, 
   3.942594602603157*^9}, 3.9425946466589737`*^9, {3.9425949113557167`*^9, 
   3.9425949911134377`*^9}, 3.942595094281233*^9, {3.942595174682337*^9, 
   3.942595279071537*^9}, 3.942595447132061*^9, {3.9425956151379395`*^9, 
   3.94259563994841*^9}, 3.942595669960287*^9, {3.9425959508937435`*^9, 
   3.9425959719109993`*^9}, 3.9427690351333847`*^9, 3.9427690682198257`*^9, 
   3.9427715635525856`*^9, 3.9428545977365494`*^9, 3.9430291244111385`*^9, {
   3.9430293293032436`*^9, 3.9430293321251163`*^9}, 3.943029903411661*^9, 
   3.943029935968582*^9, {3.9430300915187435`*^9, 3.9430300983569183`*^9}, 
   3.943030165224594*^9, 3.943031018565777*^9, 3.9430310525436935`*^9, 
   3.9430315909590073`*^9, {3.943031676607229*^9, 3.943031762295637*^9}, {
   3.943032046234873*^9, 3.94303207506736*^9}, {3.943032277998928*^9, 
   3.943032328893503*^9}, 3.9430323609657345`*^9, {3.9430338379985332`*^9, 
   3.9430338777026024`*^9}, {3.9430340737475815`*^9, 3.9430340995907764`*^9}, 
   3.943034138748911*^9, 3.943034215671747*^9, 3.9430955097704773`*^9, 
   3.9433588087017574`*^9, 3.9433588506085987`*^9, 3.9433604537355385`*^9, 
   3.9433690498361454`*^9, {3.943369097716297*^9, 3.9433691157514877`*^9}, {
   3.9433691779950886`*^9, 3.9433691920949574`*^9}, {3.943369408544922*^9, 
   3.943369419957775*^9}, {3.9433694534026623`*^9, 3.9433694610976887`*^9}, {
   3.9433718095535316`*^9, 3.9433718209741173`*^9}, {3.943371942155674*^9, 
   3.943371948822159*^9}, {3.943372132182953*^9, 3.9433721356424065`*^9}, {
   3.9433723369107685`*^9, 3.9433723433940105`*^9}, {3.9433725200260067`*^9, 
   3.943372539188036*^9}, 3.9433729214440956`*^9, 3.946134979625437*^9, {
   3.946135028668358*^9, 3.9461350308236866`*^9}, {3.946380295211197*^9, 
   3.946380296539772*^9}, {3.94640043978706*^9, 3.946400483226412*^9}, 
   3.9464023612987766`*^9, {3.9464025415333214`*^9, 3.9464025643481045`*^9}, {
   3.9464031878470516`*^9, 3.946403191088213*^9}, {3.9464034240072136`*^9, 
   3.9464034490416183`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"b0b5f86b-cc2e-e04d-b2ed-4360d9e5fb4f"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.942592057012724*^9, {3.942592245428005*^9, 3.94259229837319*^9}, {
   3.94259276149564*^9, 3.942592764239746*^9}, {3.9425935259046726`*^9, 
   3.942593548727476*^9}, 3.9425936374098434`*^9, {3.942594582938095*^9, 
   3.942594602603157*^9}, 3.9425946466589737`*^9, {3.9425949113557167`*^9, 
   3.9425949911134377`*^9}, 3.942595094281233*^9, {3.942595174682337*^9, 
   3.942595279071537*^9}, 3.942595447132061*^9, {3.9425956151379395`*^9, 
   3.94259563994841*^9}, 3.942595669960287*^9, {3.9425959508937435`*^9, 
   3.9425959719109993`*^9}, 3.9427690351333847`*^9, 3.9427690682198257`*^9, 
   3.9427715635525856`*^9, 3.9428545977365494`*^9, 3.9430291244111385`*^9, {
   3.9430293293032436`*^9, 3.9430293321251163`*^9}, 3.943029903411661*^9, 
   3.943029935968582*^9, {3.9430300915187435`*^9, 3.9430300983569183`*^9}, 
   3.943030165224594*^9, 3.943031018565777*^9, 3.9430310525436935`*^9, 
   3.9430315909590073`*^9, {3.943031676607229*^9, 3.943031762295637*^9}, {
   3.943032046234873*^9, 3.94303207506736*^9}, {3.943032277998928*^9, 
   3.943032328893503*^9}, 3.9430323609657345`*^9, {3.9430338379985332`*^9, 
   3.9430338777026024`*^9}, {3.9430340737475815`*^9, 3.9430340995907764`*^9}, 
   3.943034138748911*^9, 3.943034215671747*^9, 3.9430955097704773`*^9, 
   3.9433588087017574`*^9, 3.9433588506085987`*^9, 3.9433604537355385`*^9, 
   3.9433690498361454`*^9, {3.943369097716297*^9, 3.9433691157514877`*^9}, {
   3.9433691779950886`*^9, 3.9433691920949574`*^9}, {3.943369408544922*^9, 
   3.943369419957775*^9}, {3.9433694534026623`*^9, 3.9433694610976887`*^9}, {
   3.9433718095535316`*^9, 3.9433718209741173`*^9}, {3.943371942155674*^9, 
   3.943371948822159*^9}, {3.943372132182953*^9, 3.9433721356424065`*^9}, {
   3.9433723369107685`*^9, 3.9433723433940105`*^9}, {3.9433725200260067`*^9, 
   3.943372539188036*^9}, 3.9433729214440956`*^9, 3.946134979625437*^9, {
   3.946135028668358*^9, 3.9461350308236866`*^9}, {3.946380295211197*^9, 
   3.946380296539772*^9}, {3.94640043978706*^9, 3.946400483226412*^9}, 
   3.9464023612987766`*^9, {3.9464025415333214`*^9, 3.9464025643481045`*^9}, {
   3.9464031878470516`*^9, 3.946403191088213*^9}, {3.9464034240072136`*^9, 
   3.9464034490416183`*^9}, 3.94734240899786*^9, 3.947342456115858*^9, 
   3.9476906366089897`*^9},ExpressionUUID->"5b2a032a-505e-c740-a415-\
a5a50f903e5d"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "1.", " ", "Clear", " ", "and", " ", "declare", " ", "all", " ", 
    "variables", " ", "as", " ", 
    RowBox[{"symbols", "."}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "eps_ht", ",", "hIt", ",", "cIt", ",", "q", ",", "mL", ",", "pit", ",", 
      "rBH", ",", "eps_ct", ",", "aD", ",", "betaI", ",", "t", ",", "hItBar", 
      ",", "cItBar", ",", "qBar", ",", "cItBar1", ",", "qBar1", ",", "mLBar", 
      ",", "pitBar", ",", "rBHBar"}], "]"}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"Optionally", ",", 
     RowBox[{
      RowBox[{"load", " ", "them", " ", "as", " ", 
       RowBox[{"symbols", ":", 
        RowBox[{"Symbol", "/@", 
         RowBox[{"{", 
          
          RowBox[{"\"\<eps_ht\>\"", ",", "\"\<hIt\>\"", ",", "\"\<cIt\>\"", 
           ",", "\"\<q\>\"", ",", "\"\<mL\>\"", ",", "\"\<pit\>\"", 
           ",", "\"\<rBH\>\"", ",", "\"\<eps_ct\>\"", ",", "\"\<aD\>\"", 
           ",", "\"\<betaI\>\"", ",", "\"\<t\>\"", ",", "\"\<hItBar\>\"", 
           ",", "\"\<cItBar\>\"", ",", "\"\<qBar\>\"", ",", "\"\<cItBar1\>\"",
            ",", "\"\<qBar1\>\"", ",", "\"\<mLBar\>\"", ",", "\"\<pitBar\>\"",
            ",", "\"\<rBHBar\>\""}], "}"}]}]}]}], ";"}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "2.", " ", "Define", " ", "the", " ", "original", " ", "equation", " ", 
       "as", " ", "F", 
       RowBox[{"(", "...", ")"}]}], "==", 
      RowBox[{
      "0.", " ", "We", " ", "create", " ", "dummy", " ", "variables", " ", 
       "for", " ", "the", " ", "time\:2011t", " ", "and", " ", "time\:2011", 
       RowBox[{"(", 
        RowBox[{"t", "+", "1"}], ")"}], " ", 
       RowBox[{"objects", ".", 
        RowBox[{"Here", ":", 
         RowBox[{"-", "hItT"}]}]}]}]}], ",", "cItT", ",", 
     RowBox[{"qT", " ", "represent", " ", 
      RowBox[{"hIt", "[", "t", "]"}]}], ",", 
     RowBox[{"cIt", "[", "t", "]"}], ",", 
     RowBox[{"q", "[", "t", "]"}], ",", 
     RowBox[{"-", "cItT1"}], ",", "qT1", ",", 
     RowBox[{"pitT1", " ", "represent", " ", 
      RowBox[{"cIt", "[", 
       RowBox[{"1", "+", "t"}], "]"}]}], ",", 
     RowBox[{"q", "[", 
      RowBox[{"1", "+", "t"}], "]"}], ",", 
     RowBox[{"pit", "[", 
      RowBox[{"1", "+", "t"}], "]"}], ",", 
     RowBox[{
      RowBox[{"-", "mLT"}], " ", "and", " ", "rBHt", " ", "denote", " ", 
      RowBox[{"mL", "[", "t", "]"}], " ", "and", " ", 
      RowBox[{
       RowBox[{"rBH", "[", "t", "]"}], "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{
      "hItT_", ",", "cItT_", ",", "qT_", ",", "cItT1_", ",", "qT1_", ",", 
       "mLT_", ",", "pitT1_", ",", "rBHt_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"eps_ht", "/", "hItT"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"aD", "*", 
            RowBox[{"betaI", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}]}], "-", "eps_ct", "+", 
           RowBox[{"aD", "*", "eps_ct"}]}], ")"}], "*", "qT"}], ")"}], "/", 
       "cItT"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"betaI", "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "t"}], ")"}]}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"aD", "*", 
            RowBox[{"betaI", "^", 
             RowBox[{"(", 
              RowBox[{"2", "+", "t"}], ")"}]}]}], "-", "eps_ct", "+", 
           RowBox[{"aD", "*", "eps_ct"}]}], ")"}], "*", "qT1"}], ")"}], "/", 
       "cItT1"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"mLT", "*", "pitT1", "*", "qT1", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"aD", "*", 
                RowBox[{"betaI", "^", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", "t"}], ")"}]}]}], "-", "eps_ct", "+", 
               RowBox[{"aD", "*", "eps_ct"}]}], ")"}], "/", "cItT"}], ")"}], "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"betaI", "^", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "t"}], ")"}]}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"aD", "*", 
                  RowBox[{"betaI", "^", 
                   RowBox[{"(", 
                    RowBox[{"2", "+", "t"}], ")"}]}]}], "-", "eps_ct", "+", 
                 RowBox[{"aD", "*", "eps_ct"}]}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{"1", "+", "rBHt"}], ")"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"cItT1", "*", "pitT1"}], ")"}]}], ")"}]}], ")"}]}], 
        ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", "rBHt"}], ")"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"3.", " ", "Collect", " ", "the", " ", "variables", " ", 
     RowBox[{"we", "'"}], "ll", " ", "differentiate", " ", "with", " ", 
     "respect", " ", 
     RowBox[{"to", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{
      "hItT", ",", "cItT", ",", "qT", ",", "cItT1", ",", "qT1", ",", "mLT", ",",
        "pitT1", ",", "rBHt"}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "4.", " ", "Compute", " ", "partial", " ", "derivatives", " ", "of", " ",
        "F", " ", "at", " ", "the", " ", "steady", " ", 
       RowBox[{"state", ".", "The"}], " ", "steady", " ", "state", " ", "is", 
       " ", "given", " ", "by", " ", 
       RowBox[{"replacing", ":", "hItT"}]}], "->", "hItBar"}], ",", 
     RowBox[{"cItT", "->", "cItBar"}], ",", 
     RowBox[{"qT", "->", "qBar"}], ",", 
     RowBox[{"cItT1", "->", "cItBar1"}], ",", 
     RowBox[{"qT1", "->", "qBar1"}], ",", 
     RowBox[{"mLT", "->", "mLBar"}], ",", 
     RowBox[{"pitT1", "->", "pitBar"}], ",", 
     RowBox[{"rBHt", "->", 
      RowBox[{"rBHBar", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"hItT", "->", "hItBar"}], ",", 
          RowBox[{"cItT", "->", "cItBar"}], ",", 
          RowBox[{"qT", "->", "qBar"}], ",", 
          RowBox[{"cItT1", "->", "cItBar1"}], ",", 
          RowBox[{"qT1", "->", "qBar1"}], ",", 
          RowBox[{"mLT", "->", "mLBar"}], ",", 
          RowBox[{"pitT1", "->", "pitBar"}], ",", 
          RowBox[{"rBHt", "->", "rBHBar"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"5.", " ", "Define", " ", "symbols", " ", "for", " ", "log"}], "\[Hyphen]", 
     RowBox[{"deviations", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", " ", "ln", " ", "X"}], ")"}], "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "hItHatT", ",", "cItHatT", ",", "qHatT", ",", "cItHatT1", ",", "qHatT1", 
      ",", "mLHatT", ",", "pitHatT", ",", "rBHHatT"}], "]"}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "6.", " ", "Multiply", " ", "each", " ", "partial", " ", "derivative", " ",
       "by", " ", "the", " ", "steady", " ", "state", " ", "level", " ", 
      "and", " ", "its", " ", "corresponding", " ", 
      RowBox[{"hat", ".", "This"}], " ", "yields", " ", "the", " ", 
      "linearized", " ", "equation", " ", "in", " ", "terms", " ", "of", " ", 
      "log"}], "\[Hyphen]", 
     RowBox[{"deviations", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varsBar", "=", 
     RowBox[{"{", 
      RowBox[{
      "hItBar", ",", "cItBar", ",", "qBar", ",", "cItBar1", ",", "qBar1", ",",
        "mLBar", ",", "pitBar", ",", "rBHBar"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", "hItBar", "*", "hItHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", "cItBar", "*", "cItHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", "qBar", "*", "qHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "*", "cItBar1", "*", "cItHatT1"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "*", "qBar1", "*", "qHatT1"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "*", "mLBar", "*", "mLHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "7", "]"}], "]"}], "*", "pitBar", "*", "pitHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "8", "]"}], "]"}], "*", "rBHBar", "*", "rBHHatT"}]}], "==",
       "0"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"7.", " ", "Simplify", " ", "the", " ", "final", " ", "linear", " ", 
     RowBox[{"equation", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"simplifiedLogLinEq", "=", 
     RowBox[{"Simplify", "[", "logLinEq", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Optionally", ",", 
     RowBox[{
     "replace", " ", "steady", " ", "state", " ", "values", " ", "with", " ", 
      "1", " ", "to", " ", "eliminate", " ", "them"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEqNoBar", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"simplifiedLogLinEq", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"hItBar", "->", "1"}], ",", 
         RowBox[{"cItBar", "->", "1"}], ",", 
         RowBox[{"qBar", "->", "1"}], ",", 
         RowBox[{"cItBar1", "->", "1"}], ",", 
         RowBox[{"qBar1", "->", "1"}], ",", 
         RowBox[{"mLBar", "->", "1"}], ",", 
         RowBox[{"pitBar", "->", "1"}], ",", 
         RowBox[{"rBHBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "8.", " ", "Define", " ", "substitution", " ", "rules", " ", "to", " ", 
       "reintroduce", " ", "time", " ", 
       RowBox[{"indices", ".", "Here"}], " ", "we", " ", 
       RowBox[{"assign", ":", "hItHatT"}]}], "->", 
      RowBox[{"hItHat", "[", "t", "]"}]}], ",", 
     RowBox[{"cItHatT", "->", 
      RowBox[{"cItHat", "[", "t", "]"}]}], ",", 
     RowBox[{"qHatT", "->", 
      RowBox[{"qHat", "[", "t", "]"}]}], ",", 
     RowBox[{"cItHatT1", "->", 
      RowBox[{"cItHat", "[", 
       RowBox[{"t", "+", "1"}], "]"}]}], ",", 
     RowBox[{"qHatT1", "->", 
      RowBox[{"qHat", "[", 
       RowBox[{"t", "+", "1"}], "]"}]}], ",", 
     RowBox[{"mLHatT", "->", 
      RowBox[{"mLHat", "[", "t", "]"}]}], ",", 
     RowBox[{"pitHatT", "->", 
      RowBox[{"pitHat", "[", 
       RowBox[{"t", "+", "1"}], "]"}]}], ",", 
     RowBox[{"rBHHatT", "->", 
      RowBox[{"rBHHat", "[", "t", "]"}]}], ",", 
     RowBox[{"and", " ", "we", " ", "also", " ", "re"}], "\[Hyphen]", 
     RowBox[{"write", " ", "the", " ", "time"}], "\[Dash]", 
     RowBox[{"exponents", " ", "on", " ", 
      RowBox[{"betaI", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"timeSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"hItHatT", "->", 
        RowBox[{"hItHat", "[", "t", "]"}]}], ",", 
       RowBox[{"cItHatT", "->", 
        RowBox[{"cItHat", "[", "t", "]"}]}], ",", 
       RowBox[{"qHatT", "->", 
        RowBox[{"qHat", "[", "t", "]"}]}], ",", 
       RowBox[{"cItHatT1", "->", 
        RowBox[{"cItHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"qHatT1", "->", 
        RowBox[{"qHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"mLHatT", "->", 
        RowBox[{"mLHat", "[", "t", "]"}]}], ",", 
       RowBox[{"pitHatT", "->", 
        RowBox[{"pitHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"rBHHatT", "->", 
        RowBox[{"rBHHat", "[", "t", "]"}]}], ",", 
       RowBox[{
        RowBox[{"betaI", "^", 
         RowBox[{"(", 
          RowBox[{"1", "+", "t"}], ")"}]}], "->", 
        RowBox[{"betaI", "^", 
         RowBox[{"(", 
          RowBox[{"t", "+", "1"}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{"betaI", "^", 
         RowBox[{"(", 
          RowBox[{"2", "+", "t"}], ")"}]}], "->", 
        RowBox[{"betaI", "^", 
         RowBox[{"(", 
          RowBox[{"t", "+", "2"}], ")"}]}]}]}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqTimeIndexed", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"Finally", ",", 
     RowBox[{
     "output", " ", "the", " ", "versions", " ", "without", " ", "time", " ", 
      "indices", " ", "and", " ", "with", " ", "time", " ", 
      RowBox[{"indices", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
   "logLinEqNoBar", "\n", 
   RowBox[{"final", " ", "=", 
    RowBox[{"FullSimplify", "[", "eqTimeIndexed", "]"}]}], "\[IndentingNewLine]",
    "final", "\n"}]}]], "Input",
 CellChangeTimes->{
  3.942592057012724*^9, {3.942592245428005*^9, 3.94259229837319*^9}, {
   3.94259276149564*^9, 3.942592764239746*^9}, {3.9425935259046726`*^9, 
   3.942593548727476*^9}, 3.9425936374098434`*^9, {3.942594582938095*^9, 
   3.942594602603157*^9}, 3.9425946466589737`*^9, {3.9425949113557167`*^9, 
   3.9425949911134377`*^9}, 3.942595094281233*^9, {3.942595174682337*^9, 
   3.942595279071537*^9}, 3.942595447132061*^9, {3.9425956151379395`*^9, 
   3.94259563994841*^9}, 3.942595669960287*^9, {3.9425959508937435`*^9, 
   3.9425959719109993`*^9}, 3.9427690351333847`*^9, 3.9427690682198257`*^9, 
   3.9427715635525856`*^9, 3.9428545977365494`*^9, 3.9430291244111385`*^9, {
   3.9430293293032436`*^9, 3.9430293321251163`*^9}, 3.943029903411661*^9, 
   3.943029935968582*^9, {3.9430300915187435`*^9, 3.9430300983569183`*^9}, 
   3.943030165224594*^9, 3.943031018565777*^9, 3.9430310525436935`*^9, 
   3.9430315909590073`*^9, {3.943031676607229*^9, 3.943031762295637*^9}, {
   3.943032046234873*^9, 3.94303207506736*^9}, {3.943032277998928*^9, 
   3.943032328893503*^9}, 3.9430323609657345`*^9, {3.9430338379985332`*^9, 
   3.9430338777026024`*^9}, {3.9430340737475815`*^9, 3.9430340995907764`*^9}, 
   3.943034138748911*^9, 3.943034215671747*^9, 3.9430955097704773`*^9, 
   3.9433588087017574`*^9, 3.9433588506085987`*^9, 3.9433604537355385`*^9, 
   3.9433690498361454`*^9, {3.943369097716297*^9, 3.9433691157514877`*^9}, {
   3.9433691779950886`*^9, 3.9433691920949574`*^9}, {3.943369408544922*^9, 
   3.943369419957775*^9}, {3.9433694534026623`*^9, 3.9433694610976887`*^9}, {
   3.9433718095535316`*^9, 3.9433718209741173`*^9}, {3.943371942155674*^9, 
   3.943371948822159*^9}, {3.943372132182953*^9, 3.9433721356424065`*^9}, {
   3.9433723369107685`*^9, 3.9433723433940105`*^9}, {3.9433725200260067`*^9, 
   3.943372539188036*^9}, 3.9433729214440956`*^9, 3.946134979625437*^9, {
   3.946135028668358*^9, 3.9461350308236866`*^9}, {3.946380295211197*^9, 
   3.946380296539772*^9}, {3.94640043978706*^9, 3.946400483226412*^9}, 
   3.9464023612987766`*^9, {3.9464025415333214`*^9, 3.9464025643481045`*^9}, {
   3.9464031878470516`*^9, 3.946403191088213*^9}, {3.9464034240072136`*^9, 
   3.9464034490416183`*^9}, 3.94734240899786*^9, {3.947342456115858*^9, 
   3.9473425197101955`*^9}, {3.9473429805323334`*^9, 3.9473429810118866`*^9}, 
   3.947343041703169*^9, 3.9476906567326527`*^9, {3.947690980682455*^9, 
   3.9476909851086464`*^9}, {3.947691065119421*^9, 3.947691067107668*^9}, {
   3.9479502014980087`*^9, 3.9479502457827015`*^9}},
 CellLabel->
  "In[159]:=",ExpressionUUID->"0e074e25-5497-e244-8216-c9871e946f7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "1.", " ", "Clear", " ", "and", " ", "declare", " ", "all", " ", 
    "variables", " ", "as", " ", 
    RowBox[{"symbols", "."}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "lItT", ",", "cItT", ",", "wItT", ",", "aD", ",", "betaI", ",", "eps_ct",
       ",", "phi", ",", "t", ",", "lItBar", ",", "cItBar", ",", "wItBar"}], 
     "]"}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"Optionally", ",", 
     RowBox[{
      RowBox[{"load", " ", "them", " ", "as", " ", 
       RowBox[{"symbols", ":", 
        RowBox[{"Symbol", "/@", 
         RowBox[{"{", 
          
          RowBox[{"\"\<lItT\>\"", ",", "\"\<cItT\>\"", ",", "\"\<wItT\>\"", 
           ",", "\"\<aD\>\"", ",", "\"\<betaI\>\"", ",", "\"\<eps_ct\>\"", 
           ",", "\"\<phi\>\"", ",", "\"\<t\>\"", ",", "\"\<lItBar\>\"", 
           ",", "\"\<cItBar\>\"", ",", "\"\<wItBar\>\""}], "}"}]}]}]}], 
      ";"}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "2.", " ", "Define", " ", "the", " ", "original", " ", "equation", " ", 
       "as", " ", "F", 
       RowBox[{"(", "...", ")"}]}], "==", 
      RowBox[{"0.", " ", "Here"}]}], ",", "lItT", ",", "cItT", ",", 
     RowBox[{"and", " ", "wItT", " ", "correspond", " ", "to", " ", 
      RowBox[{"lIt", "[", "t", "]"}]}], ",", 
     RowBox[{"cIt", "[", "t", "]"}], ",", 
     RowBox[{"and", " ", 
      RowBox[{"wIt", "[", "t", "]"}]}], ",", 
     RowBox[{"respectively", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{"lItT_", ",", "cItT_", ",", "wItT_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"lItT", "^", "phi"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"aD", "*", 
            RowBox[{"betaI", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}]}], "-", "eps_ct", "+", 
           RowBox[{"aD", "*", "eps_ct"}]}], ")"}], "*", "wItT"}], ")"}], "/", 
       "cItT"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"3.", " ", "Collect", " ", "the", " ", "variables", " ", 
     RowBox[{"we", "'"}], "ll", " ", "differentiate", " ", "with", " ", 
     "respect", " ", 
     RowBox[{"to", "."}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{"lItT", ",", "cItT", ",", "wItT"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "4.", " ", "Compute", " ", "partial", " ", "derivatives", " ", "of", " ",
        "F", " ", "at", " ", "the", " ", "steady", " ", 
       RowBox[{"state", ".", "The"}], " ", "steady", " ", "state", " ", "is", 
       " ", "imposed", " ", "by", " ", 
       RowBox[{"replacing", ":", "lItT"}]}], "->", "lItBar"}], ",", 
     RowBox[{"cItT", "->", "cItBar"}], ",", 
     RowBox[{"wItT", "->", 
      RowBox[{"wItBar", "."}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"lItT", "->", "lItBar"}], ",", 
          RowBox[{"cItT", "->", "cItBar"}], ",", 
          RowBox[{"wItT", "->", "wItBar"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"5.", " ", "Define", " ", "symbols", " ", "for", " ", "log"}], "\[Hyphen]", 
     RowBox[{"deviations", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", " ", "ln", " ", "X"}], ")"}], "."}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"lItHatT", ",", "cItHatT", ",", "wItHatT"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "6.", " ", "Multiply", " ", "each", " ", "partial", " ", "derivative", " ",
       "by", " ", "the", " ", "steady", " ", "state", " ", "level", " ", 
      "and", " ", "its", " ", "corresponding", " ", "log"}], "\[Hyphen]", 
     RowBox[{
      RowBox[{
       RowBox[{"deviation", ".", "This"}], " ", "yields", " ", "the", " ", 
       "linearized", " ", "equation", " ", "F"}], "=", 
      RowBox[{"0", " ", "in", " ", "terms", " ", "of", " ", "the", " ", 
       RowBox[{"\[OpenCurlyDoubleQuote]", "hat", "\[CloseCurlyDoubleQuote]"}],
        " ", 
       RowBox[{"variables", "."}]}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"varsBar", "=", 
     RowBox[{"{", 
      RowBox[{"lItBar", ",", "cItBar", ",", "wItBar"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", "lItBar", "*", "lItHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", "cItBar", "*", "cItHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", "wItBar", "*", "wItHatT"}]}], "==",
       "0"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"7.", " ", "Simplify", " ", "the", " ", "final", " ", "linear", " ", 
     RowBox[{"equation", "."}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"simplifiedLogLinEq", "=", 
     RowBox[{"Simplify", "[", "logLinEq", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Optionally", ",", 
     RowBox[{
     "replace", " ", "steady", " ", "state", " ", "values", " ", "with", " ", 
      "1", " ", "to", " ", "eliminate", " ", 
      RowBox[{"them", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEqNoBar", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"simplifiedLogLinEq", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"lItBar", "->", "1"}], ",", 
         RowBox[{"cItBar", "->", "1"}], ",", 
         RowBox[{"wItBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "8.", " ", "Define", " ", "substitution", " ", "rules", " ", "to", " ", 
       "reintroduce", " ", "time", " ", 
       RowBox[{"indices", ".", "Here"}], " ", "we", " ", 
       RowBox[{"assign", ":", "lItHatT"}]}], "->", 
      RowBox[{"lItHat", "[", "t", "]"}]}], ",", 
     RowBox[{"cItHatT", "->", 
      RowBox[{"cItHat", "[", "t", "]"}]}], ",", 
     RowBox[{"wItHatT", "->", 
      RowBox[{"wItHat", "[", "t", "]"}]}], ",", 
     RowBox[{"and", " ", "also", " ", "re"}], "\[Hyphen]", 
     RowBox[{"write", " ", 
      RowBox[{"betaI", "^", 
       RowBox[{"(", 
        RowBox[{"1", "+", "t"}], ")"}]}], " ", "as", " ", 
      RowBox[{
       RowBox[{"betaI", "^", 
        RowBox[{"(", 
         RowBox[{"t", "+", "1"}], ")"}]}], "."}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"timeSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"lItHatT", "->", 
        RowBox[{"lItHat", "[", "t", "]"}]}], ",", 
       RowBox[{"cItHatT", "->", 
        RowBox[{"cItHat", "[", "t", "]"}]}], ",", 
       RowBox[{"wItHatT", "->", 
        RowBox[{"wItHat", "[", "t", "]"}]}], ",", 
       RowBox[{
        RowBox[{"betaI", "^", 
         RowBox[{"(", 
          RowBox[{"1", "+", "t"}], ")"}]}], "->", 
        RowBox[{"betaI", "^", 
         RowBox[{"(", 
          RowBox[{"t", "+", "1"}], ")"}]}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"eqTimeIndexed", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Finally", ",", 
     RowBox[{
     "output", " ", "both", " ", "the", " ", "version", " ", "without", " ", 
      "time", " ", "indices", " ", "and", " ", "with", " ", "time", " ", 
      RowBox[{"indices", ":"}]}]}], "*)"}], "\n", "logLinEqNoBar", "\n", 
   RowBox[{"final", " ", "=", 
    RowBox[{"FullSimplify", "[", "eqTimeIndexed", "]"}]}], "\[IndentingNewLine]",
    "final", "\n"}]}]], "Input",
 CellChangeTimes->{
  3.9476919365670357`*^9, {3.94795032638373*^9, 3.947950374200945*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"fb2f931c-bc15-f341-bf84-64962e1f5fe1"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.942592057012724*^9, {3.942592245428005*^9, 3.94259229837319*^9}, {
   3.94259276149564*^9, 3.942592764239746*^9}, {3.9425935259046726`*^9, 
   3.942593548727476*^9}, 3.9425936374098434`*^9, {3.942594582938095*^9, 
   3.942594602603157*^9}, 3.9425946466589737`*^9, {3.9425949113557167`*^9, 
   3.9425949911134377`*^9}, 3.942595094281233*^9, {3.942595174682337*^9, 
   3.942595279071537*^9}, 3.942595447132061*^9, {3.9425956151379395`*^9, 
   3.94259563994841*^9}, 3.942595669960287*^9, {3.9425959508937435`*^9, 
   3.9425959719109993`*^9}, 3.9427690351333847`*^9, 3.9427690682198257`*^9, 
   3.9427715635525856`*^9, 3.9428545977365494`*^9, 3.9430291244111385`*^9, {
   3.9430293293032436`*^9, 3.9430293321251163`*^9}, 3.943029903411661*^9, 
   3.943029935968582*^9, {3.9430300915187435`*^9, 3.9430300983569183`*^9}, 
   3.943030165224594*^9, 3.943031018565777*^9, 3.9430310525436935`*^9, 
   3.9430315909590073`*^9, {3.943031676607229*^9, 3.943031762295637*^9}, {
   3.943032046234873*^9, 3.94303207506736*^9}, {3.943032277998928*^9, 
   3.943032328893503*^9}, 3.9430323609657345`*^9, {3.9430338379985332`*^9, 
   3.9430338777026024`*^9}, {3.9430340737475815`*^9, 3.9430340995907764`*^9}, 
   3.943034138748911*^9, 3.943034215671747*^9, 3.9430955097704773`*^9, 
   3.9433588087017574`*^9, 3.9433588506085987`*^9, 3.9433604537355385`*^9, 
   3.9433690498361454`*^9, {3.943369097716297*^9, 3.9433691157514877`*^9}, {
   3.9433691779950886`*^9, 3.9433691920949574`*^9}, {3.943369408544922*^9, 
   3.943369419957775*^9}, {3.9433694534026623`*^9, 3.9433694610976887`*^9}, {
   3.9433718095535316`*^9, 3.9433718209741173`*^9}, {3.943371942155674*^9, 
   3.943371948822159*^9}, {3.943372132182953*^9, 3.9433721356424065`*^9}, {
   3.9433723369107685`*^9, 3.9433723433940105`*^9}, {3.9433725200260067`*^9, 
   3.943372539188036*^9}, 3.9433729214440956`*^9, 3.946134979625437*^9, {
   3.946135028668358*^9, 3.9461350308236866`*^9}, {3.946380295211197*^9, 
   3.946380296539772*^9}, {3.94640043978706*^9, 3.946400483226412*^9}, 
   3.9464023612987766`*^9, {3.9464025415333214`*^9, 3.9464025643481045`*^9}, {
   3.9464031878470516`*^9, 3.946403191088213*^9}, {3.9464034240072136`*^9, 
   3.9464034490416183`*^9}, 3.94734240899786*^9, {3.947342456115858*^9, 
   3.9473425197101955`*^9}},ExpressionUUID->"a67f113d-d41d-d24a-8f3f-\
b4722fe41f74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "entrappanuer", " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Parameters", " ", "and", " ", "Variables", " ", "for", " ", 
     "Entrepreneurs"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"{", 
      RowBox[{"betaE", ",", "alpha", ",", "delta", ",", "xi1", ",", "xi2", ",", 
       RowBox[{"AE", "[", "t", "]"}], ",", 
       RowBox[{"wpt", "[", "t", "]"}], ",", 
       RowBox[{"wip", "[", "t", "]"}], ",", 
       RowBox[{"qt", "[", "t", "]"}], ",", 
       RowBox[{"rtE", "[", "t", "]"}], ",", 
       RowBox[{"pit", "[", "t", "]"}], ",", 
       RowBox[{"ctE", "[", "t", "]"}], ",", 
       RowBox[{"btE", "[", "t", "]"}], ",", 
       RowBox[{"kEt", "[", "t", "]"}], ",", 
       RowBox[{"uEt", "[", "t", "]"}], ",", 
       RowBox[{"mEt", "[", "t", "]"}], ",", 
       RowBox[{"LEP", "[", "t", "]"}], ",", 
       RowBox[{"LEI", "[", "t", "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Utility", " ", "function", " ", "for", " ", "entrepreneurs"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uEntrepreneur", "[", 
      RowBox[{"ctE_", ",", "ctELag_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Log", "[", "ctE", "]"}], "-", 
      RowBox[{"alpha", " ", 
       RowBox[{"Log", "[", "ctELag", "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Production", " ", "function", " ", "for", " ", "entrepreneurs"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yE", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"AE", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"kE", "[", 
          RowBox[{"t", "-", "1"}], "]"}], "^", "alpha"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LEP", "[", "t", "]"}], "+", 
           RowBox[{"LEI", "[", "t", "]"}]}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"1", "-", "alpha"}], ")"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Utilization", " ", "cost", " ", "function"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FUtil", "[", "u_", "]"}], ":=", 
     RowBox[{
      RowBox[{"xi1", " ", 
       RowBox[{"(", 
        RowBox[{"u", "-", "1"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"xi2", "/", "2"}], ")"}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"u", "-", "1"}], ")"}], "^", "2"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Budget", " ", "constraint", " ", "for", " ", "entrepreneurs", " ", "in", 
     " ", "period", " ", "t"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BCEntrepreneur", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"ctE", "[", "t", "]"}], "+", 
      RowBox[{
       RowBox[{"wpt", "[", "t", "]"}], " ", 
       RowBox[{"LEP", "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"wip", "[", "t", "]"}], " ", 
       RowBox[{"LEI", "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"rtE", "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ")"}], "/", 
         RowBox[{"pit", "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"btE", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"qt", "[", "t", "]"}], " ", 
       RowBox[{"kEt", "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"FUtil", "[", 
        RowBox[{"uEt", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"kEt", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], "-", 
      RowBox[{"yE", "[", "t", "]"}], "-", 
      RowBox[{"btE", "[", "t", "]"}], "-", 
      RowBox[{
       RowBox[{"qt", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "delta"}], ")"}], " ", 
       RowBox[{"kEt", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Borrowing", " ", "constraint", " ", "for", " ", "entrepreneurs", " ", 
     "in", " ", "period", " ", "t"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BorrowingConstraint", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"rtE", "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"btE", "[", "t", "]"}]}], "-", 
      RowBox[{
       RowBox[{"Mt", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"qt", "[", 
          RowBox[{"t", "+", "1"}], "]"}], " ", 
         RowBox[{"pit", "[", 
          RowBox[{"t", "+", "1"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "delta"}], ")"}], " ", 
         RowBox[{"kEt", "[", "t", "]"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", "Lagrangian", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LE", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"betaE", "^", "t"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"uEntrepreneur", "[", 
          RowBox[{
           RowBox[{"ctE", "[", "t", "]"}], ",", 
           RowBox[{"ctE", "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], "]"}], "+", 
         RowBox[{
          RowBox[{"lambdaE", "[", "t", "]"}], " ", 
          RowBox[{"BCEntrepreneur", "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"muE", "[", "t", "]"}], " ", 
          RowBox[{"BorrowingConstraint", "[", "t", "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"betaE", "^", 
        RowBox[{"(", 
         RowBox[{"t", "+", "1"}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"uEntrepreneur", "[", 
          RowBox[{
           RowBox[{"ctE", "[", 
            RowBox[{"t", "+", "1"}], "]"}], ",", 
           RowBox[{"ctE", "[", "t", "]"}]}], "]"}], "+", 
         RowBox[{
          RowBox[{"lambdaE", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"BCEntrepreneur", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"muE", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"BorrowingConstraint", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"First", "-", 
     RowBox[{"order", " ", "conditions", " ", "for", " ", "entrepreneurs"}]}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focCtE", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LE", ",", 
        RowBox[{"ctE", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "consumption", " ", 
     RowBox[{"ctE", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focKEt", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LE", ",", 
        RowBox[{"kEt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "capital", " ", 
     RowBox[{"kEt", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focBtE", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LE", ",", 
        RowBox[{"btE", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "borrowing", " ", 
     RowBox[{"btE", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focUEt", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LE", ",", 
        RowBox[{"uEt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "utilization", " ", 
     RowBox[{"uEt", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Display", " ", "results"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"debugFOCs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<FOC wrt ctE[t]\>\"", "->", "focCtE"}], ",", 
       RowBox[{"\"\<FOC wrt kEt[t]\>\"", "->", "focKEt"}], ",", 
       RowBox[{"\"\<FOC wrt btE[t]\>\"", "->", "focBtE"}], ",", 
       RowBox[{"\"\<FOC wrt uEt[t]\>\"", "->", "focUEt"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Output", " ", "the", " ", "Lagrangian"}], ",", "FOCs"}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Lagrangian\>\"", "->", "LE"}], ",", 
     RowBox[{"\"\<First-Order Conditions\>\"", "->", "debugFOCs"}]}], "}"}], 
   "\n"}]}]], "Input",
 CellChangeTimes->{
  3.942592057012724*^9, {3.942592245428005*^9, 3.94259229837319*^9}, {
   3.94259276149564*^9, 3.942592764239746*^9}, {3.9425935259046726`*^9, 
   3.942593548727476*^9}, 3.9425936374098434`*^9, {3.942594582938095*^9, 
   3.942594602603157*^9}, 3.9425946466589737`*^9, {3.9425949113557167`*^9, 
   3.9425949911134377`*^9}, 3.942595094281233*^9, {3.942595174682337*^9, 
   3.942595279071537*^9}, 3.942595447132061*^9, {3.9425956151379395`*^9, 
   3.94259563994841*^9}, 3.942595669960287*^9, {3.9425959508937435`*^9, 
   3.9425959719109993`*^9}, 3.9427690351333847`*^9, 3.9427690682198257`*^9, 
   3.9427715635525856`*^9, 3.9428545977365494`*^9, 3.9430291244111385`*^9, {
   3.9430293293032436`*^9, 3.9430293321251163`*^9}, 3.943029903411661*^9, 
   3.943029935968582*^9, {3.9430300915187435`*^9, 3.9430300983569183`*^9}, 
   3.943030165224594*^9, 3.943031018565777*^9, 3.9430310525436935`*^9, 
   3.9430315909590073`*^9, {3.943031676607229*^9, 3.943031762295637*^9}, {
   3.943032046234873*^9, 3.94303207506736*^9}, {3.943032277998928*^9, 
   3.943032328893503*^9}, 3.9430323609657345`*^9, {3.9430338379985332`*^9, 
   3.9430338777026024`*^9}, {3.9430340737475815`*^9, 3.9430340995907764`*^9}, 
   3.943034138748911*^9, 3.943034215671747*^9, 3.9430955097704773`*^9, 
   3.9433588087017574`*^9, 3.9433588506085987`*^9, 3.9433604537355385`*^9, 
   3.9433690498361454`*^9, {3.943369097716297*^9, 3.9433691157514877`*^9}, {
   3.9433691779950886`*^9, 3.9433691920949574`*^9}, {3.943369408544922*^9, 
   3.943369419957775*^9}, {3.9433694534026623`*^9, 3.9433694610976887`*^9}, {
   3.9433718095535316`*^9, 3.9433718209741173`*^9}, {3.943371942155674*^9, 
   3.943371948822159*^9}, {3.943372132182953*^9, 3.9433721356424065`*^9}, {
   3.9433723369107685`*^9, 3.9433723433940105`*^9}, {3.9433725200260067`*^9, 
   3.943372539188036*^9}, 3.9433729214440956`*^9, 3.946134979625437*^9, {
   3.946135028668358*^9, 3.9461350308236866`*^9}, {3.946380295211197*^9, 
   3.946380296539772*^9}, {3.94640043978706*^9, 3.946400483226412*^9}, 
   3.9464023612987766`*^9, {3.9464025415333214`*^9, 3.9464025643481045`*^9}, {
   3.9464031878470516`*^9, 3.946403191088213*^9}, {3.9464034240072136`*^9, 
   3.9464034490416183`*^9}, 3.94734240899786*^9, {3.947342456115858*^9, 
   3.9473425048120995`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"24e808de-ed6a-4146-a49a-28e49cf93adc"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9464031981481724`*^9, 
  3.9464032115819416`*^9}},ExpressionUUID->"4129f409-7408-7d45-9299-\
8b83db08acfc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Definisikan", " ", "FOC", " ", "wrt", " ", 
    RowBox[{"c_t", "^", "E"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"eq1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"alpha", " ", 
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}]}], ")"}], "/", 
          RowBox[{"ctE", "[", "t", "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"betaE", "^", "t"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"ctE", "[", "t", "]"}]}], "+", 
          RowBox[{"lambdaE", "[", "t", "]"}]}], ")"}]}]}], "==", "0"}]}], 
    ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"1", ")"}], " ", "Pecahkan", " ", "eq1", " ", "untuk", " ", 
     RowBox[{"lambdaE", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solLambda", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"eq1", ",", 
       RowBox[{"lambdaE", "[", "t", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Hasilnya", " ", "memberi", " ", 
      RowBox[{"lambdaE", "[", "t", "]"}], " ", "dalam", " ", "fungsi", " ", 
      "alpha"}], ",", "betaE", ",", 
     RowBox[{"dan", " ", 
      RowBox[{"ctE", "[", "t", "]"}]}]}], "*)"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Misal", " ", "Anda", " ", "punya", " ", "FOC"}], "-", 
     RowBox[{
     "FOC", " ", "lain", " ", "sebagai", " ", "daftar", " ", "persamaan", " ", 
      RowBox[{"(", 
       RowBox[{"sesuaikan", " ", "sendiri"}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focSystem", "=", 
     RowBox[{"{", 
      RowBox[{"(*", 
       RowBox[{"FOC", " ", "wrt", " ", 
        RowBox[{"kE", "[", "t", "]"}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"lambdaE", "[", "t", "]"}], " ", 
             RowBox[{"qt", "[", "t", "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "delta"}], ")"}], " ", 
             RowBox[{"Mt", "[", "t", "]"}], " ", 
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"pit", "[", 
              RowBox[{"1", "+", "t"}], "]"}], " ", 
             RowBox[{"qt", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"betaE", "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "t"}], ")"}]}], " ", 
          RowBox[{"lambdaE", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "delta"}], ")"}], " ", 
               RowBox[{"qt", "[", 
                RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}], "+", 
            RowBox[{"xi1", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"uEt", "[", 
                RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], " ", "xi2", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"uEt", "[", 
                 RowBox[{"t", "+", "1"}], "]"}]}], ")"}], "^", "2"}]}]}], 
           ")"}]}]}], "==", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"bE", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}], " ", 
            RowBox[{"lambdaE", "[", 
             RowBox[{"t", "+", "1"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"pit", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"lambdaE", "[", "t", "]"}]}], "+", 
            RowBox[{
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}], "==", 
        "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"uE", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"betaE", "^", "t"}], " ", 
         RowBox[{"kEt", "[", 
          RowBox[{"t", "-", "1"}], "]"}], " ", 
         RowBox[{"lambdaE", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"xi1", "+", 
           RowBox[{"xi2", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"uEt", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], "==", 
        "0"}]}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"2", ")"}], " ", "Gunakan", " ", "identitas", " ", "waktu"}], ",", 
     RowBox[{
      RowBox[{"misal", " ", 
       RowBox[{"lambdaE", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], "=", 
      RowBox[{
       RowBox[{"lambdaE", "[", 
        RowBox[{"t", "+", "1"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"didapat", " ", "dengan", " ", "mengganti", " ", "t"}], "->", 
          RowBox[{"t", "+", 
           RowBox[{"1", " ", "di", " ", "solLambda"}]}]}], ",", 
         RowBox[{"dsb", "."}]}], ")"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lambdaNext", "=", 
     RowBox[{"solLambda", "/.", " ", 
      RowBox[{"t", "->", 
       RowBox[{"t", "+", "1"}]}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"3", ")"}], " ", "Substitusikan", " ", "solusi", " ", "ke", " ", 
     "sistem", " ", "FOC"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focSystemSub", "=", 
     RowBox[{
      RowBox[{"focSystem", "/.", " ", 
       RowBox[{"solLambda", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "/.", " ", 
      RowBox[{"lambdaNext", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Selanjutnya", ",", 
     RowBox[{
     "Anda", " ", "bisa", " ", "gunakan", " ", "Solve", " ", "atau", " ", 
      "NSolve", " ", "untuk", " ", "menyelesaikan", " ", "sistem", " ", 
      "lengkap"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"focSystemSub", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"lambdaE", "[", "t", "]"}], ",", 
         RowBox[{"muE", "[", "t", "]"}]}], 
        RowBox[{"(*", 
         RowBox[{
         "variabel", " ", "lain", " ", "yang", " ", "ingin", " ", 
          "dipecahkan"}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{"dsb", "."}], "*)"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Definisikan", " ", "FOC", " ", "wrt", " ", 
     RowBox[{"c_t", "^", "E"}]}], "*)"}], 
   RowBox[{
    RowBox[{"eq1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"alpha", " ", 
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}]}], ")"}], "/", 
          RowBox[{"ctE", "[", "t", "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"betaE", "^", "t"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"ctE", "[", "t", "]"}]}], "+", 
          RowBox[{"lambdaE", "[", "t", "]"}]}], ")"}]}]}], "==", "0"}]}], 
    ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"1", ")"}], " ", "Pecahkan", " ", "eq1", " ", "untuk", " ", 
     RowBox[{"lambdaE", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solLambda", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"eq1", ",", 
       RowBox[{"lambdaE", "[", "t", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Hasilnya", " ", "memberi", " ", 
      RowBox[{"lambdaE", "[", "t", "]"}], " ", "dalam", " ", "fungsi", " ", 
      "alpha"}], ",", "betaE", ",", 
     RowBox[{"dan", " ", 
      RowBox[{"ctE", "[", "t", "]"}]}]}], "*)"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Misal", " ", "Anda", " ", "punya", " ", "FOC"}], "-", 
     RowBox[{
     "FOC", " ", "lain", " ", "sebagai", " ", "daftar", " ", "persamaan", " ", 
      RowBox[{"(", 
       RowBox[{"sesuaikan", " ", "sendiri"}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focSystem", "=", 
     RowBox[{"{", 
      RowBox[{"(*", 
       RowBox[{"FOC", " ", "wrt", " ", 
        RowBox[{"kE", "[", "t", "]"}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"lambdaE", "[", "t", "]"}], " ", 
             RowBox[{"qt", "[", "t", "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "delta"}], ")"}], " ", 
             RowBox[{"Mt", "[", "t", "]"}], " ", 
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"pit", "[", 
              RowBox[{"1", "+", "t"}], "]"}], " ", 
             RowBox[{"qt", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"betaE", "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "t"}], ")"}]}], " ", 
          RowBox[{"lambdaE", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "delta"}], ")"}], " ", 
               RowBox[{"qt", "[", 
                RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}], "+", 
            RowBox[{"xi1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"uEt", "[", 
                RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], " ", "xi2", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"uEt", "[", 
                 RowBox[{"t", "+", "1"}], "]"}]}], ")"}], "^", "2"}]}]}], 
           ")"}]}]}], "==", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"bE", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}], " ", 
            RowBox[{"lambdaE", "[", 
             RowBox[{"t", "+", "1"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"pit", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"lambdaE", "[", "t", "]"}]}], "+", 
            RowBox[{
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}], "==", 
        "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"uE", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"betaE", "^", "t"}], " ", 
         RowBox[{"kEt", "[", 
          RowBox[{"t", "-", "1"}], "]"}], " ", 
         RowBox[{"lambdaE", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"xi1", "+", 
           RowBox[{"xi2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"uEt", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], "==", 
        "0"}]}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"2", ")"}], " ", "Gunakan", " ", "identitas", " ", "waktu"}], ",", 
     RowBox[{
      RowBox[{"misal", " ", 
       RowBox[{"lambdaE", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], "=", 
      RowBox[{
       RowBox[{"lambdaE", "[", 
        RowBox[{"t", "+", "1"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"didapat", " ", "dengan", " ", "mengganti", " ", "t"}], "->", 
          RowBox[{"t", "+", 
           RowBox[{"1", " ", "di", " ", "solLambda"}]}]}], ",", 
         RowBox[{"dsb", "."}]}], ")"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lambdaNext", "=", 
     RowBox[{"solLambda", "/.", " ", 
      RowBox[{"t", "->", 
       RowBox[{"t", "+", "1"}]}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"3", ")"}], " ", "Substitusikan", " ", "solusi", " ", "ke", " ", 
     "sistem", " ", "FOC"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focSystemSub", "=", 
     RowBox[{
      RowBox[{"focSystem", "/.", " ", 
       RowBox[{"solLambda", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "/.", " ", 
      RowBox[{"lambdaNext", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Cetak", " ", "sistem", " ", "persamaan", " ", "yang", " ", "baru"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Sistem persamaan setelah substitusi: \>\"", ",", 
      "focSystemSub"}], "]"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Selanjutnya", ",", 
     RowBox[{
     "Anda", " ", "bisa", " ", "gunakan", " ", "Solve", " ", "atau", " ", 
      "NSolve", " ", "untuk", " ", "menyelesaikan", " ", "sistem", " ", 
      "lengkap"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"focSystemSub", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"lambdaE", "[", "t", "]"}], ",", 
         RowBox[{"muE", "[", "t", "]"}]}], 
        RowBox[{"(*", 
         RowBox[{
         "variabel", " ", "lain", " ", "yang", " ", "ingin", " ", 
          "dipecahkan"}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{"dsb", "."}], "*)"}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.946139816861929*^9, 3.9461398521181507`*^9, {3.946140256790245*^9, 
   3.9461402839309597`*^9}, {3.9461405343897038`*^9, 3.9461405627286797`*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"e52c92a4-2eb6-c645-94b2-60c371363739"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{
  3.942511329185976*^9, 3.942511423550762*^9, 3.942591573184946*^9, {
   3.9425916035900593`*^9, 3.942591633542879*^9}, {3.9425918643458405`*^9, 
   3.9425918709932823`*^9}, 3.9430982526884403`*^9, {3.943106042988516*^9, 
   3.943106076844755*^9}, {3.943108704823662*^9, 3.9431087103972626`*^9}, {
   3.943358560356596*^9, 3.943358583894329*^9}, 3.943358615914463*^9, 
   3.9433587817943974`*^9, 3.943368571775612*^9, {3.9433686889968395`*^9, 
   3.943368716318613*^9}, 
   3.943368758918228*^9},ExpressionUUID->"f19b7f51-99bd-4547-9650-\
5ff8e4c33086"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Sistem", " ", "persamaan", " ", "setelah", " ", "substitusi"}], 
   "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"focSystemSub", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
               RowBox[{"qt", "[", "t", "]"}]}], ")"}], "/", 
             RowBox[{"ctE", "[", "t", "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "delta"}], ")"}], " ", 
             RowBox[{"Mt", "[", "t", "]"}], " ", 
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"pit", "[", 
              RowBox[{"1", "+", "t"}], "]"}], " ", 
             RowBox[{"qt", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "delta"}], ")"}], " ", 
                 RowBox[{"qt", "[", 
                  RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
              RowBox[{"xi1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"uEt", "[", 
                  RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"1", "/", "2"}], " ", "xi2", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"uEt", "[", 
                   RowBox[{"1", "+", "t"}], "]"}]}], ")"}], "^", "2"}]}]}], 
             ")"}]}], ")"}], "/", 
          RowBox[{"ctE", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}]}], "==", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ctE", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"pit", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"alpha", " ", "betaE"}]}], ")"}], "/", 
               RowBox[{"ctE", "[", "t", "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}], "==", 
        "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"betaE", "^", "t"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
           RowBox[{"kEt", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"xi1", "+", 
             RowBox[{"xi2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"uEt", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
         RowBox[{"ctE", "[", "t", "]"}]}], "==", "0"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Pecahkan", " ", "persamaan", " ", "kedua", " ", "untuk", " ", 
     RowBox[{"muE", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"muESolution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"focSystemSub", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"muE", "[", "t", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Substitusikan", " ", "hasil", " ", 
     RowBox[{"muE", "[", "t", "]"}], " ", "ke", " ", "persamaan", " ", 
     "pertama"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq1Sub", "=", 
     RowBox[{
      RowBox[{"focSystemSub", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/.", " ", 
      RowBox[{"muESolution", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Tambahkan", " ", "persamaan", " ", "ketiga", " ", "ke", " ", "output"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq3", "=", 
     RowBox[{"focSystemSub", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Cetak", " ", "hasil"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Persamaan pertama setelah eliminasi muE[t]: \>\"", ",", 
      "eq1Sub"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Persamaan ketiga tetap: \>\"", ",", "eq3"}], "]"}], ";"}], 
   "\n", "\n", "\n"}]}]], "Input",
 CellChangeTimes->{{3.942508348357641*^9, 3.9425083483586407`*^9}, 
   3.9425104770787735`*^9, 3.946140941609421*^9, {3.9461411946531467`*^9, 
   3.9461412087808075`*^9}},
 CellLabel->
  "In[353]:=",ExpressionUUID->"e2c58ebf-4fbc-3d4b-ac91-cf15352134a5"],

Cell[BoxData[""], "Input",ExpressionUUID->"b88ee315-af2d-ad44-b33b-38496d3a52d4"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.942508439620474*^9, 3.942508439622467*^9}, 
   3.947343144267002*^9},ExpressionUUID->"4126ecf3-b2bc-c34e-b9ce-\
ab3dbe467b58"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", 
   RowBox[{"1.", " ", "Clear", " ", "all", " ", "symbols"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "betaE", ",", "alpha", ",", "delta", ",", "xi1", ",", "xi2", ",", "t", ",",
       "cET", ",", "qT", ",", "MT", ",", "rET", ",", "cET1", ",", "qT1", ",", 
      "pitT1", ",", "uET1", ",", "cETBar", ",", "qBar", ",", "MBar", ",", 
      "rEBar", ",", "cETBar1", ",", "qBar1", ",", "pitBar1", ",", "uEBar1", ",",
       "cEhatT", ",", "qHatT", ",", "MhatT", ",", "rEhatT", ",", "cEhatT1", ",",
       "qHatT1", ",", "pitHatT1", ",", "uEhatT1", ",", "cEhat", ",", "qHat", ",",
       "Mhat", ",", "rEhat", ",", "pitHat", ",", "uEhat"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "2.", " ", "Define", " ", "the", " ", "equation", " ", "function", " ", 
      "F", " ", "cET"}], ",", "qT", ",", "MT", ",", 
     RowBox[{"rET", " ", "represent", " ", 
      RowBox[{"cE", "[", "t", "]"}]}], ",", 
     RowBox[{"q", "[", "t", "]"}], ",", 
     RowBox[{"M", "[", "t", "]"}], ",", 
     RowBox[{
      RowBox[{"rE", "[", "t", "]"}], ";", "\[IndentingNewLine]", "cET1"}], ",",
      "qT1", ",", "pitT1", ",", 
     RowBox[{"uET1", " ", "represent", " ", 
      RowBox[{"cE", "[", 
       RowBox[{"1", "+", "t"}], "]"}]}], ",", 
     RowBox[{"q", "[", 
      RowBox[{"1", "+", "t"}], "]"}], ",", 
     RowBox[{"pit", "[", 
      RowBox[{"1", "+", "t"}], "]"}], ",", 
     RowBox[{
      RowBox[{"uE", "[", 
       RowBox[{"1", "+", "t"}], "]"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{
      "cET_", ",", "qT_", ",", "MT_", ",", "rET_", ",", "cET1_", ",", "qT1_", 
       ",", "pitT1_", ",", "uET1_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"betaE", "^", "t"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"alpha", "*", "betaE"}]}], ")"}], "*", "qT"}], ")"}], "/",
           "cET"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"alpha", "*", "betaE"}]}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"1", "-", "delta"}], ")"}], "*", "MT", "*", "qT1", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"betaE", "*", "cET"}], "-", 
               RowBox[{"cET1", "*", "pitT1"}], "+", 
               RowBox[{"betaE", "*", "cET", "*", "rET"}]}], ")"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"cET", "*", "cET1", "*", 
             RowBox[{"(", 
              RowBox[{"1", "+", "rET"}], ")"}]}], ")"}]}], ")"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"betaE", "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "t"}], ")"}]}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"alpha", "*", "betaE"}]}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "delta"}], ")"}], "*", "qT1"}], ")"}]}], "+", 
           RowBox[{"xi1", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "uET1"}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"1", "/", "2"}], "*", "xi2", "*", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "uET1"}], ")"}], "^", "2"}]}]}], 
          ")"}]}], ")"}], "/", "cET1"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "List", " ", "variables", " ", "for", " ", "differentiation"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{
      "cET", ",", "qT", ",", "MT", ",", "rET", ",", "cET1", ",", "qT1", ",", 
       "pitT1", ",", "uET1"}], "}"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "4.", " ", "Compute", " ", "partial", " ", "derivatives", " ", "of", " ", 
     "F", " ", "at", " ", "the", " ", "steady", " ", "state"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"cET", "->", "cETBar"}], ",", 
          RowBox[{"qT", "->", "qBar"}], ",", 
          RowBox[{"MT", "->", "MBar"}], ",", 
          RowBox[{"rET", "->", "rEBar"}], ",", 
          RowBox[{"cET1", "->", "cETBar1"}], ",", 
          RowBox[{"qT1", "->", "qBar1"}], ",", 
          RowBox[{"pitT1", "->", "pitBar1"}], ",", 
          RowBox[{"uET1", "->", "uEBar1"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"5.", " ", "Define", " ", "symbols", " ", "for", " ", "log"}], "-",
      "deviations"}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"These", " ", "represent", " ", "the", " ", "deviations", " ", 
     RowBox[{"(", 
      RowBox[{"d", " ", "ln", 
       RowBox[{"(", "variable", ")"}]}], ")"}], " ", "from", " ", "steady", " ",
      "state"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"For", " ", "time", " ", "t", " ", 
     RowBox[{"variables", ":"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"cEhatT", ",", "qHatT", ",", "MhatT", ",", "rEhatT"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"For", " ", "time", " ", "t"}], "+", 
     RowBox[{"1", " ", 
      RowBox[{"variables", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"cEhatT1", ",", "qHatT1", ",", "pitHatT1", ",", "uEhatT1"}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"6.", " ", "Form", " ", "the", " ", "linearized", " ", 
     RowBox[{"equation", ":", 
      RowBox[{
      "multiply", " ", "each", " ", "derivative", " ", "by", " ", "steady", " ",
        "state", "*", "hat"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", "cETBar", "*", "cEhatT"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", "qBar", "*", "qHatT"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "*", "MBar", "*", "MhatT"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "*", "rEBar", "*", "rEhatT"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "*", "cETBar1", "*", "cEhatT1"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "6", "]"}], "]"}], "*", "qBar1", "*", "qHatT1"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "7", "]"}], "]"}], "*", "pitBar1", "*", "pitHatT1"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "8", "]"}], "]"}], "*", "uEBar1", "*", "uEhatT1"}]}]}], 
    " ", ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "7.", " ", "Simplify", " ", "and", " ", "set", " ", "steady", " ", 
     "state", " ", "values", " ", "equal", " ", "to", " ", "1", " ", 
     RowBox[{"(", "optional", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEqNoBar", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEq", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cETBar", "->", "1"}], ",", 
         RowBox[{"qBar", "->", "1"}], ",", 
         RowBox[{"MBar", "->", "1"}], ",", 
         RowBox[{"rEBar", "->", "1"}], ",", 
         RowBox[{"cETBar1", "->", "1"}], ",", 
         RowBox[{"qBar1", "->", "1"}], ",", 
         RowBox[{"pitBar1", "->", "1"}], ",", 
         RowBox[{"uEBar1", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "8.", " ", "Reintroduce", " ", "time", " ", "indices", " ", "and", " ", 
     "adjust", " ", "exponents", " ", "on", " ", "betaE"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"timeSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cEhatT", "->", 
        RowBox[{"cEhat", "[", "t", "]"}]}], ",", 
       RowBox[{"qHatT", "->", 
        RowBox[{"qHat", "[", "t", "]"}]}], ",", 
       RowBox[{"MhatT", "->", 
        RowBox[{"Mhat", "[", "t", "]"}]}], ",", 
       RowBox[{"rEhatT", "->", 
        RowBox[{"rEhat", "[", "t", "]"}]}], ",", 
       RowBox[{"cEhatT1", "->", 
        RowBox[{"cEhat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"qHatT1", "->", 
        RowBox[{"qHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"pitHatT1", "->", 
        RowBox[{"pitHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"uEhatT1", "->", 
        RowBox[{"uEhat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"betaE", "^", 
         RowBox[{"(", 
          RowBox[{"1", "+", "t"}], ")"}]}], "->", 
        RowBox[{"betaE", "^", 
         RowBox[{"(", 
          RowBox[{"t", "+", "1"}], ")"}]}]}]}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqTimeIndexed", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Output", " ", "the", " ", "final", " ", "linearized", " ", "equations"}],
     "*)"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"final", "=", 
    RowBox[{"FullSimplify", "[", "eqTimeIndexed", "]"}]}], "\n", "final", 
   "\n", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.942508439620474*^9, 3.942508439622467*^9}, 
   3.947343144267002*^9, 3.947343225841057*^9, 3.9476921206255417`*^9, 
   3.9476925659858646`*^9, {3.9476929256355705`*^9, 3.9476929420413055`*^9}, {
   3.947693156454401*^9, 3.947693171855715*^9}, {3.947693208884466*^9, 
   3.947693262539545*^9}, 3.9476933214529095`*^9, {3.947951709971283*^9, 
   3.947951764419405*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"e455865f-d51a-c546-92e4-fe2425237d2b"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.9476933821967697`*^9, 3.9476933997913017`*^9}, {
  3.9479516911854343`*^9, 
  3.9479517038352757`*^9}},ExpressionUUID->"2dd959b2-176f-8a4f-80e4-\
1ab403b9ba23"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9476933821967697`*^9, 
  3.9476933997913017`*^9}},ExpressionUUID->"7e7eb5ba-8e84-5b42-acd7-\
29c01026fa12"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"1.", " ", "Clear", " ", "all", " ", "symbols"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "betaE", ",", "alpha", ",", "xi1", ",", "xi2", ",", "t", ",", "kEtT", ",",
       "ctET", ",", "uEtT", ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "variables", " ", "in", " ", "F", " ", "corresponding", " ", "to", " ", 
         RowBox[{"kEt", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ",", 
        RowBox[{"ctE", "[", "t", "]"}], ",", 
        RowBox[{"uEt", "[", "t", "]"}]}], "*)"}], "kEBar", ",", "ctEBar", ",",
       "uEBar", ",", 
      RowBox[{"(*", 
       RowBox[{"steady", " ", "state", " ", "values"}], "*)"}], "kEhatT", ",",
       "ctEhatT", ",", "uEhatT", ",", 
      RowBox[{"(*", 
       RowBox[{"log", "-", "deviations"}], "*)"}], "kEhat", ",", "ctEhat", ",",
       "uEhat"}], "       ", 
     RowBox[{"(*", 
      RowBox[{"time", "-", 
       RowBox[{"indexed", " ", "log", " ", "deviations"}]}], "*)"}], "]"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "2.", " ", "Define", " ", "the", " ", "original", " ", "equation", " ", 
       "as", " ", "F", 
       RowBox[{"(", "...", ")"}]}], "==", 
      RowBox[{"0.", " ", "Here"}]}], ",", 
     RowBox[{"kEtT", " ", "represents", " ", 
      RowBox[{"kEt", "[", 
       RowBox[{"t", "-", "1"}], "]"}]}], ",", 
     RowBox[{"ctET", " ", "represents", " ", 
      RowBox[{"ctE", "[", "t", "]"}]}], ",", 
     RowBox[{"and", " ", "uEtT", " ", "represents", " ", 
      RowBox[{
       RowBox[{"uEt", "[", "t", "]"}], "."}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{"kEtT_", ",", "ctET_", ",", "uEtT_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"betaE", "^", "t"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"alpha", "*", "betaE"}]}], ")"}], "*", "kEtT", "*", 
        RowBox[{"(", 
         RowBox[{"xi1", "+", 
          RowBox[{"xi2", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "uEtT"}], ")"}]}]}], ")"}]}], ")"}], "/",
       "ctET"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "List", " ", "the", " ", "variables", " ", "for", " ", 
     "differentiation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{"kEtT", ",", "ctET", ",", "uEtT"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "4.", " ", "Compute", " ", "partial", " ", "derivatives", " ", "of", " ", 
     "F", " ", "at", " ", "the", " ", "steady", " ", "state"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"kEtT", "->", "kEBar"}], ",", 
          RowBox[{"ctET", "->", "ctEBar"}], ",", 
          RowBox[{"uEtT", "->", "uEBar"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"5.", " ", "Define", " ", "symbols", " ", "for", " ", "log"}], "-", 
     RowBox[{"deviations", " ", 
      RowBox[{"(", 
       RowBox[{"d", " ", "ln", 
        RowBox[{"(", "variable", ")"}]}], ")"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"kEhatT", " ", "corresponds", " ", "to", " ", 
       RowBox[{"kEt", "'"}], "s", " ", "log", " ", "deviation", " ", "at", " ",
        "time", " ", "t"}], "-", "1"}], ",", 
     RowBox[{"etc", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"kEhatT", ",", "ctEhatT", ",", "uEhatT"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "6.", " ", "Form", " ", "the", " ", "linearized", " ", "equation", " ", 
      "by", " ", "multiplying", " ", "each", " ", "derivative", " ", "by", " ",
       "the", " ", "corresponding", " ", "steady", " ", "state", " ", "and", " ",
       "log"}], "-", "deviation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", "kEBar", "*", "kEhatT"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", "ctEBar", "*", "ctEhatT"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "*", "uEBar", "*", "uEhatT"}]}]}], 
    ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "7.", " ", "Simplify", " ", "and", " ", "optionally", " ", "normalize", " ",
      "steady", " ", "state", " ", "values", " ", "to", " ", "1"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEqNoBar", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEq", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"kEBar", "->", "1"}], ",", 
         RowBox[{"ctEBar", "->", "1"}], ",", 
         RowBox[{"uEBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"8.", " ", "Reintroduce", " ", "time", " ", 
       RowBox[{"indices", ":", "kEhatT"}]}], "->", 
      RowBox[{
       RowBox[{"kEhat", "[", 
        RowBox[{"t", "-", "1"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"since", " ", "kEtT", " ", "represents", " ", 
         RowBox[{"kEt", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ")"}]}]}], ",", 
     RowBox[{"ctEhatT", "->", 
      RowBox[{"ctEhat", "[", "t", "]"}]}], ",", 
     RowBox[{"uEhatT", "->", 
      RowBox[{"uEhat", "[", "t", "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"timeSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"kEhatT", "->", 
        RowBox[{"kEhat", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], ",", 
       RowBox[{"ctEhatT", "->", 
        RowBox[{"ctEhat", "[", "t", "]"}]}], ",", 
       RowBox[{"uEhatT", "->", 
        RowBox[{"uEhat", "[", "t", "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"eqTimeIndexed", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Output", " ", "the", " ", "final", " ", "linearized", " ", "equations"}],
     "*)"}], "\[IndentingNewLine]", "logLinEqNoBar", "\n", "eqTimeIndexed", 
   "\n", "\[IndentingNewLine]", "\n"}]}]], "Input",
 CellChangeTimes->{{3.946985315020729*^9, 3.9469853498544445`*^9}, {
   3.9469855371680393`*^9, 3.9469855426712666`*^9}, {3.946986379214081*^9, 
   3.946986384157078*^9}, 3.9469868520171394`*^9, {3.946987699902313*^9, 
   3.9469877303491592`*^9}, 3.9469881338402653`*^9, {3.946988164224745*^9, 
   3.9469881780090294`*^9}, {3.947004166869732*^9, 3.947004204956812*^9}, {
   3.947178139271166*^9, 3.9471781409626083`*^9}, {3.9473433951528263`*^9, 
   3.947343404765833*^9}, 3.9476921024180756`*^9, {3.947693597434248*^9, 
   3.947693625683399*^9}, {3.947694955148752*^9, 3.9476949754949703`*^9}},
 CellLabel->
  "In[206]:=",ExpressionUUID->"0ee05957-9f4b-5148-9577-73fb4d317e3e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"CGP", " ", "Lagrange"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"goods", " ", "market"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "Parameters", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"params", "=", 
    RowBox[{"{", 
     RowBox[{
     "\[Beta]", ",", "\[CapitalLambda]E", ",", "\[Kappa]", ",", "\[Delta]", ",", 
      RowBox[{"Pt", "[", "t", "]"}], ",", 
      RowBox[{"Pk", "[", "t", "]"}], ",", 
      RowBox[{"xt", "[", "t", "]"}], ",", 
      RowBox[{"kt", "[", "t", "]"}], ",", 
      RowBox[{"it", "[", "t", "]"}], ",", 
      RowBox[{"kt", "[", "t", "]"}], ",", 
      RowBox[{"iqk", "[", "t", "]"}], ",", 
      RowBox[{"\[Epsilon]qk", "[", "t", "]"}], ",", 
      RowBox[{"\[Lambda]", "[", "t", "]"}]}], "}"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Define", " ", 
    RowBox[{"\[CapitalDelta]xBar", "[", "t", "]"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalDelta]xBar", "[", "t_", "]"}], ":=", 
    RowBox[{
     RowBox[{"kt", "[", "t", "]"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Delta]"}], ")"}], " ", 
      RowBox[{"kt", "[", 
       RowBox[{"t", "-", "1"}], "]"}]}]}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Objective", " ", "function", " ", "for", " ", "CGP"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"objectiveCGP", "[", 
     RowBox[{
     "it_", ",", "\[CapitalDelta]xBar_", ",", "\[CapitalLambda]E_", ",", 
      "Pk_", ",", "Pt_"}], "]"}], ":=", 
    RowBox[{"\[CapitalLambda]E", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Pk", " ", "\[CapitalDelta]xBar"}], "-", 
       RowBox[{"Pt", " ", "it"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\n", 
  RowBox[{"(*", 
   RowBox[{"Constraint", " ", "for", " ", "CGP"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"constraintCGP", "[", "t_", "]"}], ":=", 
    RowBox[{
     RowBox[{"xt", "[", "t", "]"}], "-", 
     RowBox[{"xt", "[", 
      RowBox[{"t", "-", "1"}], "]"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"\[Kappa]", "/", "2"}], " ", "*", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"it", "[", "t", "]"}], " ", 
                RowBox[{"\[Epsilon]qk", "[", "t", "]"}]}], ")"}], "/", 
              RowBox[{"it", "[", 
               RowBox[{"1", "-", "t"}], "]"}]}], ")"}], "-", "1"}], ")"}], "^",
           "2"}]}]}], ")"}], " ", 
      RowBox[{"it", "[", "t", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Define", " ", "Lagrangian", " ", "for", " ", "two", " ", "periods", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"t", " ", "and", " ", "t"}], "+", "1"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"L", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"objectiveCGP", "[", 
        RowBox[{
         RowBox[{"it", "[", "t", "]"}], ",", 
         RowBox[{"\[CapitalDelta]xBar", "[", "t", "]"}], ",", 
         "\[CapitalLambda]E", ",", 
         RowBox[{"Pk", "[", "t", "]"}], ",", 
         RowBox[{"Pt", "[", "t", "]"}]}], "]"}], "+", 
       RowBox[{
        RowBox[{"\[Lambda]", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"constraintCGP", "[", "t", "]"}], ")"}]}]}], ")"}], "+", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"objectiveCGP", "[", 
         RowBox[{
          RowBox[{"it", "[", 
           RowBox[{"t", "+", "1"}], "]"}], ",", 
          RowBox[{"\[CapitalDelta]xBar", "[", 
           RowBox[{"t", "+", "1"}], "]"}], ",", "\[CapitalLambda]E", ",", 
          RowBox[{"Pk", "[", 
           RowBox[{"t", "+", "1"}], "]"}], ",", 
          RowBox[{"Pt", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{"\[Lambda]", "[", 
          RowBox[{"t", "+", "1"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"constraintCGP", "[", 
           RowBox[{"t", "+", "1"}], "]"}], ")"}]}]}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"First", "-", 
    RowBox[{"order", " ", "conditions", " ", "for", " ", "CGP"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"focIt", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"L", ",", 
       RowBox[{"it", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], 
  "        ", 
  RowBox[{"(*", 
   RowBox[{"FOC", " ", "with", " ", "respect", " ", "to", " ", 
    RowBox[{"it", "[", "t", "]"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"focXt", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"L", ",", 
       RowBox[{"xt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], 
  "        ", 
  RowBox[{"(*", 
   RowBox[{"FOC", " ", "with", " ", "respect", " ", "to", " ", 
    RowBox[{"xt", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"Debug", " ", "the", " ", "FOCs", " ", "before", " ", "solving"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"debugFOCs", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FOC wrt it[t]\>\"", "->", "focIt"}], ",", 
      RowBox[{"\"\<FOC wrt xt[t]\>\"", "->", "focXt"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Solve", " ", "FOCs", " ", "for", " ", "\[Lambda]"}], ",", 
    RowBox[{"keeping", " ", "full", " ", "expressions"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lambdaSolutions", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<Lambda wrt it[t]\>\"", "->", 
       RowBox[{"Solve", "[", 
        RowBox[{"focIt", ",", 
         RowBox[{"\[Lambda]", "[", "t", "]"}]}], "]"}]}], ",", 
      RowBox[{"\"\<Lambda wrt xt[t]\>\"", "->", 
       RowBox[{"Solve", "[", 
        RowBox[{"focXt", ",", 
         RowBox[{"\[Lambda]", "[", "t", "]"}]}], "]"}]}]}], "}"}]}], ";"}], 
  "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", "Results", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<Lambda Solutions\>\"", "->", "lambdaSolutions"}], "}"}], 
  "]"}], "\[IndentingNewLine]", "focIt", "\n", "focXt", \
"\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.946985315020729*^9, 3.9469853498544445`*^9}, {
   3.9469855371680393`*^9, 3.9469855426712666`*^9}, {3.946986379214081*^9, 
   3.946986384157078*^9}, 3.9469868520171394`*^9, {3.946987699902313*^9, 
   3.9469877303491592`*^9}, 3.9469881338402653`*^9, {3.946988164224745*^9, 
   3.9469881780090294`*^9}, {3.947004166869732*^9, 3.947004204956812*^9}, {
   3.947178139271166*^9, 3.9471781409626083`*^9}, 3.9473433951528263`*^9, {
   3.947774463264351*^9, 3.947774582804943*^9}, {3.9477746544935417`*^9, 
   3.9477746704503098`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"d50ef5dd-7d10-9347-8ed7-e6a9098ab778"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"-", "\[CapitalLambda]E"}], " ", 
    RowBox[{"Pt", "[", "t", "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"\[Kappa]", " ", 
        RowBox[{"it", "[", "t", "]"}], " ", 
        RowBox[{"\[Epsilon]qk", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          FractionBox[
           RowBox[{
            RowBox[{"it", "[", "t", "]"}], " ", 
            RowBox[{"\[Epsilon]qk", "[", "t", "]"}]}], 
           RowBox[{"it", "[", 
            RowBox[{"1", "-", "t"}], "]"}]]}], ")"}]}], 
       RowBox[{"it", "[", 
        RowBox[{"1", "-", "t"}], "]"}]], "-", 
      RowBox[{
       FractionBox["1", "2"], " ", "\[Kappa]", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          FractionBox[
           RowBox[{
            RowBox[{"it", "[", "t", "]"}], " ", 
            RowBox[{"\[Epsilon]qk", "[", "t", "]"}]}], 
           RowBox[{"it", "[", 
            RowBox[{"1", "-", "t"}], "]"}]]}], ")"}], "2"]}]}], ")"}], " ", 
    RowBox[{"\[Lambda]", "[", "t", "]"}]}]}], "\[Equal]", "0"}]], "Input",
 CellChangeTimes->{{3.9477832974356384`*^9, 
  3.947783320320606*^9}},ExpressionUUID->"63b0b1fd-2390-274b-9686-\
decf9bf4215f"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9477832974356384`*^9, 3.9477833320736427`*^9}, {
   3.947783444542406*^9, 3.9477834917791805`*^9}, {3.9477835283245945`*^9, 
   3.9477835684462967`*^9}, 
   3.9477836422302113`*^9},ExpressionUUID->"71ece0e5-c6b3-3242-9291-\
2dce22eed9c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "1.", " ", "Define", " ", "the", " ", "substitution", " ", "rule", " ", 
    "for", " ", 
    RowBox[{"\[Lambda]", "[", "t", "]"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"lambdaSub1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Lambda]", "[", "t", "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", "*", "\[CapitalLambda]E", "*", 
            RowBox[{
             RowBox[{"it", "[", 
              RowBox[{"1", "-", "t"}], "]"}], "^", "2"}], "*", 
            RowBox[{"Pt", "[", "t", "]"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], "*", 
             RowBox[{
              RowBox[{"it", "[", 
               RowBox[{"1", "-", "t"}], "]"}], "^", "2"}]}], "+", 
            RowBox[{"\[Kappa]", "*", 
             RowBox[{
              RowBox[{"it", "[", 
               RowBox[{"1", "-", "t"}], "]"}], "^", "2"}]}], "-", 
            RowBox[{"4", "*", "\[Kappa]", "*", 
             RowBox[{"it", "[", 
              RowBox[{"1", "-", "t"}], "]"}], "*", 
             RowBox[{"it", "[", "t", "]"}], "*", 
             RowBox[{"\[Epsilon]qk", "[", "t", "]"}]}], "+", 
            RowBox[{"3", "*", "\[Kappa]", "*", 
             RowBox[{
              RowBox[{"it", "[", "t", "]"}], "^", "2"}], "*", 
             RowBox[{
              RowBox[{"\[Epsilon]qk", "[", "t", "]"}], "^", "2"}]}]}], 
           ")"}]}], ")"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "2.", " ", "Define", " ", "the", " ", "substitution", " ", "rule", " ", 
     "for", " ", 
     RowBox[{"\[Lambda]", "[", 
      RowBox[{"t", "+", "1"}], "]"}], " ", "explicitly", " ", "by", " ", 
     "adding", " ", "1", " ", "to", " ", "every", " ", "time", " ", "index"}],
     "*)"}], "\n", 
   RowBox[{
    RowBox[{"lambdaSub2", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Lambda]", "[", 
        RowBox[{"t", "+", "1"}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", "*", "\[CapitalLambda]E", "*", 
            RowBox[{
             RowBox[{"it", "[", 
              RowBox[{"1", "-", 
               RowBox[{"(", 
                RowBox[{"t", "+", "1"}], ")"}]}], "]"}], "^", "2"}], "*", 
            RowBox[{"Pt", "[", 
             RowBox[{"t", "+", "1"}], "]"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], "*", 
             RowBox[{
              RowBox[{"it", "[", 
               RowBox[{"1", "-", 
                RowBox[{"(", 
                 RowBox[{"t", "+", "1"}], ")"}]}], "]"}], "^", "2"}]}], "+", 
            RowBox[{"\[Kappa]", "*", 
             RowBox[{
              RowBox[{"it", "[", 
               RowBox[{"1", "-", 
                RowBox[{"(", 
                 RowBox[{"t", "+", "1"}], ")"}]}], "]"}], "^", "2"}]}], "-", 
            RowBox[{"4", "*", "\[Kappa]", "*", 
             RowBox[{"it", "[", 
              RowBox[{"1", "-", 
               RowBox[{"(", 
                RowBox[{"t", "+", "1"}], ")"}]}], "]"}], "*", 
             RowBox[{"it", "[", 
              RowBox[{"t", "+", "1"}], "]"}], "*", 
             RowBox[{"\[Epsilon]qk", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", 
            RowBox[{"3", "*", "\[Kappa]", "*", 
             RowBox[{
              RowBox[{"it", "[", 
               RowBox[{"t", "+", "1"}], "]"}], "^", "2"}], "*", 
             RowBox[{
              RowBox[{"\[Epsilon]qk", "[", 
               RowBox[{"t", "+", "1"}], "]"}], "^", "2"}]}]}], ")"}]}], 
         ")"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "Define", " ", "example", " ", "equations", " ", "that", " ", 
     "involve", " ", 
     RowBox[{"\[Lambda]", "[", "t", "]"}], " ", "and", " ", 
     RowBox[{"\[Lambda]", "[", 
      RowBox[{"t", "+", "1"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Equation", " ", 
     RowBox[{"A", ":", 
      RowBox[{
       RowBox[{"An", " ", "example", " ", "first"}], "-", 
       RowBox[{"order", " ", "condition", " ", 
        RowBox[{"(", "FOC", ")"}], " ", "involving", " ", 
        RowBox[{"\[Lambda]", "[", "t", "]"}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqA", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[CapitalLambda]E"}], "*", 
        RowBox[{"Pt", "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Kappa]", "*", 
             RowBox[{"it", "[", "t", "]"}], "*", 
             RowBox[{"\[Epsilon]qk", "[", "t", "]"}], "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{
                 RowBox[{"it", "[", "t", "]"}], "*", 
                 RowBox[{
                  RowBox[{"\[Epsilon]qk", "[", "t", "]"}], "/", 
                  RowBox[{"it", "[", 
                   RowBox[{"1", "-", "t"}], "]"}]}]}]}], ")"}], "/", 
              RowBox[{"it", "[", 
               RowBox[{"1", "-", "t"}], "]"}]}]}], "-", 
            RowBox[{
             RowBox[{"1", "/", "2"}], "*", "\[Kappa]", "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{
                 RowBox[{"it", "[", "t", "]"}], "*", 
                 RowBox[{
                  RowBox[{"\[Epsilon]qk", "[", "t", "]"}], "/", 
                  RowBox[{"it", "[", 
                   RowBox[{"1", "-", "t"}], "]"}]}]}]}], ")"}], "^", 
              "2"}]}]}], ")"}]}], ")"}], "*", 
        RowBox[{"\[Lambda]", "[", "t", "]"}]}]}], "==", "0"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Equation", " ", 
     RowBox[{"B", ":", 
      RowBox[{"A", " ", "linking", " ", "condition", " ", "between", " ", 
       RowBox[{"\[Lambda]", "[", "t", "]"}], " ", "and", " ", 
       RowBox[{"\[Lambda]", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqB", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Lambda]", "[", "t", "]"}], "-", 
       RowBox[{"\[Beta]", "*", 
        RowBox[{"\[Lambda]", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}]}], "==", "0"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "4.", " ", "Apply", " ", "the", " ", "substitution", " ", "rules"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"eqAPlugged", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"eqA", "/.", " ", "lambdaSub1"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"eqBPlugged", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"eqB", "/.", " ", "lambdaSub1"}], "/.", "lambdaSub2"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "5.", " ", "Output", " ", "the", " ", "resulting", " ", "equations"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"eqAPlugged", ",", "eqBPlugged"}], "}"}], "\n", 
   "\[IndentingNewLine]", "\n", "\n", "\n"}]}]], "Input",
 CellChangeTimes->{{3.9477765584922104`*^9, 3.9477765996736145`*^9}, {
   3.9477766523289223`*^9, 3.9477766537406273`*^9}, {3.947777218009754*^9, 
   3.9477772629500523`*^9}, {3.9477773108772793`*^9, 3.947777314516247*^9}, {
   3.9477774559547176`*^9, 3.94777747338566*^9}, 3.947778172717783*^9, 
   3.9477782078892593`*^9, 3.9477782395551414`*^9, {3.9477796378394737`*^9, 
   3.947779650137188*^9}, {3.9477827329496593`*^9, 3.947782752283697*^9}, {
   3.94778280092708*^9, 3.947782853216881*^9}},
 CellLabel->
  "In[228]:=",ExpressionUUID->"2c594bee-dfa3-0445-a3c2-f168b0935ff6"],

Cell[BoxData[""], "Input",ExpressionUUID->"dcfcb1a1-4b7e-0b43-9670-8664b3289327"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{
  3.9427542379518967`*^9, {3.9427544965523434`*^9, 3.9427545632885056`*^9}, {
   3.946568422636217*^9, 3.9465684433856716`*^9}, 3.9465684783490505`*^9, 
   3.946568532208021*^9, {3.946568632693981*^9, 3.946568653514969*^9}, {
   3.946569857761751*^9, 3.9465698651066914`*^9}, 3.9465723397106075`*^9, 
   3.94665877743454*^9, {3.9466588743666687`*^9, 3.946658879360529*^9}, {
   3.946658937645237*^9, 3.9466589592356358`*^9}, {3.94666007926388*^9, 
   3.946660096683794*^9}, {3.946660162254713*^9, 3.946660179652712*^9}, {
   3.9466603112136536`*^9, 3.9466603652698765`*^9}, 3.9466606586495495`*^9, 
   3.946660721591772*^9, {3.9466614892396374`*^9, 3.946661517609167*^9}, {
   3.9466615581775208`*^9, 3.94666162347818*^9}, 3.9466620995132637`*^9, 
   3.946662154477379*^9, 3.946662259309641*^9, 3.946662304670412*^9, 
   3.9466641153553944`*^9, 3.9477757023255024`*^9, {3.9477757356890717`*^9, 
   3.9477757536725636`*^9}, {3.9477761576092434`*^9, 3.9477761750114326`*^9}},
 CellLabel->"",ExpressionUUID->"a5650fd1-18d4-1d4e-89f1-7b4f1f908005"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "itLag", ",", "itT", ",", "qkT", ",", "PtT", ",", "kappa", ",", 
     "triangleE", ",", "eps", ",", "t", ",", "itBar", ",", "qkBar", ",", 
     "PtBar", ",", "itHatLag", ",", "itHatT", ",", "qkHat", ",", "PtHat"}], 
    "]"}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "1.", " ", "Define", " ", "the", " ", "original", " ", "equation", " ", 
     "F"}], "==", "0"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{"itLag_", ",", "itT_", ",", "qkT_", ",", "PtT_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"kappa", "*", "triangleE", "*", "PtT", "*", 
       RowBox[{"(", 
        RowBox[{"itLag", "-", 
         RowBox[{"itT", "*", "eps", "*", "qkT"}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "kappa"}], ")"}], "*", 
         RowBox[{"itLag", "^", "2"}]}], "-", 
        RowBox[{
        "4", "*", "kappa", "*", "itLag", "*", "itT", "*", "eps", "*", "qkT"}],
         "+", 
        RowBox[{"3", "*", "kappa", "*", 
         RowBox[{"itT", "^", "2"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"eps", "*", "qkT"}], ")"}], "^", "2"}]}]}], ")"}], 
      ")"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "2.", " ", "List", " ", "the", " ", "variables", " ", "to", " ", 
    "differentiate", " ", "with", " ", "respect", " ", "to"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vars", "=", 
    RowBox[{"{", 
     RowBox[{"itLag", ",", "itT", ",", "qkT", ",", "PtT"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "3.", " ", "Compute", " ", "partial", " ", "derivatives", " ", "at", " ", 
    "the", " ", "steady", " ", "state"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"partials", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"F", "@@", "vars"}], ",", 
         RowBox[{"vars", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"itLag", "->", "itBar"}], ",", 
         RowBox[{"itT", "->", "itBar"}], ",", 
         RowBox[{"qkT", "->", "qkBar"}], ",", 
         RowBox[{"PtT", "->", "PtBar"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"4.", " ", "Define", " ", "log"}], "-", 
    RowBox[{"deviation", " ", "variables"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"itHatLag", ",", "itHatT", ",", "qkHat", ",", "PtHat"}], "]"}], 
   ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "5.", " ", "Multiply", " ", "each", " ", "derivative", " ", "by", " ", 
    "the", " ", "corresponding", " ", "steady", " ", "state", " ", "times", " ",
     "its", " ", "hat"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varsBar", "=", 
   RowBox[{"{", 
    RowBox[{"itBar", ",", "itBar", ",", "qkBar", ",", "PtBar"}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEq", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", "itBar", "*", "itHatLag"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", "itBar", "*", "itHatT"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "*", "qkBar", "*", "qkHat"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "*", "PtBar", "*", "PtHat"}]}], "==", 
     "0"}]}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "6.", " ", "Simplify", " ", "and", " ", "normalize", " ", "by", " ", 
    "setting", " ", "steady", " ", "states", " ", "to", " ", "1"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEqNoBar", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"logLinEq", "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"itBar", "->", "1"}], ",", 
        RowBox[{"qkBar", "->", "1"}], ",", 
        RowBox[{"PtBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"7.", " ", "Reintroduce", " ", "time", " ", "indices", " ", 
     RowBox[{"assuming", ":", "itHatLag"}]}], "->", 
    RowBox[{
     RowBox[{
      RowBox[{"itHat", "[", 
       RowBox[{"t", "-", "1"}], "]"}], " ", "itHatT"}], "->", 
     RowBox[{
      RowBox[{
       RowBox[{"itHat", "[", "t", "]"}], " ", "qkHat"}], "->", 
      RowBox[{
       RowBox[{
        RowBox[{"qkHat", "[", "t", "]"}], " ", "PtHat"}], "->", 
       RowBox[{"PtHat", "[", "t", "]"}]}]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"timeSubs", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"itHatLag", "->", 
       RowBox[{"itHat", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], ",", 
      RowBox[{"itHatT", "->", 
       RowBox[{"itHat", "[", "t", "]"}]}], ",", 
      RowBox[{"qkHat", "->", 
       RowBox[{"qkHat", "[", "t", "]"}]}], ",", 
      RowBox[{"PtHat", "->", 
       RowBox[{"PtHat", "[", "t", "]"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{"logLinEqTime", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], "\n", 
 RowBox[{"final", "=", 
  RowBox[{"FullSimplify", "[", "logLinEqTime", "]"}]}]}], "Input",
 CellChangeTimes->{{3.947784073489916*^9, 3.947784073489916*^9}, {
  3.9479524236628036`*^9, 3.947952454649807*^9}, {3.947952601062275*^9, 
  3.947952641709175*^9}},
 CellLabel->
  "In[235]:=",ExpressionUUID->"e2dbdcc9-c66d-4441-907d-edfe421a4271"],

Cell[BoxData[""], "Input",
 CellLabel->"In[92]:=",ExpressionUUID->"39487013-ded2-0e45-9fd8-d526c979fc41"],

Cell[BoxData[""], "Input",ExpressionUUID->"ad54bf90-5079-e447-887e-2c9f31b492f1"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{3.9469892159862976`*^9, 
  3.9469897185201645`*^9},ExpressionUUID->"9179d0fc-bd3a-474d-81a0-\
4d1659297c19"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "itLag", ",", "itL", ",", "itT", ",", "itFut", ",", "qkT", ",", "qkFut", ",",
      "PtT", ",", "PtFut", ",", "beta", ",", "LambdaE", ",", "kappa", ",", 
     "eps", ",", "itBar", ",", "qkBar", ",", "PtBar", ",", "itHatLag", ",", 
     "itHatL", ",", "itHatT", ",", "itHatFut", ",", "qkHatT", ",", "qkHatFut",
      ",", "PtHatT", ",", "PtHatFut", ",", "t"}], "]"}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "1.", " ", "Define", " ", "the", " ", "original", " ", "equation", " ", 
     "F"}], "==", 
    RowBox[{"0", " ", "as", " ", "LHS", " ", "minus", " ", "RHS"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{
     "itLag_", ",", "itL_", ",", "itT_", ",", "itFut_", ",", "qkT_", ",", 
      "qkFut_", ",", "PtT_", ",", "PtFut_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", " ", "beta", " ", "LambdaE", " ", 
        RowBox[{"itLag", "^", "2"}], " ", "PtFut"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "kappa"}], ")"}], "*", 
          RowBox[{"itLag", "^", "2"}]}], "-", 
         RowBox[{
         "4", "*", "kappa", "*", "itLag", "*", "itFut", "*", "eps", "*", 
          "qkFut"}], "+", 
         RowBox[{"3", "*", "kappa", "*", 
          RowBox[{"itFut", "^", "2"}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"eps", "*", "qkFut"}], ")"}], "^", "2"}]}]}], ")"}], 
       ")"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", " ", "LambdaE", " ", 
        RowBox[{"itL", "^", "2"}], " ", "PtT"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "kappa"}], ")"}], "*", 
          RowBox[{"itL", "^", "2"}]}], "-", 
         RowBox[{
         "4", "*", "kappa", "*", "itL", "*", "itT", "*", "eps", "*", "qkT"}], 
         "+", 
         RowBox[{"3", "*", "kappa", "*", 
          RowBox[{"itT", "^", "2"}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"eps", "*", "qkT"}], ")"}], "^", "2"}]}]}], ")"}], 
       ")"}]}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "2.", " ", "List", " ", "the", " ", "variables", " ", "for", " ", 
    "differentiation"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vars", "=", 
    RowBox[{"{", 
     RowBox[{
     "itLag", ",", "itL", ",", "itT", ",", "itFut", ",", "qkT", ",", "qkFut", 
      ",", "PtT", ",", "PtFut"}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "3.", " ", "Compute", " ", "the", " ", "partial", " ", "derivatives", " ", 
    "evaluated", " ", "at", " ", "the", " ", "steady", " ", "state"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"partials", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"F", "@@", "vars"}], ",", 
         RowBox[{"vars", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"itLag", "->", "itBar"}], ",", 
         RowBox[{"itL", "->", "itBar"}], ",", 
         RowBox[{"itT", "->", "itBar"}], ",", 
         RowBox[{"itFut", "->", "itBar"}], ",", 
         RowBox[{"qkT", "->", "qkBar"}], ",", 
         RowBox[{"qkFut", "->", "qkBar"}], ",", 
         RowBox[{"PtT", "->", "PtBar"}], ",", 
         RowBox[{"PtFut", "->", "PtBar"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], "\n",
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"4.", " ", "Define", " ", "the", " ", "log"}], "-", 
    RowBox[{"deviation", " ", 
     RowBox[{"(", "\"\<hat\>\"", ")"}], " ", "variables"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "itHatLag", ",", "itHatL", ",", "itHatT", ",", "itHatFut", ",", "qkHatT", 
     ",", "qkHatFut", ",", "PtHatT", ",", "PtHatFut"}], "]"}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "5.", " ", "Multiply", " ", "each", " ", "derivative", " ", "by", " ", 
    "its", " ", "steady", " ", "state", " ", "and", " ", "corresponding", " ",
     "hat"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEq", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", "itBar", "*", "itHatLag"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", "itBar", "*", "itHatL"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "*", "itBar", "*", "itHatT"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "*", "itBar", "*", "itHatFut"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "*", "qkBar", "*", "qkHatT"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "6", "]"}], "]"}], "*", "qkBar", "*", "qkHatFut"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "7", "]"}], "]"}], "*", "PtBar", "*", "PtHatT"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "8", "]"}], "]"}], "*", "PtBar", "*", "PtHatFut"}]}], "==",
      "0"}]}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "6.", " ", "Simplify", " ", "and", " ", "normalize", " ", "by", " ", 
    "setting", " ", "steady", " ", "states", " ", "to", " ", "1"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEqNoBar", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"logLinEq", "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"itBar", "->", "1"}], ",", 
        RowBox[{"qkBar", "->", "1"}], ",", 
        RowBox[{"PtBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "7.", " ", "Reintroduce", " ", "the", " ", "original", " ", "time", " ", 
    "indices"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"timeSubs", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"itHatLag", "->", 
       RowBox[{"itHat", "[", 
        RowBox[{"-", "t"}], "]"}]}], ",", 
      RowBox[{"itHatL", "->", 
       RowBox[{"itHat", "[", 
        RowBox[{"1", "-", "t"}], "]"}]}], ",", 
      RowBox[{"itHatT", "->", 
       RowBox[{"itHat", "[", "t", "]"}]}], ",", 
      RowBox[{"itHatFut", "->", 
       RowBox[{"itHat", "[", 
        RowBox[{"1", "+", "t"}], "]"}]}], ",", 
      RowBox[{"qkHatT", "->", 
       RowBox[{"qkHat", "[", "t", "]"}]}], ",", 
      RowBox[{"qkHatFut", "->", 
       RowBox[{"qkHat", "[", 
        RowBox[{"1", "+", "t"}], "]"}]}], ",", 
      RowBox[{"PtHatT", "->", 
       RowBox[{"PtHat", "[", "t", "]"}]}], ",", 
      RowBox[{"PtHatFut", "->", 
       RowBox[{"PtHat", "[", 
        RowBox[{"1", "+", "t"}], "]"}]}]}], "}"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{"logLinEqTime", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], "\n", 
 RowBox[{"final", "=", 
  RowBox[{
  "FullSimplify", "[", "logLinEqTime", 
   "]"}]}], "\[IndentingNewLine]", "final"}], "Input",
 CellChangeTimes->{
  3.947784242263548*^9, 3.9477844171534996`*^9, {3.9479529619790745`*^9, 
   3.947953020147213*^9}},
 CellLabel->
  "In[246]:=",ExpressionUUID->"fd3ecd2e-f399-4b4c-8d0c-8c734248c72a"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{{3.94698950101556*^9, 3.9469895031470222`*^9}, {
  3.946989691328703*^9, 
  3.946989705939865*^9}},ExpressionUUID->"90347a46-5dbd-b54f-8f1e-\
a6938e1fe31a"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{3.946989910123577*^9, 
  3.9477748578081017`*^9},ExpressionUUID->"d48f496e-7176-4c4a-84fa-\
2b0987060b46"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9469965989965515`*^9, 3.946996631543125*^9}, {
   3.946996679326996*^9, 3.946996680746643*^9}, {3.9469967383488903`*^9, 
   3.9469967415651703`*^9}, 3.947000760794897*^9, 
   3.947774826414343*^9},ExpressionUUID->"16a53433-1cc7-e74a-b3e2-\
121a43b05c36"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{{3.9469966392186947`*^9, 3.9469966392196903`*^9}, 
   3.9469967613630085`*^9},
 CellLabel->
  "In[110]:=",ExpressionUUID->"0d88e268-8e18-e44d-b2d8-cdf7e7401492"],

Cell[BoxData[
 RowBox[{"\n", "\n", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.946997714031584*^9, {3.946997818668518*^9, 3.946997840825136*^9}, {
   3.9469981410677166`*^9, 3.9469981620450706`*^9}, {3.9469984739662876`*^9, 
   3.9469984868744564`*^9}, {3.9470004652612762`*^9, 
   3.9470004746943607`*^9}, {3.947000923688463*^9, 3.9470009573882008`*^9}, {
   3.9470011983600025`*^9, 3.947001200512789*^9}, {3.9470014349401226`*^9, 
   3.947001442098938*^9}, 
   3.9477748041658745`*^9},ExpressionUUID->"040b9176-9fb1-6c42-b2d6-\
b57a6d9f6770"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9469965989965515`*^9, 
  3.946996631543125*^9}},ExpressionUUID->"415c207e-69ac-8e4e-b60e-\
cce02daeab93"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"goods", " ", "retailers"}], " ", "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Contoh", " ", "pemecahan", " ", "fungsi", " ", "profit", " ", 
     "retailer"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Parameter", " ", "contoh"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"{", 
      RowBox[{"betaR", ",", "kappaP", ",", "iota", ",", "piStar", ",", 
       RowBox[{"epsilonU", "[", "t", "]"}], ",", 
       RowBox[{"Pt", "[", "t", "]"}], ",", 
       RowBox[{"Pw", "[", "t", "]"}], ",", 
       RowBox[{"Y", "[", "t", "]"}], ",", 
       RowBox[{"Pi", "[", "t", "]"}], ",", 
       RowBox[{"Pj", "[", "t", "]"}], ",", 
       RowBox[{"Pj", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"1.", " ", "Bagian", " ", "pendapatan"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"revenue", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Pj", "[", "t", "]"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Pj", "[", "t", "]"}], "/", 
          RowBox[{"Pt", "[", "t", "]"}]}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{"epsilonU", "[", "t", "]"}]}], ")"}]}], ")"}], "*", 
      RowBox[{"Y", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"2.", " ", "Bagian", " ", "biaya", " ", "wholesale"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"costWholesale", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Pw", "[", "t", "]"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Pj", "[", "t", "]"}], "/", 
          RowBox[{"Pt", "[", "t", "]"}]}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{"epsilonU", "[", "t", "]"}]}], ")"}]}], ")"}], "*", 
      RowBox[{"Y", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "Bagian", " ", "quadratic", " ", "adjustment", " ", "cost"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"adjCost", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"kappaP", "/", "2"}], ")"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Pj", "[", "t", "]"}], "/", 
           RowBox[{"Pj", "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ")"}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"Pi", "[", 
            RowBox[{"t", "-", "1"}], "]"}], "^", "iota"}], " ", 
          RowBox[{"piStar", "^", 
           RowBox[{"(", 
            RowBox[{"1", "-", "iota"}], ")"}]}]}]}], ")"}], "^", "2"}], " ", "*", 
      RowBox[{"Pj", "[", "t", "]"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Pj", "[", "t", "]"}], "/", 
          RowBox[{"Pt", "[", "t", "]"}]}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{"epsilonU", "[", "t", "]"}]}], ")"}]}], ")"}], "*", 
      RowBox[{"Y", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "4.", " ", "Fungsi", " ", "profit", " ", "total", " ", "periode", " ", 
     "t"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"profitRetail", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"revenue", "[", "t", "]"}], "-", 
      RowBox[{"costWholesale", "[", "t", "]"}], "-", 
      RowBox[{"adjCost", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
    "5.", " ", "Contoh", " ", "fungsi", " ", "objektif", " ", "dua", " ", 
     "periode"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"obj", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"revenue", "[", "t", "]"}], "-", 
        RowBox[{"costWholesale", "[", "t", "]"}], "-", 
        RowBox[{"adjCost", "[", "t", "]"}]}], ")"}], "+", 
      RowBox[{
       RowBox[{"betaR", "^", 
        RowBox[{"(", 
         RowBox[{"t", "+", "1"}], ")"}]}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"revenue", "[", 
          RowBox[{"t", "+", "1"}], "]"}], "-", 
         RowBox[{"costWholesale", "[", 
          RowBox[{"t", "+", "1"}], "]"}], "-", 
         RowBox[{"adjCost", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"6.", " ", "First"}], "-", 
     RowBox[{"order", " ", "condition", " ", "wrt", " ", 
      RowBox[{"Pj", "[", "t", "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focPjt", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"obj", ",", 
        RowBox[{"Pj", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "\[IndentingNewLine]",
    "focPjt", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.947087114500244*^9, 3.9470871163989105`*^9}, {
  3.9470871676026287`*^9, 3.9470871922291965`*^9}, {3.947087223790371*^9, 
  3.9470873702921944`*^9}, {3.9470874023732185`*^9, 3.947087413339325*^9}, {
  3.9470913294324627`*^9, 3.9470913359381046`*^9}, {3.94709139935532*^9, 
  3.9470914606802616`*^9}, {3.9470915357667885`*^9, 3.947091559078287*^9}, {
  3.9470916095928574`*^9, 3.947091637500084*^9}, {3.9473460120193176`*^9, 
  3.947346041941885*^9}, {3.947346107088167*^9, 3.9473461398450375`*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"fa04d5b8-3a30-3845-b5fc-decb17933490"],

Cell[BoxData[
 RowBox[{"\n", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "Pj", ",", "Pt", ",", "Y", ",", "epsU", ",", "Pw", ",", "PjFut", ",", 
      "PtFut", ",", "YFut", ",", "epsUFut", ",", "PjLag", ",", "PiLag", ",", 
      "piVar", ",", "beta", ",", "LambdaE", ",", "kappaP", ",", "piStar", ",",
       "iota", ",", "betaR", ",", "t", ",", "PjHat", ",", "PtHat", ",", 
      "YHat", ",", "epsUHat", ",", "PwHat", ",", "PjFutHat", ",", "PtFutHat", 
      ",", "YFutHat", ",", "epsUFutHat", ",", "PjLagHat", ",", "PiLagHat", ",",
       "piVarHat"}], "]"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{
      "Pj_", ",", "Pt_", ",", "Y_", ",", "epsU_", ",", "Pw_", ",", "PjFut_", ",",
        "PtFut_", ",", "YFut_", ",", "epsUFut_", ",", "PjLag_", ",", "PiLag_",
        ",", "piVar_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Pj", "/", "Pt"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"-", "epsU"}], ")"}]}], "*", "Y"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"kappaP", "*", "Pj", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"piStar", "^", 
              RowBox[{"(", 
               RowBox[{"1", "-", "iota"}], ")"}]}]}], "*", 
            RowBox[{"PiLag", "^", "iota"}]}], "+", 
           RowBox[{"Pj", "/", "PjLag"}]}], ")"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Pj", "/", "Pt"}], ")"}], "^", 
          RowBox[{"(", 
           RowBox[{"-", "epsU"}], ")"}]}], "*", "Y"}], ")"}], "/", "PjLag"}], 
      "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"1", "/", "2"}], "*", "kappaP", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"piStar", "^", 
              RowBox[{"(", 
               RowBox[{"1", "-", "iota"}], ")"}]}]}], "*", 
            RowBox[{"PiLag", "^", "iota"}]}], "+", 
           RowBox[{"Pj", "/", "PjLag"}]}], ")"}], "^", "2"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Pj", "/", "Pt"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"-", "epsU"}], ")"}]}], "*", "Y"}], ")"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"epsU", "*", "Pj", "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Pj", "/", "Pt"}], ")"}], "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "-", "epsU"}], ")"}]}], "*", "Y"}], ")"}], "/",
        "Pt"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"kappaP", "*", "epsU", "*", "Pj", "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"piStar", "^", 
               RowBox[{"(", 
                RowBox[{"1", "-", "iota"}], ")"}]}]}], "*", 
             RowBox[{"PiLag", "^", "iota"}]}], "+", 
            RowBox[{"Pj", "/", "PjLag"}]}], ")"}], "^", "2"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Pj", "/", "Pt"}], ")"}], "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "-", "epsU"}], ")"}]}], "*", "Y"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", "Pt"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"epsU", "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Pj", "/", "Pt"}], ")"}], "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "-", "epsU"}], ")"}]}], "*", "Pw", "*", "Y"}],
         ")"}], "/", "Pt"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"betaR", "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "t"}], ")"}]}], "*", "kappaP", "*", 
         RowBox[{"PjFut", "^", "2"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"piStar", "^", 
              RowBox[{"(", 
               RowBox[{"1", "-", "iota"}], ")"}]}]}], "*", 
            RowBox[{"piVar", "^", "iota"}]}], "+", 
           RowBox[{"PjFut", "/", "Pj"}]}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"PjFut", "/", "PtFut"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"-", "epsUFut"}], ")"}]}], "*", "YFut"}], ")"}]}], ")"}],
        "/", 
       RowBox[{"Pj", "^", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{
      "Pj", ",", "Pt", ",", "Y", ",", "epsU", ",", "Pw", ",", "PjFut", ",", 
       "PtFut", ",", "YFut", ",", "epsUFut", ",", "PjLag", ",", "PiLag", ",", 
       "piVar"}], "}"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", "var"}], "]"}], "/.", " ", 
        RowBox[{"Thread", "[", 
         RowBox[{"vars", "->", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"1", ",", 
            RowBox[{"Length", "[", "vars", "]"}]}], "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"var", ",", "vars"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", "PjHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", "PtHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", "YHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "*", "epsUHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "*", "PwHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "*", "PjFutHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "7", "]"}], "]"}], "*", "PtFutHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "8", "]"}], "]"}], "*", "YFutHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "9", "]"}], "]"}], "*", "epsUFutHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "10", "]"}], "]"}], "*", "PjLagHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "11", "]"}], "]"}], "*", "PiLagHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "12", "]"}], "]"}], "*", "piVarHat"}]}], "==", "0"}]}], 
    ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"logLinEqNoBar", "=", 
     RowBox[{"Simplify", "[", "logLinEq", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"timeSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"PjHat", "->", 
          RowBox[{"PjHat", "[", "#", "]"}]}], "&"}], "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"PtHat", "->", 
          RowBox[{"PtHat", "[", "#", "]"}]}], "&"}], "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"YHat", "->", 
          RowBox[{"YHat", "[", "#", "]"}]}], "&"}], "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"epsUHat", "->", 
          RowBox[{"epsUHat", "[", "#", "]"}]}], "&"}], "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"PwHat", "->", 
          RowBox[{"PwHat", "[", "#", "]"}]}], "&"}], "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"PjFutHat", "->", 
          RowBox[{"PjHat", "[", "#", "]"}]}], "&"}], "[", 
        RowBox[{"t", "+", "1"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"PtFutHat", "->", 
          RowBox[{"PtHat", "[", "#", "]"}]}], "&"}], "[", 
        RowBox[{"t", "+", "1"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"YFutHat", "->", 
          RowBox[{"YHat", "[", "#", "]"}]}], "&"}], "[", 
        RowBox[{"t", "+", "1"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"epsUFutHat", "->", 
          RowBox[{"epsUHat", "[", "#", "]"}]}], "&"}], "[", 
        RowBox[{"t", "+", "1"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"PjLagHat", "->", 
          RowBox[{"PjHat", "[", "#", "]"}]}], "&"}], "[", 
        RowBox[{"t", "-", "1"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"PiLagHat", "->", 
          RowBox[{"PiHat", "[", "#", "]"}]}], "&"}], "[", 
        RowBox[{"t", "-", "1"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"piVarHat", "->", 
          RowBox[{"piVarHat", "[", "#", "]"}]}], "&"}], "[", "t", "]"}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"logLinEqTime", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], 
   "\n"}]}]], "Input",
 CellChangeTimes->{
  3.9424252827947807`*^9, 3.9424879659349766`*^9, {3.9473471907510777`*^9, 
   3.947347191898058*^9}, 3.947784779983919*^9, 3.947784987716772*^9},
 CellLabel->"In[99]:=",ExpressionUUID->"52999333-fe05-e84a-acf1-fc22be5bf2ea"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.942508401042242*^9, 
  3.942508401044237*^9}},ExpressionUUID->"e44d3794-52ef-d540-95ab-\
731b5a7762cd"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"retail", " ", "banking"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{
  3.942425871529419*^9, 3.942426101584881*^9, 3.9424261402649555`*^9, 
   3.9473466087112083`*^9, {3.947346779662201*^9, 3.947346796649639*^9}, 
   3.947346964656801*^9, {3.9473470205344906`*^9, 3.9473470595561905`*^9}, 
   3.9473471027397194`*^9, {3.9477846114062653`*^9, 3.947784628251028*^9}, {
   3.947954466290764*^9, 3.947954468666727*^9}, {3.9479545001509304`*^9, 
   3.9479545383854084`*^9}},ExpressionUUID->"28629b7d-e028-5846-af8b-\
9f2b85a1dc47"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.948211170519268*^9},ExpressionUUID->"4b97082b-f52c-d940-8b60-\
cf5f1725bfda"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "itLag", ",", "itL", ",", "itT", ",", "itFut", ",", "qkT", ",", "qkFut", ",",
      "PtT", ",", "PtFut", ",", "beta", ",", "LambdaE", ",", "kappa", ",", 
     "eps", ",", "itBar", ",", "qkBar", ",", "PtBar", ",", "itHatLag", ",", 
     "itHatL", ",", "itHatT", ",", "itHatFut", ",", "qkHatT", ",", "qkHatFut",
      ",", "PtHatT", ",", "PtHatFut", ",", "t", ",", "F", ",", "vars", ",", 
     "partials", ",", "logLinEq", ",", "logLinEqNoBar", ",", "timeSubs", ",", 
     "logLinEqTime", ",", "final"}], "]"}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "1."}], " ", "Define", " ", "the", " ", "original", " ", 
    "nonlinear", " ", "equation", " ", "with", " ", "substituted", " ", 
    "lambda"}], "***)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F", "[", 
   RowBox[{
   "itLag_", ",", "itL_", ",", "itT_", ",", "itFut_", ",", "qkT_", ",", 
    "qkFut_", ",", "PtT_", ",", "PtFut_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2", " ", "beta", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "epsilonP"}], "+", 
         RowBox[{
          RowBox[{"hp", "[", "t", "]"}], "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"hp", "[", "t", "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"qh", "-", 
           RowBox[{"wt", "[", "t", "]"}]}], ")"}]}], ")"}]}], ")"}], " ", 
     RowBox[{"itLag", "^", "2"}], " ", "PtFut"}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "kappa"}], ")"}], "*", 
       RowBox[{"itLag", "^", "2"}]}], ")"}], "-", 
     RowBox[{
     "4", "*", "kappa", "*", "itLag", "*", "itFut", "*", "eps", "*", 
      "qkFut"}], "+", 
     RowBox[{"3", "*", "kappa", "*", 
      RowBox[{"itFut", "^", "2"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"eps", "*", "qkFut"}], ")"}], "^", "2"}]}]}], ")"}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "epsilonP"}], "+", 
           RowBox[{
            RowBox[{"hp", "[", 
             RowBox[{"t", "+", "1"}], "]"}], "^", 
            RowBox[{"(", 
             RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"hp", "[", 
            RowBox[{"t", "+", "1"}], "]"}], "*", 
           RowBox[{"(", 
            RowBox[{"qh", "-", 
             RowBox[{"wt", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}], ")"}]}], ")"}], " ", 
       RowBox[{"itL", "^", "2"}], " ", "PtT"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "kappa"}], ")"}], "*", 
        RowBox[{"itL", "^", "2"}]}], ")"}], "-", 
      RowBox[{
      "4", "*", "kappa", "*", "itL", "*", "itT", "*", "eps", "*", "qkT"}], "+", 
      RowBox[{"3", "*", "kappa", "*", 
       RowBox[{"itT", "^", "2"}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"eps", "*", "qkT"}], ")"}], "^", "2"}]}]}], ")"}]}], ";"}], 
  "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "2."}], " ", "List", " ", "the", " ", "variables", " ", 
    "for", " ", "differentiation"}], "***)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vars", "=", 
    RowBox[{"{", 
     RowBox[{
     "itLag", ",", "itL", ",", "itT", ",", "itFut", ",", "qkT", ",", "qkFut", 
      ",", "PtT", ",", "PtFut"}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "3."}], " ", "Compute", " ", "partial", " ", "derivatives", 
    " ", "at", " ", "the", " ", "steady", " ", "state"}], "***)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"partials", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"F", "@@", "vars"}], ",", 
         RowBox[{"vars", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"itLag", "->", "itBar"}], ",", 
         RowBox[{"itL", "->", "itBar"}], ",", 
         RowBox[{"itT", "->", "itBar"}], ",", 
         RowBox[{"itFut", "->", "itBar"}], ",", 
         RowBox[{"qkT", "->", "qkBar"}], ",", 
         RowBox[{"qkFut", "->", "qkBar"}], ",", 
         RowBox[{"PtT", "->", "PtBar"}], ",", 
         RowBox[{"PtFut", "->", "PtBar"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"**", "4."}], " ", "Define", " ", "log"}], "-", 
    RowBox[{"deviation", " ", "variables", " ", 
     RowBox[{"(", 
      RowBox[{"the", " ", "\\\"", "hat", "\\\"", " ", "variables"}], 
      ")"}]}]}], "***)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Already", " ", "cleared", " ", "above"}], "*)"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "5."}], " ", "Multiply", " ", "each", " ", "derivative", " ",
     "by", " ", 
    RowBox[{"(", 
     RowBox[{"steady", " ", "state"}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{"hat", " ", "variable"}], ")"}]}], "***)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEq", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", "itBar", "*", "itHatLag"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", "itBar", "*", "itHatL"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "*", "itBar", "*", "itHatT"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "*", "itBar", "*", "itHatFut"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "*", "qkBar", "*", "qkHatT"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "6", "]"}], "]"}], "*", "qkBar", "*", "qkHatFut"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "7", "]"}], "]"}], "*", "PtBar", "*", "PtHatT"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "8", "]"}], "]"}], "*", "PtBar", "*", "PtHatFut"}]}], "==",
      "0"}]}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"**", "6."}], " ", "Optionally", " ", "simplify"}], "&"}], " ", 
    "set", " ", "steady", " ", "states", " ", "to", " ", "1", " ", 
    RowBox[{"(", 
     RowBox[{"if", " ", "appropriate"}], ")"}]}], "***)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEqNoBar", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"logLinEq", "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"itBar", "->", "1"}], ",", 
        RowBox[{"qkBar", "->", "1"}], ",", 
        RowBox[{"PtBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"**", "7."}], " ", "Re"}], "-", 
    RowBox[{"introduce", " ", "time", " ", "indexing", " ", "for", " ", 
     RowBox[{"leads", "/", "lags"}], " ", "if", " ", "needed"}]}], 
   "***)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"timeSubs", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"itHatLag", "->", 
       RowBox[{"itHat", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], ",", 
      RowBox[{"(*", 
       RowBox[{"lagged", " ", "variable"}], "*)"}], 
      RowBox[{"itHatL", "->", 
       RowBox[{"itHat", "[", "t", "]"}]}], ",", 
      RowBox[{"(*", 
       RowBox[{"current", " ", "variables"}], "*)"}], 
      RowBox[{"itHatT", "->", 
       RowBox[{"itHat", "[", "t", "]"}]}], ",", 
      RowBox[{"itHatFut", "->", 
       RowBox[{"itHat", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], ",", 
      RowBox[{"(*", 
       RowBox[{"future", " ", "variable"}], "*)"}], 
      RowBox[{"qkHatT", "->", 
       RowBox[{"qkHat", "[", "t", "]"}]}], ",", 
      RowBox[{"qkHatFut", "->", 
       RowBox[{"qkHat", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], ",", 
      RowBox[{"PtHatT", "->", 
       RowBox[{"PtHat", "[", "t", "]"}]}], ",", 
      RowBox[{"PtHatFut", "->", 
       RowBox[{"PtHat", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEqTime", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "8."}], " ", "FullSimplify", " ", "the", " ", "final", " ", 
    "linear", " ", "equation"}], "***)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"final", "=", 
    RowBox[{"FullSimplify", "[", "logLinEqTime", "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "Show"}], " ", "the", " ", "result"}], 
   "***)"}]}], "\[IndentingNewLine]", "final", "\n"}], "Input",
 CellChangeTimes->{{3.948211170519268*^9, 3.9482111876671753`*^9}, {
  3.9482112794644413`*^9, 3.9482112948257694`*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"5dd43024-de83-cb41-a7b3-b837d316dc18"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"beta", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "epsilonP"}], "+", 
       SuperscriptBox[
        RowBox[{"hp", "[", "t", "]"}], 
        RowBox[{"1", "+", "phi"}]]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "eps", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{"3", " ", "eps"}]}], ")"}], " ", "kappa", " ", 
        RowBox[{"itHat", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          RowBox[{"3", " ", "eps"}]}], ")"}], " ", "eps", " ", "kappa", " ", 
        RowBox[{"itHat", "[", 
         RowBox[{"1", "+", "t"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "kappa", "-", 
          RowBox[{"4", " ", "eps", " ", "kappa"}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["eps", "2"], " ", "kappa"}]}], ")"}], " ", 
        RowBox[{"PtHat", "[", 
         RowBox[{"1", "+", "t"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          RowBox[{"3", " ", "eps"}]}], ")"}], " ", "eps", " ", "kappa", " ", 
        RowBox[{"qkHat", "[", 
         RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "eps"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"3", " ", "eps"}]}], ")"}], " ", "kappa"}]}], ")"}], " ", 
     RowBox[{"hp", "[", "t", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"qh", "-", 
       RowBox[{"wt", "[", "t", "]"}]}], ")"}]}], ")"}]}], "\[Equal]", 
  "0"}]], "Output",
 CellChangeTimes->{3.9482116014800625`*^9},
 CellLabel->"Out[85]=",ExpressionUUID->"ae10c4aa-bf57-d44a-a92a-66cab0b5888f"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.94820885691658*^9},
 CellLabel->"",ExpressionUUID->"dfc70790-c88c-054d-8485-03f8062fbf9d"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.9482109068747272`*^9, 3.9482109437608814`*^9, 
  3.9482110261963253`*^9, 
  3.9482111329284325`*^9},ExpressionUUID->"87f03399-2a49-8741-8bdb-\
0504f8780838"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "beta", ",", "epsilonP", ",", "hp", ",", "phi", ",", "eps", ",", "kappa", 
     ",", "itHat", ",", "PtHat", ",", "qkHat", ",", "qh", ",", "wt", ",", "t",
      ",", "Rb", ",", "ebs"}], "]"}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"1.", " ", "Define", " ", "rbs", " ", "from", " ", "equation", " ", 
    RowBox[{"(", "10", ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rbs", "[", "t_", "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"ebs", "/", 
       RowBox[{"(", 
        RowBox[{"ebs", "-", "1"}], ")"}]}], ")"}], "*", 
     RowBox[{"Rb", "[", "t", "]"}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"2.", " ", "Plug", " ", 
    RowBox[{"rbs", "[", "t", "]"}], " ", "into", " ", "the", " ", "provided", 
    " ", "equation"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pluggedEquation", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"beta", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "epsilonP"}], "+", 
          RowBox[{
           RowBox[{"hp", "[", "t", "]"}], "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "eps", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", 
             RowBox[{"3", " ", "eps"}]}], ")"}], " ", "kappa", " ", 
           RowBox[{"itHat", "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"2", "-", 
             RowBox[{"3", " ", "eps"}]}], ")"}], " ", "eps", " ", "kappa", " ", 
           RowBox[{"itHat", "[", 
            RowBox[{"t", "+", "1"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "kappa", "-", 
             RowBox[{"4", " ", "eps", " ", "kappa"}], "+", 
             RowBox[{"3", " ", 
              RowBox[{"eps", "^", "2"}], " ", "kappa"}]}], ")"}], " ", 
           RowBox[{"PtHat", "[", 
            RowBox[{"t", "+", "1"}], "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"2", "-", 
             RowBox[{"3", " ", "eps"}]}], ")"}], " ", "eps", " ", "kappa", " ", 
           RowBox[{"qkHat", "[", 
            RowBox[{"t", "+", "1"}], "]"}]}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "eps"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"3", " ", "eps"}]}], ")"}], " ", "kappa"}]}], ")"}], " ", 
        RowBox[{"hp", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"qh", "-", 
          RowBox[{"wt", "[", "t", "]"}]}], ")"}]}], ")"}]}], "==", "0"}]}], 
   ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"3.", " ", "Substitute", " ", 
    RowBox[{"rbs", "[", "t", "]"}], " ", "for", " ", 
    RowBox[{"itHat", "[", "t", "]"}], " ", "and", " ", "simplify"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"simplifiedEquation", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"pluggedEquation", "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"itHat", "[", "t", "]"}], "->", 
        RowBox[{"rbs", "[", "t", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"4.", " ", "Display", " ", "the", " ", "final", " ", "result"}], 
   "*)"}]}], "\n", 
 RowBox[{"final", "=", 
  RowBox[{
  "FullSimplify", "[", "simplifiedEquation", "]"}]}], "\n", "final"}], "Input",
 CellChangeTimes->{
  3.9482152949421577`*^9, {3.94821541538015*^9, 3.948215496568266*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"f8ff8a6e-75b1-f84b-9f88-c43ea5866f36"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"beta", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "epsilonP"}], "+", 
       SuperscriptBox[
        RowBox[{"hp", "[", "t", "]"}], 
        RowBox[{"1", "+", "phi"}]]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "eps", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{"3", " ", "eps"}]}], ")"}], " ", "kappa", " ", 
        RowBox[{"itHat", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          RowBox[{"3", " ", "eps"}]}], ")"}], " ", "eps", " ", "kappa", " ", 
        RowBox[{"itHat", "[", 
         RowBox[{"1", "+", "t"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "kappa", "-", 
          RowBox[{"4", " ", "eps", " ", "kappa"}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["eps", "2"], " ", "kappa"}]}], ")"}], " ", 
        RowBox[{"PtHat", "[", 
         RowBox[{"1", "+", "t"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          RowBox[{"3", " ", "eps"}]}], ")"}], " ", "eps", " ", "kappa", " ", 
        RowBox[{"qkHat", "[", 
         RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "eps"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"3", " ", "eps"}]}], ")"}], " ", "kappa"}]}], ")"}], " ", 
     RowBox[{"hp", "[", "t", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"qh", "-", 
       RowBox[{"wt", "[", "t", "]"}]}], ")"}]}], ")"}]}], "\[Equal]", 
  "0"}]], "Output",
 CellChangeTimes->{3.948215423427166*^9, 3.948215501767233*^9},
 CellLabel->"Out[95]=",ExpressionUUID->"eb186086-31e5-d846-94d9-89ab52a2b104"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"beta", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "epsilonP"}], "+", 
       SuperscriptBox[
        RowBox[{"hp", "[", "t", "]"}], 
        RowBox[{"1", "+", "phi"}]]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "eps", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{"3", " ", "eps"}]}], ")"}], " ", "kappa", " ", 
        RowBox[{"itHat", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          RowBox[{"3", " ", "eps"}]}], ")"}], " ", "eps", " ", "kappa", " ", 
        RowBox[{"itHat", "[", 
         RowBox[{"1", "+", "t"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "kappa", "-", 
          RowBox[{"4", " ", "eps", " ", "kappa"}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["eps", "2"], " ", "kappa"}]}], ")"}], " ", 
        RowBox[{"PtHat", "[", 
         RowBox[{"1", "+", "t"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          RowBox[{"3", " ", "eps"}]}], ")"}], " ", "eps", " ", "kappa", " ", 
        RowBox[{"qkHat", "[", 
         RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "eps"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"3", " ", "eps"}]}], ")"}], " ", "kappa"}]}], ")"}], " ", 
     RowBox[{"hp", "[", "t", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"qh", "-", 
       RowBox[{"wt", "[", "t", "]"}]}], ")"}]}], ")"}]}], "\[Equal]", 
  "0"}]], "Output",
 CellChangeTimes->{3.948215423427166*^9, 3.9482155017752934`*^9},
 CellLabel->"Out[96]=",ExpressionUUID->"a55a4d9e-d06c-c344-8ad4-6bab88a233e3"]
}, Open  ]],

Cell[BoxData[""], "Input",ExpressionUUID->"22c9a5ff-e8ca-da4a-bea9-0829d17500f1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "rd", ",", "Rt", ",", "dt", ",", "lambdaP", ",", "kappaD", ",", "beta", ",",
      "epsd", ",", "t", ",", "F", ",", "vars", ",", "partials", ",", 
     "logLinEq", ",", "logLinEqNoBar", ",", "timeSubs", ",", "logLinEqTime", ",",
      "final"}], "]"}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "1.", " ", "Define", " ", "the", " ", "original", " ", "nonlinear", " ", 
     "equation", " ", "F"}], "==", "0"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{"rd_", ",", "Rt_", ",", "dt_", ",", "lambdaP_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "epsd", "-", 
     RowBox[{"(", 
      RowBox[{"epsd", "*", 
       RowBox[{"Rt", "/", "rd"}]}], ")"}], "-", 
     RowBox[{"kappaD", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"rd", "/", "rdLag"}], ")"}], "-", "1"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"rd", "/", "Rt"}], ")"}]}], "+", 
     RowBox[{"beta", "*", 
      RowBox[{"Expect", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"lambdaPNext", "/", "lambdaP"}], ")"}], "*", "kappaD", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"rdNext", "/", "rd"}], ")"}], "-", "1"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"rdNext", "/", "Rt"}], ")"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"rdNext", "/", "rd"}], ")"}], "^", "2"}], "*", 
         RowBox[{"(", 
          RowBox[{"dtNext", "/", "dt"}], ")"}]}], ",", "t"}], "]"}]}]}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "2.", " ", "Substitute", " ", "lambda", " ", "expressions", " ", "before", 
    " ", "differentiation"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"lambdaP", "[", "t_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "epsilonP"}], "+", 
      RowBox[{
       RowBox[{"hp", "[", "t", "]"}], "^", 
       RowBox[{"(", 
        RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"hp", "[", "t", "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"qh", "-", 
        RowBox[{"wt", "[", "t", "]"}]}], ")"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"lambdaP", "[", 
     RowBox[{"t", "+", "1"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "epsilonP"}], "+", 
       RowBox[{
        RowBox[{"hp", "[", 
         RowBox[{"t", "+", "1"}], "]"}], "^", 
        RowBox[{"(", 
         RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"hp", "[", 
        RowBox[{"t", "+", "1"}], "]"}], "*", 
       RowBox[{"(", 
        RowBox[{"qh", "-", 
         RowBox[{"wt", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}], ")"}]}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fsubstituted", "=", 
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{"rd", ",", "Rt", ",", "dt", ",", 
       RowBox[{"lambdaP", "[", "t", "]"}]}], "]"}], "/.", " ", 
     RowBox[{"{", 
      RowBox[{"lambdaPNext", "->", 
       RowBox[{"lambdaP", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "3.", " ", "List", " ", "the", " ", "variables", " ", "for", " ", 
    "differentiation"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"vars", "=", 
    RowBox[{"{", 
     RowBox[{"rd", ",", "Rt", ",", "dt"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "4.", " ", "Compute", " ", "partial", " ", "derivatives", " ", "at", " ", 
    "the", " ", "steady", " ", "state"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"partials", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"Fsubstituted", ",", 
         RowBox[{"vars", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rd", "->", "rdBar"}], ",", 
         RowBox[{"Rt", "->", "RtBar"}], ",", 
         RowBox[{"dt", "->", "dtBar"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"5.", " ", "Define", " ", "log"}], "-", 
    RowBox[{"deviation", " ", "variables", " ", 
     RowBox[{"(", 
      RowBox[{"the", " ", "\"\<hat\>\"", " ", "variables"}], ")"}]}]}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"rdHat", ",", "RtHat", ",", "dtHat"}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "6.", " ", "Multiply", " ", "each", " ", "derivative", " ", "by", " ", 
    "steady", " ", "state", " ", "and", " ", "corresponding", " ", "hat"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEq", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", "rdBar", "*", "rdHat"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", "RtBar", "*", "RtHat"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "*", "dtBar", "*", "dtHat"}]}], "==", 
     "0"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "7.", " ", "Simplify", " ", "and", " ", "normalize", " ", "by", " ", 
    "setting", " ", "steady", " ", "states", " ", "to", " ", "1"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEqNoBar", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"logLinEq", "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rdBar", "->", "1"}], ",", 
        RowBox[{"RtBar", "->", "1"}], ",", 
        RowBox[{"dtBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "8.", " ", "Reintroduce", " ", "the", " ", "original", " ", "time", " ", 
    "indices"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"timeSubs", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"rdHat", "->", 
       RowBox[{"rdHat", "[", "t", "]"}]}], ",", 
      RowBox[{"rdHatNext", "->", 
       RowBox[{"rdHat", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], ",", 
      RowBox[{"RtHat", "->", 
       RowBox[{"RtHat", "[", "t", "]"}]}], ",", 
      RowBox[{"dtHat", "->", 
       RowBox[{"dtHat", "[", "t", "]"}]}], ",", 
      RowBox[{"dtHatNext", "->", 
       RowBox[{"dtHat", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}]}], "}"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEqTime", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "9.", " ", "FullSimplify", " ", "the", " ", "final", " ", "linear", " ", 
    "equation"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"final", "=", 
    RowBox[{"FullSimplify", "[", "logLinEqTime", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"10.", " ", "Show", " ", "the", " ", "result"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"final", "\[IndentingNewLine]"}], "\n"}], "Input",
 CellChangeTimes->{{3.948216925292404*^9, 3.948216925292404*^9}, {
  3.9482169557775154`*^9, 
  3.9482169629591255`*^9}},ExpressionUUID->"b183add0-1c78-2a45-be65-\
c39d82fd76d6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "rd", ",", "Rt", ",", "dt", ",", "lambdaP", ",", "kappaD", ",", "beta", ",",
      "epsd", ",", "F", ",", "vars", ",", "partials", ",", "logLinEq", ",", 
     "logLinEqNoBar", ",", "timeSubs", ",", "logLinEqTime", ",", "final"}], 
    "]"}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "1.", " ", "Define", " ", "the", " ", "original", " ", "nonlinear", " ", 
     "equation", " ", "F"}], "==", "0"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{"rd_", ",", "Rt_", ",", "dt_", ",", "lambdaP_", ",", "wt_"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "epsd", "-", 
     RowBox[{"(", 
      RowBox[{"epsd", "*", 
       RowBox[{"Rt", "/", "rd"}]}], ")"}], "-", 
     RowBox[{"kappaD", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"rd", "/", "rdLag"}], ")"}], "-", "1"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"rd", "/", "Rt"}], ")"}]}], "+", 
     RowBox[{"beta", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"lambdaPNext", "/", "lambdaP"}], ")"}], "*", "kappaD", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"rdNext", "/", "rd"}], ")"}], "-", "1"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"rdNext", "/", "Rt"}], ")"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"rdNext", "/", "rd"}], ")"}], "^", "2"}], "*", 
        RowBox[{"(", 
         RowBox[{"dtNext", "/", "dt"}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "2.", " ", "Substitute", " ", "lambda", " ", "expressions", " ", "before", 
    " ", "differentiation"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lambdaP", ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "epsilonP"}], "+", 
      RowBox[{"hp", "^", 
       RowBox[{"(", 
        RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"hp", "*", 
      RowBox[{"(", 
       RowBox[{"qh", "-", "wt"}], ")"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"lambdaPNext", ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "epsilonP"}], "+", 
       RowBox[{"hpNext", "^", 
        RowBox[{"(", 
         RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"hpNext", "*", 
       RowBox[{"(", 
        RowBox[{"qh", "-", "wtNext"}], ")"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Fsubstituted", "=", 
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{"rd", ",", "Rt", ",", "dt", ",", "lambdaP", ",", "wt"}], "]"}], 
     "/.", " ", 
     RowBox[{"{", 
      RowBox[{"lambdaPNext", "->", "lambdaPNext"}], "}"}]}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "3.", " ", "List", " ", "the", " ", "variables", " ", "for", " ", 
    "differentiation"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vars", "=", 
    RowBox[{"{", 
     RowBox[{"rd", ",", "Rt", ",", "dt", ",", "wt"}], "}"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "4.", " ", "Compute", " ", "partial", " ", "derivatives", " ", "at", " ", 
    "the", " ", "steady", " ", "state"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"partials", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"Fsubstituted", ",", 
         RowBox[{"vars", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rd", "->", "rdBar"}], ",", 
         RowBox[{"Rt", "->", "RtBar"}], ",", 
         RowBox[{"dt", "->", "dtBar"}], ",", 
         RowBox[{"wt", "->", "wtBar"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], "\n",
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"5.", " ", "Define", " ", "log"}], "-", 
    RowBox[{"deviation", " ", "variables"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"rd", ",", "Rt", ",", "dt", ",", "wt"}], "]"}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "6.", " ", "Multiply", " ", "each", " ", "derivative", " ", "by", " ", 
    "steady", " ", "state", " ", "and", " ", "corresponding", " ", 
    "deviation"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEq", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", "rdBar", "*", "rd"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", "RtBar", "*", "Rt"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "*", "dtBar", "*", "dt"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "*", "wtBar", "*", "wt"}]}], "==", 
     "0"}]}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "7.", " ", "Simplify", " ", "and", " ", "normalize", " ", "by", " ", 
    "setting", " ", "steady", " ", "states", " ", "to", " ", "1"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEqNoBar", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"logLinEq", "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rdBar", "->", "1"}], ",", 
        RowBox[{"RtBar", "->", "1"}], ",", 
        RowBox[{"dtBar", "->", "1"}], ",", 
        RowBox[{"wtBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "8.", " ", "Reintroduce", " ", "the", " ", "original", " ", "time", " ", 
    "indices"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"timeSubs", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"rd", "->", 
       RowBox[{"rd", "[", "t", "]"}]}], ",", 
      RowBox[{"rdNext", "->", 
       RowBox[{"rd", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], ",", 
      RowBox[{"rdLag", "->", 
       RowBox[{"rd", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], ",", 
      RowBox[{"Rt", "->", 
       RowBox[{"Rt", "[", "t", "]"}]}], ",", 
      RowBox[{"dt", "->", 
       RowBox[{"dt", "[", "t", "]"}]}], ",", 
      RowBox[{"dtNext", "->", 
       RowBox[{"dt", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], ",", 
      RowBox[{"wt", "->", 
       RowBox[{"wt", "[", "t", "]"}]}], ",", 
      RowBox[{"wtNext", "->", 
       RowBox[{"wt", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], ",", 
      RowBox[{"hp", "->", 
       RowBox[{"hp", "[", "t", "]"}]}], ",", 
      RowBox[{"hpNext", "->", 
       RowBox[{"hp", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEqTime", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "9.", " ", "FullSimplify", " ", "the", " ", "final", " ", "linear", " ", 
    "equation"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"final", "=", 
    RowBox[{"FullSimplify", "[", "logLinEqTime", "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"10.", " ", "Show", " ", "the", " ", "result"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"final", "\[IndentingNewLine]", "\n", "\n", "\n", 
  "\n"}], "\n"}], "Input",
 CellChangeTimes->{
  3.9482172029295044`*^9, {3.9482172767034664`*^9, 3.948217329190628*^9}, 
   3.948217605001524*^9, {3.948218357118347*^9, 3.948218401248472*^9}, {
   3.9482184816585445`*^9, 3.948218554252701*^9}, {3.948218584625622*^9, 
   3.9482186765515785`*^9}, {3.948218792408987*^9, 3.9482188281772537`*^9}, 
   3.9482192330981655`*^9, {3.94821929869018*^9, 3.9482193203191605`*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"6b2be15b-ddfc-2e4b-8670-7e87cade0d44"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"beta", " ", "kappaD", " ", 
     RowBox[{"dt", "[", 
      RowBox[{"1", "+", "t"}], "]"}], " ", 
     RowBox[{"hp", "[", "t", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"epsilonP", "-", 
       SuperscriptBox[
        RowBox[{"hp", "[", 
         RowBox[{"1", "+", "t"}], "]"}], 
        RowBox[{"1", "+", "phi"}]]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"rd", "[", 
       RowBox[{"1", "+", "t"}], "]"}], "3"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "qh"}], ")"}], " ", 
        RowBox[{"dt", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"rd", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "qh"}], ")"}], " ", 
        RowBox[{"rd", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{"3", " ", 
           RowBox[{"rd", "[", 
            RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"rd", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "qh"}], ")"}], " ", 
           RowBox[{"Rt", "[", "t", "]"}]}], "+", 
          RowBox[{"wt", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "epsilonP"}], "+", 
       SuperscriptBox[
        RowBox[{"hp", "[", "t", "]"}], 
        RowBox[{"1", "+", "phi"}]]}], ")"}], " ", 
     RowBox[{"hp", "[", 
      RowBox[{"1", "+", "t"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"qh", "-", 
       RowBox[{"wt", "[", 
        RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}]]}], "\[Equal]", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "kappaD"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"epsd", "+", "kappaD"}], ")"}], " ", 
        RowBox[{"rd", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}]}]}], ")"}], " ", 
     RowBox[{"rd", "[", "t", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"kappaD", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"epsd", "+", "kappaD"}], ")"}], " ", 
        RowBox[{"rd", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}]}]}], ")"}], " ", 
     RowBox[{"Rt", "[", "t", "]"}]}]}], 
   RowBox[{"rd", "[", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "t"}], "]"}]]}]], "Output",
 CellChangeTimes->{3.948217240274227*^9, 3.948217340255846*^9, 
  3.9482184131957417`*^9, 3.948218608742796*^9, 3.9482188384815693`*^9, 
  3.948219330969372*^9},
 CellLabel->
  "Out[194]=",ExpressionUUID->"38ce5f7e-8b39-5a4a-b0aa-2258574271c2"]
}, Open  ]]
},
WindowSize->{1380.75, 765.75},
WindowMargins->{{5.25, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"cbc78bb6-c411-c243-8fb9-e034a4f1496b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 5081, 70, 47, "Input",ExpressionUUID->"f9fb2cec-0218-1946-a7a4-614cfc63c79f"],
Cell[5638, 92, 81, 0, 28, "Input",ExpressionUUID->"93063096-b854-5642-83fe-da57c1f294a1"],
Cell[5722, 94, 81, 0, 28, "Input",ExpressionUUID->"0708fca9-59ce-8847-af89-18fc69779938"],
Cell[CellGroupData[{
Cell[5828, 98, 6337, 175, 446, "Input",ExpressionUUID->"9ace75de-4978-4347-8abf-940e21a736de"],
Cell[CellGroupData[{
Cell[12190, 277, 506, 10, 22, "Print",ExpressionUUID->"3180c1ab-5e0d-ca40-9394-5e86f56408d7"],
Cell[12699, 289, 428, 9, 22, "Print",ExpressionUUID->"cba57453-8210-be49-9e99-e7c7a95b445f"]
}, Open  ]]
}, Open  ]],
Cell[13154, 302, 1335, 34, 180, "Input",ExpressionUUID->"6cbdf14f-fcad-b24a-9b64-6f911cd48fed"],
Cell[CellGroupData[{
Cell[14514, 340, 301, 6, 66, "Input",ExpressionUUID->"4978f1f1-0572-b84b-b184-a61a2eb98030"],
Cell[CellGroupData[{
Cell[14840, 350, 402, 8, 22, "Print",ExpressionUUID->"3b40c5c1-cbf0-244a-912a-65c58f9ab2e4"],
Cell[15245, 360, 356, 8, 22, "Print",ExpressionUUID->"3dd3e17b-7b29-3d40-970d-7f04b4476b62"]
}, Open  ]]
}, Open  ]],
Cell[15628, 372, 4603, 132, 370, "Input",ExpressionUUID->"aec07186-9953-eb4b-a898-e758c5d4aabf"],
Cell[20234, 506, 11864, 333, 738, "Input",ExpressionUUID->"dc40e394-a162-e344-af1c-469b5ff19c55"],
Cell[32101, 841, 335, 5, 28, "Input",ExpressionUUID->"5a156fc5-2eb4-7e48-b51d-4ec8fa2678b1"],
Cell[32439, 848, 81, 0, 28, "Input",ExpressionUUID->"67031162-bd98-8f49-8550-4b19913fb9a6"],
Cell[32523, 850, 19496, 551, 922, "Input",ExpressionUUID->"1d324b32-3e60-a146-b5b4-6a3a4bd7b1e8"],
Cell[52022, 1403, 139, 2, 28, "Input",ExpressionUUID->"9e0d05d0-5fdf-944e-97f6-884be9bc4fd5"],
Cell[52164, 1407, 139, 2, 28, "Input",ExpressionUUID->"1d5db560-18c8-3845-bae1-e95058242b47"],
Cell[52306, 1411, 228, 5, 28, "Input",ExpressionUUID->"483b27fc-4b8e-9c46-8db4-040fdf9ca070"],
Cell[52537, 1418, 10149, 244, 541, "Input",ExpressionUUID->"94fcf45b-6f21-634c-b1d5-7d0ae8a5c58d"],
Cell[62689, 1664, 81, 0, 28, "Input",ExpressionUUID->"b9ef39e2-d105-c74c-ae1b-589fe4deab77"],
Cell[62773, 1666, 379, 7, 104, "Input",ExpressionUUID->"8880107c-6260-f84b-9c38-4d69438e0d38"],
Cell[63155, 1675, 9953, 237, 751, "Input",ExpressionUUID->"b0b5f86b-cc2e-e04d-b2ed-4360d9e5fb4f"],
Cell[73111, 1914, 2380, 33, 28, "Input",ExpressionUUID->"5b2a032a-505e-c740-a415-a5a50f903e5d"],
Cell[75494, 1949, 25931, 684, 1017, "Input",ExpressionUUID->"0e074e25-5497-e244-8216-c9871e946f7c"],
Cell[101428, 2635, 18134, 520, 865, "Input",ExpressionUUID->"fb2f931c-bc15-f341-bf84-64962e1f5fe1"],
Cell[119565, 3157, 2382, 33, 28, "Input",ExpressionUUID->"a67f113d-d41d-d24a-8f3f-b4722fe41f74"],
Cell[121950, 3192, 11161, 277, 732, "Input",ExpressionUUID->"24e808de-ed6a-4146-a49a-28e49cf93adc"],
Cell[133114, 3471, 156, 3, 28, "Input",ExpressionUUID->"4129f409-7408-7d45-9299-8b83db08acfc"],
Cell[133273, 3476, 15636, 429, 1036, "Input",ExpressionUUID->"e52c92a4-2eb6-c645-94b2-60c371363739"],
Cell[148912, 3907, 602, 10, 47, "Input",ExpressionUUID->"f19b7f51-99bd-4547-9650-5ff8e4c33086"],
Cell[149517, 3919, 6360, 174, 427, "Input",ExpressionUUID->"e2c58ebf-4fbc-3d4b-ac91-cf15352134a5"],
Cell[155880, 4095, 81, 0, 28, "Input",ExpressionUUID->"b88ee315-af2d-ad44-b33b-38496d3a52d4"],
Cell[155964, 4097, 175, 3, 28, "Input",ExpressionUUID->"4126ecf3-b2bc-c34e-b9ce-ab3dbe467b58"],
Cell[156142, 4102, 10895, 275, 827, "Input",ExpressionUUID->"e455865f-d51a-c546-92e4-fe2425237d2b"],
Cell[167040, 4379, 228, 4, 47, "Input",ExpressionUUID->"2dd959b2-176f-8a4f-80e4-1ab403b9ba23"],
Cell[167271, 4385, 156, 3, 28, "Input",ExpressionUUID->"7e7eb5ba-8e84-5b42-acd7-29c01026fa12"],
Cell[167430, 4390, 7720, 196, 656, "Input",ExpressionUUID->"0ee05957-9f4b-5148-9577-73fb4d317e3e"],
Cell[175153, 4588, 7254, 194, 637, "Input",ExpressionUUID->"d50ef5dd-7d10-9347-8ed7-e6a9098ab778"],
Cell[182410, 4784, 1353, 39, 66, "Input",ExpressionUUID->"63b0b1fd-2390-274b-9686-decf9bf4215f"],
Cell[183766, 4825, 287, 5, 28, "Input",ExpressionUUID->"71ece0e5-c6b3-3242-9291-2dce22eed9c9"],
Cell[184056, 4832, 13223, 371, 580, "Input",ExpressionUUID->"2c594bee-dfa3-0445-a3c2-f168b0935ff6"],
Cell[197282, 5205, 81, 0, 28, "Input",ExpressionUUID->"dcfcb1a1-4b7e-0b43-9670-8664b3289327"],
Cell[197366, 5207, 1093, 15, 47, "Input",ExpressionUUID->"a5650fd1-18d4-1d4e-89f1-7b4f1f908005"],
Cell[198462, 5224, 6079, 169, 503, "Input",ExpressionUUID->"e2dbdcc9-c66d-4441-907d-edfe421a4271"],
Cell[204544, 5395, 105, 1, 28, "Input",ExpressionUUID->"39487013-ded2-0e45-9fd8-d526c979fc41"],
Cell[204652, 5398, 81, 0, 28, "Input",ExpressionUUID->"ad54bf90-5079-e447-887e-2c9f31b492f1"],
Cell[204736, 5400, 156, 3, 47, "Input",ExpressionUUID->"9179d0fc-bd3a-474d-81a0-4d1659297c19"],
Cell[204895, 5405, 7820, 213, 580, "Input",ExpressionUUID->"fd3ecd2e-f399-4b4c-8d0c-8c734248c72a"],
Cell[212718, 5620, 204, 4, 47, "Input",ExpressionUUID->"90347a46-5dbd-b54f-8f1e-a6938e1fe31a"],
Cell[212925, 5626, 154, 3, 47, "Input",ExpressionUUID->"d48f496e-7176-4c4a-84fa-2b0987060b46"],
Cell[213082, 5631, 303, 5, 28, "Input",ExpressionUUID->"16a53433-1cc7-e74a-b3e2-121a43b05c36"],
Cell[213388, 5638, 209, 4, 47, "Input",ExpressionUUID->"0d88e268-8e18-e44d-b2d8-cdf7e7401492"],
Cell[213600, 5644, 559, 10, 85, "Input",ExpressionUUID->"040b9176-9fb1-6c42-b2d6-b57a6d9f6770"],
Cell[214162, 5656, 154, 3, 28, "Input",ExpressionUUID->"415c207e-69ac-8e4e-b60e-cce02daeab93"],
Cell[214319, 5661, 5830, 155, 522, "Input",ExpressionUUID->"fa04d5b8-3a30-3845-b5fc-decb17933490"],
Cell[220152, 5818, 9528, 263, 503, "Input",ExpressionUUID->"52999333-fe05-e84a-acf1-fc22be5bf2ea"],
Cell[229683, 6083, 152, 3, 28, "Input",ExpressionUUID->"e44d3794-52ef-d540-95ab-731b5a7762cd"],
Cell[229838, 6088, 605, 11, 47, "Input",ExpressionUUID->"28629b7d-e028-5846-af8b-9f2b85a1dc47"],
Cell[230446, 6101, 128, 3, 28, "Input",ExpressionUUID->"4b97082b-f52c-d940-8b60-cf5f1725bfda"],
Cell[CellGroupData[{
Cell[230599, 6108, 9703, 267, 694, "Input",ExpressionUUID->"5dd43024-de83-cb41-a7b3-b837d316dc18"],
Cell[240305, 6377, 2077, 61, 75, "Output",ExpressionUUID->"ae10c4aa-bf57-d44a-a92a-66cab0b5888f"]
}, Open  ]],
Cell[242397, 6441, 138, 2, 28, "Input",ExpressionUUID->"dfc70790-c88c-054d-8485-03f8062fbf9d"],
Cell[242538, 6445, 205, 4, 28, "Input",ExpressionUUID->"87f03399-2a49-8741-8bdb-0504f8780838"],
Cell[CellGroupData[{
Cell[242768, 6453, 4106, 110, 313, "Input",ExpressionUUID->"f8ff8a6e-75b1-f84b-9f88-c43ea5866f36"],
Cell[246877, 6565, 2097, 61, 75, "Output",ExpressionUUID->"eb186086-31e5-d846-94d9-89ab52a2b104"],
Cell[248977, 6628, 2099, 61, 75, "Output",ExpressionUUID->"a55a4d9e-d06c-c344-8ad4-6bab88a233e3"]
}, Open  ]],
Cell[251091, 6692, 81, 0, 28, "Input",ExpressionUUID->"22c9a5ff-e8ca-da4a-bea9-0829d17500f1"],
Cell[251175, 6694, 7804, 228, 751, "Input",ExpressionUUID->"b183add0-1c78-2a45-be65-c39d82fd76d6"],
Cell[CellGroupData[{
Cell[259004, 6926, 8209, 235, 827, "Input",ExpressionUUID->"6b2be15b-ddfc-2e4b-8670-7e87cade0d44"],
Cell[267216, 7163, 3117, 98, 143, "Output",ExpressionUUID->"38ce5f7e-8b39-5a4a-b0aa-2258574271c2"]
}, Open  ]]
}
]
*)

