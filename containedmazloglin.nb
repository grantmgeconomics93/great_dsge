(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    123234,       3192]
NotebookOptionsPosition[    118631,       3124]
NotebookOutlinePosition[    119034,       3140]
CellTagsIndexPosition[    118991,       3137]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.9424097710067005`*^9, 3.9424097735303288`*^9}, 
   3.942409986837412*^9, {3.942410224952446*^9, 3.942410250698843*^9}, 
   3.942414205266445*^9, 3.9424171668779297`*^9, 3.942419692092272*^9, 
   3.9424204177254696`*^9, 3.9424204789909916`*^9, {3.942420720045725*^9, 
   3.942420728957245*^9}, {3.9424208281063786`*^9, 3.9424208471915607`*^9}, {
   3.942420880106722*^9, 3.942420886782583*^9}, 3.9424222361942863`*^9, {
   3.942423052980547*^9, 3.9424230739505024`*^9}, 3.942423164222044*^9, 
   3.9424232036387615`*^9, {3.9424232833174133`*^9, 3.942423307845436*^9}, {
   3.942423342657379*^9, 3.942423370843012*^9}, {3.9424235561691933`*^9, 
   3.942423573217308*^9}, 3.9424237825038567`*^9, 3.942423914171425*^9, 
   3.94248768227162*^9, 3.942502868082756*^9, 3.942503100647709*^9, 
   3.942503140525156*^9, 3.9425046010225945`*^9, {3.9425052399102135`*^9, 
   3.9425052421572056`*^9}, {3.9425064032796345`*^9, 3.9425064272894344`*^9}, 
   3.94250658942535*^9, 3.9425067828417664`*^9, 3.942506854326124*^9, {
   3.9425079465509777`*^9, 3.94250799672328*^9}, 3.9425081754514484`*^9, 
   3.942510581203039*^9, {3.942511009251314*^9, 3.942511017852148*^9}, {
   3.942511221733576*^9, 3.9425112586265945`*^9}, 3.9425117108579197`*^9, 
   3.9425117602628727`*^9, {3.942511856447809*^9, 3.9425119345891457`*^9}, 
   3.9425122263945293`*^9, {3.942512955427664*^9, 3.9425129698917313`*^9}, {
   3.94251301365139*^9, 3.9425130307669353`*^9}, {3.942513108585476*^9, 
   3.942513112112303*^9}, {3.9425135466473694`*^9, 3.942513556385315*^9}, {
   3.942513868974186*^9, 3.942513921787203*^9}, {3.9425139580605755`*^9, 
   3.9425139700600357`*^9}, 3.9425140419308376`*^9, {3.942514134970972*^9, 
   3.9425141648856773`*^9}, {3.9425141998729115`*^9, 
   3.9425142444404106`*^9}, {3.9425142927988625`*^9, 3.942514303916441*^9}, {
   3.9425148598096733`*^9, 3.9425148712374344`*^9}, {3.942514910480751*^9, 
   3.942514917020756*^9}, {3.942514973867367*^9, 3.9425150148147144`*^9}, 
   3.9425161769270763`*^9, 3.9425162112263985`*^9, {3.9425166428949184`*^9, 
   3.942516672205147*^9}, {3.942517042567255*^9, 3.9425170621009064`*^9}, {
   3.9425171674338245`*^9, 3.9425171874190807`*^9}, 3.942517223580761*^9, 
   3.9425173582750072`*^9, 3.942517406842678*^9, {3.9425176475276356`*^9, 
   3.942517664750183*^9}, {3.942517718150387*^9, 3.942517744371004*^9}, {
   3.9425178154654617`*^9, 3.942517834731922*^9}, 3.942517913433714*^9, 
   3.942518014903372*^9, {3.9425881118939304`*^9, 3.942588226554573*^9}, {
   3.9425896390154*^9, 3.942589660098751*^9}, {3.9425905522714367`*^9, 
   3.942590594677908*^9}, {3.9425911684561577`*^9, 3.9425911698701305`*^9}, 
   3.942751573759756*^9, 3.942751621808159*^9, 3.9427516680874004`*^9, {
   3.9427517329189034`*^9, 3.9427517351424484`*^9}, {3.9427519255838013`*^9, 
   3.9427519869494553`*^9}, 3.9427520332742233`*^9, 3.942752333177307*^9, {
   3.942752770986908*^9, 3.9427527730965176`*^9}, {3.94275302368054*^9, 
   3.942753025683384*^9}, {3.9428474340546665`*^9, 3.9428474362622166`*^9}, {
   3.9428483214733906`*^9, 3.942848362170891*^9}, 3.9428484049196663`*^9, 
   3.942848454450346*^9, {3.9428490839405823`*^9, 3.942849160084255*^9}, {
   3.942849213918829*^9, 3.942849287185663*^9}, {3.9428493507735596`*^9, 
   3.942849353695465*^9}, 3.9428493846297016`*^9, {3.942850052822735*^9, 
   3.9428500750204296`*^9}, {3.9428501420583496`*^9, 
   3.9428501459492645`*^9}, {3.9428503972435436`*^9, 
   3.9428504100488663`*^9}, {3.942853049260662*^9, 3.9428530504676895`*^9}, {
   3.942853092458111*^9, 3.9428531192472134`*^9}, {3.942853353568598*^9, 
   3.9428533545898075`*^9}, {3.9428533987449627`*^9, 
   3.9428534229557915`*^9}, {3.9429231648091373`*^9, 3.942923166138708*^9}, {
   3.9429246809890385`*^9, 3.942924683690712*^9}, {3.9429247321913033`*^9, 
   3.942924732889475*^9}, {3.9429254250561047`*^9, 3.9429254513153687`*^9}, 
   3.9429254838702602`*^9, {3.9429255434986267`*^9, 3.942925560423479*^9}, {
   3.942925616054928*^9, 3.942925642339443*^9}, {3.9429261874701004`*^9, 
   3.9429262104446373`*^9}, {3.942926484765465*^9, 3.942926497715992*^9}, {
   3.94292658112232*^9, 3.9429265839319725`*^9}, {3.9429267900613174`*^9, 
   3.9429267947414474`*^9}, 3.9429268487589626`*^9, {3.94293422696509*^9, 
   3.9429342288360386`*^9}, {3.9429343606643944`*^9, 
   3.9429343661244335`*^9}, {3.942934751577406*^9, 3.9429347571734104`*^9}, {
   3.9429348102113075`*^9, 3.942934825030098*^9}, 3.9429349712800045`*^9, {
   3.942935395628916*^9, 3.9429354119468803`*^9}, {3.942935638691334*^9, 
   3.9429356840764217`*^9}, 3.9429360778661404`*^9, {3.9429361132493095`*^9, 
   3.9429361676882057`*^9}, {3.942936520458252*^9, 3.942936526243181*^9}, {
   3.9429461492206955`*^9, 3.9429461723246975`*^9}, {3.943008575399826*^9, 
   3.943008584860981*^9}, {3.943012952041334*^9, 3.9430129533912315`*^9}, {
   3.9430272878138313`*^9, 3.9430272905139027`*^9}, 3.943106855318901*^9, {
   3.943373167306566*^9, 
   3.943373172855282*^9}},ExpressionUUID->"f9fb2cec-0218-1946-a7a4-\
614cfc63c79f"],

Cell[BoxData[""], "Input",ExpressionUUID->"93063096-b854-5642-83fe-da57c1f294a1"],

Cell[BoxData[""], "Input",ExpressionUUID->"0708fca9-59ce-8847-af89-18fc69779938"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"patient", " ", "households", " ", "Lagrange"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "Parameters", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"params", "=", 
    RowBox[{"{", 
     RowBox[{
     "betaP", ",", "alpha", ",", "xiP", ",", "epsilonP", ",", "phi", ",", 
      "qh", ",", 
      RowBox[{"wt", "[", "t", "]"}], ",", 
      RowBox[{"rt", "[", "t", "]"}], ",", 
      RowBox[{"pit", "[", "t", "]"}], ",", 
      RowBox[{"cp", "[", "t", "]"}], ",", 
      RowBox[{"dp", "[", "t", "]"}], ",", 
      RowBox[{"hp", "[", "t", "]"}], ",", 
      RowBox[{"lambdaP", "[", "t", "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Utility", " ", "function", " ", "for", " ", "patient", " ", 
    "households"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uPatient", "[", 
     RowBox[{"cp_", ",", "cpLag_", ",", "hp_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "alpha"}], ")"}], " ", "xiP", " ", 
      RowBox[{"Log", "[", 
       RowBox[{"cp", "-", 
        RowBox[{"a", " ", "cpLag"}]}], "]"}]}], "+", 
     RowBox[{"epsilonP", " ", 
      RowBox[{"Log", "[", "hp", "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"hp", "^", 
        RowBox[{"(", 
         RowBox[{"1", "+", "phi"}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", "phi"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Budget", " ", "constraint", " ", "for", " ", "patient", " ", "households",
     " ", "in", " ", "period", " ", "t"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BCPatient", "[", "t_", "]"}], ":=", 
    RowBox[{
     RowBox[{"cp", "[", "t", "]"}], "+", 
     RowBox[{"qh", " ", 
      RowBox[{"hp", "[", "t", "]"}]}], "+", 
     RowBox[{"dp", "[", "t", "]"}], "-", 
     RowBox[{
      RowBox[{"wt", "[", "t", "]"}], " ", 
      RowBox[{"hp", "[", "t", "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"rt", "[", 
           RowBox[{"t", "-", "1"}], "]"}]}], ")"}], "/", 
        RowBox[{"pit", "[", "t", "]"}]}], ")"}], " ", 
      RowBox[{"dp", "[", 
       RowBox[{"t", "-", "1"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Define", " ", "Lagrangian", " ", "for", " ", "two", " ", "periods", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"t", " ", "and", " ", "t"}], "+", "1"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LP", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"uPatient", "[", 
        RowBox[{
         RowBox[{"cp", "[", "t", "]"}], ",", 
         RowBox[{"cp", "[", 
          RowBox[{"t", "-", "1"}], "]"}], ",", 
         RowBox[{"hp", "[", "t", "]"}]}], "]"}], "+", 
       RowBox[{
        RowBox[{"lambdaP", "[", "t", "]"}], "*", 
        RowBox[{"BCPatient", "[", "t", "]"}]}]}], ")"}], "+", 
     RowBox[{
      RowBox[{"betaP", "^", 
       RowBox[{"(", 
        RowBox[{"t", "+", "1"}], ")"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"uPatient", "[", 
         RowBox[{
          RowBox[{"cp", "[", 
           RowBox[{"t", "+", "1"}], "]"}], ",", 
          RowBox[{"cp", "[", "t", "]"}], ",", 
          RowBox[{"hp", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{"lambdaP", "[", 
          RowBox[{"t", "+", "1"}], "]"}], "*", 
         RowBox[{"BCPatient", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}]}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"First", "-", 
    RowBox[{
    "order", " ", "conditions", " ", "for", " ", "patient", " ", 
     "households"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"focPCt", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"LP", ",", 
       RowBox[{"cp", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], 
  "        ", 
  RowBox[{"(*", 
   RowBox[{"FOC", " ", "with", " ", "respect", " ", "to", " ", 
    RowBox[{"cp", "[", "t", "]"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"focPHt", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"LP", ",", 
       RowBox[{"hp", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], 
  "        ", 
  RowBox[{"(*", 
   RowBox[{"FOC", " ", "with", " ", "respect", " ", "to", " ", 
    RowBox[{"hp", "[", "t", "]"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"focPdP", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"LP", ",", 
       RowBox[{"dp", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], 
  "        ", 
  RowBox[{"(*", 
   RowBox[{"FOC", " ", "with", " ", "respect", " ", "to", " ", 
    RowBox[{"dp", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"Debug", " ", "the", " ", "FOCs", " ", "before", " ", "solving"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"debugFOCs", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FOC wrt cp[t]\>\"", "->", "focPCt"}], ",", 
      RowBox[{"\"\<FOC wrt hp[t]\>\"", "->", "focPHt"}], ",", 
      RowBox[{"\"\<FOC wrt dp[t]\>\"", "->", "focPdP"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Solve", " ", "FOCs", " ", "for", " ", "lambda"}], ",", 
    RowBox[{"keeping", " ", "full", " ", "expressions"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lambdaSolutions", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<Lambda wrt cp[t]\>\"", "->", 
       RowBox[{"Solve", "[", 
        RowBox[{"focPCt", ",", 
         RowBox[{"lambdaP", "[", "t", "]"}]}], "]"}]}], ",", 
      RowBox[{"\"\<Lambda wrt hp[t]\>\"", "->", 
       RowBox[{"Solve", "[", 
        RowBox[{"focPHt", ",", 
         RowBox[{"lambdaP", "[", "t", "]"}]}], "]"}]}], ",", 
      RowBox[{"\"\<Lambda wrt dp[t]\>\"", "->", 
       RowBox[{"Solve", "[", 
        RowBox[{"focPdP", ",", 
         RowBox[{"lambdaP", "[", "t", "]"}]}], "]"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "Results", "*)"}]}], "\n", 
 RowBox[{"Print", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<Lambda Solutions\>\"", "->", "lambdaSolutions"}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.942591478649725*^9, 3.942591478649725*^9}, 
   3.9425915249837914`*^9, {3.942591893611925*^9, 3.9425919125734234`*^9}, 
   3.9425920148237686`*^9, {3.9431068767277374`*^9, 3.9431068801445446`*^9}, {
   3.943373150584465*^9, 3.943373154683838*^9}, 3.943530733499941*^9, {
   3.9435311122916813`*^9, 3.9435311485272903`*^9}, {3.9436169128066196`*^9, 
   3.943616924451643*^9}, {3.943617362437744*^9, 3.943617382325964*^9}, {
   3.9436179521460266`*^9, 3.943617955790903*^9}, {3.9453529856666317`*^9, 
   3.9453530067840347`*^9}, {3.945361819427248*^9, 3.9453618221393833`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"9ace75de-4978-4347-8abf-940e21a736de"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"Lambda Solutions\"\>", "\[Rule]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"Lambda wrt cp[t]\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"lambdaP", "[", "t", "]"}], "\[Rule]", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "alpha"}], ")"}], " ", "xiP", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["a", "2"], " ", 
              SuperscriptBox["betaP", 
               RowBox[{"1", "+", "t"}]], " ", 
              RowBox[{"cp", "[", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "-", 
             RowBox[{"a", " ", 
              RowBox[{"cp", "[", "t", "]"}]}], "-", 
             RowBox[{"a", " ", 
              SuperscriptBox["betaP", 
               RowBox[{"1", "+", "t"}]], " ", 
              RowBox[{"cp", "[", "t", "]"}]}], "+", 
             RowBox[{"cp", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", 
              RowBox[{"cp", "[", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "-", 
             RowBox[{"cp", "[", "t", "]"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", 
              RowBox[{"cp", "[", "t", "]"}]}], "-", 
             RowBox[{"cp", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}]]}], "}"}], "}"}]}], 
     ",", 
     RowBox[{"\<\"Lambda wrt hp[t]\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"lambdaP", "[", "t", "]"}], "\[Rule]", 
         FractionBox[
          RowBox[{
           RowBox[{"-", "epsilonP"}], "+", 
           SuperscriptBox[
            RowBox[{"hp", "[", "t", "]"}], 
            RowBox[{"1", "+", "phi"}]]}], 
          RowBox[{
           RowBox[{"hp", "[", "t", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"qh", "-", 
             RowBox[{"wt", "[", "t", "]"}]}], ")"}]}]]}], "}"}], "}"}]}], ",", 
     RowBox[{"\<\"Lambda wrt dp[t]\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"lambdaP", "[", "t", "]"}], "\[Rule]", 
         FractionBox[
          RowBox[{
           SuperscriptBox["betaP", 
            RowBox[{"1", "+", "t"}]], " ", 
           RowBox[{"lambdaP", "[", 
            RowBox[{"1", "+", "t"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"rt", "[", "t", "]"}]}], ")"}]}], 
          RowBox[{"pit", "[", 
           RowBox[{"1", "+", "t"}], "]"}]]}], "}"}], "}"}]}]}], "}"}]}], 
  "}"}]], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.9453530115724983`*^9, {3.9453567033453445`*^9, 3.945356704812771*^9}, {
   3.9453567451134853`*^9, 3.945356790620058*^9}, 3.945361873726124*^9, 
   3.945444393223093*^9},
 CellLabel->
  "During evaluation of \
In[19]:=",ExpressionUUID->"3dd3e17b-7b29-3d40-970d-7f04b4476b62"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"Lambda Solutions\"\>", "\[Rule]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"Lambda wrt cp[t]\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"lambdaP", "[", "t", "]"}], "\[Rule]", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "alpha"}], ")"}], " ", "xiP", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["a", "2"], " ", 
              SuperscriptBox["betaP", 
               RowBox[{"1", "+", "t"}]], " ", 
              RowBox[{"cp", "[", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "-", 
             RowBox[{"a", " ", 
              RowBox[{"cp", "[", "t", "]"}]}], "-", 
             RowBox[{"a", " ", 
              SuperscriptBox["betaP", 
               RowBox[{"1", "+", "t"}]], " ", 
              RowBox[{"cp", "[", "t", "]"}]}], "+", 
             RowBox[{"cp", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", 
              RowBox[{"cp", "[", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "-", 
             RowBox[{"cp", "[", "t", "]"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", 
              RowBox[{"cp", "[", "t", "]"}]}], "-", 
             RowBox[{"cp", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}]]}], "}"}], "}"}]}], 
     ",", 
     RowBox[{"\<\"Lambda wrt hp[t]\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"lambdaP", "[", "t", "]"}], "\[Rule]", 
         FractionBox[
          RowBox[{
           RowBox[{"-", "epsilonP"}], "+", 
           SuperscriptBox[
            RowBox[{"hp", "[", "t", "]"}], 
            RowBox[{"1", "+", "phi"}]]}], 
          RowBox[{
           RowBox[{"hp", "[", "t", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"qh", "-", 
             RowBox[{"wt", "[", "t", "]"}]}], ")"}]}]]}], "}"}], "}"}]}], ",", 
     RowBox[{"\<\"Lambda wrt dp[t]\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"lambdaP", "[", "t", "]"}], "\[Rule]", 
         FractionBox[
          RowBox[{
           SuperscriptBox["betaP", 
            RowBox[{"1", "+", "t"}]], " ", 
           RowBox[{"lambdaP", "[", 
            RowBox[{"1", "+", "t"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"rt", "[", "t", "]"}]}], ")"}]}], 
          RowBox[{"pit", "[", 
           RowBox[{"1", "+", "t"}], "]"}]]}], "}"}], "}"}]}]}], "}"}]}], 
  "}"}]], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.9453530115724983`*^9, {3.9453567033453445`*^9, 3.945356704812771*^9}, {
   3.9453567451134853`*^9, 3.945356790620058*^9}, 3.945361873726124*^9},
 CellLabel->
  "During evaluation of \
In[30]:=",ExpressionUUID->"bd798fe7-18dc-194b-9c9c-5302cebc1728"],

Cell[BoxData[""], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.9453530115724983`*^9, {3.9453567033453445`*^9, 3.945356704812771*^9}, {
   3.9453567451134853`*^9, 3.945356790620058*^9}, 
   3.945363954370018*^9},ExpressionUUID->"7e77d44f-dd6b-6740-a667-\
bc7cfc0472a9"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.9453530115724983`*^9, {3.9453567033453445`*^9, 3.945356704812771*^9}, {
   3.9453567451134853`*^9, 3.945356764892103*^9}, 
   3.945363938791115*^9},ExpressionUUID->"2d9b71e8-1d9f-a94c-a988-\
7eb8c83edf27"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Updated", " ", "Lambda", " ", "Solutions"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"lambdaSolutions", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<Lambda wrt cp[t]\>\"", "->", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"lambdaP", "[", "t", "]"}], "->", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "alpha"}], ")"}], " ", "xiP", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"a", "^", "2"}], " ", "betaP", " ", 
                 RowBox[{"cp", "[", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "-", 
                RowBox[{"a", " ", 
                 RowBox[{"cp", "[", "t", "]"}]}], "-", 
                RowBox[{"a", " ", "betaP", " ", 
                 RowBox[{"cp", "[", "t", "]"}]}], "+", 
                RowBox[{"cp", "[", 
                 RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a", " ", 
                 RowBox[{"cp", "[", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "-", 
                RowBox[{"cp", "[", "t", "]"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a", " ", 
                 RowBox[{"cp", "[", "t", "]"}]}], "-", 
                RowBox[{"cp", "[", 
                 RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], ")"}]}]}], "}"}], 
         "}"}]}], ",", 
       RowBox[{"\"\<Lambda wrt hp[t]\>\"", "->", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"lambdaP", "[", "t", "]"}], "->", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "epsilonP"}], "+", 
              RowBox[{
               RowBox[{"hp", "[", "t", "]"}], "^", 
               RowBox[{"(", 
                RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"hp", "[", "t", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"qh", "-", 
                RowBox[{"wt", "[", "t", "]"}]}], ")"}]}], ")"}]}]}], "}"}], 
         "}"}]}], ",", 
       RowBox[{"\"\<Lambda wrt dp[t]\>\"", "->", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"lambdaP", "[", "t", "]"}], "->", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"betaP", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "epsilonP"}], "+", 
                RowBox[{
                 RowBox[{"hp", "[", 
                  RowBox[{"1", "+", "t"}], "]"}], "^", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"rt", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"hp", "[", 
               RowBox[{"1", "+", "t"}], "]"}], " ", 
              RowBox[{"pit", "[", 
               RowBox[{"1", "+", "t"}], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"qh", "-", 
                RowBox[{"wt", "[", 
                 RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], ")"}]}]}], "}"}], 
         "}"}]}]}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"First", "-", 
     RowBox[{"Order", " ", "Conditions", " ", "with", " ", 
      RowBox[{"lambdaP", "[", "t", "]"}], " ", "eliminated"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Substitute", " ", 
      RowBox[{"lambdaP", "[", "t", "]"}], " ", "into", " ", 
      RowBox[{"dp", "[", "t", "]"}]}], ",", 
     RowBox[{"cp", "[", "t", "]"}], ",", 
     RowBox[{"and", " ", 
      RowBox[{"hp", "[", "t", "]"}], " ", "FOCs"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focSubstituted", "=", 
     RowBox[{"{", 
      RowBox[{"(*", 
       RowBox[{"FOC", " ", "wrt", " ", 
        RowBox[{"cp", "[", "t", "]"}], " ", "with", " ", 
        RowBox[{"lambdaP", "[", "t", "]"}], " ", "substituted"}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "alpha"}], ")"}], " ", "xiP", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"a", "^", "2"}], " ", "betaP", " ", 
               RowBox[{"cp", "[", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "-", 
              RowBox[{"a", " ", 
               RowBox[{"cp", "[", "t", "]"}]}], "-", 
              RowBox[{"a", " ", "betaP", " ", 
               RowBox[{"cp", "[", "t", "]"}]}], "+", 
              RowBox[{"cp", "[", 
               RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"a", " ", 
               RowBox[{"cp", "[", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "-", 
              RowBox[{"cp", "[", "t", "]"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"a", " ", 
               RowBox[{"cp", "[", "t", "]"}]}], "-", 
              RowBox[{"cp", "[", 
               RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], ")"}]}], ")"}], "==", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "epsilonP"}], "+", 
            RowBox[{
             RowBox[{"hp", "[", "t", "]"}], "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"hp", "[", "t", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"qh", "-", 
              RowBox[{"wt", "[", "t", "]"}]}], ")"}]}], ")"}]}], ")"}]}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"hp", "[", "t", "]"}], " ", "with", " ", 
         RowBox[{"lambdaP", "[", "t", "]"}], " ", "substituted"}], "*)"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "epsilonP"}], "+", 
            RowBox[{
             RowBox[{"hp", "[", "t", "]"}], "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"hp", "[", "t", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"qh", "-", 
              RowBox[{"wt", "[", "t", "]"}]}], ")"}]}], ")"}]}], ")"}], "==", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"betaP", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "epsilonP"}], "+", 
              RowBox[{
               RowBox[{"hp", "[", 
                RowBox[{"1", "+", "t"}], "]"}], "^", 
               RowBox[{"(", 
                RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rt", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"hp", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"pit", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"qh", "-", 
              RowBox[{"wt", "[", 
               RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], ")"}]}], ")"}]}], 
       ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"dp", "[", "t", "]"}], " ", "with", " ", 
         RowBox[{"lambdaP", "[", "t", "]"}], " ", "substituted"}], "*)"}], 
       RowBox[{
        RowBox[{"dp", "[", "t", "]"}], "==", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"betaP", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "epsilonP"}], "+", 
              RowBox[{
               RowBox[{"hp", "[", 
                RowBox[{"1", "+", "t"}], "]"}], "^", 
               RowBox[{"(", 
                RowBox[{"1", "+", "phi"}], ")"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rt", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"hp", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"pit", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"qh", "-", 
              RowBox[{"wt", "[", 
               RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], ")"}]}], ")"}]}]}], 
      "\n", "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Solve", " ", "for", " ", 
      RowBox[{"cp", "[", "t", "]"}]}], ",", 
     RowBox[{"hp", "[", "t", "]"}], ",", 
     RowBox[{"and", " ", 
      RowBox[{"dp", "[", "t", "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solutions", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"focSubstituted", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cp", "[", "t", "]"}], ",", 
         RowBox[{"hp", "[", "t", "]"}], ",", 
         RowBox[{"dp", "[", "t", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Display", " ", "the", " ", "solutions"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"\"\<Solutions for cp[t], hp[t], dp[t]\>\"", "->", "solutions"}], 
    "}"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9435308262466354`*^9, 3.9435308504180183`*^9}, {
  3.9464033007482395`*^9, 
  3.9464033091918945`*^9}},ExpressionUUID->"b7a511ea-a296-6f41-a45a-\
13f2bb0b1e10"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"unpatceint", " ", "households"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.943616429544197*^9, 
  3.943616484662098*^9}},ExpressionUUID->"483b27fc-4b8e-9c46-8db4-\
040fdf9ca070"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", 
   RowBox[{
   "Parameters", " ", "and", " ", "Variables", " ", "for", " ", "Impatient", 
    " ", "Households"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"{", 
      RowBox[{
      "betaI", ",", "aD", ",", "phi", ",", "eps_ct", ",", "eps_ht", ",", 
       RowBox[{"cIt", "[", "t", "]"}], ",", 
       RowBox[{"cItLag", "[", "t", "]"}], ",", 
       RowBox[{"hIt", "[", "t", "]"}], ",", 
       RowBox[{"lIt", "[", "t", "]"}], ",", 
       RowBox[{"lItLag", "[", "t", "]"}], ",", 
       RowBox[{"bIt", "[", "t", "]"}], ",", 
       RowBox[{"bItLag", "[", "t", "]"}], ",", 
       RowBox[{"rBH", "[", "t", "]"}], ",", 
       RowBox[{"rBH", "[", "tLag", "]"}], ",", 
       RowBox[{"wIt", "[", "t", "]"}], ",", 
       RowBox[{"qt", "[", "t", "]"}], ",", 
       RowBox[{"pit", "[", "t", "]"}], ",", 
       RowBox[{"mLt", "[", "t", "]"}], ",", 
       RowBox[{"hItLag", "[", "t", "]"}]}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Utility", " ", "function", " ", "for", " ", "impatient", " ", 
     "households"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uImpatient", "[", 
      RowBox[{"cIt_", ",", "cItLag_", ",", "hIt_", ",", "lIt_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "aD"}], ")"}], " ", "eps_ct", " ", 
       RowBox[{"Log", "[", "cIt", "]"}]}], "-", 
      RowBox[{"aD", " ", 
       RowBox[{"Log", "[", "cItLag", "]"}]}], "+", 
      RowBox[{"eps_ht", " ", 
       RowBox[{"Log", "[", "hIt", "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"lIt", "^", 
         RowBox[{"(", 
          RowBox[{"1", "+", "phi"}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", "phi"}], ")"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Budget", " ", "constraint", " ", "for", " ", "impatient", " ", 
     "households", " ", "in", " ", "period", " ", "t"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BCImpatient", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"cIt", "[", "t", "]"}], "+", 
      RowBox[{
       RowBox[{"qt", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"hIt", "[", "t", "]"}], "-", 
         RowBox[{"hIt", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"rBH", "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ")"}], "/", 
         RowBox[{"pit", "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"bIt", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"wIt", "[", "t", "]"}], " ", 
       RowBox[{"lIt", "[", "t", "]"}]}], "-", 
      RowBox[{"bIt", "[", "t", "]"}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Borrowing", " ", "constraint", " ", "for", " ", "impatient", " ", 
     "households", " ", "in", " ", "period", " ", "t"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BorrowingConstraint", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"rBH", "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"bIt", "[", "t", "]"}]}], "-", 
      RowBox[{
       RowBox[{"mLt", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"qt", "[", 
          RowBox[{"t", "+", "1"}], "]"}], " ", 
         RowBox[{"hIt", "[", "t", "]"}], " ", 
         RowBox[{"pit", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", "Lagrangian", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LI", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"uImpatient", "[", 
         RowBox[{
          RowBox[{"cIt", "[", "t", "]"}], ",", 
          RowBox[{"cIt", "[", 
           RowBox[{"t", "-", "1"}], "]"}], ",", 
          RowBox[{"hIt", "[", "t", "]"}], ",", 
          RowBox[{"lIt", "[", "t", "]"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{"lambdaI", "[", "t", "]"}], " ", 
         RowBox[{"BCImpatient", "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"muI", "[", "t", "]"}], " ", 
         RowBox[{"BorrowingConstraint", "[", "t", "]"}]}]}], ")"}], "+", 
      RowBox[{
       RowBox[{"betaI", "^", 
        RowBox[{"(", 
         RowBox[{"t", "+", "1"}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"uImpatient", "[", 
          RowBox[{
           RowBox[{"cIt", "[", 
            RowBox[{"t", "+", "1"}], "]"}], ",", 
           RowBox[{"cIt", "[", "t", "]"}], ",", 
           RowBox[{"hIt", "[", 
            RowBox[{"t", "+", "1"}], "]"}], ",", 
           RowBox[{"lIt", "[", 
            RowBox[{"t", "+", "1"}], "]"}]}], "]"}], "+", 
         RowBox[{
          RowBox[{"lambdaI", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"BCImpatient", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"muI", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"BorrowingConstraint", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"First", "-", 
     RowBox[{
     "order", " ", "conditions", " ", "for", " ", "impatient", " ", 
      "households"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focCtI", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LI", ",", 
        RowBox[{"cIt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "consumption", " ", 
     RowBox[{"cIt", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focHtI", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LI", ",", 
        RowBox[{"hIt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "housing", " ", 
     RowBox[{"hIt", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focLtI", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LI", ",", 
        RowBox[{"lIt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "hours", " ", "worked", " ", 
     RowBox[{"lIt", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focBtI", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LI", ",", 
        RowBox[{"bIt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "borrowing", " ", 
     RowBox[{"bIt", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Display", " ", "results"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"debugFOCs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<FOC wrt cIt[t]\>\"", "->", "focCtI"}], ",", 
       RowBox[{"\"\<FOC wrt hIt[t]\>\"", "->", "focHtI"}], ",", 
       RowBox[{"\"\<FOC wrt lIt[t]\>\"", "->", "focLtI"}], ",", 
       RowBox[{"\"\<FOC wrt bIt[t]\>\"", "->", "focBtI"}]}], "}"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Output", " ", "the", " ", "Lagrangian", " ", "and", " ", "FOCs"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Lagrangian\>\"", "->", "LI"}], ",", 
     RowBox[{"\"\<First-Order Conditions\>\"", "->", "debugFOCs"}]}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{
  3.9428556216292534`*^9, 3.9428558638346443`*^9, 3.942856329183136*^9, 
   3.9428564862004185`*^9, 3.9428566889696026`*^9, {3.942856910773079*^9, 
   3.9428569354905777`*^9}, {3.942857364787548*^9, 3.9428573898232937`*^9}, {
   3.9428577783808823`*^9, 3.9428578049808903`*^9}, 3.9428579940329285`*^9, {
   3.9428580395093536`*^9, 3.942858042871578*^9}, 3.9428591140860786`*^9, 
   3.9431155151779137`*^9, {3.9431158839568024`*^9, 3.943115919462967*^9}, {
   3.943116017131489*^9, 3.943116043165043*^9}, {3.943116203605345*^9, 
   3.943116248865116*^9}, 3.943116279396555*^9, {3.9431165276830425`*^9, 
   3.943116567202736*^9}, {3.94311672191103*^9, 3.943116753600672*^9}, {
   3.943116983151354*^9, 3.9431169998925896`*^9}, {3.9431182676864986`*^9, 
   3.943118310423565*^9}, {3.9431188651155624`*^9, 3.9431188743868217`*^9}, {
   3.9431189471438274`*^9, 3.943118963078903*^9}, {3.9431190017983513`*^9, 
   3.9431190163987827`*^9}, 3.9431844617301445`*^9, {3.943184531994499*^9, 
   3.9431845466193027`*^9}, {3.9431847557619095`*^9, 3.943184775501425*^9}, {
   3.943359097367693*^9, 3.943359119211834*^9}, 3.943368823503065*^9, 
   3.9433689041234646`*^9, 3.9433690047130775`*^9, {3.943372602202656*^9, 
   3.9433726292470894`*^9}, 3.9433731892332497`*^9, 3.943373405777813*^9, 
   3.943373880790806*^9, 3.9435298263594894`*^9, {3.943531181261368*^9, 
   3.943531227021929*^9}, 3.943533171298271*^9, {3.9435333243153496`*^9, 
   3.9435333617947254`*^9}, 3.9435362777779655`*^9, 3.9435367592692184`*^9, {
   3.9435380153508034`*^9, 3.943538038666689*^9}, {3.943548833672926*^9, 
   3.9435488363959446`*^9}, 3.9435490988596954`*^9, {3.9435491348483696`*^9, 
   3.943549140611929*^9}, {3.9435492777151756`*^9, 3.9435492934218426`*^9}, {
   3.943616506312252*^9, 3.9436165507183113`*^9}, {3.9436180500715656`*^9, 
   3.9436180530685368`*^9}, {3.945173009921896*^9, 3.945173031726755*^9}, {
   3.9451733102613754`*^9, 3.945173337662203*^9}, 3.9463751018555126`*^9, 
   3.9463802729152527`*^9, {3.946380978417076*^9, 3.9463810300157757`*^9}, 
   3.946396126499422*^9, 3.946397331734724*^9, 3.946398470666641*^9, 
   3.9463985289595127`*^9, 3.9463986259487324`*^9, {3.9464011586499176`*^9, 
   3.9464011613548775`*^9}, {3.9464016694565735`*^9, 
   3.9464017233964157`*^9}, {3.946402820333645*^9, 3.9464028291536007`*^9}, {
   3.9464035597819443`*^9, 3.946403566628748*^9}},
 CellLabel->
  "In[394]:=",ExpressionUUID->"94fcf45b-6f21-634c-b1d5-7d0ae8a5c58d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"Lagrangian\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"lIt", "[", "t", "]"}], 
        RowBox[{"1", "+", "phi"}]], 
       RowBox[{"1", "+", "phi"}]]}], "-", 
     RowBox[{"aD", " ", 
      RowBox[{"Log", "[", 
       RowBox[{"cIt", "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "t"}], "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "aD"}], ")"}], " ", 
      RowBox[{"Log", "[", 
       RowBox[{"cIt", "[", "t", "]"}], "]"}], " ", "eps_ct"}], "+", 
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{"hIt", "[", "t", "]"}], "]"}], " ", "eps_ht"}], "+", 
     RowBox[{
      RowBox[{"muI", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"hIt", "[", "t", "]"}]}], " ", 
         RowBox[{"mLt", "[", "t", "]"}], " ", 
         RowBox[{"pit", "[", 
          RowBox[{"1", "+", "t"}], "]"}], " ", 
         RowBox[{"qt", "[", 
          RowBox[{"1", "+", "t"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"bIt", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"rBH", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"lambdaI", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"bIt", "[", "t", "]"}]}], "+", 
        RowBox[{"cIt", "[", "t", "]"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"hIt", "[", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
           RowBox[{"hIt", "[", "t", "]"}]}], ")"}], " ", 
         RowBox[{"qt", "[", "t", "]"}]}], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"bIt", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"rBH", "[", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], "]"}]}], ")"}]}], 
         RowBox[{"pit", "[", "t", "]"}]], "-", 
        RowBox[{
         RowBox[{"lIt", "[", "t", "]"}], " ", 
         RowBox[{"wIt", "[", "t", "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["betaI", 
       RowBox[{"1", "+", "t"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"lIt", "[", 
            RowBox[{"1", "+", "t"}], "]"}], 
           RowBox[{"1", "+", "phi"}]], 
          RowBox[{"1", "+", "phi"}]]}], "-", 
        RowBox[{"aD", " ", 
         RowBox[{"Log", "[", 
          RowBox[{"cIt", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "aD"}], ")"}], " ", 
         RowBox[{"Log", "[", 
          RowBox[{"cIt", "[", 
           RowBox[{"1", "+", "t"}], "]"}], "]"}], " ", "eps_ct"}], "+", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"hIt", "[", 
           RowBox[{"1", "+", "t"}], "]"}], "]"}], " ", "eps_ht"}], "+", 
        RowBox[{
         RowBox[{"muI", "[", 
          RowBox[{"1", "+", "t"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"hIt", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}], " ", 
            RowBox[{"mLt", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"pit", "[", 
             RowBox[{"2", "+", "t"}], "]"}], " ", 
            RowBox[{"qt", "[", 
             RowBox[{"2", "+", "t"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"bIt", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rBH", "[", 
               RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"lambdaI", "[", 
          RowBox[{"1", "+", "t"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"bIt", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], "+", 
           RowBox[{"cIt", "[", 
            RowBox[{"1", "+", "t"}], "]"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"hIt", "[", "t", "]"}]}], "+", 
              RowBox[{"hIt", "[", 
               RowBox[{"1", "+", "t"}], "]"}]}], ")"}], " ", 
            RowBox[{"qt", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"bIt", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rBH", "[", "t", "]"}]}], ")"}]}], 
            RowBox[{"pit", "[", 
             RowBox[{"1", "+", "t"}], "]"}]], "-", 
           RowBox[{
            RowBox[{"lIt", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"wIt", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{"\<\"First-Order Conditions\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\<\"FOC wrt cIt[t]\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"aD", " ", 
            SuperscriptBox["betaI", 
             RowBox[{"1", "+", "t"}]]}], 
           RowBox[{"cIt", "[", "t", "]"}]]}], "+", 
         RowBox[{"lambdaI", "[", "t", "]"}], "+", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "aD"}], ")"}], " ", "eps_ct"}], 
          RowBox[{"cIt", "[", "t", "]"}]]}], "\[Equal]", "0"}]}], ",", 
      RowBox[{"\<\"FOC wrt hIt[t]\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{
         FractionBox["eps_ht", 
          RowBox[{"hIt", "[", "t", "]"}]], "+", 
         RowBox[{
          RowBox[{"lambdaI", "[", "t", "]"}], " ", 
          RowBox[{"qt", "[", "t", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["betaI", 
           RowBox[{"1", "+", "t"}]], " ", 
          RowBox[{"lambdaI", "[", 
           RowBox[{"1", "+", "t"}], "]"}], " ", 
          RowBox[{"qt", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"mLt", "[", "t", "]"}], " ", 
          RowBox[{"muI", "[", "t", "]"}], " ", 
          RowBox[{"pit", "[", 
           RowBox[{"1", "+", "t"}], "]"}], " ", 
          RowBox[{"qt", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}]}], "\[Equal]", "0"}]}], ",", 
      RowBox[{"\<\"FOC wrt lIt[t]\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"lIt", "[", "t", "]"}], "phi"]}], "-", 
         RowBox[{
          RowBox[{"lambdaI", "[", "t", "]"}], " ", 
          RowBox[{"wIt", "[", "t", "]"}]}]}], "\[Equal]", "0"}]}], ",", 
      RowBox[{"\<\"FOC wrt bIt[t]\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"lambdaI", "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"muI", "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"rBH", "[", "t", "]"}]}], ")"}]}], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox["betaI", 
            RowBox[{"1", "+", "t"}]], " ", 
           RowBox[{"lambdaI", "[", 
            RowBox[{"1", "+", "t"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"rBH", "[", "t", "]"}]}], ")"}]}], 
          RowBox[{"pit", "[", 
           RowBox[{"1", "+", "t"}], "]"}]]}], "\[Equal]", "0"}]}]}], 
     "}"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.946402859275978*^9, 3.9464035822179165`*^9},
 CellLabel->
  "Out[404]=",ExpressionUUID->"03f759ac-a224-7c42-8a72-d212d0c339e1"]
}, Open  ]],

Cell[BoxData[""], "Input",ExpressionUUID->"b9ef39e2-d105-c74c-ae1b-589fe4deab77"],

Cell[BoxData[
 RowBox[{"\n", "\n", "\n", "\[IndentingNewLine]", 
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]}]], "Input",
 CellChangeTimes->{
  3.946400316124754*^9, 3.9464005812752533`*^9, {3.94640143677759*^9, 
   3.9464014829991436`*^9}, {3.946401823560726*^9, 3.946401836477703*^9}, 
   3.946403333041109*^9},ExpressionUUID->"8880107c-6260-f84b-9c38-\
4d69438e0d38"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", 
   RowBox[{"Define", " ", "FOC", " ", "wrt", " ", 
    RowBox[{"cIt", "[", "t", "]"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"eq1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"aD", " ", 
            RowBox[{"betaI", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}]}], ")"}], "/", 
          RowBox[{"cIt", "[", "t", "]"}]}], ")"}]}], "+", 
       RowBox[{"lambdaI", "[", "t", "]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "aD"}], ")"}], " ", "eps_ct"}], ")"}], "/", 
        RowBox[{"cIt", "[", "t", "]"}]}]}], "==", "0"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"1", ")"}], " ", "Solve", " ", "eq1", " ", "for", " ", 
     RowBox[{"lambdaI", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solLambda", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"eq1", ",", 
       RowBox[{"lambdaI", "[", "t", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Result", " ", "gives", " ", 
      RowBox[{"lambdaI", "[", "t", "]"}], " ", "in", " ", "terms", " ", "of", 
      " ", "aD"}], ",", "betaI", ",", "eps_ct", ",", 
     RowBox[{"and", " ", 
      RowBox[{"cIt", "[", "t", "]"}]}]}], "*)"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Define", " ", "other", " ", "FOCs"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focSystem", "=", 
     RowBox[{"{", 
      RowBox[{"(*", 
       RowBox[{"FOC", " ", "wrt", " ", 
        RowBox[{"hIt", "[", "t", "]"}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"eps_ht", "/", 
          RowBox[{"hIt", "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"lambdaI", "[", "t", "]"}], " ", 
          RowBox[{"qt", "[", "t", "]"}]}], "-", 
         RowBox[{
          RowBox[{"betaI", "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "t"}], ")"}]}], " ", 
          RowBox[{"lambdaI", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"qt", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"mLt", "[", "t", "]"}], " ", 
          RowBox[{"muI", "[", "t", "]"}], " ", 
          RowBox[{"pit", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"qt", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}]}], "==", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"lIt", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{
           RowBox[{"lIt", "[", "t", "]"}], "^", "phi"}]}], "-", 
         RowBox[{
          RowBox[{"lambdaI", "[", "t", "]"}], " ", 
          RowBox[{"wIt", "[", "t", "]"}]}]}], "==", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"bIt", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"lambdaI", "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"muI", "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"rBH", "[", "t", "]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betaI", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}], " ", 
            RowBox[{"lambdaI", "[", 
             RowBox[{"t", "+", "1"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rBH", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"pit", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}]}], "==", "0"}]}], "}"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"2", ")"}], " ", "Use", " ", "time", " ", "identity"}], ",", 
     RowBox[{
      RowBox[{"lambdaI", "[", 
       RowBox[{"t", "+", "1"}], "]"}], " ", "and", " ", 
      RowBox[{"lambdaI", "[", 
       RowBox[{"t", "-", "1"}], "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lambdaNext", "=", 
     RowBox[{"solLambda", "/.", " ", 
      RowBox[{"t", "->", 
       RowBox[{"t", "+", "1"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"lambdaPrev", "=", 
     RowBox[{"solLambda", "/.", " ", 
      RowBox[{"t", "->", 
       RowBox[{"t", "-", "1"}]}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"3", ")"}], " ", "Substitute", " ", "solution", " ", "into", " ",
      "the", " ", "system", " ", "of", " ", "FOCs"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focSystemSub", "=", 
     RowBox[{
      RowBox[{"focSystem", "/.", " ", 
       RowBox[{"solLambda", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "/.", " ", 
      RowBox[{"lambdaNext", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Print", " ", "the", " ", "system", " ", "of", " ", "equations", " ", 
     "after", " ", "substitution"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<System of equations after substitution: \>\"", ",", 
      "focSystemSub"}], "]"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Solve", " ", "for", " ", "remaining", " ", "variables"}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"focSystemSub", ",", 
       RowBox[{"{", 
        RowBox[{"muI", "[", "t", "]"}], 
        RowBox[{"(*", 
         RowBox[{
         "Add", " ", "other", " ", "variables", " ", "if", " ", "needed"}], 
         "*)"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Example", ":", 
     RowBox[{"Substitute", " ", 
      RowBox[{"muI", "[", "t", "]"}], " ", "from", " ", "FOC", " ", "wrt", 
      " ", 
      RowBox[{"bIt", "[", "t", "]"}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"muISolution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"focSystemSub", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"muI", "[", "t", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Substitute", " ", 
     RowBox[{"muI", "[", "t", "]"}], " ", "into", " ", "FOC", " ", "wrt", " ", 
     RowBox[{"hIt", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"eq1Sub", "=", 
     RowBox[{
      RowBox[{"focSystemSub", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/.", " ", 
      RowBox[{"muISolution", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Keep", " ", "FOC", " ", "wrt", " ", 
     RowBox[{"lIt", "[", "t", "]"}], " ", "unchanged"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"eq2", "=", 
     RowBox[{"focSystemSub", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Print", " ", "results"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<Equation wrt hIt[t] after elimination of muI[t]: \>\"", ",", 
      "eq1Sub"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Equation wrt lIt[t] remains: \>\"", ",", "eq2"}], "]"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n"}]}]], "Input",
 CellChangeTimes->{
  3.942592057012724*^9, {3.942592245428005*^9, 3.94259229837319*^9}, {
   3.94259276149564*^9, 3.942592764239746*^9}, {3.9425935259046726`*^9, 
   3.942593548727476*^9}, 3.9425936374098434`*^9, {3.942594582938095*^9, 
   3.942594602603157*^9}, 3.9425946466589737`*^9, {3.9425949113557167`*^9, 
   3.9425949911134377`*^9}, 3.942595094281233*^9, {3.942595174682337*^9, 
   3.942595279071537*^9}, 3.942595447132061*^9, {3.9425956151379395`*^9, 
   3.94259563994841*^9}, 3.942595669960287*^9, {3.9425959508937435`*^9, 
   3.9425959719109993`*^9}, 3.9427690351333847`*^9, 3.9427690682198257`*^9, 
   3.9427715635525856`*^9, 3.9428545977365494`*^9, 3.9430291244111385`*^9, {
   3.9430293293032436`*^9, 3.9430293321251163`*^9}, 3.943029903411661*^9, 
   3.943029935968582*^9, {3.9430300915187435`*^9, 3.9430300983569183`*^9}, 
   3.943030165224594*^9, 3.943031018565777*^9, 3.9430310525436935`*^9, 
   3.9430315909590073`*^9, {3.943031676607229*^9, 3.943031762295637*^9}, {
   3.943032046234873*^9, 3.94303207506736*^9}, {3.943032277998928*^9, 
   3.943032328893503*^9}, 3.9430323609657345`*^9, {3.9430338379985332`*^9, 
   3.9430338777026024`*^9}, {3.9430340737475815`*^9, 3.9430340995907764`*^9}, 
   3.943034138748911*^9, 3.943034215671747*^9, 3.9430955097704773`*^9, 
   3.9433588087017574`*^9, 3.9433588506085987`*^9, 3.9433604537355385`*^9, 
   3.9433690498361454`*^9, {3.943369097716297*^9, 3.9433691157514877`*^9}, {
   3.9433691779950886`*^9, 3.9433691920949574`*^9}, {3.943369408544922*^9, 
   3.943369419957775*^9}, {3.9433694534026623`*^9, 3.9433694610976887`*^9}, {
   3.9433718095535316`*^9, 3.9433718209741173`*^9}, {3.943371942155674*^9, 
   3.943371948822159*^9}, {3.943372132182953*^9, 3.9433721356424065`*^9}, {
   3.9433723369107685`*^9, 3.9433723433940105`*^9}, {3.9433725200260067`*^9, 
   3.943372539188036*^9}, 3.9433729214440956`*^9, 3.946134979625437*^9, {
   3.946135028668358*^9, 3.9461350308236866`*^9}, {3.946380295211197*^9, 
   3.946380296539772*^9}, {3.94640043978706*^9, 3.946400483226412*^9}, 
   3.9464023612987766`*^9, {3.9464025415333214`*^9, 3.9464025643481045`*^9}, {
   3.9464031878470516`*^9, 3.946403191088213*^9}, {3.9464034240072136`*^9, 
   3.9464034490416183`*^9}},
 CellLabel->
  "In[405]:=",ExpressionUUID->"b0b5f86b-cc2e-e04d-b2ed-4360d9e5fb4f"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"System of equations after substitution: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       FractionBox["eps_ht", 
        RowBox[{"hIt", "[", "t", "]"}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"aD", " ", 
            SuperscriptBox["betaI", 
             RowBox[{"1", "+", "t"}]]}], "-", "eps_ct", "+", 
           RowBox[{"aD", " ", "eps_ct"}]}], ")"}], " ", 
         RowBox[{"qt", "[", "t", "]"}]}], 
        RowBox[{"cIt", "[", "t", "]"}]], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["betaI", 
          RowBox[{"1", "+", "t"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"aD", " ", 
            SuperscriptBox["betaI", 
             RowBox[{"2", "+", "t"}]]}], "-", "eps_ct", "+", 
           RowBox[{"aD", " ", "eps_ct"}]}], ")"}], " ", 
         RowBox[{"qt", "[", 
          RowBox[{"1", "+", "t"}], "]"}]}], 
        RowBox[{"cIt", "[", 
         RowBox[{"1", "+", "t"}], "]"}]], "-", 
       RowBox[{
        RowBox[{"mLt", "[", "t", "]"}], " ", 
        RowBox[{"muI", "[", "t", "]"}], " ", 
        RowBox[{"pit", "[", 
         RowBox[{"1", "+", "t"}], "]"}], " ", 
        RowBox[{"qt", "[", 
         RowBox[{"1", "+", "t"}], "]"}]}]}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"lIt", "[", "t", "]"}], "phi"]}], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"aD", " ", 
            SuperscriptBox["betaI", 
             RowBox[{"1", "+", "t"}]]}], "-", "eps_ct", "+", 
           RowBox[{"aD", " ", "eps_ct"}]}], ")"}], " ", 
         RowBox[{"wIt", "[", "t", "]"}]}], 
        RowBox[{"cIt", "[", "t", "]"}]]}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"aD", " ", 
           SuperscriptBox["betaI", 
            RowBox[{"1", "+", "t"}]]}], "-", "eps_ct", "+", 
          RowBox[{"aD", " ", "eps_ct"}]}], 
         RowBox[{"cIt", "[", "t", "]"}]]}], "+", 
       RowBox[{
        RowBox[{"muI", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"rBH", "[", "t", "]"}]}], ")"}]}], "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["betaI", 
          RowBox[{"1", "+", "t"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"aD", " ", 
            SuperscriptBox["betaI", 
             RowBox[{"2", "+", "t"}]]}], "-", "eps_ct", "+", 
           RowBox[{"aD", " ", "eps_ct"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"rBH", "[", "t", "]"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"cIt", "[", 
          RowBox[{"1", "+", "t"}], "]"}], " ", 
         RowBox[{"pit", "[", 
          RowBox[{"1", "+", "t"}], "]"}]}]]}], "\[Equal]", "0"}]}], "}"}]}],
  SequenceForm[
  "System of equations after substitution: ", \
{$CellContext`hIt[$CellContext`t]^(-1) Pattern[$CellContext`eps, 
        Blank[$CellContext`ht]] + $CellContext`cIt[$CellContext`t]^(-1) \
($CellContext`aD $CellContext`betaI^(1 + $CellContext`t) - 
       Pattern[$CellContext`eps, 
        Blank[$CellContext`ct]] + $CellContext`aD Pattern[$CellContext`eps, 
          
          Blank[$CellContext`ct]]) $CellContext`qt[$CellContext`t] - \
$CellContext`betaI^(1 + $CellContext`t) $CellContext`cIt[
       1 + $CellContext`t]^(-1) ($CellContext`aD $CellContext`betaI^(
         2 + $CellContext`t) - Pattern[$CellContext`eps, 
       Blank[$CellContext`ct]] + $CellContext`aD Pattern[$CellContext`eps, 
         Blank[$CellContext`ct]]) $CellContext`qt[
      1 + $CellContext`t] - $CellContext`mLt[$CellContext`t] \
$CellContext`muI[$CellContext`t] $CellContext`pit[
      1 + $CellContext`t] $CellContext`qt[1 + $CellContext`t] == 
    0, -$CellContext`lIt[$CellContext`t]^$CellContext`phi - \
$CellContext`cIt[$CellContext`t]^(-1) ($CellContext`aD $CellContext`betaI^(
         1 + $CellContext`t) - Pattern[$CellContext`eps, 
       Blank[$CellContext`ct]] + $CellContext`aD Pattern[$CellContext`eps, 
         Blank[$CellContext`ct]]) $CellContext`wIt[$CellContext`t] == 
    0, -$CellContext`cIt[$CellContext`t]^(-1) ($CellContext`aD \
$CellContext`betaI^(1 + $CellContext`t) - Pattern[$CellContext`eps, 
        Blank[$CellContext`ct]] + $CellContext`aD Pattern[$CellContext`eps, 
          Blank[$CellContext`ct]]) + $CellContext`muI[$CellContext`t] (
       1 + $CellContext`rBH[$CellContext`t]) + $CellContext`betaI^(
        1 + $CellContext`t) $CellContext`cIt[
        1 + $CellContext`t]^(-1) ($CellContext`aD $CellContext`betaI^(
          2 + $CellContext`t) - Pattern[$CellContext`eps, 
        Blank[$CellContext`ct]] + $CellContext`aD Pattern[$CellContext`eps, 
          Blank[$CellContext`ct]]) $CellContext`pit[1 + $CellContext`t]^(-1) (
       1 + $CellContext`rBH[$CellContext`t]) == 0}],
  Editable->False]], "Print",
 CellChangeTimes->{3.946403487570137*^9, 3.946403626886097*^9},
 CellLabel->
  "During evaluation of \
In[405]:=",ExpressionUUID->"73d20644-dbb9-484d-b64c-372187a53b60"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Equation wrt hIt[t] after elimination of muI[t]: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     FractionBox["eps_ht", 
      RowBox[{"hIt", "[", "t", "]"}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"aD", " ", 
          SuperscriptBox["betaI", 
           RowBox[{"1", "+", "t"}]]}], "-", "eps_ct", "+", 
         RowBox[{"aD", " ", "eps_ct"}]}], ")"}], " ", 
       RowBox[{"qt", "[", "t", "]"}]}], 
      RowBox[{"cIt", "[", "t", "]"}]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["betaI", 
        RowBox[{"1", "+", "t"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"aD", " ", 
          SuperscriptBox["betaI", 
           RowBox[{"2", "+", "t"}]]}], "-", "eps_ct", "+", 
         RowBox[{"aD", " ", "eps_ct"}]}], ")"}], " ", 
       RowBox[{"qt", "[", 
        RowBox[{"1", "+", "t"}], "]"}]}], 
      RowBox[{"cIt", "[", 
       RowBox[{"1", "+", "t"}], "]"}]], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"mLt", "[", "t", "]"}], " ", 
       RowBox[{"pit", "[", 
        RowBox[{"1", "+", "t"}], "]"}], " ", 
       RowBox[{"qt", "[", 
        RowBox[{"1", "+", "t"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"aD", " ", 
            SuperscriptBox["betaI", 
             RowBox[{"1", "+", "t"}]]}], "-", "eps_ct", "+", 
           RowBox[{"aD", " ", "eps_ct"}]}], 
          RowBox[{"cIt", "[", "t", "]"}]], "-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["betaI", 
            RowBox[{"1", "+", "t"}]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"aD", " ", 
              SuperscriptBox["betaI", 
               RowBox[{"2", "+", "t"}]]}], "-", "eps_ct", "+", 
             RowBox[{"aD", " ", "eps_ct"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"rBH", "[", "t", "]"}]}], ")"}]}], 
          RowBox[{
           RowBox[{"cIt", "[", 
            RowBox[{"1", "+", "t"}], "]"}], " ", 
           RowBox[{"pit", "[", 
            RowBox[{"1", "+", "t"}], "]"}]}]]}], ")"}]}], 
      RowBox[{"1", "+", 
       RowBox[{"rBH", "[", "t", "]"}]}]]}], "\[Equal]", "0"}]}],
  SequenceForm[
  "Equation wrt hIt[t] after elimination of muI[t]: ", \
$CellContext`hIt[$CellContext`t]^(-1) Pattern[$CellContext`eps, 
       Blank[$CellContext`ht]] + $CellContext`cIt[$CellContext`t]^(-1) \
($CellContext`aD $CellContext`betaI^(1 + $CellContext`t) - 
      Pattern[$CellContext`eps, 
       Blank[$CellContext`ct]] + $CellContext`aD Pattern[$CellContext`eps, 
         Blank[$CellContext`ct]]) $CellContext`qt[$CellContext`t] - \
$CellContext`betaI^(1 + $CellContext`t) $CellContext`cIt[
      1 + $CellContext`t]^(-1) ($CellContext`aD $CellContext`betaI^(
        2 + $CellContext`t) - Pattern[$CellContext`eps, 
      Blank[$CellContext`ct]] + $CellContext`aD Pattern[$CellContext`eps, 
        Blank[$CellContext`ct]]) $CellContext`qt[
     1 + $CellContext`t] - $CellContext`mLt[$CellContext`t] $CellContext`pit[
     1 + $CellContext`t] $CellContext`qt[
     1 + $CellContext`t] (
      1 + $CellContext`rBH[$CellContext`t])^(-1) \
($CellContext`cIt[$CellContext`t]^(-1) ($CellContext`aD $CellContext`betaI^(
          1 + $CellContext`t) - Pattern[$CellContext`eps, 
        Blank[$CellContext`ct]] + $CellContext`aD Pattern[$CellContext`eps, 
          Blank[$CellContext`ct]]) - $CellContext`betaI^(
       1 + $CellContext`t) $CellContext`cIt[
       1 + $CellContext`t]^(-1) ($CellContext`aD $CellContext`betaI^(
         2 + $CellContext`t) - Pattern[$CellContext`eps, 
       Blank[$CellContext`ct]] + $CellContext`aD Pattern[$CellContext`eps, 
         Blank[$CellContext`ct]]) $CellContext`pit[1 + $CellContext`t]^(-1) (
      1 + $CellContext`rBH[$CellContext`t])) == 0],
  Editable->False]], "Print",
 CellChangeTimes->{3.946403487570137*^9, 3.9464036268911114`*^9},
 CellLabel->
  "During evaluation of \
In[405]:=",ExpressionUUID->"ed7f8dd5-1b8a-1847-b409-46d2e0de89e7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Equation wrt lIt[t] remains: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox[
       RowBox[{"lIt", "[", "t", "]"}], "phi"]}], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"aD", " ", 
          SuperscriptBox["betaI", 
           RowBox[{"1", "+", "t"}]]}], "-", "eps_ct", "+", 
         RowBox[{"aD", " ", "eps_ct"}]}], ")"}], " ", 
       RowBox[{"wIt", "[", "t", "]"}]}], 
      RowBox[{"cIt", "[", "t", "]"}]]}], "\[Equal]", "0"}]}],
  SequenceForm[
  "Equation wrt lIt[t] remains: ", \
-$CellContext`lIt[$CellContext`t]^$CellContext`phi - \
$CellContext`cIt[$CellContext`t]^(-1) ($CellContext`aD $CellContext`betaI^(
        1 + $CellContext`t) - Pattern[$CellContext`eps, 
      Blank[$CellContext`ct]] + $CellContext`aD Pattern[$CellContext`eps, 
        Blank[$CellContext`ct]]) $CellContext`wIt[$CellContext`t] == 0],
  Editable->False]], "Print",
 CellChangeTimes->{3.946403487570137*^9, 3.946403626895073*^9},
 CellLabel->
  "During evaluation of \
In[405]:=",ExpressionUUID->"62c8d3d6-9211-164c-add7-9c65ad68efa0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\n", 
  RowBox[{"(*", " ", "entrappanuer", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Parameters", " ", "and", " ", "Variables", " ", "for", " ", 
     "Entrepreneurs"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"{", 
      RowBox[{
      "betaE", ",", "alpha", ",", "delta", ",", "xi1", ",", "xi2", ",", 
       RowBox[{"AE", "[", "t", "]"}], ",", 
       RowBox[{"wpt", "[", "t", "]"}], ",", 
       RowBox[{"wip", "[", "t", "]"}], ",", 
       RowBox[{"qt", "[", "t", "]"}], ",", 
       RowBox[{"rtE", "[", "t", "]"}], ",", 
       RowBox[{"pit", "[", "t", "]"}], ",", 
       RowBox[{"ctE", "[", "t", "]"}], ",", 
       RowBox[{"btE", "[", "t", "]"}], ",", 
       RowBox[{"kEt", "[", "t", "]"}], ",", 
       RowBox[{"uEt", "[", "t", "]"}], ",", 
       RowBox[{"mEt", "[", "t", "]"}], ",", 
       RowBox[{"LEP", "[", "t", "]"}], ",", 
       RowBox[{"LEI", "[", "t", "]"}]}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Utility", " ", "function", " ", "for", " ", "entrepreneurs"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uEntrepreneur", "[", 
      RowBox[{"ctE_", ",", "ctELag_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Log", "[", "ctE", "]"}], "-", 
      RowBox[{"alpha", " ", 
       RowBox[{"Log", "[", "ctELag", "]"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Production", " ", "function", " ", "for", " ", "entrepreneurs"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yE", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"AE", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"kE", "[", 
          RowBox[{"t", "-", "1"}], "]"}], "^", "alpha"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LEP", "[", "t", "]"}], "+", 
           RowBox[{"LEI", "[", "t", "]"}]}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"1", "-", "alpha"}], ")"}]}]}], ")"}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Utilization", " ", "cost", " ", "function"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FUtil", "[", "u_", "]"}], ":=", 
     RowBox[{
      RowBox[{"xi1", " ", 
       RowBox[{"(", 
        RowBox[{"u", "-", "1"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"xi2", "/", "2"}], ")"}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"u", "-", "1"}], ")"}], "^", "2"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Budget", " ", "constraint", " ", "for", " ", "entrepreneurs", " ", "in", 
     " ", "period", " ", "t"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BCEntrepreneur", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"ctE", "[", "t", "]"}], "+", 
      RowBox[{
       RowBox[{"wpt", "[", "t", "]"}], " ", 
       RowBox[{"LEP", "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"wip", "[", "t", "]"}], " ", 
       RowBox[{"LEI", "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"rtE", "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ")"}], "/", 
         RowBox[{"pit", "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"btE", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"qt", "[", "t", "]"}], " ", 
       RowBox[{"kEt", "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"FUtil", "[", 
        RowBox[{"uEt", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"kEt", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], "-", 
      RowBox[{"yE", "[", "t", "]"}], "-", 
      RowBox[{"btE", "[", "t", "]"}], "-", 
      RowBox[{
       RowBox[{"qt", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "delta"}], ")"}], " ", 
       RowBox[{"kEt", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Borrowing", " ", "constraint", " ", "for", " ", "entrepreneurs", " ", 
     "in", " ", "period", " ", "t"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BorrowingConstraint", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"rtE", "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"btE", "[", "t", "]"}]}], "-", 
      RowBox[{
       RowBox[{"Mt", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"qt", "[", 
          RowBox[{"t", "+", "1"}], "]"}], " ", 
         RowBox[{"pit", "[", 
          RowBox[{"t", "+", "1"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "delta"}], ")"}], " ", 
         RowBox[{"kEt", "[", "t", "]"}]}], ")"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "Lagrangian", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LE", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"betaE", "^", "t"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"uEntrepreneur", "[", 
          RowBox[{
           RowBox[{"ctE", "[", "t", "]"}], ",", 
           RowBox[{"ctE", "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], "]"}], "+", 
         RowBox[{
          RowBox[{"lambdaE", "[", "t", "]"}], " ", 
          RowBox[{"BCEntrepreneur", "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"muE", "[", "t", "]"}], " ", 
          RowBox[{"BorrowingConstraint", "[", "t", "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"betaE", "^", 
        RowBox[{"(", 
         RowBox[{"t", "+", "1"}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"uEntrepreneur", "[", 
          RowBox[{
           RowBox[{"ctE", "[", 
            RowBox[{"t", "+", "1"}], "]"}], ",", 
           RowBox[{"ctE", "[", "t", "]"}]}], "]"}], "+", 
         RowBox[{
          RowBox[{"lambdaE", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"BCEntrepreneur", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"muE", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"BorrowingConstraint", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}]}], ")"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"First", "-", 
     RowBox[{"order", " ", "conditions", " ", "for", " ", "entrepreneurs"}]}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focCtE", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LE", ",", 
        RowBox[{"ctE", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "consumption", " ", 
     RowBox[{"ctE", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focKEt", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LE", ",", 
        RowBox[{"kEt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "capital", " ", 
     RowBox[{"kEt", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focBtE", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LE", ",", 
        RowBox[{"btE", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "borrowing", " ", 
     RowBox[{"btE", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focUEt", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LE", ",", 
        RowBox[{"uEt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "utilization", " ", 
     RowBox[{"uEt", "[", "t", "]"}]}], "*)"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Display", " ", "results"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"debugFOCs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<FOC wrt ctE[t]\>\"", "->", "focCtE"}], ",", 
       RowBox[{"\"\<FOC wrt kEt[t]\>\"", "->", "focKEt"}], ",", 
       RowBox[{"\"\<FOC wrt btE[t]\>\"", "->", "focBtE"}], ",", 
       RowBox[{"\"\<FOC wrt uEt[t]\>\"", "->", "focUEt"}]}], "}"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Output", " ", "the", " ", "Lagrangian"}], ",", "FOCs"}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Lagrangian\>\"", "->", "LE"}], ",", 
     RowBox[{"\"\<First-Order Conditions\>\"", "->", "debugFOCs"}]}], "}"}], 
   "\n"}]}]], "Input",
 CellChangeTimes->{
  3.942592057012724*^9, {3.942592245428005*^9, 3.94259229837319*^9}, {
   3.94259276149564*^9, 3.942592764239746*^9}, {3.9425935259046726`*^9, 
   3.942593548727476*^9}, 3.9425936374098434`*^9, {3.942594582938095*^9, 
   3.942594602603157*^9}, 3.9425946466589737`*^9, {3.9425949113557167`*^9, 
   3.9425949911134377`*^9}, 3.942595094281233*^9, {3.942595174682337*^9, 
   3.942595279071537*^9}, 3.942595447132061*^9, {3.9425956151379395`*^9, 
   3.94259563994841*^9}, 3.942595669960287*^9, {3.9425959508937435`*^9, 
   3.9425959719109993`*^9}, 3.9427690351333847`*^9, 3.9427690682198257`*^9, 
   3.9427715635525856`*^9, 3.9428545977365494`*^9, 3.9430291244111385`*^9, {
   3.9430293293032436`*^9, 3.9430293321251163`*^9}, 3.943029903411661*^9, 
   3.943029935968582*^9, {3.9430300915187435`*^9, 3.9430300983569183`*^9}, 
   3.943030165224594*^9, 3.943031018565777*^9, 3.9430310525436935`*^9, 
   3.9430315909590073`*^9, {3.943031676607229*^9, 3.943031762295637*^9}, {
   3.943032046234873*^9, 3.94303207506736*^9}, {3.943032277998928*^9, 
   3.943032328893503*^9}, 3.9430323609657345`*^9, {3.9430338379985332`*^9, 
   3.9430338777026024`*^9}, {3.9430340737475815`*^9, 3.9430340995907764`*^9}, 
   3.943034138748911*^9, 3.943034215671747*^9, 3.9430955097704773`*^9, 
   3.9433588087017574`*^9, 3.9433588506085987`*^9, 3.9433604537355385`*^9, 
   3.9433690498361454`*^9, {3.943369097716297*^9, 3.9433691157514877`*^9}, {
   3.9433691779950886`*^9, 3.9433691920949574`*^9}, {3.943369408544922*^9, 
   3.943369419957775*^9}, {3.9433694534026623`*^9, 3.9433694610976887`*^9}, {
   3.9433718095535316`*^9, 3.9433718209741173`*^9}, {3.943371942155674*^9, 
   3.943371948822159*^9}, {3.943372132182953*^9, 3.9433721356424065`*^9}, {
   3.9433723369107685`*^9, 3.9433723433940105`*^9}, {3.9433725200260067`*^9, 
   3.943372539188036*^9}, 3.9433729214440956`*^9, 3.946134979625437*^9, {
   3.946135028668358*^9, 3.9461350308236866`*^9}, {3.946380295211197*^9, 
   3.946380296539772*^9}, {3.94640043978706*^9, 3.946400483226412*^9}, 
   3.9464023612987766`*^9, {3.9464025415333214`*^9, 3.9464025643481045`*^9}, {
   3.9464031878470516`*^9, 3.946403191088213*^9}, {3.9464034240072136`*^9, 
   3.9464034490416183`*^9}},
 CellLabel->
  "In[367]:=",ExpressionUUID->"5b2a032a-505e-c740-a415-a5a50f903e5d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"Lagrangian\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{
      SuperscriptBox["betaE", "t"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "alpha"}], " ", 
         RowBox[{"Log", "[", 
          RowBox[{"ctE", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}], "]"}]}], "+", 
        RowBox[{"Log", "[", 
         RowBox[{"ctE", "[", "t", "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"muE", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "delta"}], ")"}], " ", 
              RowBox[{"kEt", "[", "t", "]"}], " ", 
              RowBox[{"Mt", "[", "t", "]"}], " ", 
              RowBox[{"pit", "[", 
               RowBox[{"1", "+", "t"}], "]"}], " ", 
              RowBox[{"qt", "[", 
               RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"btE", "[", "t", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"lambdaE", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"btE", "[", "t", "]"}]}], "+", 
           RowBox[{"ctE", "[", "t", "]"}], "-", 
           RowBox[{
            RowBox[{"AE", "[", "t", "]"}], " ", 
            SuperscriptBox[
             RowBox[{"kE", "[", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "t"}], "]"}], "alpha"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"LEI", "[", "t", "]"}], "+", 
               RowBox[{"LEP", "[", "t", "]"}]}], ")"}], 
             RowBox[{"1", "-", "alpha"}]]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "delta"}], ")"}], " ", 
            RowBox[{"kEt", "[", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
            RowBox[{"qt", "[", "t", "]"}]}], "+", 
           RowBox[{
            RowBox[{"kEt", "[", "t", "]"}], " ", 
            RowBox[{"qt", "[", "t", "]"}]}], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"btE", "[", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rtE", "[", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "t"}], "]"}]}], ")"}]}], 
            RowBox[{"pit", "[", "t", "]"}]], "+", 
           RowBox[{
            RowBox[{"kEt", "[", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xi1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"uEt", "[", "t", "]"}]}], ")"}]}], "+", 
              RowBox[{
               FractionBox["1", "2"], " ", "xi2", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"uEt", "[", "t", "]"}]}], ")"}], "2"]}]}], ")"}]}], 
           "+", 
           RowBox[{
            RowBox[{"LEI", "[", "t", "]"}], " ", 
            RowBox[{"wip", "[", "t", "]"}]}], "+", 
           RowBox[{
            RowBox[{"LEP", "[", "t", "]"}], " ", 
            RowBox[{"wpt", "[", "t", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["betaE", 
       RowBox[{"1", "+", "t"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "alpha"}], " ", 
         RowBox[{"Log", "[", 
          RowBox[{"ctE", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"Log", "[", 
         RowBox[{"ctE", "[", 
          RowBox[{"1", "+", "t"}], "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"muE", "[", 
          RowBox[{"1", "+", "t"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "delta"}], ")"}], " ", 
              RowBox[{"kEt", "[", 
               RowBox[{"1", "+", "t"}], "]"}], " ", 
              RowBox[{"Mt", "[", 
               RowBox[{"1", "+", "t"}], "]"}], " ", 
              RowBox[{"pit", "[", 
               RowBox[{"2", "+", "t"}], "]"}], " ", 
              RowBox[{"qt", "[", 
               RowBox[{"2", "+", "t"}], "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"btE", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rtE", "[", 
               RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"lambdaE", "[", 
          RowBox[{"1", "+", "t"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"btE", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], "+", 
           RowBox[{"ctE", "[", 
            RowBox[{"1", "+", "t"}], "]"}], "-", 
           RowBox[{
            RowBox[{"AE", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"kE", "[", "t", "]"}], "alpha"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"LEI", "[", 
                RowBox[{"1", "+", "t"}], "]"}], "+", 
               RowBox[{"LEP", "[", 
                RowBox[{"1", "+", "t"}], "]"}]}], ")"}], 
             RowBox[{"1", "-", "alpha"}]]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "delta"}], ")"}], " ", 
            RowBox[{"kEt", "[", "t", "]"}], " ", 
            RowBox[{"qt", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"kEt", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"qt", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"btE", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}], 
            RowBox[{"pit", "[", 
             RowBox[{"1", "+", "t"}], "]"}]], "+", 
           RowBox[{
            RowBox[{"kEt", "[", "t", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xi1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"uEt", "[", 
                  RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
              RowBox[{
               FractionBox["1", "2"], " ", "xi2", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"uEt", "[", 
                   RowBox[{"1", "+", "t"}], "]"}]}], ")"}], "2"]}]}], ")"}]}],
            "+", 
           RowBox[{
            RowBox[{"LEI", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"wip", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"LEP", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"wpt", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{"\<\"First-Order Conditions\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\<\"FOC wrt ctE[t]\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"alpha", " ", 
            SuperscriptBox["betaE", 
             RowBox[{"1", "+", "t"}]]}], 
           RowBox[{"ctE", "[", "t", "]"}]]}], "+", 
         RowBox[{
          SuperscriptBox["betaE", "t"], " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"ctE", "[", "t", "]"}]], "+", 
            RowBox[{"lambdaE", "[", "t", "]"}]}], ")"}]}]}], "\[Equal]", 
        "0"}]}], ",", 
      RowBox[{"\<\"FOC wrt kEt[t]\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox["betaE", "t"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"lambdaE", "[", "t", "]"}], " ", 
             RowBox[{"qt", "[", "t", "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "delta"}], ")"}], " ", 
             RowBox[{"Mt", "[", "t", "]"}], " ", 
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"pit", "[", 
              RowBox[{"1", "+", "t"}], "]"}], " ", 
             RowBox[{"qt", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["betaE", 
           RowBox[{"1", "+", "t"}]], " ", 
          RowBox[{"lambdaE", "[", 
           RowBox[{"1", "+", "t"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "delta"}], ")"}], " ", 
               RowBox[{"qt", "[", 
                RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
            RowBox[{"xi1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"uEt", "[", 
                RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             FractionBox["1", "2"], " ", "xi2", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"uEt", "[", 
                 RowBox[{"1", "+", "t"}], "]"}]}], ")"}], "2"]}]}], ")"}]}]}],
         "\[Equal]", "0"}]}], ",", 
      RowBox[{"\<\"FOC wrt btE[t]\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox["betaE", 
            RowBox[{"1", "+", "t"}]], " ", 
           RowBox[{"lambdaE", "[", 
            RowBox[{"1", "+", "t"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}], 
          RowBox[{"pit", "[", 
           RowBox[{"1", "+", "t"}], "]"}]], "+", 
         RowBox[{
          SuperscriptBox["betaE", "t"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"lambdaE", "[", "t", "]"}]}], "+", 
            RowBox[{
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}], 
        "\[Equal]", "0"}]}], ",", 
      RowBox[{"\<\"FOC wrt uEt[t]\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{
         SuperscriptBox["betaE", "t"], " ", 
         RowBox[{"kEt", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
         RowBox[{"lambdaE", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"xi1", "+", 
           RowBox[{"xi2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"uEt", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], 
        "\[Equal]", "0"}]}]}], "}"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.946402936833193*^9, 3.9464030403198147`*^9, 
  3.9464031150683193`*^9, 3.946403196496645*^9, 3.946403369853876*^9, 
  3.9464034552608624`*^9},
 CellLabel->
  "Out[380]=",ExpressionUUID->"bc7320d9-b60f-0948-9470-cea64c1d3abb"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9464031981481724`*^9, 
  3.9464032115819416`*^9}},ExpressionUUID->"4129f409-7408-7d45-9299-\
8b83db08acfc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Definisikan", " ", "FOC", " ", "wrt", " ", 
    RowBox[{"c_t", "^", "E"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"eq1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"alpha", " ", 
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}]}], ")"}], "/", 
          RowBox[{"ctE", "[", "t", "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"betaE", "^", "t"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"ctE", "[", "t", "]"}]}], "+", 
          RowBox[{"lambdaE", "[", "t", "]"}]}], ")"}]}]}], "==", "0"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"1", ")"}], " ", "Pecahkan", " ", "eq1", " ", "untuk", " ", 
     RowBox[{"lambdaE", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"solLambda", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"eq1", ",", 
       RowBox[{"lambdaE", "[", "t", "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Hasilnya", " ", "memberi", " ", 
      RowBox[{"lambdaE", "[", "t", "]"}], " ", "dalam", " ", "fungsi", " ", 
      "alpha"}], ",", "betaE", ",", 
     RowBox[{"dan", " ", 
      RowBox[{"ctE", "[", "t", "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Misal", " ", "Anda", " ", "punya", " ", "FOC"}], "-", 
     RowBox[{
     "FOC", " ", "lain", " ", "sebagai", " ", "daftar", " ", "persamaan", " ", 
      RowBox[{"(", 
       RowBox[{"sesuaikan", " ", "sendiri"}], ")"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focSystem", "=", 
     RowBox[{"{", 
      RowBox[{"(*", 
       RowBox[{"FOC", " ", "wrt", " ", 
        RowBox[{"kE", "[", "t", "]"}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"lambdaE", "[", "t", "]"}], " ", 
             RowBox[{"qt", "[", "t", "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "delta"}], ")"}], " ", 
             RowBox[{"Mt", "[", "t", "]"}], " ", 
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"pit", "[", 
              RowBox[{"1", "+", "t"}], "]"}], " ", 
             RowBox[{"qt", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"betaE", "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "t"}], ")"}]}], " ", 
          RowBox[{"lambdaE", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "delta"}], ")"}], " ", 
               RowBox[{"qt", "[", 
                RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}], "+", 
            RowBox[{"xi1", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"uEt", "[", 
                RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], " ", "xi2", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"uEt", "[", 
                 RowBox[{"t", "+", "1"}], "]"}]}], ")"}], "^", "2"}]}]}], 
           ")"}]}]}], "==", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"bE", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}], " ", 
            RowBox[{"lambdaE", "[", 
             RowBox[{"t", "+", "1"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"pit", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"lambdaE", "[", "t", "]"}]}], "+", 
            RowBox[{
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}], "==", 
        "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"uE", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"betaE", "^", "t"}], " ", 
         RowBox[{"kEt", "[", 
          RowBox[{"t", "-", "1"}], "]"}], " ", 
         RowBox[{"lambdaE", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"xi1", "+", 
           RowBox[{"xi2", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"uEt", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], "==", 
        "0"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"2", ")"}], " ", "Gunakan", " ", "identitas", " ", "waktu"}], 
     ",", 
     RowBox[{
      RowBox[{"misal", " ", 
       RowBox[{"lambdaE", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], "=", 
      RowBox[{
       RowBox[{"lambdaE", "[", 
        RowBox[{"t", "+", "1"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"didapat", " ", "dengan", " ", "mengganti", " ", "t"}], "->", 
          RowBox[{"t", "+", 
           RowBox[{"1", " ", "di", " ", "solLambda"}]}]}], ",", 
         RowBox[{"dsb", "."}]}], ")"}]}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"lambdaNext", "=", 
     RowBox[{"solLambda", "/.", " ", 
      RowBox[{"t", "->", 
       RowBox[{"t", "+", "1"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"3", ")"}], " ", "Substitusikan", " ", "solusi", " ", "ke", " ", 
     "sistem", " ", "FOC"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focSystemSub", "=", 
     RowBox[{
      RowBox[{"focSystem", "/.", " ", 
       RowBox[{"solLambda", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "/.", " ", 
      RowBox[{"lambdaNext", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Selanjutnya", ",", 
     RowBox[{
     "Anda", " ", "bisa", " ", "gunakan", " ", "Solve", " ", "atau", " ", 
      "NSolve", " ", "untuk", " ", "menyelesaikan", " ", "sistem", " ", 
      "lengkap"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"solution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"focSystemSub", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"lambdaE", "[", "t", "]"}], ",", 
         RowBox[{"muE", "[", "t", "]"}]}], 
        RowBox[{"(*", 
         RowBox[{
         "variabel", " ", "lain", " ", "yang", " ", "ingin", " ", 
          "dipecahkan"}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{"dsb", "."}], "*)"}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Definisikan", " ", "FOC", " ", "wrt", " ", 
     RowBox[{"c_t", "^", "E"}]}], "*)"}], 
   RowBox[{
    RowBox[{"eq1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"alpha", " ", 
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}]}], ")"}], "/", 
          RowBox[{"ctE", "[", "t", "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"betaE", "^", "t"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"ctE", "[", "t", "]"}]}], "+", 
          RowBox[{"lambdaE", "[", "t", "]"}]}], ")"}]}]}], "==", "0"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"1", ")"}], " ", "Pecahkan", " ", "eq1", " ", "untuk", " ", 
     RowBox[{"lambdaE", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"solLambda", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"eq1", ",", 
       RowBox[{"lambdaE", "[", "t", "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Hasilnya", " ", "memberi", " ", 
      RowBox[{"lambdaE", "[", "t", "]"}], " ", "dalam", " ", "fungsi", " ", 
      "alpha"}], ",", "betaE", ",", 
     RowBox[{"dan", " ", 
      RowBox[{"ctE", "[", "t", "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Misal", " ", "Anda", " ", "punya", " ", "FOC"}], "-", 
     RowBox[{
     "FOC", " ", "lain", " ", "sebagai", " ", "daftar", " ", "persamaan", " ", 
      RowBox[{"(", 
       RowBox[{"sesuaikan", " ", "sendiri"}], ")"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focSystem", "=", 
     RowBox[{"{", 
      RowBox[{"(*", 
       RowBox[{"FOC", " ", "wrt", " ", 
        RowBox[{"kE", "[", "t", "]"}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"lambdaE", "[", "t", "]"}], " ", 
             RowBox[{"qt", "[", "t", "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "delta"}], ")"}], " ", 
             RowBox[{"Mt", "[", "t", "]"}], " ", 
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"pit", "[", 
              RowBox[{"1", "+", "t"}], "]"}], " ", 
             RowBox[{"qt", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"betaE", "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "t"}], ")"}]}], " ", 
          RowBox[{"lambdaE", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "delta"}], ")"}], " ", 
               RowBox[{"qt", "[", 
                RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}], "+", 
            RowBox[{"xi1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"uEt", "[", 
                RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], " ", "xi2", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"uEt", "[", 
                 RowBox[{"t", "+", "1"}], "]"}]}], ")"}], "^", "2"}]}]}], 
           ")"}]}]}], "==", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"bE", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}], " ", 
            RowBox[{"lambdaE", "[", 
             RowBox[{"t", "+", "1"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"pit", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"lambdaE", "[", "t", "]"}]}], "+", 
            RowBox[{
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}], "==", 
        "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"uE", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"betaE", "^", "t"}], " ", 
         RowBox[{"kEt", "[", 
          RowBox[{"t", "-", "1"}], "]"}], " ", 
         RowBox[{"lambdaE", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"xi1", "+", 
           RowBox[{"xi2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"uEt", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], "==", 
        "0"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"2", ")"}], " ", "Gunakan", " ", "identitas", " ", "waktu"}], 
     ",", 
     RowBox[{
      RowBox[{"misal", " ", 
       RowBox[{"lambdaE", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], "=", 
      RowBox[{
       RowBox[{"lambdaE", "[", 
        RowBox[{"t", "+", "1"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"didapat", " ", "dengan", " ", "mengganti", " ", "t"}], "->", 
          RowBox[{"t", "+", 
           RowBox[{"1", " ", "di", " ", "solLambda"}]}]}], ",", 
         RowBox[{"dsb", "."}]}], ")"}]}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"lambdaNext", "=", 
     RowBox[{"solLambda", "/.", " ", 
      RowBox[{"t", "->", 
       RowBox[{"t", "+", "1"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"3", ")"}], " ", "Substitusikan", " ", "solusi", " ", "ke", " ", 
     "sistem", " ", "FOC"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focSystemSub", "=", 
     RowBox[{
      RowBox[{"focSystem", "/.", " ", 
       RowBox[{"solLambda", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "/.", " ", 
      RowBox[{"lambdaNext", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Cetak", " ", "sistem", " ", "persamaan", " ", "yang", " ", "baru"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<Sistem persamaan setelah substitusi: \>\"", ",", "focSystemSub"}], 
     "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Selanjutnya", ",", 
     RowBox[{
     "Anda", " ", "bisa", " ", "gunakan", " ", "Solve", " ", "atau", " ", 
      "NSolve", " ", "untuk", " ", "menyelesaikan", " ", "sistem", " ", 
      "lengkap"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"solution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"focSystemSub", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"lambdaE", "[", "t", "]"}], ",", 
         RowBox[{"muE", "[", "t", "]"}]}], 
        RowBox[{"(*", 
         RowBox[{
         "variabel", " ", "lain", " ", "yang", " ", "ingin", " ", 
          "dipecahkan"}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{"dsb", "."}], "*)"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.946139816861929*^9, 3.9461398521181507`*^9, {3.946140256790245*^9, 
   3.9461402839309597`*^9}, {3.9461405343897038`*^9, 3.9461405627286797`*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"e52c92a4-2eb6-c645-94b2-60c371363739"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{
  3.942511329185976*^9, 3.942511423550762*^9, 3.942591573184946*^9, {
   3.9425916035900593`*^9, 3.942591633542879*^9}, {3.9425918643458405`*^9, 
   3.9425918709932823`*^9}, 3.9430982526884403`*^9, {3.943106042988516*^9, 
   3.943106076844755*^9}, {3.943108704823662*^9, 3.9431087103972626`*^9}, {
   3.943358560356596*^9, 3.943358583894329*^9}, 3.943358615914463*^9, 
   3.9433587817943974`*^9, 3.943368571775612*^9, {3.9433686889968395`*^9, 
   3.943368716318613*^9}, 
   3.943368758918228*^9},ExpressionUUID->"f19b7f51-99bd-4547-9650-\
5ff8e4c33086"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Sistem", " ", "persamaan", " ", "setelah", " ", "substitusi"}], 
   "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"focSystemSub", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
               RowBox[{"qt", "[", "t", "]"}]}], ")"}], "/", 
             RowBox[{"ctE", "[", "t", "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "delta"}], ")"}], " ", 
             RowBox[{"Mt", "[", "t", "]"}], " ", 
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"pit", "[", 
              RowBox[{"1", "+", "t"}], "]"}], " ", 
             RowBox[{"qt", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "delta"}], ")"}], " ", 
                 RowBox[{"qt", "[", 
                  RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
              RowBox[{"xi1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"uEt", "[", 
                  RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"1", "/", "2"}], " ", "xi2", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"uEt", "[", 
                   RowBox[{"1", "+", "t"}], "]"}]}], ")"}], "^", "2"}]}]}], 
             ")"}]}], ")"}], "/", 
          RowBox[{"ctE", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}]}], "==", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ctE", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"pit", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"alpha", " ", "betaE"}]}], ")"}], "/", 
               RowBox[{"ctE", "[", "t", "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}], "==", 
        "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"betaE", "^", "t"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
           RowBox[{"kEt", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"xi1", "+", 
             RowBox[{"xi2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"uEt", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], ")"}], 
         "/", 
         RowBox[{"ctE", "[", "t", "]"}]}], "==", "0"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Pecahkan", " ", "persamaan", " ", "kedua", " ", "untuk", " ", 
     RowBox[{"muE", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"muESolution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"focSystemSub", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"muE", "[", "t", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Substitusikan", " ", "hasil", " ", 
     RowBox[{"muE", "[", "t", "]"}], " ", "ke", " ", "persamaan", " ", 
     "pertama"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"eq1Sub", "=", 
     RowBox[{
      RowBox[{"focSystemSub", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/.", " ", 
      RowBox[{"muESolution", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Tambahkan", " ", "persamaan", " ", "ketiga", " ", "ke", " ", "output"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"eq3", "=", 
     RowBox[{"focSystemSub", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Cetak", " ", "hasil"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<Persamaan pertama setelah eliminasi muE[t]: \>\"", ",", "eq1Sub"}], 
     "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Persamaan ketiga tetap: \>\"", ",", "eq3"}], "]"}], ";"}], 
   "\n", "\n", "\n"}]}]], "Input",
 CellChangeTimes->{{3.942508348357641*^9, 3.9425083483586407`*^9}, 
   3.9425104770787735`*^9, 3.946140941609421*^9, {3.9461411946531467`*^9, 
   3.9461412087808075`*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"e2c58ebf-4fbc-3d4b-ac91-cf15352134a5"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.942508439620474*^9, 
  3.942508439622467*^9}},ExpressionUUID->"4126ecf3-b2bc-c34e-b9ce-\
ab3dbe467b58"],

Cell[BoxData[
 RowBox[{"\n", "\n"}]], "Input",
 CellChangeTimes->{
  3.9427542379518967`*^9, {3.9427544965523434`*^9, 
   3.9427545632885056`*^9}},ExpressionUUID->"a5650fd1-18d4-1d4e-89f1-\
7b4f1f908005"],

Cell[BoxData[""], "Input",ExpressionUUID->"ad54bf90-5079-e447-887e-2c9f31b492f1"],

Cell[BoxData[
 RowBox[{"\n", "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.9427549950755463`*^9, 3.942754995076544*^9}, {
   3.942856797987402*^9, 3.942856829082693*^9}, 3.943370342061611*^9, {
   3.943370944682108*^9, 
   3.9433709631648884`*^9}},ExpressionUUID->"8331c5f9-92bc-9347-8078-\
669c615e9f37"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.942754716102133*^9},
 CellLabel->"",ExpressionUUID->"283b5187-a2f1-ef49-b5fd-690301eeecfb"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.9424252546658554`*^9, 
  3.942508294844681*^9},ExpressionUUID->"79788ce8-4cec-0840-aa08-\
3875ff1d3e80"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9425082690938396`*^9, 
  3.942508282245655*^9}},ExpressionUUID->"f0ade162-6b1f-0f48-a2c9-\
2be142b63af0"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{3.9424252827947807`*^9, 
  3.9424879659349766`*^9},ExpressionUUID->"52999333-fe05-e84a-acf1-\
fc22be5bf2ea"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.942508401042242*^9, 
  3.942508401044237*^9}},ExpressionUUID->"e44d3794-52ef-d540-95ab-\
731b5a7762cd"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.942425871529419*^9, 3.942426101584881*^9, 
  3.9424261402649555`*^9},ExpressionUUID->"28629b7d-e028-5846-af8b-\
9f2b85a1dc47"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.942508459698223*^9},
 NumberMarks->False,ExpressionUUID->"e55264a3-3c28-884f-aa83-8e502c7364cc"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9425084730478153`*^9, 
  3.942508473048811*^9}},ExpressionUUID->"53dfc11f-fccd-cd48-934d-\
0bdae6dc2306"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.942508490141901*^9},
 NumberMarks->False,ExpressionUUID->"4872fec1-2e2d-8f47-88e7-ab3bbb9b5585"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.942508502797901*^9, 
  3.9425085027990284`*^9}},ExpressionUUID->"4cec27a2-cefe-5d4d-80b5-\
b6621fdb0cf4"],

Cell[BoxData[""], "Input",ExpressionUUID->"7ac59aaa-0927-bb4e-a803-639587cde41b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9424200456002064`*^9, 3.942420045601204*^9}, 
   3.9424203234497356`*^9},ExpressionUUID->"924a110a-67bc-4749-9189-\
169660317c54"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9425082473900776`*^9, 
  3.9425082473911057`*^9}},ExpressionUUID->"65b3d420-0425-f249-80e5-\
5dc6a13ce3c4"],

Cell[BoxData[""], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"c41eee93-8b45-4c47-8d30-e7d8dc6d4ab1"],

Cell[BoxData[""], "Input",ExpressionUUID->"4b97082b-f52c-d940-8b60-cf5f1725bfda"]
},
WindowSize->{1380.75, 765.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.1 for Microsoft Windows (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"cbc78bb6-c411-c243-8fb9-e034a4f1496b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 5081, 70, 47, "Input",ExpressionUUID->"f9fb2cec-0218-1946-a7a4-614cfc63c79f"],
Cell[5638, 92, 81, 0, 28, "Input",ExpressionUUID->"93063096-b854-5642-83fe-da57c1f294a1"],
Cell[5722, 94, 81, 0, 28, "Input",ExpressionUUID->"0708fca9-59ce-8847-af89-18fc69779938"],
Cell[CellGroupData[{
Cell[5828, 98, 7204, 202, 522, "Input",ExpressionUUID->"9ace75de-4978-4347-8abf-940e21a736de"],
Cell[CellGroupData[{
Cell[13057, 304, 3166, 88, 84, "Print",ExpressionUUID->"3dd3e17b-7b29-3d40-970d-7f04b4476b62"],
Cell[16226, 394, 3140, 87, 84, "Print",ExpressionUUID->"bd798fe7-18dc-194b-9c9c-5302cebc1728"],
Cell[19369, 483, 306, 7, 22, "Print",ExpressionUUID->"7e77d44f-dd6b-6740-a667-bc7cfc0472a9"],
Cell[19678, 492, 409, 9, 92, "Print",ExpressionUUID->"2d9b71e8-1d9f-a94c-a988-7eb8c83edf27"]
}, Open  ]]
}, Open  ]],
Cell[20114, 505, 10281, 277, 408, "Input",ExpressionUUID->"b7a511ea-a296-6f41-a45a-13f2bb0b1e10"],
Cell[30398, 784, 228, 5, 28, "Input",ExpressionUUID->"483b27fc-4b8e-9c46-8db4-040fdf9ca070"],
Cell[CellGroupData[{
Cell[30651, 793, 10164, 247, 541, "Input",ExpressionUUID->"94fcf45b-6f21-634c-b1d5-7d0ae8a5c58d"],
Cell[40818, 1042, 7896, 223, 305, "Output",ExpressionUUID->"03f759ac-a224-7c42-8a72-d212d0c339e1"]
}, Open  ]],
Cell[48729, 1268, 81, 0, 28, "Input",ExpressionUUID->"b9ef39e2-d105-c74c-ae1b-589fe4deab77"],
Cell[48813, 1270, 379, 7, 104, "Input",ExpressionUUID->"8880107c-6260-f84b-9c38-4d69438e0d38"],
Cell[CellGroupData[{
Cell[49217, 1281, 9988, 244, 751, "Input",ExpressionUUID->"b0b5f86b-cc2e-e04d-b2ed-4360d9e5fb4f"],
Cell[CellGroupData[{
Cell[59230, 1529, 5258, 126, 85, "Print",ExpressionUUID->"73d20644-dbb9-484d-b64c-372187a53b60"],
Cell[64491, 1657, 4123, 99, 75, "Print",ExpressionUUID->"ed7f8dd5-1b8a-1847-b409-46d2e0de89e7"],
Cell[68617, 1758, 1170, 29, 42, "Print",ExpressionUUID->"62c8d3d6-9211-164c-add7-9c65ad68efa0"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[69836, 1793, 11149, 279, 770, "Input",ExpressionUUID->"5b2a032a-505e-c740-a415-a5a50f903e5d"],
Cell[80988, 2074, 11840, 324, 427, "Output",ExpressionUUID->"bc7320d9-b60f-0948-9470-cea64c1d3abb"]
}, Open  ]],
Cell[92843, 2401, 156, 3, 28, "Input",ExpressionUUID->"4129f409-7408-7d45-9299-8b83db08acfc"],
Cell[93002, 2406, 15677, 438, 1036, "Input",ExpressionUUID->"e52c92a4-2eb6-c645-94b2-60c371363739"],
Cell[108682, 2846, 602, 10, 47, "Input",ExpressionUUID->"f19b7f51-99bd-4547-9650-5ff8e4c33086"],
Cell[109287, 2858, 6383, 178, 427, "Input",ExpressionUUID->"e2c58ebf-4fbc-3d4b-ac91-cf15352134a5"],
Cell[115673, 3038, 152, 3, 28, "Input",ExpressionUUID->"4126ecf3-b2bc-c34e-b9ce-ab3dbe467b58"],
Cell[115828, 3043, 204, 5, 66, "Input",ExpressionUUID->"a5650fd1-18d4-1d4e-89f1-7b4f1f908005"],
Cell[116035, 3050, 81, 0, 28, "Input",ExpressionUUID->"ad54bf90-5079-e447-887e-2c9f31b492f1"],
Cell[116119, 3052, 339, 6, 85, "Input",ExpressionUUID->"8331c5f9-92bc-9347-8078-669c615e9f37"],
Cell[116461, 3060, 139, 2, 28, "Input",ExpressionUUID->"283b5187-a2f1-ef49-b5fd-690301eeecfb"],
Cell[116603, 3064, 152, 3, 28, "Input",ExpressionUUID->"79788ce8-4cec-0840-aa08-3875ff1d3e80"],
Cell[116758, 3069, 154, 3, 28, "Input",ExpressionUUID->"f0ade162-6b1f-0f48-a2c9-2be142b63af0"],
Cell[116915, 3074, 156, 3, 47, "Input",ExpressionUUID->"52999333-fe05-e84a-acf1-fc22be5bf2ea"],
Cell[117074, 3079, 152, 3, 28, "Input",ExpressionUUID->"e44d3794-52ef-d540-95ab-731b5a7762cd"],
Cell[117229, 3084, 174, 3, 28, "Input",ExpressionUUID->"28629b7d-e028-5846-af8b-9f2b85a1dc47"],
Cell[117406, 3089, 144, 2, 28, "Input",ExpressionUUID->"e55264a3-3c28-884f-aa83-8e502c7364cc"],
Cell[117553, 3093, 154, 3, 28, "Input",ExpressionUUID->"53dfc11f-fccd-cd48-934d-0bdae6dc2306"],
Cell[117710, 3098, 144, 2, 28, "Input",ExpressionUUID->"4872fec1-2e2d-8f47-88e7-ab3bbb9b5585"],
Cell[117857, 3102, 154, 3, 28, "Input",ExpressionUUID->"4cec27a2-cefe-5d4d-80b5-b6621fdb0cf4"],
Cell[118014, 3107, 81, 0, 28, "Input",ExpressionUUID->"7ac59aaa-0927-bb4e-a803-639587cde41b"],
Cell[118098, 3109, 179, 3, 28, "Input",ExpressionUUID->"924a110a-67bc-4749-9189-169660317c54"],
Cell[118280, 3114, 156, 3, 28, "Input",ExpressionUUID->"65b3d420-0425-f249-80e5-5dc6a13ce3c4"],
Cell[118439, 3119, 104, 1, 28, "Input",ExpressionUUID->"c41eee93-8b45-4c47-8d30-e7d8dc6d4ab1"],
Cell[118546, 3122, 81, 0, 28, "Input",ExpressionUUID->"4b97082b-f52c-d940-8b60-cf5f1725bfda"]
}
]
*)

