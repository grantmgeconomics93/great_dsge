(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    376006,       9888]
NotebookOptionsPosition[    362642,       9713]
NotebookOutlinePosition[    363094,       9730]
CellTagsIndexPosition[    363051,       9727]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Declare", " ", "parameters", " ", "and", " ", "static", " ", 
      RowBox[{"variables", ".", "Here"}]}], ",", "betaP", ",", "a", ",", 
     "xiP", ",", "epsilonP", ",", "phi", ",", "qh", ",", "wt", ",", "rt", ",", 
     RowBox[{"and", " ", "pit", " ", "are", " ", "parameters"}], ",", 
     RowBox[{"while", " ", "cp"}], ",", "hp", ",", "dp", ",", 
     RowBox[{
     "and", " ", "lambdaP", " ", "are", " ", "the", " ", "unknown", " ", 
      "steady"}], "\[Hyphen]", 
     RowBox[{"state", " ", 
      RowBox[{"values", ".", 
       RowBox[{"(", 
        RowBox[{
        "Assign", " ", "numerical", " ", "values", " ", "to", " ", "the", " ",
          "parameters", " ", "as", " ", 
         RowBox[{"needed", "."}]}], ")"}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Static", " ", "Utility", " ", "Function", " ", "for", " ", "Patient", " ",
      "Households"}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"In", " ", "steady", " ", "state"}], ",", 
     RowBox[{
      RowBox[{"cp", "[", "t", "]"}], "=", "cp"}], ",", 
     RowBox[{"so", " ", 
      RowBox[{"(", 
       RowBox[{"cp", "-", 
        RowBox[{"a", " ", "cp"}]}], ")"}], " ", "becomes", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "a"}], ")"}], "*", "cp"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Static", " ", "Utility", " ", "Function", " ", "for", " ", "Patient", " ",
      "Households"}], "*)"}], 
   RowBox[{
    RowBox[{
     RowBox[{"uPatientStatic", "[", 
      RowBox[{"cp_", ",", "hp_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"\[Alpha]", "^", "P"}]}], ")"}], " ", 
       RowBox[{"\[Xi]", "^", "P"}], " ", 
       RowBox[{"Log", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"\[Alpha]", "^", "P"}]}], ")"}], " ", "cp"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"\[Epsilon]", "^", "P"}], " ", 
       RowBox[{"Log", "[", "hp", "]"}]}], "-", 
      RowBox[{
       RowBox[{"hp", "^", 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Phi]"}], ")"}]}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Phi]"}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Static", " ", "Budget", " ", "Constraint", " ", "for", " ", "Patient", " ",
      "Households"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"BCPatientStatic", ":=", 
     RowBox[{"cp", "+", "dp", "-", 
      RowBox[{"wt", " ", "hp"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "rt"}], ")"}], "/", "\[Pi]t"}], ")"}], " ", 
       "dp"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Define", " ", "the", " ", "Static", " ", "Lagrangian"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Lstatic", "=", 
     RowBox[{
      RowBox[{"uPatientStatic", "[", 
       RowBox[{"cp", ",", "hp"}], "]"}], "+", 
      RowBox[{"\[Lambda]", " ", "BCPatientStatic"}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Derive", " ", "the", " ", "First"}], "-", 
     RowBox[{"Order", " ", "Conditions", " ", 
      RowBox[{"(", "FOCs", ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FOCcp", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"Lstatic", ",", "cp"}], "]"}], "==", "0"}]}], ";"}], "   ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "consumption", " ", 
     RowBox[{"c", "^", "p"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"FOChp", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"Lstatic", ",", "hp"}], "]"}], "==", "0"}]}], ";"}], "   ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "housing", " ", 
     RowBox[{"h", "^", "p"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"FOCdp", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"Lstatic", ",", "dp"}], "]"}], "==", "0"}]}], ";"}], "   ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "deposits", " ", 
     RowBox[{"d", "^", "p"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"FOClambda", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"Lstatic", ",", "\[Lambda]"}], "]"}], "==", "0"}]}], ";"}], 
   "  ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "multiplier", " ", 
     RowBox[{"\[Lambda]", "^", "P"}]}], "*)"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Display", " ", "the", " ", "FOCs"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"FOCcp", ",", "FOChp", ",", "FOCdp", ",", "FOClambda"}], "}"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n"}]}]], "Input",
 CellChangeTimes->{{3.9424097710067005`*^9, 3.9424097735303288`*^9}, 
   3.942409986837412*^9, {3.942410224952446*^9, 3.942410250698843*^9}, 
   3.942414205266445*^9, 3.9424171668779297`*^9, 3.942419692092272*^9, 
   3.9424204177254696`*^9, 3.9424204789909916`*^9, {3.942420720045725*^9, 
   3.942420728957245*^9}, {3.9424208281063786`*^9, 3.9424208471915607`*^9}, {
   3.942420880106722*^9, 3.942420886782583*^9}, 3.9424222361942863`*^9, {
   3.942423052980547*^9, 3.9424230739505024`*^9}, 3.942423164222044*^9, 
   3.9424232036387615`*^9, {3.9424232833174133`*^9, 3.942423307845436*^9}, {
   3.942423342657379*^9, 3.942423370843012*^9}, {3.9424235561691933`*^9, 
   3.942423573217308*^9}, 3.9424237825038567`*^9, 3.942423914171425*^9, 
   3.94248768227162*^9, 3.942502868082756*^9, 3.942503100647709*^9, 
   3.942503140525156*^9, 3.9425046010225945`*^9, {3.9425052399102135`*^9, 
   3.9425052421572056`*^9}, {3.9425064032796345`*^9, 3.9425064272894344`*^9}, 
   3.94250658942535*^9, 3.9425067828417664`*^9, 3.942506854326124*^9, {
   3.9425079465509777`*^9, 3.94250799672328*^9}, 3.9425081754514484`*^9, 
   3.942510581203039*^9, {3.942511009251314*^9, 3.942511017852148*^9}, {
   3.942511221733576*^9, 3.9425112586265945`*^9}, 3.9425117108579197`*^9, 
   3.9425117602628727`*^9, {3.942511856447809*^9, 3.9425119345891457`*^9}, 
   3.9425122263945293`*^9, {3.942512955427664*^9, 3.9425129698917313`*^9}, {
   3.94251301365139*^9, 3.9425130307669353`*^9}, {3.942513108585476*^9, 
   3.942513112112303*^9}, {3.9425135466473694`*^9, 3.942513556385315*^9}, {
   3.942513868974186*^9, 3.942513921787203*^9}, {3.9425139580605755`*^9, 
   3.9425139700600357`*^9}, 3.9425140419308376`*^9, {3.942514134970972*^9, 
   3.9425141648856773`*^9}, {3.9425141998729115`*^9, 
   3.9425142444404106`*^9}, {3.9425142927988625`*^9, 3.942514303916441*^9}, {
   3.9425148598096733`*^9, 3.9425148712374344`*^9}, {3.942514910480751*^9, 
   3.942514917020756*^9}, {3.942514973867367*^9, 3.9425150148147144`*^9}, 
   3.9425161769270763`*^9, 3.9425162112263985`*^9, {3.9425166428949184`*^9, 
   3.942516672205147*^9}, {3.942517042567255*^9, 3.9425170621009064`*^9}, {
   3.9425171674338245`*^9, 3.9425171874190807`*^9}, 3.942517223580761*^9, 
   3.9425173582750072`*^9, 3.942517406842678*^9, {3.9425176475276356`*^9, 
   3.942517664750183*^9}, {3.942517718150387*^9, 3.942517744371004*^9}, {
   3.9425178154654617`*^9, 3.942517834731922*^9}, 3.942517913433714*^9, 
   3.942518014903372*^9, {3.9425881118939304`*^9, 3.942588226554573*^9}, {
   3.9425896390154*^9, 3.942589660098751*^9}, {3.9425905522714367`*^9, 
   3.942590594677908*^9}, {3.9425911684561577`*^9, 3.9425911698701305`*^9}, 
   3.942751573759756*^9, 3.942751621808159*^9, 3.9427516680874004`*^9, {
   3.9427517329189034`*^9, 3.9427517351424484`*^9}, {3.9427519255838013`*^9, 
   3.9427519869494553`*^9}, 3.9427520332742233`*^9, 3.942752333177307*^9, {
   3.942752770986908*^9, 3.9427527730965176`*^9}, {3.94275302368054*^9, 
   3.942753025683384*^9}, {3.9428474340546665`*^9, 3.9428474362622166`*^9}, {
   3.9428483214733906`*^9, 3.942848362170891*^9}, 3.9428484049196663`*^9, 
   3.942848454450346*^9, {3.9428490839405823`*^9, 3.942849160084255*^9}, {
   3.942849213918829*^9, 3.942849287185663*^9}, {3.9428493507735596`*^9, 
   3.942849353695465*^9}, 3.9428493846297016`*^9, {3.942850052822735*^9, 
   3.9428500750204296`*^9}, {3.9428501420583496`*^9, 
   3.9428501459492645`*^9}, {3.9428503972435436`*^9, 
   3.9428504100488663`*^9}, {3.942853049260662*^9, 3.9428530504676895`*^9}, {
   3.942853092458111*^9, 3.9428531192472134`*^9}, {3.942853353568598*^9, 
   3.9428533545898075`*^9}, {3.9428533987449627`*^9, 
   3.9428534229557915`*^9}, {3.9429231648091373`*^9, 3.942923166138708*^9}, {
   3.9429246809890385`*^9, 3.942924683690712*^9}, {3.9429247321913033`*^9, 
   3.942924732889475*^9}, {3.9429254250561047`*^9, 3.9429254513153687`*^9}, 
   3.9429254838702602`*^9, {3.9429255434986267`*^9, 3.942925560423479*^9}, {
   3.942925616054928*^9, 3.942925642339443*^9}, {3.9429261874701004`*^9, 
   3.9429262104446373`*^9}, {3.942926484765465*^9, 3.942926497715992*^9}, {
   3.94292658112232*^9, 3.9429265839319725`*^9}, {3.9429267900613174`*^9, 
   3.9429267947414474`*^9}, 3.9429268487589626`*^9, {3.94293422696509*^9, 
   3.9429342288360386`*^9}, {3.9429343606643944`*^9, 
   3.9429343661244335`*^9}, {3.942934751577406*^9, 3.9429347571734104`*^9}, {
   3.9429348102113075`*^9, 3.942934825030098*^9}, 3.9429349712800045`*^9, {
   3.942935395628916*^9, 3.9429354119468803`*^9}, {3.942935638691334*^9, 
   3.9429356840764217`*^9}, 3.9429360778661404`*^9, {3.9429361132493095`*^9, 
   3.9429361676882057`*^9}, {3.942936520458252*^9, 3.942936526243181*^9}, {
   3.9429461492206955`*^9, 3.9429461723246975`*^9}, {3.943008575399826*^9, 
   3.943008584860981*^9}, {3.943012952041334*^9, 3.9430129533912315`*^9}, {
   3.9430272878138313`*^9, 3.9430272905139027`*^9}, 3.943106855318901*^9, {
   3.943373167306566*^9, 3.943373172855282*^9}, {3.949506821079384*^9, 
   3.9495068659453564`*^9}, 3.949506917242092*^9, 3.9497598584248276`*^9, {
   3.949760070409359*^9, 3.9497601044920845`*^9}, 3.949760460544508*^9, 
   3.9497608916708984`*^9, {3.949762948031452*^9, 3.949763002752819*^9}, {
   3.9497631134323196`*^9, 3.9497631675*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"f9fb2cec-0218-1946-a7a4-614cfc63c79f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]", "+", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["\[Alpha]", "P"]}], ")"}], " ", 
       SuperscriptBox["\[Xi]", "P"]}], "cp"]}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["hp", "\[Phi]"]}], "+", 
     FractionBox[
      SuperscriptBox["\[Epsilon]", "P"], "hp"], "-", 
     RowBox[{"wt", " ", "\[Lambda]"}]}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{"\[Lambda]", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{"1", "+", "rt"}], "\[Pi]t"]}], ")"}]}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{"cp", "+", "dp", "-", 
     RowBox[{"hp", " ", "wt"}], "-", 
     FractionBox[
      RowBox[{"dp", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "rt"}], ")"}]}], "\[Pi]t"]}], "\[Equal]", "0"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.949759871630947*^9, 3.949760088108082*^9, 
  3.9497609006273575`*^9, 3.9497631764557037`*^9},
 CellLabel->"Out[78]=",ExpressionUUID->"89f46449-40bc-454b-bf12-432d0c41fab6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"--", "1"}], ")"}], " ", "Define", " ", "the", " ", "static", " ", 
    RowBox[{"equations", "--"}]}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{"Equation", " ", "for", " ", "\[Lambda]"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"eq1", "=", 
     RowBox[{
      RowBox[{"\[Lambda]", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[Alpha]", "^", "P"}]}], ")"}], " ", 
          RowBox[{"\[Xi]", "^", "P"}]}], ")"}], "/", "cp"}]}], "==", "0"}]}], 
    ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "for", " ", "housing", " ", 
     RowBox[{"(", "hp", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqHP", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"hp", "^", "\[Phi]"}]}], "+", 
       RowBox[{
        RowBox[{"\[Epsilon]", "^", "P"}], "/", "hp"}], "-", 
       RowBox[{"wt", " ", "\[Lambda]"}]}], "==", "0"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "for", " ", "deposits", " ", 
     RowBox[{"(", "dp", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqDP", "=", 
     RowBox[{
      RowBox[{"\[Lambda]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "r_t"}], ")"}], "/", "\[Pi]_t"}]}], ")"}]}], "==",
       "0"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Budget", " ", "constraint"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqBudget", "=", 
     RowBox[{
      RowBox[{"cp", "+", "dp", "-", 
       RowBox[{"hp", " ", "wt"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"dp", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "r_t"}], ")"}]}], ")"}], "/", "\[Pi]_t"}]}], "==",
       "0"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"--", "2"}], ")"}], " ", "Solve", " ", "for", " ", "\[Lambda]", 
     " ", "from", " ", 
     RowBox[{"eq1", "--"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lambdaSolution", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"Solve", "[", 
       RowBox[{"eq1", ",", "\[Lambda]"}], "]"}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Output", " ", "the", " ", "solution", " ", "for", " ", "\[Lambda]"}], 
    "*)"}], "\[IndentingNewLine]", "lambdaSolution", "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Extract", " ", "the", " ", "substitution", " ", "rule"}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lambdaSub", "=", 
     RowBox[{"lambdaSolution", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"--", "3"}], ")"}], " ", "Substitute", " ", "\[Lambda]", " ", 
     "in", " ", "eqHP", " ", "and", " ", 
     RowBox[{"eqDP", "--"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqHPPlugged", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"eqHP", "/.", " ", "lambdaSub"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"eqDPPlugged", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"eqDP", "/.", " ", "lambdaSub"}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"--", "4"}], ")"}], " ", "Optionally"}], ",", 
     RowBox[{"define", " ", "final", " ", "simplified", " ", 
      RowBox[{"equations", "--"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqHPFinal", "=", "eqHPPlugged"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"eqDPFinal", "=", "eqDPPlugged"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Output", " ", "the", " ", "final", " ", "equations", " ", "along", " ", 
     "with", " ", "the", " ", "budget", " ", "constraint"}], "*)"}], "\n", 
   RowBox[{"{", 
    RowBox[{"eqHPFinal", ",", "eqDPFinal", ",", "eqBudget"}], "}"}], "\n", 
   "\n", "\n", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Static", " ", "Budget", " ", "Constraint", " ", "for", " ", "Patient", " ",
      "Households"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BCPatientStatic", ":=", 
     RowBox[{"cp", "+", "dp", "-", 
      RowBox[{"wt", " ", "hp"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "rt"}], ")"}], "/", "\[Pi]t"}], ")"}], " ", 
       "dp"}]}]}], ";"}], "\n"}]}]], "Input",
 CellChangeTimes->{{3.9497611429836006`*^9, 3.949761153916502*^9}, 
   3.949761241954275*^9, {3.949761847467903*^9, 3.949761883688841*^9}, {
   3.9497632334362183`*^9, 3.94976333540119*^9}, {3.949763503609247*^9, 
   3.949763532627447*^9}, 
   3.949767441519554*^9},ExpressionUUID->"73a5e06e-15c9-2347-9c11-\
545b67147ef3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Lambda]", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[Alpha]", "P"]}], ")"}], " ", 
      SuperscriptBox["\[Xi]", "P"]}], "cp"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.9497612272792816`*^9, 3.949761286283636*^9, 
  3.949761889772356*^9, 3.9497635436913853`*^9},
 CellLabel->"Out[84]=",ExpressionUUID->"c1670040-ed74-054f-a4e2-562c369196e7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["hp", "\[Phi]"], "+", 
     FractionBox[
      RowBox[{"wt", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["\[Alpha]", "P"]}], ")"}], " ", 
       SuperscriptBox["\[Xi]", "P"]}], "cp"]}], "\[Equal]", 
    FractionBox[
     SuperscriptBox["\[Epsilon]", "P"], "hp"]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[Alpha]", "P"]}], ")"}], " ", 
      SuperscriptBox["\[Xi]", "P"], " ", 
      RowBox[{"(", 
       RowBox[{"\[Pi]", "-", 
        RowBox[{"_t", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "r_t"}], ")"}]}]}], ")"}]}], "cp"], "\[Equal]", 
    "0"}], ",", 
   RowBox[{
    RowBox[{"cp", "+", "dp", "-", 
     RowBox[{"hp", " ", "wt"}], "-", 
     FractionBox[
      RowBox[{"dp", " ", "_t", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "r_t"}], ")"}]}], "\[Pi]"]}], "\[Equal]", "0"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.9497612272792816`*^9, 3.949761286283636*^9, 
  3.949761889772356*^9, 3.9497635439718075`*^9},
 CellLabel->"Out[90]=",ExpressionUUID->"989a8f9c-9396-624a-b30a-0383185b187d"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.9495068013552494`*^9},ExpressionUUID->"93063096-b854-5642-83fe-\
da57c1f294a1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"patient", " ", "households", " ", "Lagrange"}], "*)"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "Parameters", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"params", "=", 
    RowBox[{"{", 
     RowBox[{
     "betaP", ",", "alpha", ",", "xiP", ",", "epsilonP", ",", "phi", ",", 
      "qh", ",", 
      RowBox[{"wt", "[", "t", "]"}], ",", 
      RowBox[{"rt", "[", "t", "]"}], ",", 
      RowBox[{"pit", "[", "t", "]"}], ",", 
      RowBox[{"cp", "[", "t", "]"}], ",", 
      RowBox[{"dp", "[", "t", "]"}], ",", 
      RowBox[{"hp", "[", "t", "]"}], ",", 
      RowBox[{"lambdaP", "[", "t", "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Utility", " ", "function", " ", "for", " ", "patient", " ", 
    "households"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uPatient", "[", 
     RowBox[{"cp_", ",", "cpLag_", ",", "hp_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "a"}], ")"}], " ", "xiP", " ", 
      RowBox[{"Log", "[", 
       RowBox[{"cp", "-", 
        RowBox[{"a", " ", "cpLag"}]}], "]"}]}], "+", 
     RowBox[{"epsilonP", " ", 
      RowBox[{"Log", "[", "hp", "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"hp", "^", 
        RowBox[{"(", 
         RowBox[{"1", "+", "phi"}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", "phi"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Budget", " ", "constraint", " ", "for", " ", "patient", " ", 
     "households", " ", "in", " ", "period", " ", "t"}], ",", 
    RowBox[{
     RowBox[{
     "now", " ", "incorporating", " ", "the", " ", "net", " ", "change", " ", 
      "in", " ", "housing", " ", "services", " ", "\[CapitalDelta]h"}], "=", 
     RowBox[{
      RowBox[{"hp", "[", "t", "]"}], "-", 
      RowBox[{"hp", "[", 
       RowBox[{"t", "-", "1"}], "]"}]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BCPatient", "[", "t_", "]"}], ":=", 
    RowBox[{
     RowBox[{"cp", "[", "t", "]"}], "+", 
     RowBox[{"qh", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"hp", "[", "t", "]"}], "-", 
        RowBox[{"hp", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], ")"}]}], "+", 
     RowBox[{"dp", "[", "t", "]"}], "-", 
     RowBox[{
      RowBox[{"wt", "[", "t", "]"}], " ", 
      RowBox[{"hp", "[", "t", "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"rt", "[", 
           RowBox[{"t", "-", "1"}], "]"}]}], ")"}], "/", 
        RowBox[{"pit", "[", "t", "]"}]}], ")"}], " ", 
      RowBox[{"dp", "[", 
       RowBox[{"t", "-", "1"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Define", " ", "Lagrangian", " ", "for", " ", "two", " ", "periods", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"t", " ", "and", " ", "t"}], "+", "1"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LP", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"uPatient", "[", 
        RowBox[{
         RowBox[{"cp", "[", "t", "]"}], ",", 
         RowBox[{"cp", "[", 
          RowBox[{"t", "-", "1"}], "]"}], ",", 
         RowBox[{"hp", "[", "t", "]"}]}], "]"}], "+", 
       RowBox[{
        RowBox[{"lambdaP", "[", "t", "]"}], "*", 
        RowBox[{"BCPatient", "[", "t", "]"}]}]}], ")"}], "+", 
     RowBox[{
      RowBox[{"betaP", "^", 
       RowBox[{"(", 
        RowBox[{"t", "+", "1"}], ")"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"uPatient", "[", 
         RowBox[{
          RowBox[{"cp", "[", 
           RowBox[{"t", "+", "1"}], "]"}], ",", 
          RowBox[{"cp", "[", "t", "]"}], ",", 
          RowBox[{"hp", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{"lambdaP", "[", 
          RowBox[{"t", "+", "1"}], "]"}], "*", 
         RowBox[{"BCPatient", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}]}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"First", "-", 
    RowBox[{
    "order", " ", "conditions", " ", "for", " ", "patient", " ", 
     "households"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"focPCt", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"LP", ",", 
       RowBox[{"cp", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], 
  "        ", 
  RowBox[{"(*", 
   RowBox[{"FOC", " ", "with", " ", "respect", " ", "to", " ", 
    RowBox[{"cp", "[", "t", "]"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"focPHt", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"LP", ",", 
       RowBox[{"hp", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], 
  "        ", 
  RowBox[{"(*", 
   RowBox[{"FOC", " ", "with", " ", "respect", " ", "to", " ", 
    RowBox[{"hp", "[", "t", "]"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"focPdP", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"LP", ",", 
       RowBox[{"dp", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], 
  "        ", 
  RowBox[{"(*", 
   RowBox[{"FOC", " ", "with", " ", "respect", " ", "to", " ", 
    RowBox[{"dp", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"Debug", " ", "the", " ", "FOCs", " ", "before", " ", "solving"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"debugFOCs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<FOC wrt cp[t]\>\"", "->", "focPCt"}], ",", 
     RowBox[{"\"\<FOC wrt hp[t]\>\"", "->", "focPHt"}], ",", 
     RowBox[{"\"\<FOC wrt dp[t]\>\"", "->", "focPdP"}]}], "}"}]}], 
  ";"}], "\n", "debugFOCs", "\n"}], "Input",
 CellChangeTimes->{
  3.9483807487855415`*^9, {3.9487320822936993`*^9, 3.9487320835154877`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"0708fca9-59ce-8847-af89-18fc69779938"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"FOC wrt cp[t]\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "a"}], ")"}], " ", "xiP"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "a"}], " ", 
         RowBox[{"cp", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
        RowBox[{"cp", "[", "t", "]"}]}]], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "a"}], ")"}], " ", "a", " ", 
        SuperscriptBox["betaP", 
         RowBox[{"1", "+", "t"}]], " ", "xiP"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "a"}], " ", 
         RowBox[{"cp", "[", "t", "]"}]}], "+", 
        RowBox[{"cp", "[", 
         RowBox[{"1", "+", "t"}], "]"}]}]], "+", 
      RowBox[{"lambdaP", "[", "t", "]"}]}], "\[Equal]", "0"}]}], ",", 
   RowBox[{"\<\"FOC wrt hp[t]\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{
      FractionBox["epsilonP", 
       RowBox[{"hp", "[", "t", "]"}]], "-", 
      SuperscriptBox[
       RowBox[{"hp", "[", "t", "]"}], "phi"], "-", 
      RowBox[{
       SuperscriptBox["betaP", 
        RowBox[{"1", "+", "t"}]], " ", "qh", " ", 
       RowBox[{"lambdaP", "[", 
        RowBox[{"1", "+", "t"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"lambdaP", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"qh", "-", 
         RowBox[{"wt", "[", "t", "]"}]}], ")"}]}]}], "\[Equal]", "0"}]}], ",", 
   RowBox[{"\<\"FOC wrt dp[t]\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"lambdaP", "[", "t", "]"}], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["betaP", 
         RowBox[{"1", "+", "t"}]], " ", 
        RowBox[{"lambdaP", "[", 
         RowBox[{"1", "+", "t"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"rt", "[", "t", "]"}]}], ")"}]}], 
       RowBox[{"pit", "[", 
        RowBox[{"1", "+", "t"}], "]"}]]}], "\[Equal]", "0"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.9496597069922276`*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"331e89ae-d4d3-0148-9d6e-d62837cf9c8a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.942591478649725*^9, 3.942591478649725*^9}, 
   3.9425915249837914`*^9, {3.942591893611925*^9, 3.9425919125734234`*^9}, 
   3.9425920148237686`*^9, {3.9431068767277374`*^9, 3.9431068801445446`*^9}, {
   3.943373150584465*^9, 3.943373154683838*^9}, 3.943530733499941*^9, {
   3.9435311122916813`*^9, 3.9435311485272903`*^9}, {3.9436169128066196`*^9, 
   3.943616924451643*^9}, {3.943617362437744*^9, 3.943617382325964*^9}, {
   3.9436179521460266`*^9, 3.943617955790903*^9}, {3.9453529856666317`*^9, 
   3.9453530067840347`*^9}, {3.945361819427248*^9, 3.9453618221393833`*^9}, {
   3.9466612675401*^9, 3.9466612786488857`*^9}, {3.9466613158820724`*^9, 
   3.94666132181089*^9}, 3.9471762973235054`*^9, {3.94717643434391*^9, 
   3.9471764402908535`*^9}, 
   3.948380731015253*^9},ExpressionUUID->"9ace75de-4978-4347-8abf-\
940e21a736de"],

Cell[CellGroupData[{

Cell[BoxData[""], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.9453530115724983`*^9, {3.9453567033453445`*^9, 3.945356704812771*^9}, {
   3.9453567451134853`*^9, 3.945356790620058*^9}, 3.945361873726124*^9, 
   3.945444393223093*^9, 3.9466611651340885`*^9, 3.9466612297905045`*^9, 
   3.946661287221405*^9, 3.9466613275977764`*^9, 3.9471763760931816`*^9, {
   3.947176416060137*^9, 
   3.9471764208432503`*^9}},ExpressionUUID->"3180c1ab-5e0d-ca40-9394-\
5e86f56408d7"],

Cell[BoxData[""], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.9453530115724983`*^9, {3.9453567033453445`*^9, 3.945356704812771*^9}, {
   3.9453567451134853`*^9, 3.945356790620058*^9}, 3.945361873726124*^9, 
   3.945444393223093*^9, 3.9466611651340885`*^9, 3.9466612297905045`*^9, 
   3.946661287221405*^9, 
   3.947176360899105*^9},ExpressionUUID->"cba57453-8210-be49-9e99-\
e7c7a95b445f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Define", " ", "the", " ", "equation"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"eq", "=", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "a"}], ")"}], " ", "xiP"}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "a"}], " ", 
          RowBox[{"cp", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"cp", "[", "t", "]"}]}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "a"}], ")"}], " ", "a", " ", 
         SuperscriptBox["betaP", 
          RowBox[{"1", "+", "t"}]], " ", "xiP"}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "a"}], " ", 
          RowBox[{"cp", "[", "t", "]"}]}], "+", 
         RowBox[{"cp", "[", 
          RowBox[{"1", "+", "t"}], "]"}]}]], "+", 
       RowBox[{"lambdaP", "[", "t", "]"}]}], "\[Equal]", "0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Solve", " ", "for", " ", 
     RowBox[{"lambdaP", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"lambdaSolution", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"Solve", "[", 
      RowBox[{"eq", ",", 
       RowBox[{"lambdaP", "[", "t", "]"}]}], "]"}], "]"}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Output", " ", "the", " ", "solution"}], "*)"}], "\[IndentingNewLine]",
    "lambdaSolution", "\n", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.9471770066521263`*^9, 3.947177006654125*^9}, {
   3.9471771841496162`*^9, 3.9471772197199135`*^9}, {3.947177358902153*^9, 
   3.947177397399147*^9}, 3.947177812835148*^9, 3.9483808549701595`*^9, 
   3.9483808919548016`*^9, {3.948380978827957*^9, 3.948380994442505*^9}, {
   3.94873217108959*^9, 3.948732210490299*^9}},
 CellLabel->
  "In[276]:=",ExpressionUUID->"6cbdf14f-fcad-b24a-9b64-6f911cd48fed"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"lambdaP", "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", "xiP", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "a"}], " ", 
          RowBox[{"cp", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"cp", "[", "t", "]"}]}]], "+", 
       FractionBox[
        RowBox[{"a", " ", 
         SuperscriptBox["betaP", 
          RowBox[{"1", "+", "t"}]]}], 
        RowBox[{
         RowBox[{"a", " ", 
          RowBox[{"cp", "[", "t", "]"}]}], "-", 
         RowBox[{"cp", "[", 
          RowBox[{"1", "+", "t"}], "]"}]}]]}], ")"}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.9495815883833294`*^9},
 CellLabel->
  "Out[277]=",ExpressionUUID->"7c3554d3-4946-fd4b-bc7b-7e9e3ebaec7b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"lambdaP", "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", "xiP", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "a"}], " ", 
          RowBox[{"cp", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"cp", "[", "t", "]"}]}]], "+", 
       FractionBox[
        RowBox[{"a", " ", 
         SuperscriptBox["betaP", 
          RowBox[{"1", "+", "t"}]]}], 
        RowBox[{
         RowBox[{"a", " ", 
          RowBox[{"cp", "[", "t", "]"}]}], "-", 
         RowBox[{"cp", "[", 
          RowBox[{"1", "+", "t"}], "]"}]}]]}], ")"}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.949581588388489*^9},
 CellLabel->
  "Out[278]=",ExpressionUUID->"0c1908c2-3a31-d14e-ab3a-e4b82587ec48"]
}, Open  ]],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{{3.9471770066521263`*^9, 3.947177006654125*^9}, {
   3.9471771841496162`*^9, 3.9471772197199135`*^9}, {3.947177358902153*^9, 
   3.947177397399147*^9}, 3.947177812835148*^9, 
   3.949488593344095*^9},ExpressionUUID->"4978f1f1-0572-b84b-b184-\
a61a2eb98030"],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9471770066521263`*^9, 3.947177006654125*^9}, {
   3.9471771841496162`*^9, 3.9471772197199135`*^9}, {3.947177358902153*^9, 
   3.947177397399147*^9}, 3.947177812835148*^9, {3.949488593344095*^9, 
   3.94948859878549*^9}},ExpressionUUID->"45d14f52-30e0-da46-9903-\
bc98c6f0cfcd"],

Cell[CellGroupData[{

Cell[BoxData[""], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.9453530115724983`*^9, {3.9453567033453445`*^9, 3.945356704812771*^9}, {
   3.9453567451134853`*^9, 3.945356790620058*^9}, 3.945361873726124*^9, 
   3.945444393223093*^9, 3.9466611651340885`*^9, 3.9466612297905045`*^9, 
   3.947176336343334*^9},ExpressionUUID->"3b40c5c1-cbf0-244a-912a-\
65c58f9ab2e4"],

Cell[BoxData[""], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.9453530115724983`*^9, {3.9453567033453445`*^9, 3.945356704812771*^9}, {
   3.9453567451134853`*^9, 3.945356790620058*^9}, 3.945361873726124*^9, 
   3.945444393223093*^9, 
   3.9466611651340885`*^9},ExpressionUUID->"3dd3e17b-7b29-3d40-970d-\
7f04b4476b62"]
}, Open  ]]
}, Open  ]],

Cell["", "Text",
 CellChangeTimes->{{3.948381791916382*^9, 3.9483818207745*^9}, 
   3.948381854840227*^9},ExpressionUUID->"a69b7710-0a9d-1846-91aa-\
7a4298560cda"],

Cell[BoxData[
 RowBox[{"\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"--", "1"}], ")"}], " ", "Define", " ", "your", " ", "existing", 
    " ", 
    RowBox[{"objects", "--"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"lambdaSub1", "=", 
     RowBox[{
      RowBox[{"\[Lambda]", "[", "t", "]"}], "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", "xiP", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "a"}], " ", 
              RowBox[{"cp", "[", 
               RowBox[{"t", "-", "1"}], "]"}]}], "+", 
             RowBox[{"cp", "[", "t", "]"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a", " ", 
             RowBox[{"betaP", "^", 
              RowBox[{"(", 
               RowBox[{"1", "+", "t"}], ")"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", 
              RowBox[{"cp", "[", "t", "]"}]}], "-", 
             RowBox[{"cp", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}]}], ")"}]}], ")"}]}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Shifted", " ", "version"}], ",", 
     RowBox[{
      RowBox[{"for", " ", "t"}], "->", 
      RowBox[{"t", "+", "1"}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"lambdaSub2", "=", 
     RowBox[{
      RowBox[{"\[Lambda]", "[", 
       RowBox[{"t", "+", "1"}], "]"}], "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", "xiP", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "a"}], " ", 
              RowBox[{"cp", "[", "t", "]"}]}], "+", 
             RowBox[{"cp", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a", " ", 
             RowBox[{"betaP", "^", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"(", 
                 RowBox[{"t", "+", "1"}], ")"}]}], ")"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", 
              RowBox[{"cp", "[", 
               RowBox[{"t", "+", "1"}], "]"}]}], "-", 
             RowBox[{"cp", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], ")"}]}]}], ")"}]}], ")"}]}]}],
     ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqHP", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"epsilonP", "/", 
        RowBox[{"hp", "[", "t", "]"}]}], "-", 
       RowBox[{
        RowBox[{"hp", "[", "t", "]"}], "^", "phi"}], "-", 
       RowBox[{
        RowBox[{"betaP", "^", 
         RowBox[{"(", 
          RowBox[{"1", "+", "t"}], ")"}]}], " ", "qh", " ", 
        RowBox[{"\[Lambda]", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"\[Lambda]", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"qh", "-", 
          RowBox[{"wt", "[", "t", "]"}]}], ")"}]}]}], "==", "0"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"eqDP", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Lambda]", "[", "t", "]"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"betaP", "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "t"}], ")"}]}], " ", 
          RowBox[{"\[Lambda]", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"rt", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
        RowBox[{"pit", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}]}], "==", "0"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"--", "2"}], ")"}], " ", "Substitute", " ", "out", " ", 
      RowBox[{"\[Lambda]", "[", "t", "]"}]}], ",", 
     RowBox[{
      RowBox[{"\[Lambda]", "[", 
       RowBox[{"t", "+", "1"}], "]"}], " ", "in", " ", "eqHP", " ", "and", " ", 
      RowBox[{"eqDP", "--"}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"eqHPPlugged", "=", 
     RowBox[{
      RowBox[{"eqHP", "/.", " ", "lambdaSub1"}], "/.", " ", "lambdaSub2"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"eqDPPlugged", "=", 
     RowBox[{
      RowBox[{"eqDP", "/.", " ", "lambdaSub1"}], "/.", " ", "lambdaSub2"}]}], 
    ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"--", "3"}], ")"}], " ", "Optionally"}], ",", 
     RowBox[{"simplify", " ", "the", " ", "resulting", " ", 
      RowBox[{"expressions", "--"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqHPFinal", "=", "eqHPPlugged"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"eqDPFinal", "=", "eqDPPlugged"}], ";"}], "\[IndentingNewLine]", 
   "eqDPFinal", "\[IndentingNewLine]", "eqHPFinal", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "eqHPFinal", " ", "and", " ", "eqDPFinal", " ", "no", " ", "longer", " ", 
     "contain", " ", 
     RowBox[{"\[Lambda]", "[", "t", "]"}], " ", "or", " ", 
     RowBox[{
      RowBox[{"\[Lambda]", "[", 
       RowBox[{"t", "+", "1"}], "]"}], "."}]}], "*)"}], "\n"}]}]], "Input",
 CellChangeTimes->{
  3.948381881067642*^9, {3.948382221302662*^9, 3.948382245748192*^9}, {
   3.9483822965825863`*^9, 3.9483823421609554`*^9}, 3.9483823813971424`*^9, 
   3.948382423237911*^9, 3.9484541616896267`*^9, {3.94873227466889*^9, 
   3.9487322905274315`*^9}, {3.9487323540735054`*^9, 3.94873241161858*^9}, {
   3.9488224649084167`*^9, 3.9488224943983135`*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"42a8e955-c96a-7241-b392-ab997b076293"],

Cell["", "Text",
 CellChangeTimes->{{3.948381791916382*^9, 
  3.948381823237238*^9}},ExpressionUUID->"b6a1118c-8d19-934d-bab1-\
26bb44974ff4"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{3.9471778347934628`*^9, 
  3.9483813188468075`*^9},ExpressionUUID->"aec07186-9953-eb4b-a898-\
e758c5d4aabf"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\n", "\n", "\n", "\n",
   "\[IndentingNewLine]", "\n"}]], "Input",
 CellChangeTimes->{{3.949160548335102*^9, 3.949160548336027*^9}, 
   3.9491606160273876`*^9, {3.9491608682781734`*^9, 3.949160905430361*^9}, {
   3.9491630254841213`*^9, 3.949163068362707*^9}, {3.949399970990902*^9, 
   3.9494000089316673`*^9}},ExpressionUUID->"665ccb08-e918-c74f-86bd-\
79b899402612"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9472605060053177`*^9, 3.9472605107869415`*^9}, {
   3.9472605593338985`*^9, 3.947260564568186*^9}, {3.9472627523949776`*^9, 
   3.9472627563084297`*^9}, 3.947263042091564*^9, {3.9476129373485565`*^9, 
   3.947612939510252*^9}, {3.9476132526794376`*^9, 3.9476132613216953`*^9}, {
   3.9476132917043533`*^9, 3.9476132994810257`*^9}, {3.947689046932955*^9, 
   3.947689049203066*^9}, {3.947689131070076*^9, 3.947689139681988*^9}, 
   3.947690286768343*^9, {3.9479488066840305`*^9, 3.947948848141241*^9}, 
   3.9483813041174603`*^9, {3.9487324460448093`*^9, 3.948732452103302*^9}, {
   3.948732498769882*^9, 3.948732539387699*^9}, 3.9487325701348076`*^9, {
   3.9488225935967216`*^9, 
   3.948822671563921*^9}},ExpressionUUID->"dc40e394-a162-e344-af1c-\
469b5ff19c55"],

Cell[BoxData[""], "Input",ExpressionUUID->"7a834a5d-16f4-cc45-8b91-2c83acb7bfcf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "1.", " ", "Clear", " ", "and", " ", "declare", " ", "all", " ", 
    "variables", " ", "as", " ", 
    RowBox[{"symbols", "."}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "cpTm1", ",", "cpT", ",", "cpTp1", ",", "cpTp2", ",", "rtT", ",", 
      "pitTp1", ",", "a", ",", "xiP", ",", "betaP", ",", "t", ",", "cpBar", ",",
       "rtBar", ",", "pitBar", ",", "cpHatTm1", ",", "cpHatT", ",", 
      "cpHatTp1", ",", "cpHatTp2", ",", "rtHatT", ",", "pitHatTp1"}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Optionally", ",", 
     RowBox[{
      RowBox[{"load", " ", "them", " ", "as", " ", 
       RowBox[{"symbols", ":", 
        RowBox[{"Symbol", "/@", 
         RowBox[{"{", 
          
          RowBox[{"\"\<cpTm1\>\"", ",", "\"\<cpT\>\"", ",", "\"\<cpTp1\>\"", 
           ",", "\"\<cpTp2\>\"", ",", "\"\<rtT\>\"", ",", "\"\<pitTp1\>\"", 
           ",", "\"\<a\>\"", ",", "\"\<xiP\>\"", ",", "\"\<betaP\>\"", 
           ",", "\"\<t\>\"", ",", "\"\<cpBar\>\"", ",", "\"\<rtBar\>\"", 
           ",", "\"\<pitBar\>\"", ",", "\"\<cpHatTm1\>\"", 
           ",", "\"\<cpHatT\>\"", ",", "\"\<cpHatTp1\>\"", 
           ",", "\"\<cpHatTp2\>\"", ",", "\"\<rtHatT\>\"", 
           ",", "\"\<pitHatTp1\>\""}], "}"}]}]}]}], ";"}]}], "*)"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "2.", " ", "Define", " ", "the", " ", "original", " ", "equation", " ", 
      "F", 
      RowBox[{"(", "...", ")"}]}], "==", "0."}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{
      "cpTm1_", ",", "cpT_", ",", "cpTp1_", ",", "cpTp2_", ",", "rtT_", ",", 
       "pitTp1_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "a"}], ")"}], "*", "xiP", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "a"}], "*", "cpTm1"}], "+", "cpT"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "*", 
            RowBox[{"betaP", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", "*", "cpT"}], "-", "cpTp1"}], ")"}]}]}], ")"}]}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "a"}], ")"}], "*", 
          RowBox[{"betaP", "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "t"}], ")"}]}], "*", "xiP", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "a"}], "*", "cpT"}], "+", "cpTp1"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"a", "*", 
               RowBox[{"betaP", "^", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "t"}], ")"}]}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", "*", "cpTp1"}], "-", "cpTp2"}], ")"}]}]}], ")"}], 
          "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", "rtT"}], ")"}]}], ")"}], "/", "pitTp1"}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "Specify", " ", "the", " ", "list", " ", "of", " ", 
     "variables", " ", "to", " ", "differentiate", " ", "with", " ", 
     "respect", " ", 
     RowBox[{"to", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{
      "cpTm1", ",", "cpT", ",", "cpTp1", ",", "cpTp2", ",", "rtT", ",", 
       "pitTp1"}], "}"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "4.", " ", "Compute", " ", "the", " ", "partial", " ", "derivatives", " ",
       "of", " ", "F", " ", "with", " ", "respect", " ", "to", " ", "each", " ",
       "variable"}], ",", 
     RowBox[{
      RowBox[{"evaluating", " ", "at", " ", "steady", " ", 
       RowBox[{"state", ".", "We"}], " ", "assume", " ", "that", " ", "in", " ",
        "steady", " ", 
       RowBox[{"state", ":", 
        RowBox[{"cp", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}]}], "=", 
      RowBox[{
       RowBox[{"cp", "[", "t", "]"}], "=", 
       RowBox[{
        RowBox[{"cp", "[", 
         RowBox[{"t", "+", "1"}], "]"}], "=", 
        RowBox[{
         RowBox[{"cp", "[", 
          RowBox[{"t", "+", "2"}], "]"}], "=", "cpBar"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"rt", "[", "t", "]"}], "=", "rtBar"}], ",", 
     RowBox[{
      RowBox[{"and", " ", 
       RowBox[{"pit", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], "=", 
      RowBox[{"pitBar", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"cpTm1", "->", "cpBar"}], ",", 
          RowBox[{"cpT", "->", "cpBar"}], ",", 
          RowBox[{"cpTp1", "->", "cpBar"}], ",", 
          RowBox[{"cpTp2", "->", "cpBar"}], ",", 
          RowBox[{"rtT", "->", "rtBar"}], ",", 
          RowBox[{"pitTp1", "->", "pitBar"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"5.", " ", "Define", " ", "symbols", " ", "for", " ", "log"}], "-", 
     RowBox[{"deviations", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "cpHatTm1", ",", "cpHatT", ",", "cpHatTp1", ",", "cpHatTp2", ",", 
      "rtHatT", ",", "pitHatTp1"}], "]"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
       "6.", " ", "Multiply", " ", "each", " ", "partial", " ", "derivative", 
        " ", "by", " ", "the", " ", "steady", " ", "state", " ", "value", " ",
         "of", " ", "its", " ", "variable", " ", "and", " ", "its", " ", 
        "corresponding", " ", "log"}], "-", 
       RowBox[{
        RowBox[{"deviation", ".", "The"}], " ", "order", " ", "corresponds", " ", 
        RowBox[{"to", ":", 
         RowBox[{"cp", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}]}]}], "->", 
      RowBox[{"cpBar", "*", "cpHatTm1"}]}], ",", 
     RowBox[{
      RowBox[{"cp", "[", "t", "]"}], "->", 
      RowBox[{"cpBar", "*", "cpHatT"}]}], ",", 
     RowBox[{
      RowBox[{"cp", "[", 
       RowBox[{"t", "+", "1"}], "]"}], "->", 
      RowBox[{"cpBar", "*", "cpHatTp1"}]}], ",", 
     RowBox[{
      RowBox[{"cp", "[", 
       RowBox[{"t", "+", "2"}], "]"}], "->", 
      RowBox[{"cpBar", "*", "cpHatTp2"}]}], ",", 
     RowBox[{
      RowBox[{"rt", "[", "t", "]"}], "->", 
      RowBox[{"rtBar", "*", "rtHatT"}]}], ",", 
     RowBox[{
      RowBox[{"pit", "[", 
       RowBox[{"t", "+", "1"}], "]"}], "->", 
      RowBox[{"pitBar", "*", 
       RowBox[{"pitHatTp1", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varsBar", "=", 
     RowBox[{"{", 
      RowBox[{
      "cpBar", ",", "cpBar", ",", "cpBar", ",", "cpBar", ",", "rtBar", ",", 
       "pitBar"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", "cpBar", "*", "cpHatTm1"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", "cpBar", "*", "cpHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", "cpBar", "*", "cpHatTp1"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "*", "cpBar", "*", "cpHatTp2"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "*", "rtBar", "*", "rtHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "*", "pitBar", "*", "pitHatTp1"}]}], 
      "==", "0"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "7.", " ", "Simplify", " ", "the", " ", "final", " ", "linearized", " ", 
      RowBox[{"equation", ".", "Optionally"}]}], ",", 
     RowBox[{
     "replace", " ", "steady", " ", "state", " ", "values", " ", "with", " ", 
      "1", " ", "to", " ", "eliminate", " ", 
      RowBox[{"them", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"simplifiedLogLinEq", "=", 
     RowBox[{"Simplify", "[", "logLinEq", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"logLinEqNoBar", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"simplifiedLogLinEq", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cpBar", "->", "1"}], ",", 
         RowBox[{"rtBar", "->", "1"}], ",", 
         RowBox[{"pitBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "8.", " ", "Define", " ", "substitution", " ", "rules", " ", "to", " ", 
      "reintroduce", " ", "time", " ", "indices", " ", "for", " ", "the", " ",
       "log"}], "-", 
     RowBox[{"deviations", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"timeSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cpHatTm1", "->", 
        RowBox[{"cpHat", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], ",", 
       RowBox[{"cpHatT", "->", 
        RowBox[{"cpHat", "[", "t", "]"}]}], ",", 
       RowBox[{"cpHatTp1", "->", 
        RowBox[{"cpHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"cpHatTp2", "->", 
        RowBox[{"cpHat", "[", 
         RowBox[{"t", "+", "2"}], "]"}]}], ",", 
       RowBox[{"rtHatT", "->", 
        RowBox[{"rtHat", "[", "t", "]"}]}], ",", 
       RowBox[{"pitHatTp1", "->", 
        RowBox[{"pitHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"eqTimeIndexed", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Finally", ",", 
     RowBox[{
      RowBox[{"output", " ", "the", " ", "final", " ", "time"}], "-", 
      RowBox[{"indexed", " ", "linearized", " ", 
       RowBox[{"equation", ":"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"final", "=", 
    RowBox[{"FullSimplify", "[", "eqTimeIndexed", "]"}]}], "\n"}]}]], "Input",
 CellChangeTimes->{{3.948822715947136*^9, 3.948822715947136*^9}},
 CellLabel->
  "In[421]:=",ExpressionUUID->"04b06094-e411-2340-ae40-ed548ed14b86"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.9472605060053177`*^9, 3.9472605107869415`*^9}, {
   3.9472605593338985`*^9, 3.947260564568186*^9}, {3.9472627523949776`*^9, 
   3.9472627563084297`*^9}, 3.947263042091564*^9, {3.9476129373485565`*^9, 
   3.947612939510252*^9}, {3.9476132526794376`*^9, 3.9476132613216953`*^9}, {
   3.9476132917043533`*^9, 3.9476132994810257`*^9}, {3.947689046932955*^9, 
   3.947689049203066*^9}, {3.947689131070076*^9, 3.947689139681988*^9}, 
   3.947690286768343*^9, {3.9479488066840305`*^9, 3.947948848141241*^9}, 
   3.9483813041174603`*^9, {3.9487324460448093`*^9, 3.948732452103302*^9}, {
   3.948732498769882*^9, 3.948732539387699*^9}, 3.9487325701348076`*^9, {
   3.9488225935967216`*^9, 
   3.948822671563921*^9}},ExpressionUUID->"f0fa445f-5834-f94c-9a80-\
dd8f95a8acc3"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9472605060053177`*^9, 3.9472605107869415`*^9}, {
   3.9472605593338985`*^9, 3.947260564568186*^9}, {3.9472627523949776`*^9, 
   3.9472627563084297`*^9}, 3.947263042091564*^9, {3.9472639555408535`*^9, 
   3.9472639825124454`*^9}},ExpressionUUID->"5a156fc5-2eb4-7e48-b51d-\
4ec8fa2678b1"],

Cell[BoxData[""], "Input",ExpressionUUID->"67031162-bd98-8f49-8550-4b19913fb9a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "1.", " ", "Clear", " ", "and", " ", "declare", " ", "all", " ", 
    "variables", " ", "as", " ", 
    RowBox[{"symbols", "."}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "hpT", ",", "cpTm1", ",", "cpT", ",", "cpTp1", ",", "cpTp2", ",", "wtT", 
      ",", "epsilonP", ",", "a", ",", "xiP", ",", "betaP", ",", "t", ",", 
      "qh", ",", "phi", ",", "hpBar", ",", "cpBar", ",", "wtBar"}], "]"}], 
    ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"Optionally", ",", 
     RowBox[{
      RowBox[{"load", " ", "them", " ", "as", " ", 
       RowBox[{"symbols", ":", 
        RowBox[{"Symbol", "/@", 
         RowBox[{"{", 
          
          RowBox[{"\"\<hpT\>\"", ",", "\"\<cpTm1\>\"", ",", "\"\<cpT\>\"", 
           ",", "\"\<cpTp1\>\"", ",", "\"\<cpTp2\>\"", ",", "\"\<wtT\>\"", 
           ",", "\"\<epsilonP\>\"", ",", "\"\<a\>\"", ",", "\"\<xiP\>\"", 
           ",", "\"\<betaP\>\"", ",", "\"\<t\>\"", ",", "\"\<qh\>\"", 
           ",", "\"\<phi\>\"", ",", "\"\<hpBar\>\"", ",", "\"\<cpBar\>\"", 
           ",", "\"\<wtBar\>\""}], "}"}]}]}]}], ";"}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "2.", " ", "Define", " ", "the", " ", "original", " ", "equation", " ", 
      "F", 
      RowBox[{"(", "...", ")"}]}], "==", "0."}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{
      "hpT_", ",", "cpTm1_", ",", "cpT_", ",", "cpTp1_", ",", "cpTp2_", ",", 
       "wtT_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"epsilonP", "/", "hpT"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "a"}], ")"}], "*", "xiP", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"a", "*", 
             RowBox[{"betaP", "^", 
              RowBox[{"(", 
               RowBox[{"2", "+", 
                RowBox[{"2", "*", "t"}]}], ")"}]}], "*", "qh"}], ")"}]}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", "*", "cpTp1"}], "-", "cpTp2"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "qh"}], "+", "wtT"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", "*", "cpTm1"}], "-", "cpT"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betaP", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}], "*", 
            RowBox[{"(", 
             RowBox[{"qh", "+", 
              RowBox[{"a", "*", "qh"}], "-", 
              RowBox[{"a", "*", "wtT"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", "*", "cpT"}], "-", "cpTp1"}], ")"}]}]}], ")"}]}], "-", 
      RowBox[{"hpT", "^", "phi"}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "Specify", " ", "the", " ", "list", " ", "of", " ", 
     "variables", " ", "to", " ", "differentiate", " ", "with", " ", 
     "respect", " ", 
     RowBox[{"to", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"We", " ", "treat", " ", 
      RowBox[{"hp", "[", "t", "]"}]}], ",", 
     RowBox[{"cp", "[", 
      RowBox[{"t", "-", "1"}], "]"}], ",", 
     RowBox[{"cp", "[", "t", "]"}], ",", 
     RowBox[{"cp", "[", 
      RowBox[{"t", "+", "1"}], "]"}], ",", 
     RowBox[{"cp", "[", 
      RowBox[{"t", "+", "2"}], "]"}], ",", 
     RowBox[{"and", " ", 
      RowBox[{"wt", "[", "t", "]"}], " ", "as", " ", "our", " ", 
      RowBox[{"variables", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{
      "hpT", ",", "cpTm1", ",", "cpT", ",", "cpTp1", ",", "cpTp2", ",", 
       "wtT"}], "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "4.", " ", "Compute", " ", "the", " ", "partial", " ", "derivatives", " ",
       "of", " ", "F", " ", "with", " ", "respect", " ", "to", " ", "each", " ",
       "variable"}], ",", 
     RowBox[{
     "evaluating", " ", "at", " ", "the", " ", "steady", " ", "state", " ", 
      RowBox[{"values", ".", "We"}], " ", "assume", " ", "that", " ", "in", " ",
       "steady", " ", "state"}], ",", 
     RowBox[{
      RowBox[{"hp", "[", "t", "]"}], "=", 
      RowBox[{
       RowBox[{"hpBar", " ", "and", " ", 
        RowBox[{"cp", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], "=", 
       RowBox[{
        RowBox[{"cp", "[", "t", "]"}], "=", 
        RowBox[{
         RowBox[{"cp", "[", 
          RowBox[{"t", "+", "1"}], "]"}], "=", 
         RowBox[{
          RowBox[{"cp", "[", 
           RowBox[{"t", "+", "2"}], "]"}], "=", "cpBar"}]}]}]}]}], ",", 
     RowBox[{
      RowBox[{"wt", "[", "t", "]"}], "=", 
      RowBox[{"wtBar", "."}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"hpT", "->", "hpBar"}], ",", 
          RowBox[{"cpTm1", "->", "cpBar"}], ",", 
          RowBox[{"cpT", "->", "cpBar"}], ",", 
          RowBox[{"cpTp1", "->", "cpBar"}], ",", 
          RowBox[{"cpTp2", "->", "cpBar"}], ",", 
          RowBox[{"wtT", "->", "wtBar"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"5.", " ", "Define", " ", "symbols", " ", "for", " ", "log"}], "-", 
     RowBox[{"deviations", "."}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "hpHatT", ",", "cpHatTm1", ",", "cpHatT", ",", "cpHatTp1", ",", 
      "cpHatTp2", ",", "wtHatT"}], "]"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "6.", " ", "Multiply", " ", "each", " ", "partial", " ", "derivative", " ",
       "by", " ", "the", " ", "steady", " ", "state", " ", "value", " ", "of",
       " ", "its", " ", "variable", " ", "and", " ", "the", " ", 
      "corresponding", " ", "log"}], "-", 
     RowBox[{"deviation", " ", 
      RowBox[{"(", 
       RowBox[{"d", " ", "ln", " ", "X"}], ")"}], " ", "to", " ", "obtain", " ",
       "the", " ", "linearized", " ", 
      RowBox[{"equation", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"The", " ", "order", " ", "corresponds", " ", 
       RowBox[{"to", ":", "hpT"}]}], "->", 
      RowBox[{"hpBar", "*", "hpHatT"}]}], ",", 
     RowBox[{"cpTm1", "->", 
      RowBox[{"cpBar", "*", "cpHatTm1"}]}], ",", 
     RowBox[{"cpT", "->", 
      RowBox[{"cpBar", "*", "cpHatT"}]}], ",", 
     RowBox[{"cpTp1", "->", 
      RowBox[{"cpBar", "*", "cpHatTp1"}]}], ",", 
     RowBox[{"cpTp2", "->", 
      RowBox[{"cpBar", "*", "cpHatTp2"}]}], ",", 
     RowBox[{"wtT", "->", 
      RowBox[{"wtBar", "*", 
       RowBox[{"wtHatT", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varsBar", "=", 
     RowBox[{"{", 
      RowBox[{
      "hpBar", ",", "cpBar", ",", "cpBar", ",", "cpBar", ",", "cpBar", ",", 
       "wtBar"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", "hpBar", "*", "hpHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", "cpBar", "*", "cpHatTm1"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", "cpBar", "*", "cpHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "*", "cpBar", "*", "cpHatTp1"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "*", "cpBar", "*", "cpHatTp2"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "*", "wtBar", "*", "wtHatT"}]}], "==",
       "0"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "7.", " ", "Simplify", " ", "the", " ", "final", " ", "linearized", " ", 
     RowBox[{"equation", "."}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"simplifiedLogLinEq", "=", 
     RowBox[{"Simplify", "[", "logLinEq", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Optionally", ",", 
     RowBox[{
     "replace", " ", "steady", " ", "state", " ", "values", " ", "with", " ", 
      "1", " ", "to", " ", "eliminate", " ", 
      RowBox[{"them", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEqNoBar", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"simplifiedLogLinEq", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"hpBar", "->", "1"}], ",", 
         RowBox[{"cpBar", "->", "1"}], ",", 
         RowBox[{"wtBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "8.", " ", "Define", " ", "substitution", " ", "rules", " ", "to", " ", 
     "reintroduce", " ", "time", " ", 
     RowBox[{"indices", "."}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"timeSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"hpHatT", "->", 
        RowBox[{"hpHat", "[", "t", "]"}]}], ",", 
       RowBox[{"cpHatTm1", "->", 
        RowBox[{"cpHat", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], ",", 
       RowBox[{"cpHatT", "->", 
        RowBox[{"cpHat", "[", "t", "]"}]}], ",", 
       RowBox[{"cpHatTp1", "->", 
        RowBox[{"cpHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"cpHatTp2", "->", 
        RowBox[{"cpHat", "[", 
         RowBox[{"t", "+", "2"}], "]"}]}], ",", 
       RowBox[{"wtHatT", "->", 
        RowBox[{"wtHat", "[", "t", "]"}]}]}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqTimeIndexed", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"Finally", ",", 
     RowBox[{
      RowBox[{"output", " ", "the", " ", "final", " ", "time"}], "-", 
      RowBox[{"indexed", " ", "linearized", " ", 
       RowBox[{"equation", ":"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"final", "=", 
    RowBox[{"FullSimplify", "[", "eqTimeIndexed", "]"}]}], "\n", 
   "\n"}]}]], "Input",
 CellChangeTimes->{
  3.947605634796274*^9, 3.9476056662585087`*^9, {3.947689883073887*^9, 
   3.9476898935314236`*^9}, {3.9476899422928123`*^9, 3.9476899665633545`*^9}, 
   3.9476900275814705`*^9, {3.947690175922682*^9, 3.947690179372404*^9}, 
   3.9479498275351105`*^9, {3.9479498757882633`*^9, 3.947949938067442*^9}, {
   3.9487326444039745`*^9, 3.948732658481186*^9}, {3.948732692235449*^9, 
   3.948732718714609*^9}},
 CellLabel->
  "In[225]:=",ExpressionUUID->"1d324b32-3e60-a146-b5b4-6a3a4bd7b1e8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Clear", " ", "all", " ", "symbols", " ", "to", " ", "avoid", " ", 
    "conflicts"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "betaI", ",", "aD", ",", "phi", ",", "eps_ct", ",", "eps_ht", ",", "cI", 
      ",", "cIlag", ",", "hI", ",", "lI", ",", "lIlag", ",", "bI", ",", 
      "bIlag", ",", "rBH", ",", "rBHlag", ",", "wI", ",", "q", ",", "pi", ",",
       "mL", ",", "lambdaI", ",", "muI"}], "]"}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Parameters", " ", "and", " ", "Variables", " ", "for", " ", "Impatient", 
     " ", "Households", " ", 
     RowBox[{"(", "Static", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"{", 
      RowBox[{
      "betaI", ",", "aD", ",", "phi", ",", "eps_ct", ",", "eps_ht", ",", "cI",
        ",", "hI", ",", "lI", ",", "bI", ",", "rBH", ",", "wI", ",", "q", ",",
        "pi", ",", "mL"}], "}"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Utility", " ", "function", " ", "for", " ", "Impatient", " ", 
     "Households"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Note", ":", 
     RowBox[{
      RowBox[{"the", " ", "dynamic", " ", "term"}], "-", 
      RowBox[{"aD", " ", 
       RowBox[{"Log", "[", "cItLag", "]"}], " ", "is", " ", "dropped", " ", 
       "in", " ", "the", " ", "static", " ", "version"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uImpatient", "[", 
      RowBox[{"cI_", ",", "hI_", ",", "lI_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "aD"}], ")"}], "*", "eps_ct", "*", 
       RowBox[{"Log", "[", "cI", "]"}]}], "+", 
      RowBox[{"eps_ht", "*", 
       RowBox[{"Log", "[", "hI", "]"}]}], "-", 
      RowBox[{
       RowBox[{"lI", "^", 
        RowBox[{"(", 
         RowBox[{"1", "+", "phi"}], ")"}]}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", "phi"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Budget", " ", "constraint", " ", "for", " ", "Impatient", " ", 
     "Households"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"In", " ", "a", " ", "static", " ", "setting"}], ",", 
     RowBox[{
     "the", " ", "change", " ", "in", " ", "housing", " ", "is", " ", "zero", 
      " ", "and", " ", "past", " ", "borrowing", " ", "is", " ", 
      "dropped"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BCImpatient", ":=", 
     RowBox[{"cI", "-", 
      RowBox[{"wI", "*", "lI"}], "-", "bI"}]}], ";"}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Borrowing", " ", "constraint", " ", "for", " ", "Impatient", " ", 
     "Households"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"In", " ", "the", " ", "static", " ", "version"}], ",", 
     RowBox[{
      RowBox[{
      "we", " ", "replace", " ", "future", " ", "variables", " ", "with", " ",
        "their", " ", "current"}], "-", 
      RowBox[{"period", " ", "counterparts"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BorrowingConstraint", ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "rBH"}], ")"}], "*", "bI"}], "-", 
      RowBox[{"mL", "*", 
       RowBox[{"(", 
        RowBox[{"q", "*", "hI", "*", "pi"}], ")"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "Lagrangian", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LI", "=", 
     RowBox[{
      RowBox[{"uImpatient", "[", 
       RowBox[{"cI", ",", "hI", ",", "lI"}], "]"}], "+", 
      RowBox[{"lambdaI", "*", "BCImpatient"}], "+", 
      RowBox[{"muI", "*", "BorrowingConstraint"}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"First", "-", 
     RowBox[{
     "order", " ", "conditions", " ", "for", " ", "Impatient", " ", 
      "Households"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focCI", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LI", ",", "cI"}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{
    "FOC", " ", "with", " ", "respect", " ", "to", " ", "consumption", " ", 
     "cI"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focHI", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LI", ",", "hI"}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{
    "FOC", " ", "with", " ", "respect", " ", "to", " ", "housing", " ", 
     "hI"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focLI", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LI", ",", "lI"}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{
    "FOC", " ", "with", " ", "respect", " ", "to", " ", "labor", " ", "lI"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"focBI", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LI", ",", "bI"}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{
    "FOC", " ", "with", " ", "respect", " ", "to", " ", "borrowing", " ", 
     "bI"}], "*)"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Display", " ", "results"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"debugFOCs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<FOC wrt cI\>\"", "->", "focCI"}], ",", 
       RowBox[{"\"\<FOC wrt hI\>\"", "->", "focHI"}], ",", 
       RowBox[{"\"\<FOC wrt lI\>\"", "->", "focLI"}], ",", 
       RowBox[{"\"\<FOC wrt bI\>\"", "->", "focBI"}]}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Output", " ", "the", " ", "Lagrangian", " ", "and", " ", "FOCs"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Lagrangian\>\"", "->", "LI"}], ",", 
     RowBox[{"\"\<First-Order Conditions\>\"", "->", "debugFOCs"}]}], "}"}], 
   "\n", "\n", "\[IndentingNewLine]", "\n"}]}]], "Input",
 CellChangeTimes->{{3.9497651171509666`*^9, 3.9497651195508823`*^9}, {
   3.949765278208153*^9, 3.949765285882271*^9}, 3.9497654644613857`*^9, {
   3.949765564508293*^9, 3.9497655860603027`*^9}, 3.9497661352147675`*^9},
 CellLabel->
  "In[115]:=",ExpressionUUID->"6a3f6837-2a54-ef44-8052-e1074d73f7c7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"Lagrangian\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox["lI", 
        RowBox[{"1", "+", "phi"}]], 
       RowBox[{"1", "+", "phi"}]]}], "+", 
     RowBox[{"muI", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "hI"}], " ", "mL", " ", "pi", " ", "q"}], "+", 
        RowBox[{"bI", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "rBH"}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{"lambdaI", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "bI"}], "+", "cI", "-", 
        RowBox[{"lI", " ", "wI"}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "aD"}], ")"}], " ", 
      RowBox[{"Log", "[", "cI", "]"}], " ", "eps_ct"}], "+", 
     RowBox[{
      RowBox[{"Log", "[", "hI", "]"}], " ", "eps_ht"}]}]}], ",", 
   RowBox[{"\<\"First-Order Conditions\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\<\"FOC wrt cI\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{"lambdaI", "+", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "aD"}], ")"}], " ", "eps_ct"}], "cI"]}], "\[Equal]",
         "0"}]}], ",", 
      RowBox[{"\<\"FOC wrt hI\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", "mL"}], " ", "muI", " ", "pi", " ", "q"}], "+", 
         FractionBox["eps_ht", "hI"]}], "\[Equal]", "0"}]}], ",", 
      RowBox[{"\<\"FOC wrt lI\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["lI", "phi"]}], "-", 
         RowBox[{"lambdaI", " ", "wI"}]}], "\[Equal]", "0"}]}], ",", 
      RowBox[{"\<\"FOC wrt bI\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "lambdaI"}], "+", 
         RowBox[{"muI", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "rBH"}], ")"}]}]}], "\[Equal]", "0"}]}]}], 
     "}"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.949765127389799*^9, 3.9497661601974373`*^9},
 CellLabel->
  "Out[126]=",ExpressionUUID->"cd2aad40-24c0-b249-8758-41ac6cf0420c"]
}, Open  ]],

Cell[BoxData[""], "Input",ExpressionUUID->"d402585a-a83e-ca41-9920-45e9264735da"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Step", " ", "1"}], ":", 
    RowBox[{"Solve", " ", "for", " ", "lambdaI"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"solLambda", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"lambdaI", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "aD"}], ")"}], " ", "eps_ct"}], ")"}], "/", 
          "cI"}]}], "==", "0"}], ",", "lambdaI"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Extract", " ", 
      RowBox[{"solution", ":", "lambdaI"}]}], "=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "aD"}], ")"}], " ", "eps_ct"}], ")"}]}], "/", 
      "cI"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"lambdaSolution", "=", 
     RowBox[{"lambdaI", "/.", " ", 
      RowBox[{"solLambda", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Step", " ", "2"}], ":", 
     RowBox[{
      RowBox[{
       RowBox[{
       "Solve", " ", "for", " ", "muI", " ", "using", " ", "the", " ", 
        "equation"}], "-", "lambdaI", "+", 
       RowBox[{"muI", "*", 
        RowBox[{"(", 
         RowBox[{"1", "+", "rBH"}], ")"}]}]}], "==", "0"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solMu", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "lambdaI"}], "+", 
         RowBox[{"muI", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", "rBH"}], ")"}]}]}], "==", "0"}], ",", "muI"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"This", " ", 
      RowBox[{"gives", ":", "muI"}]}], "=", 
     RowBox[{"lambdaI", "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", "rBH"}], ")"}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"muSolution", "=", 
     RowBox[{"muI", "/.", " ", 
      RowBox[{"solMu", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Step", " ", "3"}], ":", 
     RowBox[{
      RowBox[{
       RowBox[{"Substitute", " ", "muI", " ", "into"}], "-", 
       RowBox[{"mL", "*", "muI", "*", "pi", "*", "q"}], "+", 
       RowBox[{"eps_ht", "/", "hI"}]}], "==", "0"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqFinal", "=", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", "mL"}], "*", "muSolution", "*", "pi", "*", "q"}], "+", 
         RowBox[{"eps_ht", "/", "hI"}]}], "==", "0"}], "]"}], "/.", " ", 
      RowBox[{"lambdaI", "->", "lambdaSolution"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Output", " ", "the", " ", "final", " ", "equation"}], "*)"}], "\n",
    "eqFinal", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Final", " ", "Static", " ", "Condition", " ", "for", " ", "Impatient", " ",
      "Households"}], "*)"}], 
   RowBox[{
    RowBox[{"finalCondition", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[Alpha]", "^", "D"}]}], ")"}], "*", 
          RowBox[{"m", "^", "L"}], "*", 
          RowBox[{"\[Pi]", "^", "I"}], "*", "q", "*", 
          RowBox[{"\[Epsilon]", "^", "c"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", "^", "I"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"r", "^", "B"}]}], ")"}]}], ")"}]}], ")"}], "==", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Epsilon]", "^", "h"}], "/", 
        RowBox[{"h", "^", "I"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Budget", " ", "Constraint", " ", "for", " ", "Impatient", " ", 
     "Households", " ", 
     RowBox[{"(", "static", ")"}]}], "*)"}], 
   RowBox[{
    RowBox[{"BCImpatient", ":=", 
     RowBox[{"cI", "-", 
      RowBox[{"wI", "*", "lI"}], "-", "bI"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Borrowing", " ", "Constraint", " ", "for", " ", "Impatient", " ", 
     "Households", " ", 
     RowBox[{"(", "static", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BorrowingConstraint", ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "rB"}], ")"}], "*", "bI"}], "-", 
      RowBox[{"mL", "*", 
       RowBox[{"(", 
        RowBox[{"q", "*", "hI", "*", "piI"}], ")"}]}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9497646495184097`*^9, 3.9497647232758923`*^9}, 
   3.9497649378496456`*^9, 3.949766542044777*^9, 3.9497670210488567`*^9, {
   3.9497673515261383`*^9, 
   3.9497673536391163`*^9}},ExpressionUUID->"0410ec8e-d993-c04a-ab33-\
5e62699db74b"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "aD"}], ")"}], " ", "mL", " ", "pi", " ", "q", 
    " ", "eps_ct"}], 
   RowBox[{"cI", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "rBH"}], ")"}]}]], "\[Equal]", 
  FractionBox["eps_ht", "hI"]}]], "Output",
 CellChangeTimes->{3.9497665482904987`*^9},
 CellLabel->
  "Out[132]=",ExpressionUUID->"6a9f7868-2426-1848-b619-07a43b89e409"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.947342097073511*^9},
 CellLabel->"",ExpressionUUID->"9e0d05d0-5fdf-944e-97f6-884be9bc4fd5"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.947265153472746*^9},
 CellLabel->"",ExpressionUUID->"1d5db560-18c8-3845-bae1-e95058242b47"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"unpatceint", " ", "households"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.943616429544197*^9, 
  3.943616484662098*^9}},ExpressionUUID->"483b27fc-4b8e-9c46-8db4-\
040fdf9ca070"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", 
   RowBox[{
   "Parameters", " ", "and", " ", "Variables", " ", "for", " ", "Impatient", " ",
     "Households"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"{", 
      RowBox[{"betaI", ",", "aD", ",", "phi", ",", "eps_ct", ",", "eps_ht", ",", 
       RowBox[{"cIt", "[", "t", "]"}], ",", 
       RowBox[{"cItLag", "[", "t", "]"}], ",", 
       RowBox[{"hIt", "[", "t", "]"}], ",", 
       RowBox[{"lIt", "[", "t", "]"}], ",", 
       RowBox[{"lItLag", "[", "t", "]"}], ",", 
       RowBox[{"bIt", "[", "t", "]"}], ",", 
       RowBox[{"bItLag", "[", "t", "]"}], ",", 
       RowBox[{"rBH", "[", "t", "]"}], ",", 
       RowBox[{"rBH", "[", "tLag", "]"}], ",", 
       RowBox[{"wIt", "[", "t", "]"}], ",", 
       RowBox[{"qt", "[", "t", "]"}], ",", 
       RowBox[{"pit", "[", "t", "]"}], ",", 
       RowBox[{"mLt", "[", "t", "]"}], ",", 
       RowBox[{"hItLag", "[", "t", "]"}]}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Utility", " ", "function", " ", "for", " ", "impatient", " ", 
     "households"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uImpatient", "[", 
      RowBox[{"cIt_", ",", "cItLag_", ",", "hIt_", ",", "lIt_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "aD"}], ")"}], " ", "eps_ct", " ", 
       RowBox[{"Log", "[", "cIt", "]"}]}], "-", 
      RowBox[{"aD", " ", 
       RowBox[{"Log", "[", "cItLag", "]"}]}], "+", 
      RowBox[{"eps_ht", " ", 
       RowBox[{"Log", "[", "hIt", "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"lIt", "^", 
         RowBox[{"(", 
          RowBox[{"1", "+", "phi"}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", "phi"}], ")"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Budget", " ", "constraint", " ", "for", " ", "impatient", " ", 
     "households", " ", "in", " ", "period", " ", "t"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BCImpatient", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"cIt", "[", "t", "]"}], "+", 
      RowBox[{
       RowBox[{"qt", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"hIt", "[", "t", "]"}], "-", 
         RowBox[{"hIt", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"rBH", "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ")"}], "/", 
         RowBox[{"pit", "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"bIt", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"wIt", "[", "t", "]"}], " ", 
       RowBox[{"lIt", "[", "t", "]"}]}], "-", 
      RowBox[{"bIt", "[", "t", "]"}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Borrowing", " ", "constraint", " ", "for", " ", "impatient", " ", 
     "households", " ", "in", " ", "period", " ", "t"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BorrowingConstraint", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"rBH", "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"bIt", "[", "t", "]"}]}], "-", 
      RowBox[{
       RowBox[{"mLt", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"qt", "[", 
          RowBox[{"t", "+", "1"}], "]"}], " ", 
         RowBox[{"hIt", "[", "t", "]"}], " ", 
         RowBox[{"pit", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", "Lagrangian", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LI", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"uImpatient", "[", 
         RowBox[{
          RowBox[{"cIt", "[", "t", "]"}], ",", 
          RowBox[{"cIt", "[", 
           RowBox[{"t", "-", "1"}], "]"}], ",", 
          RowBox[{"hIt", "[", "t", "]"}], ",", 
          RowBox[{"lIt", "[", "t", "]"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{"lambdaI", "[", "t", "]"}], " ", 
         RowBox[{"BCImpatient", "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"muI", "[", "t", "]"}], " ", 
         RowBox[{"BorrowingConstraint", "[", "t", "]"}]}]}], ")"}], "+", 
      RowBox[{
       RowBox[{"betaI", "^", 
        RowBox[{"(", 
         RowBox[{"t", "+", "1"}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"uImpatient", "[", 
          RowBox[{
           RowBox[{"cIt", "[", 
            RowBox[{"t", "+", "1"}], "]"}], ",", 
           RowBox[{"cIt", "[", "t", "]"}], ",", 
           RowBox[{"hIt", "[", 
            RowBox[{"t", "+", "1"}], "]"}], ",", 
           RowBox[{"lIt", "[", 
            RowBox[{"t", "+", "1"}], "]"}]}], "]"}], "+", 
         RowBox[{
          RowBox[{"lambdaI", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"BCImpatient", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"muI", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"BorrowingConstraint", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"First", "-", 
     RowBox[{
     "order", " ", "conditions", " ", "for", " ", "impatient", " ", 
      "households"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focCtI", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LI", ",", 
        RowBox[{"cIt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "consumption", " ", 
     RowBox[{"cIt", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focHtI", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LI", ",", 
        RowBox[{"hIt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "housing", " ", 
     RowBox[{"hIt", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focLtI", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LI", ",", 
        RowBox[{"lIt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "hours", " ", "worked", " ", 
     RowBox[{"lIt", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focBtI", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LI", ",", 
        RowBox[{"bIt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "borrowing", " ", 
     RowBox[{"bIt", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Display", " ", "results"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"debugFOCs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<FOC wrt cIt[t]\>\"", "->", "focCtI"}], ",", 
       RowBox[{"\"\<FOC wrt hIt[t]\>\"", "->", "focHtI"}], ",", 
       RowBox[{"\"\<FOC wrt lIt[t]\>\"", "->", "focLtI"}], ",", 
       RowBox[{"\"\<FOC wrt bIt[t]\>\"", "->", "focBtI"}]}], "}"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Output", " ", "the", " ", "Lagrangian", " ", "and", " ", "FOCs"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Lagrangian\>\"", "->", "LI"}], ",", 
     RowBox[{"\"\<First-Order Conditions\>\"", "->", "debugFOCs"}]}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{
  3.9428556216292534`*^9, 3.9428558638346443`*^9, 3.942856329183136*^9, 
   3.9428564862004185`*^9, 3.9428566889696026`*^9, {3.942856910773079*^9, 
   3.9428569354905777`*^9}, {3.942857364787548*^9, 3.9428573898232937`*^9}, {
   3.9428577783808823`*^9, 3.9428578049808903`*^9}, 3.9428579940329285`*^9, {
   3.9428580395093536`*^9, 3.942858042871578*^9}, 3.9428591140860786`*^9, 
   3.9431155151779137`*^9, {3.9431158839568024`*^9, 3.943115919462967*^9}, {
   3.943116017131489*^9, 3.943116043165043*^9}, {3.943116203605345*^9, 
   3.943116248865116*^9}, 3.943116279396555*^9, {3.9431165276830425`*^9, 
   3.943116567202736*^9}, {3.94311672191103*^9, 3.943116753600672*^9}, {
   3.943116983151354*^9, 3.9431169998925896`*^9}, {3.9431182676864986`*^9, 
   3.943118310423565*^9}, {3.9431188651155624`*^9, 3.9431188743868217`*^9}, {
   3.9431189471438274`*^9, 3.943118963078903*^9}, {3.9431190017983513`*^9, 
   3.9431190163987827`*^9}, 3.9431844617301445`*^9, {3.943184531994499*^9, 
   3.9431845466193027`*^9}, {3.9431847557619095`*^9, 3.943184775501425*^9}, {
   3.943359097367693*^9, 3.943359119211834*^9}, 3.943368823503065*^9, 
   3.9433689041234646`*^9, 3.9433690047130775`*^9, {3.943372602202656*^9, 
   3.9433726292470894`*^9}, 3.9433731892332497`*^9, 3.943373405777813*^9, 
   3.943373880790806*^9, 3.9435298263594894`*^9, {3.943531181261368*^9, 
   3.943531227021929*^9}, 3.943533171298271*^9, {3.9435333243153496`*^9, 
   3.9435333617947254`*^9}, 3.9435362777779655`*^9, 3.9435367592692184`*^9, {
   3.9435380153508034`*^9, 3.943538038666689*^9}, {3.943548833672926*^9, 
   3.9435488363959446`*^9}, 3.9435490988596954`*^9, {3.9435491348483696`*^9, 
   3.943549140611929*^9}, {3.9435492777151756`*^9, 3.9435492934218426`*^9}, {
   3.943616506312252*^9, 3.9436165507183113`*^9}, {3.9436180500715656`*^9, 
   3.9436180530685368`*^9}, {3.945173009921896*^9, 3.945173031726755*^9}, {
   3.9451733102613754`*^9, 3.945173337662203*^9}, 3.9463751018555126`*^9, 
   3.9463802729152527`*^9, {3.946380978417076*^9, 3.9463810300157757`*^9}, 
   3.946396126499422*^9, 3.946397331734724*^9, 3.946398470666641*^9, 
   3.9463985289595127`*^9, 3.9463986259487324`*^9, {3.9464011586499176`*^9, 
   3.9464011613548775`*^9}, {3.9464016694565735`*^9, 
   3.9464017233964157`*^9}, {3.946402820333645*^9, 3.9464028291536007`*^9}, {
   3.9464035597819443`*^9, 3.946403566628748*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"94fcf45b-6f21-634c-b1d5-7d0ae8a5c58d"],

Cell[BoxData[""], "Input",ExpressionUUID->"b9ef39e2-d105-c74c-ae1b-589fe4deab77"],

Cell[BoxData[
 RowBox[{"\n", "\n", "\n", "\[IndentingNewLine]", 
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]}]], "Input",
 CellChangeTimes->{
  3.946400316124754*^9, 3.9464005812752533`*^9, {3.94640143677759*^9, 
   3.9464014829991436`*^9}, {3.946401823560726*^9, 3.946401836477703*^9}, 
   3.946403333041109*^9},ExpressionUUID->"8880107c-6260-f84b-9c38-\
4d69438e0d38"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", 
   RowBox[{"Define", " ", "FOC", " ", "wrt", " ", 
    RowBox[{"cIt", "[", "t", "]"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"eq1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"aD", " ", 
            RowBox[{"betaI", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}]}], ")"}], "/", 
          RowBox[{"cIt", "[", "t", "]"}]}], ")"}]}], "+", 
       RowBox[{"lambdaI", "[", "t", "]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "aD"}], ")"}], " ", "eps_ct"}], ")"}], "/", 
        RowBox[{"cIt", "[", "t", "]"}]}]}], "==", "0"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"1", ")"}], " ", "Solve", " ", "eq1", " ", "for", " ", 
     RowBox[{"lambdaI", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solLambda", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"eq1", ",", 
       RowBox[{"lambdaI", "[", "t", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Result", " ", "gives", " ", 
      RowBox[{"lambdaI", "[", "t", "]"}], " ", "in", " ", "terms", " ", "of", 
      " ", "aD"}], ",", "betaI", ",", "eps_ct", ",", 
     RowBox[{"and", " ", 
      RowBox[{"cIt", "[", "t", "]"}]}]}], "*)"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Define", " ", "other", " ", "FOCs"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focSystem", "=", 
     RowBox[{"{", 
      RowBox[{"(*", 
       RowBox[{"FOC", " ", "wrt", " ", 
        RowBox[{"hIt", "[", "t", "]"}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"eps_ht", "/", 
          RowBox[{"hIt", "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"lambdaI", "[", "t", "]"}], " ", 
          RowBox[{"qt", "[", "t", "]"}]}], "-", 
         RowBox[{
          RowBox[{"betaI", "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "t"}], ")"}]}], " ", 
          RowBox[{"lambdaI", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"qt", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"mLt", "[", "t", "]"}], " ", 
          RowBox[{"muI", "[", "t", "]"}], " ", 
          RowBox[{"pit", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"qt", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}]}], "==", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"lIt", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{
           RowBox[{"lIt", "[", "t", "]"}], "^", "phi"}]}], "-", 
         RowBox[{
          RowBox[{"lambdaI", "[", "t", "]"}], " ", 
          RowBox[{"wIt", "[", "t", "]"}]}]}], "==", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"bIt", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"lambdaI", "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"muI", "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"rBH", "[", "t", "]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betaI", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}], " ", 
            RowBox[{"lambdaI", "[", 
             RowBox[{"t", "+", "1"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rBH", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"pit", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}]}], "==", "0"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"2", ")"}], " ", "Use", " ", "time", " ", "identity"}], ",", 
     RowBox[{
      RowBox[{"lambdaI", "[", 
       RowBox[{"t", "+", "1"}], "]"}], " ", "and", " ", 
      RowBox[{"lambdaI", "[", 
       RowBox[{"t", "-", "1"}], "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lambdaNext", "=", 
     RowBox[{"solLambda", "/.", " ", 
      RowBox[{"t", "->", 
       RowBox[{"t", "+", "1"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"lambdaPrev", "=", 
     RowBox[{"solLambda", "/.", " ", 
      RowBox[{"t", "->", 
       RowBox[{"t", "-", "1"}]}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"3", ")"}], " ", "Substitute", " ", "solution", " ", "into", " ",
      "the", " ", "system", " ", "of", " ", "FOCs"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focSystemSub", "=", 
     RowBox[{
      RowBox[{"focSystem", "/.", " ", 
       RowBox[{"solLambda", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "/.", " ", 
      RowBox[{"lambdaNext", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Print", " ", "the", " ", "system", " ", "of", " ", "equations", " ", 
     "after", " ", "substitution"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<System of equations after substitution: \>\"", ",", 
      "focSystemSub"}], "]"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Solve", " ", "for", " ", "remaining", " ", "variables"}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"focSystemSub", ",", 
       RowBox[{"{", 
        RowBox[{"muI", "[", "t", "]"}], 
        RowBox[{"(*", 
         RowBox[{
         "Add", " ", "other", " ", "variables", " ", "if", " ", "needed"}], 
         "*)"}], "}"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Example", ":", 
     RowBox[{"Substitute", " ", 
      RowBox[{"muI", "[", "t", "]"}], " ", "from", " ", "FOC", " ", "wrt", " ", 
      RowBox[{"bIt", "[", "t", "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"muISolution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"focSystemSub", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"muI", "[", "t", "]"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Substitute", " ", 
     RowBox[{"muI", "[", "t", "]"}], " ", "into", " ", "FOC", " ", "wrt", " ", 
     RowBox[{"hIt", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq1Sub", "=", 
     RowBox[{
      RowBox[{"focSystemSub", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/.", " ", 
      RowBox[{"muISolution", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Keep", " ", "FOC", " ", "wrt", " ", 
     RowBox[{"lIt", "[", "t", "]"}], " ", "unchanged"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq2", "=", 
     RowBox[{"focSystemSub", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Print", " ", "results"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Equation wrt hIt[t] after elimination of muI[t]: \>\"", ",",
       "eq1Sub"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Equation wrt lIt[t] remains: \>\"", ",", "eq2"}], "]"}], 
    ";"}], "\[IndentingNewLine]", "solLambda", "\[IndentingNewLine]", 
   "lambdaNext", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\n"}]}]], "Input",
 CellChangeTimes->{
  3.942592057012724*^9, {3.942592245428005*^9, 3.94259229837319*^9}, {
   3.94259276149564*^9, 3.942592764239746*^9}, {3.9425935259046726`*^9, 
   3.942593548727476*^9}, 3.9425936374098434`*^9, {3.942594582938095*^9, 
   3.942594602603157*^9}, 3.9425946466589737`*^9, {3.9425949113557167`*^9, 
   3.9425949911134377`*^9}, 3.942595094281233*^9, {3.942595174682337*^9, 
   3.942595279071537*^9}, 3.942595447132061*^9, {3.9425956151379395`*^9, 
   3.94259563994841*^9}, 3.942595669960287*^9, {3.9425959508937435`*^9, 
   3.9425959719109993`*^9}, 3.9427690351333847`*^9, 3.9427690682198257`*^9, 
   3.9427715635525856`*^9, 3.9428545977365494`*^9, 3.9430291244111385`*^9, {
   3.9430293293032436`*^9, 3.9430293321251163`*^9}, 3.943029903411661*^9, 
   3.943029935968582*^9, {3.9430300915187435`*^9, 3.9430300983569183`*^9}, 
   3.943030165224594*^9, 3.943031018565777*^9, 3.9430310525436935`*^9, 
   3.9430315909590073`*^9, {3.943031676607229*^9, 3.943031762295637*^9}, {
   3.943032046234873*^9, 3.94303207506736*^9}, {3.943032277998928*^9, 
   3.943032328893503*^9}, 3.9430323609657345`*^9, {3.9430338379985332`*^9, 
   3.9430338777026024`*^9}, {3.9430340737475815`*^9, 3.9430340995907764`*^9}, 
   3.943034138748911*^9, 3.943034215671747*^9, 3.9430955097704773`*^9, 
   3.9433588087017574`*^9, 3.9433588506085987`*^9, 3.9433604537355385`*^9, 
   3.9433690498361454`*^9, {3.943369097716297*^9, 3.9433691157514877`*^9}, {
   3.9433691779950886`*^9, 3.9433691920949574`*^9}, {3.943369408544922*^9, 
   3.943369419957775*^9}, {3.9433694534026623`*^9, 3.9433694610976887`*^9}, {
   3.9433718095535316`*^9, 3.9433718209741173`*^9}, {3.943371942155674*^9, 
   3.943371948822159*^9}, {3.943372132182953*^9, 3.9433721356424065`*^9}, {
   3.9433723369107685`*^9, 3.9433723433940105`*^9}, {3.9433725200260067`*^9, 
   3.943372539188036*^9}, 3.9433729214440956`*^9, 3.946134979625437*^9, {
   3.946135028668358*^9, 3.9461350308236866`*^9}, {3.946380295211197*^9, 
   3.946380296539772*^9}, {3.94640043978706*^9, 3.946400483226412*^9}, 
   3.9464023612987766`*^9, {3.9464025415333214`*^9, 3.9464025643481045`*^9}, {
   3.9464031878470516`*^9, 3.946403191088213*^9}, {3.9464034240072136`*^9, 
   3.9464034490416183`*^9}, {3.9488902899661713`*^9, 3.9488902933353233`*^9}, 
   3.948890337427595*^9},
 CellLabel->
  "In[163]:=",ExpressionUUID->"b0b5f86b-cc2e-e04d-b2ed-4360d9e5fb4f"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.942592057012724*^9, {3.942592245428005*^9, 3.94259229837319*^9}, {
   3.94259276149564*^9, 3.942592764239746*^9}, {3.9425935259046726`*^9, 
   3.942593548727476*^9}, 3.9425936374098434`*^9, {3.942594582938095*^9, 
   3.942594602603157*^9}, 3.9425946466589737`*^9, {3.9425949113557167`*^9, 
   3.9425949911134377`*^9}, 3.942595094281233*^9, {3.942595174682337*^9, 
   3.942595279071537*^9}, 3.942595447132061*^9, {3.9425956151379395`*^9, 
   3.94259563994841*^9}, 3.942595669960287*^9, {3.9425959508937435`*^9, 
   3.9425959719109993`*^9}, 3.9427690351333847`*^9, 3.9427690682198257`*^9, 
   3.9427715635525856`*^9, 3.9428545977365494`*^9, 3.9430291244111385`*^9, {
   3.9430293293032436`*^9, 3.9430293321251163`*^9}, 3.943029903411661*^9, 
   3.943029935968582*^9, {3.9430300915187435`*^9, 3.9430300983569183`*^9}, 
   3.943030165224594*^9, 3.943031018565777*^9, 3.9430310525436935`*^9, 
   3.9430315909590073`*^9, {3.943031676607229*^9, 3.943031762295637*^9}, {
   3.943032046234873*^9, 3.94303207506736*^9}, {3.943032277998928*^9, 
   3.943032328893503*^9}, 3.9430323609657345`*^9, {3.9430338379985332`*^9, 
   3.9430338777026024`*^9}, {3.9430340737475815`*^9, 3.9430340995907764`*^9}, 
   3.943034138748911*^9, 3.943034215671747*^9, 3.9430955097704773`*^9, 
   3.9433588087017574`*^9, 3.9433588506085987`*^9, 3.9433604537355385`*^9, 
   3.9433690498361454`*^9, {3.943369097716297*^9, 3.9433691157514877`*^9}, {
   3.9433691779950886`*^9, 3.9433691920949574`*^9}, {3.943369408544922*^9, 
   3.943369419957775*^9}, {3.9433694534026623`*^9, 3.9433694610976887`*^9}, {
   3.9433718095535316`*^9, 3.9433718209741173`*^9}, {3.943371942155674*^9, 
   3.943371948822159*^9}, {3.943372132182953*^9, 3.9433721356424065`*^9}, {
   3.9433723369107685`*^9, 3.9433723433940105`*^9}, {3.9433725200260067`*^9, 
   3.943372539188036*^9}, 3.9433729214440956`*^9, 3.946134979625437*^9, {
   3.946135028668358*^9, 3.9461350308236866`*^9}, {3.946380295211197*^9, 
   3.946380296539772*^9}, {3.94640043978706*^9, 3.946400483226412*^9}, 
   3.9464023612987766`*^9, {3.9464025415333214`*^9, 3.9464025643481045`*^9}, {
   3.9464031878470516`*^9, 3.946403191088213*^9}, {3.9464034240072136`*^9, 
   3.9464034490416183`*^9}, 3.94734240899786*^9, 3.947342456115858*^9, 
   3.9476906366089897`*^9},ExpressionUUID->"5b2a032a-505e-c740-a415-\
a5a50f903e5d"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "1.", " ", "Clear", " ", "and", " ", "declare", " ", "all", " ", 
    "variables", " ", "as", " ", 
    RowBox[{"symbols", "."}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "eps_ht", ",", "hIt", ",", "cIt", ",", "q", ",", "mL", ",", "pit", ",", 
      "rBH", ",", "eps_ct", ",", "aD", ",", "betaI", ",", "t", ",", "hItBar", 
      ",", "cItBar", ",", "qBar", ",", "cItBar1", ",", "qBar1", ",", "mLBar", 
      ",", "pitBar", ",", "rBHBar"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Optionally", ",", 
     RowBox[{
      RowBox[{"load", " ", "them", " ", "as", " ", 
       RowBox[{"symbols", ":", 
        RowBox[{"Symbol", "/@", 
         RowBox[{"{", 
          
          RowBox[{"\"\<eps_ht\>\"", ",", "\"\<hIt\>\"", ",", "\"\<cIt\>\"", 
           ",", "\"\<q\>\"", ",", "\"\<mL\>\"", ",", "\"\<pit\>\"", 
           ",", "\"\<rBH\>\"", ",", "\"\<eps_ct\>\"", ",", "\"\<aD\>\"", 
           ",", "\"\<betaI\>\"", ",", "\"\<t\>\"", ",", "\"\<hItBar\>\"", 
           ",", "\"\<cItBar\>\"", ",", "\"\<qBar\>\"", ",", "\"\<cItBar1\>\"",
            ",", "\"\<qBar1\>\"", ",", "\"\<mLBar\>\"", ",", "\"\<pitBar\>\"",
            ",", "\"\<rBHBar\>\""}], "}"}]}]}]}], ";"}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "2.", " ", "Define", " ", "the", " ", "original", " ", "equation", " ", 
       "as", " ", "F", 
       RowBox[{"(", "...", ")"}]}], "==", 
      RowBox[{
      "0.", " ", "We", " ", "create", " ", "dummy", " ", "variables", " ", 
       "for", " ", "the", " ", "time\:2011t", " ", "and", " ", "time\:2011", 
       RowBox[{"(", 
        RowBox[{"t", "+", "1"}], ")"}], " ", 
       RowBox[{"objects", ".", 
        RowBox[{"Here", ":", 
         RowBox[{"-", "hItT"}]}]}]}]}], ",", "cItT", ",", 
     RowBox[{"qT", " ", "represent", " ", 
      RowBox[{"hIt", "[", "t", "]"}]}], ",", 
     RowBox[{"cIt", "[", "t", "]"}], ",", 
     RowBox[{"q", "[", "t", "]"}], ",", 
     RowBox[{"-", "cItT1"}], ",", "qT1", ",", 
     RowBox[{"pitT1", " ", "represent", " ", 
      RowBox[{"cIt", "[", 
       RowBox[{"1", "+", "t"}], "]"}]}], ",", 
     RowBox[{"q", "[", 
      RowBox[{"1", "+", "t"}], "]"}], ",", 
     RowBox[{"pit", "[", 
      RowBox[{"1", "+", "t"}], "]"}], ",", 
     RowBox[{
      RowBox[{"-", "mLT"}], " ", "and", " ", "rBHt", " ", "denote", " ", 
      RowBox[{"mL", "[", "t", "]"}], " ", "and", " ", 
      RowBox[{
       RowBox[{"rBH", "[", "t", "]"}], "."}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{
      "hItT_", ",", "cItT_", ",", "qT_", ",", "cItT1_", ",", "qT1_", ",", 
       "mLT_", ",", "pitT1_", ",", "rBHt_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"eps_ht", "/", "hItT"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"aD", "*", 
            RowBox[{"betaI", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}]}], "-", "eps_ct", "+", 
           RowBox[{"aD", "*", "eps_ct"}]}], ")"}], "*", "qT"}], ")"}], "/", 
       "cItT"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"betaI", "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "t"}], ")"}]}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"aD", "*", 
            RowBox[{"betaI", "^", 
             RowBox[{"(", 
              RowBox[{"2", "+", "t"}], ")"}]}]}], "-", "eps_ct", "+", 
           RowBox[{"aD", "*", "eps_ct"}]}], ")"}], "*", "qT1"}], ")"}], "/", 
       "cItT1"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"mLT", "*", "pitT1", "*", "qT1", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"aD", "*", 
                RowBox[{"betaI", "^", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", "t"}], ")"}]}]}], "-", "eps_ct", "+", 
               RowBox[{"aD", "*", "eps_ct"}]}], ")"}], "/", "cItT"}], ")"}], "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"betaI", "^", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "t"}], ")"}]}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"aD", "*", 
                  RowBox[{"betaI", "^", 
                   RowBox[{"(", 
                    RowBox[{"2", "+", "t"}], ")"}]}]}], "-", "eps_ct", "+", 
                 RowBox[{"aD", "*", "eps_ct"}]}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{"1", "+", "rBHt"}], ")"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"cItT1", "*", "pitT1"}], ")"}]}], ")"}]}], ")"}]}], 
        ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", "rBHt"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"3.", " ", "Collect", " ", "the", " ", "variables", " ", 
     RowBox[{"we", "'"}], "ll", " ", "differentiate", " ", "with", " ", 
     "respect", " ", 
     RowBox[{"to", "."}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{
      "hItT", ",", "cItT", ",", "qT", ",", "cItT1", ",", "qT1", ",", "mLT", ",",
        "pitT1", ",", "rBHt"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "4.", " ", "Compute", " ", "partial", " ", "derivatives", " ", "of", " ",
        "F", " ", "at", " ", "the", " ", "steady", " ", 
       RowBox[{"state", ".", "The"}], " ", "steady", " ", "state", " ", "is", 
       " ", "given", " ", "by", " ", 
       RowBox[{"replacing", ":", "hItT"}]}], "->", "hItBar"}], ",", 
     RowBox[{"cItT", "->", "cItBar"}], ",", 
     RowBox[{"qT", "->", "qBar"}], ",", 
     RowBox[{"cItT1", "->", "cItBar1"}], ",", 
     RowBox[{"qT1", "->", "qBar1"}], ",", 
     RowBox[{"mLT", "->", "mLBar"}], ",", 
     RowBox[{"pitT1", "->", "pitBar"}], ",", 
     RowBox[{"rBHt", "->", 
      RowBox[{"rBHBar", "."}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"hItT", "->", "hItBar"}], ",", 
          RowBox[{"cItT", "->", "cItBar"}], ",", 
          RowBox[{"qT", "->", "qBar"}], ",", 
          RowBox[{"cItT1", "->", "cItBar1"}], ",", 
          RowBox[{"qT1", "->", "qBar1"}], ",", 
          RowBox[{"mLT", "->", "mLBar"}], ",", 
          RowBox[{"pitT1", "->", "pitBar"}], ",", 
          RowBox[{"rBHt", "->", "rBHBar"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"5.", " ", "Define", " ", "symbols", " ", "for", " ", "log"}], "\[Hyphen]", 
     RowBox[{"deviations", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", " ", "ln", " ", "X"}], ")"}], "."}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "hItHatT", ",", "cItHatT", ",", "qHatT", ",", "cItHatT1", ",", "qHatT1", 
      ",", "mLHatT", ",", "pitHatT", ",", "rBHHatT"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "6.", " ", "Multiply", " ", "each", " ", "partial", " ", "derivative", " ",
       "by", " ", "the", " ", "steady", " ", "state", " ", "level", " ", 
      "and", " ", "its", " ", "corresponding", " ", 
      RowBox[{"hat", ".", "This"}], " ", "yields", " ", "the", " ", 
      "linearized", " ", "equation", " ", "in", " ", "terms", " ", "of", " ", 
      "log"}], "\[Hyphen]", 
     RowBox[{"deviations", "."}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"varsBar", "=", 
     RowBox[{"{", 
      RowBox[{
      "hItBar", ",", "cItBar", ",", "qBar", ",", "cItBar1", ",", "qBar1", ",",
        "mLBar", ",", "pitBar", ",", "rBHBar"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", "hItBar", "*", "hItHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", "cItBar", "*", "cItHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", "qBar", "*", "qHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "*", "cItBar1", "*", "cItHatT1"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "*", "qBar1", "*", "qHatT1"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "*", "mLBar", "*", "mLHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "7", "]"}], "]"}], "*", "pitBar", "*", "pitHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "8", "]"}], "]"}], "*", "rBHBar", "*", "rBHHatT"}]}], "==",
       "0"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"7.", " ", "Simplify", " ", "the", " ", "final", " ", "linear", " ", 
     RowBox[{"equation", "."}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"simplifiedLogLinEq", "=", 
     RowBox[{"Simplify", "[", "logLinEq", "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Optionally", ",", 
     RowBox[{
     "replace", " ", "steady", " ", "state", " ", "values", " ", "with", " ", 
      "1", " ", "to", " ", "eliminate", " ", "them"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEqNoBar", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"simplifiedLogLinEq", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"hItBar", "->", "1"}], ",", 
         RowBox[{"cItBar", "->", "1"}], ",", 
         RowBox[{"qBar", "->", "1"}], ",", 
         RowBox[{"cItBar1", "->", "1"}], ",", 
         RowBox[{"qBar1", "->", "1"}], ",", 
         RowBox[{"mLBar", "->", "1"}], ",", 
         RowBox[{"pitBar", "->", "1"}], ",", 
         RowBox[{"rBHBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "8.", " ", "Define", " ", "substitution", " ", "rules", " ", "to", " ", 
       "reintroduce", " ", "time", " ", 
       RowBox[{"indices", ".", "Here"}], " ", "we", " ", 
       RowBox[{"assign", ":", "hItHatT"}]}], "->", 
      RowBox[{"hItHat", "[", "t", "]"}]}], ",", 
     RowBox[{"cItHatT", "->", 
      RowBox[{"cItHat", "[", "t", "]"}]}], ",", 
     RowBox[{"qHatT", "->", 
      RowBox[{"qHat", "[", "t", "]"}]}], ",", 
     RowBox[{"cItHatT1", "->", 
      RowBox[{"cItHat", "[", 
       RowBox[{"t", "+", "1"}], "]"}]}], ",", 
     RowBox[{"qHatT1", "->", 
      RowBox[{"qHat", "[", 
       RowBox[{"t", "+", "1"}], "]"}]}], ",", 
     RowBox[{"mLHatT", "->", 
      RowBox[{"mLHat", "[", "t", "]"}]}], ",", 
     RowBox[{"pitHatT", "->", 
      RowBox[{"pitHat", "[", 
       RowBox[{"t", "+", "1"}], "]"}]}], ",", 
     RowBox[{"rBHHatT", "->", 
      RowBox[{"rBHHat", "[", "t", "]"}]}], ",", 
     RowBox[{"and", " ", "we", " ", "also", " ", "re"}], "\[Hyphen]", 
     RowBox[{"write", " ", "the", " ", "time"}], "\[Dash]", 
     RowBox[{"exponents", " ", "on", " ", 
      RowBox[{"betaI", "."}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"timeSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"hItHatT", "->", 
        RowBox[{"hItHat", "[", "t", "]"}]}], ",", 
       RowBox[{"cItHatT", "->", 
        RowBox[{"cItHat", "[", "t", "]"}]}], ",", 
       RowBox[{"qHatT", "->", 
        RowBox[{"qHat", "[", "t", "]"}]}], ",", 
       RowBox[{"cItHatT1", "->", 
        RowBox[{"cItHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"qHatT1", "->", 
        RowBox[{"qHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"mLHatT", "->", 
        RowBox[{"mLHat", "[", "t", "]"}]}], ",", 
       RowBox[{"pitHatT", "->", 
        RowBox[{"pitHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"rBHHatT", "->", 
        RowBox[{"rBHHat", "[", "t", "]"}]}], ",", 
       RowBox[{
        RowBox[{"betaI", "^", 
         RowBox[{"(", 
          RowBox[{"1", "+", "t"}], ")"}]}], "->", 
        RowBox[{"betaI", "^", 
         RowBox[{"(", 
          RowBox[{"t", "+", "1"}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{"betaI", "^", 
         RowBox[{"(", 
          RowBox[{"2", "+", "t"}], ")"}]}], "->", 
        RowBox[{"betaI", "^", 
         RowBox[{"(", 
          RowBox[{"t", "+", "2"}], ")"}]}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"eqTimeIndexed", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Finally", ",", 
     RowBox[{
     "output", " ", "the", " ", "versions", " ", "without", " ", "time", " ", 
      "indices", " ", "and", " ", "with", " ", "time", " ", 
      RowBox[{"indices", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
   "logLinEqNoBar", "\n", 
   RowBox[{"final", " ", "=", 
    RowBox[{"FullSimplify", "[", "eqTimeIndexed", "]"}]}], "\[IndentingNewLine]",
    "final", "\n"}]}]], "Input",
 CellChangeTimes->{
  3.942592057012724*^9, {3.942592245428005*^9, 3.94259229837319*^9}, {
   3.94259276149564*^9, 3.942592764239746*^9}, {3.9425935259046726`*^9, 
   3.942593548727476*^9}, 3.9425936374098434`*^9, {3.942594582938095*^9, 
   3.942594602603157*^9}, 3.9425946466589737`*^9, {3.9425949113557167`*^9, 
   3.9425949911134377`*^9}, 3.942595094281233*^9, {3.942595174682337*^9, 
   3.942595279071537*^9}, 3.942595447132061*^9, {3.9425956151379395`*^9, 
   3.94259563994841*^9}, 3.942595669960287*^9, {3.9425959508937435`*^9, 
   3.9425959719109993`*^9}, 3.9427690351333847`*^9, 3.9427690682198257`*^9, 
   3.9427715635525856`*^9, 3.9428545977365494`*^9, 3.9430291244111385`*^9, {
   3.9430293293032436`*^9, 3.9430293321251163`*^9}, 3.943029903411661*^9, 
   3.943029935968582*^9, {3.9430300915187435`*^9, 3.9430300983569183`*^9}, 
   3.943030165224594*^9, 3.943031018565777*^9, 3.9430310525436935`*^9, 
   3.9430315909590073`*^9, {3.943031676607229*^9, 3.943031762295637*^9}, {
   3.943032046234873*^9, 3.94303207506736*^9}, {3.943032277998928*^9, 
   3.943032328893503*^9}, 3.9430323609657345`*^9, {3.9430338379985332`*^9, 
   3.9430338777026024`*^9}, {3.9430340737475815`*^9, 3.9430340995907764`*^9}, 
   3.943034138748911*^9, 3.943034215671747*^9, 3.9430955097704773`*^9, 
   3.9433588087017574`*^9, 3.9433588506085987`*^9, 3.9433604537355385`*^9, 
   3.9433690498361454`*^9, {3.943369097716297*^9, 3.9433691157514877`*^9}, {
   3.9433691779950886`*^9, 3.9433691920949574`*^9}, {3.943369408544922*^9, 
   3.943369419957775*^9}, {3.9433694534026623`*^9, 3.9433694610976887`*^9}, {
   3.9433718095535316`*^9, 3.9433718209741173`*^9}, {3.943371942155674*^9, 
   3.943371948822159*^9}, {3.943372132182953*^9, 3.9433721356424065`*^9}, {
   3.9433723369107685`*^9, 3.9433723433940105`*^9}, {3.9433725200260067`*^9, 
   3.943372539188036*^9}, 3.9433729214440956`*^9, 3.946134979625437*^9, {
   3.946135028668358*^9, 3.9461350308236866`*^9}, {3.946380295211197*^9, 
   3.946380296539772*^9}, {3.94640043978706*^9, 3.946400483226412*^9}, 
   3.9464023612987766`*^9, {3.9464025415333214`*^9, 3.9464025643481045`*^9}, {
   3.9464031878470516`*^9, 3.946403191088213*^9}, {3.9464034240072136`*^9, 
   3.9464034490416183`*^9}, 3.94734240899786*^9, {3.947342456115858*^9, 
   3.9473425197101955`*^9}, {3.9473429805323334`*^9, 3.9473429810118866`*^9}, 
   3.947343041703169*^9, 3.9476906567326527`*^9, {3.947690980682455*^9, 
   3.9476909851086464`*^9}, {3.947691065119421*^9, 3.947691067107668*^9}, {
   3.9479502014980087`*^9, 3.9479502457827015`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"0e074e25-5497-e244-8216-c9871e946f7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "1.", " ", "Clear", " ", "and", " ", "declare", " ", "all", " ", 
    "variables", " ", "as", " ", 
    RowBox[{"symbols", "."}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "lItT", ",", "cItT", ",", "wItT", ",", "aD", ",", "betaI", ",", "eps_ct",
       ",", "phi", ",", "t", ",", "lItBar", ",", "cItBar", ",", "wItBar"}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Optionally", ",", 
     RowBox[{
      RowBox[{"load", " ", "them", " ", "as", " ", 
       RowBox[{"symbols", ":", 
        RowBox[{"Symbol", "/@", 
         RowBox[{"{", 
          
          RowBox[{"\"\<lItT\>\"", ",", "\"\<cItT\>\"", ",", "\"\<wItT\>\"", 
           ",", "\"\<aD\>\"", ",", "\"\<betaI\>\"", ",", "\"\<eps_ct\>\"", 
           ",", "\"\<phi\>\"", ",", "\"\<t\>\"", ",", "\"\<lItBar\>\"", 
           ",", "\"\<cItBar\>\"", ",", "\"\<wItBar\>\""}], "}"}]}]}]}], 
      ";"}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "2.", " ", "Define", " ", "the", " ", "original", " ", "equation", " ", 
       "as", " ", "F", 
       RowBox[{"(", "...", ")"}]}], "==", 
      RowBox[{"0.", " ", "Here"}]}], ",", "lItT", ",", "cItT", ",", 
     RowBox[{"and", " ", "wItT", " ", "correspond", " ", "to", " ", 
      RowBox[{"lIt", "[", "t", "]"}]}], ",", 
     RowBox[{"cIt", "[", "t", "]"}], ",", 
     RowBox[{"and", " ", 
      RowBox[{"wIt", "[", "t", "]"}]}], ",", 
     RowBox[{"respectively", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{"lItT_", ",", "cItT_", ",", "wItT_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"lItT", "^", "phi"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"aD", "*", 
            RowBox[{"betaI", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}]}], "-", "eps_ct", "+", 
           RowBox[{"aD", "*", "eps_ct"}]}], ")"}], "*", "wItT"}], ")"}], "/", 
       "cItT"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"3.", " ", "Collect", " ", "the", " ", "variables", " ", 
     RowBox[{"we", "'"}], "ll", " ", "differentiate", " ", "with", " ", 
     "respect", " ", 
     RowBox[{"to", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{"lItT", ",", "cItT", ",", "wItT"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "4.", " ", "Compute", " ", "partial", " ", "derivatives", " ", "of", " ",
        "F", " ", "at", " ", "the", " ", "steady", " ", 
       RowBox[{"state", ".", "The"}], " ", "steady", " ", "state", " ", "is", 
       " ", "imposed", " ", "by", " ", 
       RowBox[{"replacing", ":", "lItT"}]}], "->", "lItBar"}], ",", 
     RowBox[{"cItT", "->", "cItBar"}], ",", 
     RowBox[{"wItT", "->", 
      RowBox[{"wItBar", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"lItT", "->", "lItBar"}], ",", 
          RowBox[{"cItT", "->", "cItBar"}], ",", 
          RowBox[{"wItT", "->", "wItBar"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"5.", " ", "Define", " ", "symbols", " ", "for", " ", "log"}], "\[Hyphen]", 
     RowBox[{"deviations", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", " ", "ln", " ", "X"}], ")"}], "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"lItHatT", ",", "cItHatT", ",", "wItHatT"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "6.", " ", "Multiply", " ", "each", " ", "partial", " ", "derivative", " ",
       "by", " ", "the", " ", "steady", " ", "state", " ", "level", " ", 
      "and", " ", "its", " ", "corresponding", " ", "log"}], "\[Hyphen]", 
     RowBox[{
      RowBox[{
       RowBox[{"deviation", ".", "This"}], " ", "yields", " ", "the", " ", 
       "linearized", " ", "equation", " ", "F"}], "=", 
      RowBox[{"0", " ", "in", " ", "terms", " ", "of", " ", "the", " ", 
       RowBox[{"\[OpenCurlyDoubleQuote]", "hat", "\[CloseCurlyDoubleQuote]"}],
        " ", 
       RowBox[{"variables", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varsBar", "=", 
     RowBox[{"{", 
      RowBox[{"lItBar", ",", "cItBar", ",", "wItBar"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", "lItBar", "*", "lItHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", "cItBar", "*", "cItHatT"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", "wItBar", "*", "wItHatT"}]}], "==",
       "0"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"7.", " ", "Simplify", " ", "the", " ", "final", " ", "linear", " ", 
     RowBox[{"equation", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"simplifiedLogLinEq", "=", 
     RowBox[{"Simplify", "[", "logLinEq", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Optionally", ",", 
     RowBox[{
     "replace", " ", "steady", " ", "state", " ", "values", " ", "with", " ", 
      "1", " ", "to", " ", "eliminate", " ", 
      RowBox[{"them", ":"}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"logLinEqNoBar", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"simplifiedLogLinEq", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"lItBar", "->", "1"}], ",", 
         RowBox[{"cItBar", "->", "1"}], ",", 
         RowBox[{"wItBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "8.", " ", "Define", " ", "substitution", " ", "rules", " ", "to", " ", 
       "reintroduce", " ", "time", " ", 
       RowBox[{"indices", ".", "Here"}], " ", "we", " ", 
       RowBox[{"assign", ":", "lItHatT"}]}], "->", 
      RowBox[{"lItHat", "[", "t", "]"}]}], ",", 
     RowBox[{"cItHatT", "->", 
      RowBox[{"cItHat", "[", "t", "]"}]}], ",", 
     RowBox[{"wItHatT", "->", 
      RowBox[{"wItHat", "[", "t", "]"}]}], ",", 
     RowBox[{"and", " ", "also", " ", "re"}], "\[Hyphen]", 
     RowBox[{"write", " ", 
      RowBox[{"betaI", "^", 
       RowBox[{"(", 
        RowBox[{"1", "+", "t"}], ")"}]}], " ", "as", " ", 
      RowBox[{
       RowBox[{"betaI", "^", 
        RowBox[{"(", 
         RowBox[{"t", "+", "1"}], ")"}]}], "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"timeSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"lItHatT", "->", 
        RowBox[{"lItHat", "[", "t", "]"}]}], ",", 
       RowBox[{"cItHatT", "->", 
        RowBox[{"cItHat", "[", "t", "]"}]}], ",", 
       RowBox[{"wItHatT", "->", 
        RowBox[{"wItHat", "[", "t", "]"}]}], ",", 
       RowBox[{
        RowBox[{"betaI", "^", 
         RowBox[{"(", 
          RowBox[{"1", "+", "t"}], ")"}]}], "->", 
        RowBox[{"betaI", "^", 
         RowBox[{"(", 
          RowBox[{"t", "+", "1"}], ")"}]}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"eqTimeIndexed", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Finally", ",", 
     RowBox[{
     "output", " ", "both", " ", "the", " ", "version", " ", "without", " ", 
      "time", " ", "indices", " ", "and", " ", "with", " ", "time", " ", 
      RowBox[{"indices", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
   "logLinEqNoBar", "\n", 
   RowBox[{"final", " ", "=", 
    RowBox[{"FullSimplify", "[", "eqTimeIndexed", "]"}]}], "\[IndentingNewLine]",
    "final", "\n"}]}]], "Input",
 CellChangeTimes->{
  3.9476919365670357`*^9, {3.94795032638373*^9, 3.947950374200945*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"fb2f931c-bc15-f341-bf84-64962e1f5fe1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Clear", " ", "all", " ", "relevant", " ", "symbols", " ", "to", " ", 
    "avoid", " ", "conflicts"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "betaE", ",", "alpha", ",", "delta", ",", "xi1", ",", "xi2", ",", "AE", ",",
       "wP", ",", "wI", ",", "q", ",", "rE", ",", "pi", ",", "cE", ",", "bE", 
      ",", "kE", ",", "uE", ",", "mE", ",", "LEP", ",", "LEI", ",", "lambdaE",
       ",", "muE"}], "]"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Parameters", " ", "and", " ", "Variables", " ", "for", " ", 
     "Entrepreneurs", " ", 
     RowBox[{"(", "Static", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"{", 
      RowBox[{
      "betaE", ",", "alpha", ",", "delta", ",", "xi1", ",", "xi2", ",", "AE", 
       ",", "wP", ",", "wI", ",", "q", ",", "rE", ",", "pi", ",", "cE", ",", 
       "bE", ",", "kE", ",", "uE", ",", "mE", ",", "LEP", ",", "LEI", ",", 
       "lambdaE", ",", "muE"}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Utility", " ", "function", " ", "for", " ", "Entrepreneurs", " ", 
     RowBox[{"(", "static", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uEntrepreneur", "[", "cE_", "]"}], ":=", 
     RowBox[{"Log", "[", "cE", "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Production", " ", "function", " ", "for", " ", "Entrepreneurs", " ", 
     RowBox[{"(", "static", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yE", ":=", 
     RowBox[{"AE", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"kE", "^", "alpha"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"LEP", "+", "LEI"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"1", "-", "alpha"}], ")"}]}]}], ")"}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Utilization", " ", "cost", " ", "function"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FUtil", "[", "uE_", "]"}], ":=", 
     RowBox[{
      RowBox[{"xi1", " ", 
       RowBox[{"(", 
        RowBox[{"uE", "-", "1"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"xi2", "/", "2"}], ")"}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"uE", "-", "1"}], ")"}], "^", "2"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Budget", " ", "constraint", " ", "for", " ", "Entrepreneurs", " ", 
     RowBox[{"(", "static", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BCEntrepreneur", ":=", 
     RowBox[{"cE", "+", 
      RowBox[{"wP", " ", "LEP"}], "+", 
      RowBox[{"wI", " ", "LEI"}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "rE"}], ")"}], "/", "pi"}], " ", "bE"}], "+", 
      RowBox[{"q", " ", "kE"}], "+", 
      RowBox[{
       RowBox[{"FUtil", "[", "uE", "]"}], " ", "kE"}], "-", "yE", "-", "bE", "-", 
      RowBox[{"q", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "delta"}], ")"}], " ", "kE"}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Borrowing", " ", "constraint", " ", "for", " ", "Entrepreneurs", " ", 
     RowBox[{"(", "static", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BorrowingConstraint", ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "rE"}], ")"}], " ", "bE"}], "-", 
      RowBox[{"mE", " ", 
       RowBox[{"(", 
        RowBox[{"q", " ", "pi", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "delta"}], ")"}], " ", "kE"}], ")"}]}]}]}], ";"}],
    "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Lagrangian", " ", 
     RowBox[{"(", "Static", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LE", "=", 
     RowBox[{
      RowBox[{"uEntrepreneur", "[", "cE", "]"}], "+", 
      RowBox[{"lambdaE", " ", "BCEntrepreneur"}], "+", 
      RowBox[{"muE", " ", "BorrowingConstraint"}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"First", "-", 
     RowBox[{"order", " ", "conditions", " ", "for", " ", "Entrepreneurs", " ", 
      RowBox[{"(", "Static", ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focCE", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LE", ",", "cE"}], "]"}], "==", "0"}]}], ";"}], "  ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "consumption", " ", "cE"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focKE", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LE", ",", "kE"}], "]"}], "==", "0"}]}], ";"}], "  ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "capital", " ", "kE"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focBE", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LE", ",", "bE"}], "]"}], "==", "0"}]}], ";"}], "  ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "borrowing", " ", "bE"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focUE", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LE", ",", "uE"}], "]"}], "==", "0"}]}], ";"}], "  ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "utilization", " ", "uE"}], "*)"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Display", " ", "results"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"debugFOCs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<FOC wrt cE\>\"", "->", "focCE"}], ",", 
       RowBox[{"\"\<FOC wrt kE\>\"", "->", "focKE"}], ",", 
       RowBox[{"\"\<FOC wrt bE\>\"", "->", "focBE"}], ",", 
       RowBox[{"\"\<FOC wrt uE\>\"", "->", "focUE"}]}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Output", " ", "the", " ", "Lagrangian", " ", "and", " ", "FOCs"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Lagrangian\>\"", "->", "LE"}], ",", 
     RowBox[{"\"\<First-Order Conditions\>\"", "->", "debugFOCs"}]}], "}"}], 
   "\n"}]}]], "Input",
 CellChangeTimes->{
  3.942592057012724*^9, {3.942592245428005*^9, 3.94259229837319*^9}, {
   3.94259276149564*^9, 3.942592764239746*^9}, {3.9425935259046726`*^9, 
   3.942593548727476*^9}, 3.9425936374098434`*^9, {3.942594582938095*^9, 
   3.942594602603157*^9}, 3.9425946466589737`*^9, {3.9425949113557167`*^9, 
   3.9425949911134377`*^9}, 3.942595094281233*^9, {3.942595174682337*^9, 
   3.942595279071537*^9}, 3.942595447132061*^9, {3.9425956151379395`*^9, 
   3.94259563994841*^9}, 3.942595669960287*^9, {3.9425959508937435`*^9, 
   3.9425959719109993`*^9}, 3.9427690351333847`*^9, 3.9427690682198257`*^9, 
   3.9427715635525856`*^9, 3.9428545977365494`*^9, 3.9430291244111385`*^9, {
   3.9430293293032436`*^9, 3.9430293321251163`*^9}, 3.943029903411661*^9, 
   3.943029935968582*^9, {3.9430300915187435`*^9, 3.9430300983569183`*^9}, 
   3.943030165224594*^9, 3.943031018565777*^9, 3.9430310525436935`*^9, 
   3.9430315909590073`*^9, {3.943031676607229*^9, 3.943031762295637*^9}, {
   3.943032046234873*^9, 3.94303207506736*^9}, {3.943032277998928*^9, 
   3.943032328893503*^9}, 3.9430323609657345`*^9, {3.9430338379985332`*^9, 
   3.9430338777026024`*^9}, {3.9430340737475815`*^9, 3.9430340995907764`*^9}, 
   3.943034138748911*^9, 3.943034215671747*^9, 3.9430955097704773`*^9, 
   3.9433588087017574`*^9, 3.9433588506085987`*^9, 3.9433604537355385`*^9, 
   3.9433690498361454`*^9, {3.943369097716297*^9, 3.9433691157514877`*^9}, {
   3.9433691779950886`*^9, 3.9433691920949574`*^9}, {3.943369408544922*^9, 
   3.943369419957775*^9}, {3.9433694534026623`*^9, 3.9433694610976887`*^9}, {
   3.9433718095535316`*^9, 3.9433718209741173`*^9}, {3.943371942155674*^9, 
   3.943371948822159*^9}, {3.943372132182953*^9, 3.9433721356424065`*^9}, {
   3.9433723369107685`*^9, 3.9433723433940105`*^9}, {3.9433725200260067`*^9, 
   3.943372539188036*^9}, 3.9433729214440956`*^9, 3.946134979625437*^9, {
   3.946135028668358*^9, 3.9461350308236866`*^9}, {3.946380295211197*^9, 
   3.946380296539772*^9}, {3.94640043978706*^9, 3.946400483226412*^9}, 
   3.9464023612987766`*^9, {3.9464025415333214`*^9, 3.9464025643481045`*^9}, {
   3.9464031878470516`*^9, 3.946403191088213*^9}, {3.9464034240072136`*^9, 
   3.9464034490416183`*^9}, 3.94734240899786*^9, {3.947342456115858*^9, 
   3.9473425197101955`*^9}, 3.949767809319248*^9},
 CellLabel->
  "In[133]:=",ExpressionUUID->"a67f113d-d41d-d24a-8f3f-b4722fe41f74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\"\<Lagrangian\>\"", "\[Rule]", 
     RowBox[{
      RowBox[{"muE", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "delta"}], ")"}], " ", "kE", " ", "mE", " ", 
            "pi", " ", "q"}], ")"}]}], "+", 
         RowBox[{"bE", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "rE"}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"lambdaE", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "bE"}], "+", "cE", "-", 
         RowBox[{"AE", " ", 
          SuperscriptBox["kE", "alpha"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"LEI", "+", "LEP"}], ")"}], 
           RowBox[{"1", "-", "alpha"}]]}], "+", 
         RowBox[{"kE", " ", "q"}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "delta"}], ")"}], " ", "kE", " ", "q"}], "+", 
         FractionBox[
          RowBox[{"bE", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "rE"}], ")"}]}], "pi"], "+", 
         RowBox[{"LEI", " ", "wI"}], "+", 
         RowBox[{"LEP", " ", "wP"}], "+", 
         RowBox[{"kE", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "uE"}], ")"}], " ", "xi1"}], "+", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "uE"}], ")"}], "2"], " ", "xi2"}]}], 
           ")"}]}]}], ")"}]}], "+", 
      RowBox[{"Log", "[", "cE", "]"}]}]}], ",", 
    RowBox[{"\"\<First-Order Conditions\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<FOC wrt cE\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{
          FractionBox["1", "cE"], "+", "lambdaE"}], "\[Equal]", "0"}]}], ",", 
       RowBox[{"\"\<FOC wrt kE\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "delta"}], ")"}], " ", "mE", " ", "muE", " ", 
             "pi", " ", "q"}], ")"}]}], "+", 
          RowBox[{"lambdaE", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "AE"}], " ", "alpha", " ", 
              SuperscriptBox["kE", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "alpha"}]], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"LEI", "+", "LEP"}], ")"}], 
               RowBox[{"1", "-", "alpha"}]]}], "+", "q", "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "delta"}], ")"}], " ", "q"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "uE"}], ")"}], " ", "xi1"}], "+", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "uE"}], ")"}], "2"], " ", "xi2"}]}],
             ")"}]}]}], "\[Equal]", "0"}]}], ",", 
       RowBox[{"\"\<FOC wrt bE\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{
          RowBox[{"muE", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "rE"}], ")"}]}], "+", 
          RowBox[{"lambdaE", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             FractionBox[
              RowBox[{"1", "+", "rE"}], "pi"]}], ")"}]}]}], "\[Equal]", 
         "0"}]}], ",", 
       RowBox[{"\"\<FOC wrt uE\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"kE", " ", "lambdaE", " ", 
          RowBox[{"(", 
           RowBox[{"xi1", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "uE"}], ")"}], " ", "xi2"}]}], 
           ")"}]}], "\[Equal]", "0"}]}]}], "}"}]}]}], "}"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.9497693584958725`*^9, 
  3.9497693734034348`*^9}},ExpressionUUID->"9b5be767-603c-0b4d-b011-\
d7ba65064b4b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Define", " ", "the", " ", "system", " ", "of", " ", "equations"}],
    "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"eqs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"1", "/", "cE"}], "+", "lambdaE"}], "==", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", "cE"}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "delta"}], ")"}], " ", "mE", " ", "muE", " ", 
            "pi", " ", "q"}], ")"}]}], "+", 
         RowBox[{"lambdaE", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "AE"}], " ", "alpha", " ", 
             RowBox[{"kE", "^", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "alpha"}], ")"}]}], " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"LEI", "+", "LEP"}], ")"}], "^", 
              RowBox[{"(", 
               RowBox[{"1", "-", "alpha"}], ")"}]}]}], "+", "q", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "delta"}], ")"}], " ", "q"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "uE"}], ")"}], " ", "xi1"}], "+", 
            RowBox[{
             RowBox[{"1", "/", "2"}], " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "uE"}], ")"}], "^", "2"}], " ", 
             "xi2"}]}], ")"}]}]}], "==", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", "kE"}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"muE", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "rE"}], ")"}]}], "+", 
         RowBox[{"lambdaE", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", "rE"}], ")"}], "/", "pi"}]}], ")"}]}]}], "==",
         "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", "bE"}], "*)"}], 
       RowBox[{
        RowBox[{"kE", " ", "lambdaE", " ", 
         RowBox[{"(", 
          RowBox[{"xi1", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "uE"}], ")"}], " ", "xi2"}]}], ")"}]}],
         "==", "0"}]}], " ", 
      RowBox[{"(*", 
       RowBox[{"FOC", " ", "wrt", " ", "uE"}], "*)"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Step", " ", "1"}], ":", 
     RowBox[{
     "Solve", " ", "for", " ", "lambdaE", " ", "from", " ", "the", " ", 
      "first", " ", "equation"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solLambdaE", "=", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"1", "/", "cE"}], "+", "lambdaE"}], "==", "0"}], ",", 
        "lambdaE"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Step", " ", "2"}], ":", 
     RowBox[{
     "Substitute", " ", "lambdaE", " ", "into", " ", "the", " ", "rest", " ", 
      "of", " ", "the", " ", "equations"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqsSubLambdaE", "=", 
     RowBox[{"eqs", "/.", " ", "solLambdaE"}]}], ";"}], "\[IndentingNewLine]",
    "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Step", " ", "3"}], ":", 
     RowBox[{
     "Solve", " ", "for", " ", "muE", " ", "from", " ", "the", " ", "third", " ",
       "equation", " ", 
      RowBox[{"(", 
       RowBox[{"FOC", " ", "wrt", " ", "bE"}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solMuE", "=", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"eqsSubLambdaE", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "muE"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Step", " ", "4"}], ":", 
     RowBox[{
     "Substitute", " ", "muE", " ", "into", " ", "the", " ", "remaining", " ",
       "equations"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqsFinal", "=", 
     RowBox[{"eqsSubLambdaE", "/.", " ", "solMuE"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Step", " ", "5"}], ":", 
     RowBox[{
     "Display", " ", "the", " ", "final", " ", "system", " ", "without", " ", 
      "lambdaE", " ", "and", " ", "muE"}]}], "*)"}], "\[IndentingNewLine]", 
   "eqsFinal", "\n"}]}]], "Input",
 CellChangeTimes->{{3.949769381376913*^9, 3.949769381376913*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"701e4a68-645d-5947-9384-1c5f4e49b6a5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "delta"}], ")"}], " ", "mE", " ", "q", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "pi", "+", "rE"}], ")"}]}], 
       RowBox[{"cE", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "rE"}], ")"}]}]]}], "-", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", "AE"}], " ", "alpha", " ", 
        SuperscriptBox["kE", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "alpha"}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"LEI", "+", "LEP"}], ")"}], 
         RowBox[{"1", "-", "alpha"}]]}], "+", "q", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "delta"}], ")"}], " ", "q"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "uE"}], ")"}], " ", "xi1"}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "uE"}], ")"}], "2"], " ", "xi2"}]}], 
      "cE"]}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"1", "-", "pi", "+", "rE"}], 
      RowBox[{"cE", " ", "pi"}]], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       FractionBox[
        RowBox[{"1", "+", "rE"}], "pi"]}], "cE"]}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"kE", " ", 
       RowBox[{"(", 
        RowBox[{"xi1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "uE"}], ")"}], " ", "xi2"}]}], ")"}]}], 
      "cE"]}], "\[Equal]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.9497693890792503`*^9},
 CellLabel->
  "Out[152]=",ExpressionUUID->"9ead36bb-5963-aa40-8fe7-c50aeb708fcd"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9497693584958725`*^9, 3.9497693734034348`*^9}, 
   3.9497700940558033`*^9},ExpressionUUID->"58b14532-419e-124a-a555-\
ae1c8fa742c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Clear", " ", "all", " ", "relevant", " ", "symbols", " ", "to", " ", 
    "avoid", " ", "conflicts"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "\[Alpha]", ",", "\[Delta]", ",", "\[Xi]\[Alpha]", ",", "\[Xi]\[Beta]", ",",
       "cE", ",", "wp", ",", "wi", ",", "rE", ",", "\[Pi]", ",", "bE", ",", 
      "q", ",", "kE", ",", "uE", ",", "mE", ",", "LEp", ",", "LEi", ",", 
      "AE"}], "]"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Production", " ", "function", " ", "for", " ", "Entrepreneurs", " ", 
     RowBox[{"(", "static", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yE", ":=", 
     RowBox[{"AE", " ", 
      RowBox[{"(", 
       RowBox[{"kE", " ", "\[Alpha]", " ", 
        RowBox[{"(", 
         RowBox[{"LEp", "+", "LEi"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Alpha]"}], ")"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Utilization", " ", "cost", " ", "function"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FUtil", "[", "uE_", "]"}], ":=", 
     RowBox[{
      RowBox[{"\[Xi]\[Alpha]", " ", 
       RowBox[{"(", 
        RowBox[{"uE", "-", "1"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Xi]\[Beta]", "/", "2"}], ")"}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"uE", "-", "1"}], ")"}], "^", "2"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Budget", " ", "constraint", " ", "for", " ", "Entrepreneurs", " ", 
     RowBox[{"(", "static", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"BCEntrepreneur", ":=", "cE"}], "\n", 
   RowBox[{
    RowBox[{"+", "wp"}], " ", "LEp"}], "\n", 
   RowBox[{
    RowBox[{"+", "wi"}], " ", "LEi"}], "\n", 
   RowBox[{
    RowBox[{"+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "rE"}], ")"}], "/", "\[Pi]"}], ")"}]}], " ", "bE"}],
    "\n", 
   RowBox[{
    RowBox[{"+", "q"}], " ", "kE"}], "\n", 
   RowBox[{
    RowBox[{"+", 
     RowBox[{"FUtil", "[", "uE", "]"}]}], " ", "kE"}], "\n", 
   RowBox[{"-", "yE"}], "\n", 
   RowBox[{"-", "bE"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "q"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Delta]"}], ")"}], " ", "kE"}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Borrowing", " ", "constraint", " ", "for", " ", "Entrepreneurs", " ", 
     RowBox[{"(", "static", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"BorrowingConstraint", ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "rE"}], ")"}], " ", "bE"}]}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "mE"}], " ", 
     RowBox[{"(", 
      RowBox[{"q", " ", "\[Pi]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Delta]"}], ")"}], " ", "kE"}], ")"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"System", " ", "of", " ", "equations", " ", "reformulated", " ", 
     RowBox[{"without", "^", "notation"}]}], "*)"}], 
   RowBox[{"eq1", "=", 
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Delta]"}], ")"}], " ", "mE", " ", "q", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Pi]", "+", "rE"}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"cE", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "rE"}], ")"}]}], ")"}]}], ")"}]}]}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "AE"}], " ", "\[Alpha]", " ", "kE", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"LEI", "+", "LEP"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Alpha]"}], ")"}]}], "+", "q", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Delta]"}], ")"}], " ", "q"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "uE"}], ")"}], " ", "\[Xi]\[Alpha]"}], "+", 
         RowBox[{
          RowBox[{"1", "/", "2"}], " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "uE"}], ")"}], "^", "2"}], " ", 
          "\[Xi]\[Beta]"}]}], ")"}]}], "/", "cE"}], "==", "0"}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"eq2", "=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Pi]", "+", "rE"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"cE", " ", "\[Pi]"}], ")"}]}], ")"}]}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "rE"}], ")"}], "/", "\[Pi]"}]}], ")"}]}], "/", 
      "cE"}], "==", "0"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq3", "=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"kE", " ", 
           RowBox[{"(", 
            RowBox[{"\[Xi]\[Alpha]", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "uE"}], ")"}], " ", 
              "\[Xi]\[Beta]"}]}], ")"}]}], ")"}], "/", "cE"}], ")"}]}], "==", 
      "0"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.9497693584958725`*^9, 3.9497693734034348`*^9}, {
  3.9497700940558033`*^9, 3.9497701031086597`*^9}, {3.9497702910418186`*^9, 
  3.9497702933579082`*^9}},ExpressionUUID->"6bdb1088-4e1c-f54b-9a0b-\
13f60053de22"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "entrappanuer", " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Parameters", " ", "and", " ", "Variables", " ", "for", " ", 
     "Entrepreneurs"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"{", 
      RowBox[{"betaE", ",", "alpha", ",", "delta", ",", "xi1", ",", "xi2", ",", 
       RowBox[{"AE", "[", "t", "]"}], ",", 
       RowBox[{"wpt", "[", "t", "]"}], ",", 
       RowBox[{"wip", "[", "t", "]"}], ",", 
       RowBox[{"qt", "[", "t", "]"}], ",", 
       RowBox[{"rtE", "[", "t", "]"}], ",", 
       RowBox[{"pit", "[", "t", "]"}], ",", 
       RowBox[{"ctE", "[", "t", "]"}], ",", 
       RowBox[{"btE", "[", "t", "]"}], ",", 
       RowBox[{"kEt", "[", "t", "]"}], ",", 
       RowBox[{"uEt", "[", "t", "]"}], ",", 
       RowBox[{"mEt", "[", "t", "]"}], ",", 
       RowBox[{"LEP", "[", "t", "]"}], ",", 
       RowBox[{"LEI", "[", "t", "]"}]}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Utility", " ", "function", " ", "for", " ", "entrepreneurs"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uEntrepreneur", "[", 
      RowBox[{"ctE_", ",", "ctELag_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Log", "[", "ctE", "]"}], "-", 
      RowBox[{"alpha", " ", 
       RowBox[{"Log", "[", "ctELag", "]"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Production", " ", "function", " ", "for", " ", "entrepreneurs"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yE", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"AE", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"kE", "[", 
          RowBox[{"t", "-", "1"}], "]"}], "^", "alpha"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LEP", "[", "t", "]"}], "+", 
           RowBox[{"LEI", "[", "t", "]"}]}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"1", "-", "alpha"}], ")"}]}]}], ")"}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Utilization", " ", "cost", " ", "function"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FUtil", "[", "u_", "]"}], ":=", 
     RowBox[{
      RowBox[{"xi1", " ", 
       RowBox[{"(", 
        RowBox[{"u", "-", "1"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"xi2", "/", "2"}], ")"}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"u", "-", "1"}], ")"}], "^", "2"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Budget", " ", "constraint", " ", "for", " ", "entrepreneurs", " ", "in", 
     " ", "period", " ", "t"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BCEntrepreneur", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"ctE", "[", "t", "]"}], "+", 
      RowBox[{
       RowBox[{"wpt", "[", "t", "]"}], " ", 
       RowBox[{"LEP", "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"wip", "[", "t", "]"}], " ", 
       RowBox[{"LEI", "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"rtE", "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ")"}], "/", 
         RowBox[{"pit", "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"btE", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"qt", "[", "t", "]"}], " ", 
       RowBox[{"kEt", "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"FUtil", "[", 
        RowBox[{"uEt", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"kEt", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], "-", 
      RowBox[{"yE", "[", "t", "]"}], "-", 
      RowBox[{"btE", "[", "t", "]"}], "-", 
      RowBox[{
       RowBox[{"qt", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "delta"}], ")"}], " ", 
       RowBox[{"kEt", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Borrowing", " ", "constraint", " ", "for", " ", "entrepreneurs", " ", 
     "in", " ", "period", " ", "t"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BorrowingConstraint", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"rtE", "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"btE", "[", "t", "]"}]}], "-", 
      RowBox[{
       RowBox[{"Mt", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"qt", "[", 
          RowBox[{"t", "+", "1"}], "]"}], " ", 
         RowBox[{"pit", "[", 
          RowBox[{"t", "+", "1"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "delta"}], ")"}], " ", 
         RowBox[{"kEt", "[", "t", "]"}]}], ")"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "Lagrangian", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LE", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"betaE", "^", "t"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"uEntrepreneur", "[", 
          RowBox[{
           RowBox[{"ctE", "[", "t", "]"}], ",", 
           RowBox[{"ctE", "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], "]"}], "+", 
         RowBox[{
          RowBox[{"lambdaE", "[", "t", "]"}], " ", 
          RowBox[{"BCEntrepreneur", "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"muE", "[", "t", "]"}], " ", 
          RowBox[{"BorrowingConstraint", "[", "t", "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"betaE", "^", 
        RowBox[{"(", 
         RowBox[{"t", "+", "1"}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"uEntrepreneur", "[", 
          RowBox[{
           RowBox[{"ctE", "[", 
            RowBox[{"t", "+", "1"}], "]"}], ",", 
           RowBox[{"ctE", "[", "t", "]"}]}], "]"}], "+", 
         RowBox[{
          RowBox[{"lambdaE", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"BCEntrepreneur", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"muE", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"BorrowingConstraint", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}]}], ")"}]}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"First", "-", 
     RowBox[{"order", " ", "conditions", " ", "for", " ", "entrepreneurs"}]}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focCtE", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LE", ",", 
        RowBox[{"ctE", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "consumption", " ", 
     RowBox[{"ctE", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focKEt", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LE", ",", 
        RowBox[{"kEt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "capital", " ", 
     RowBox[{"kEt", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focBtE", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LE", ",", 
        RowBox[{"btE", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "borrowing", " ", 
     RowBox[{"btE", "[", "t", "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"focUEt", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"LE", ",", 
        RowBox[{"uEt", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "utilization", " ", 
     RowBox[{"uEt", "[", "t", "]"}]}], "*)"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Display", " ", "results"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"debugFOCs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<FOC wrt ctE[t]\>\"", "->", "focCtE"}], ",", 
       RowBox[{"\"\<FOC wrt kEt[t]\>\"", "->", "focKEt"}], ",", 
       RowBox[{"\"\<FOC wrt btE[t]\>\"", "->", "focBtE"}], ",", 
       RowBox[{"\"\<FOC wrt uEt[t]\>\"", "->", "focUEt"}]}], "}"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Output", " ", "the", " ", "Lagrangian"}], ",", "FOCs"}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Lagrangian\>\"", "->", "LE"}], ",", 
     RowBox[{"\"\<First-Order Conditions\>\"", "->", "debugFOCs"}]}], "}"}], 
   "\n"}]}]], "Input",
 CellChangeTimes->{
  3.942592057012724*^9, {3.942592245428005*^9, 3.94259229837319*^9}, {
   3.94259276149564*^9, 3.942592764239746*^9}, {3.9425935259046726`*^9, 
   3.942593548727476*^9}, 3.9425936374098434`*^9, {3.942594582938095*^9, 
   3.942594602603157*^9}, 3.9425946466589737`*^9, {3.9425949113557167`*^9, 
   3.9425949911134377`*^9}, 3.942595094281233*^9, {3.942595174682337*^9, 
   3.942595279071537*^9}, 3.942595447132061*^9, {3.9425956151379395`*^9, 
   3.94259563994841*^9}, 3.942595669960287*^9, {3.9425959508937435`*^9, 
   3.9425959719109993`*^9}, 3.9427690351333847`*^9, 3.9427690682198257`*^9, 
   3.9427715635525856`*^9, 3.9428545977365494`*^9, 3.9430291244111385`*^9, {
   3.9430293293032436`*^9, 3.9430293321251163`*^9}, 3.943029903411661*^9, 
   3.943029935968582*^9, {3.9430300915187435`*^9, 3.9430300983569183`*^9}, 
   3.943030165224594*^9, 3.943031018565777*^9, 3.9430310525436935`*^9, 
   3.9430315909590073`*^9, {3.943031676607229*^9, 3.943031762295637*^9}, {
   3.943032046234873*^9, 3.94303207506736*^9}, {3.943032277998928*^9, 
   3.943032328893503*^9}, 3.9430323609657345`*^9, {3.9430338379985332`*^9, 
   3.9430338777026024`*^9}, {3.9430340737475815`*^9, 3.9430340995907764`*^9}, 
   3.943034138748911*^9, 3.943034215671747*^9, 3.9430955097704773`*^9, 
   3.9433588087017574`*^9, 3.9433588506085987`*^9, 3.9433604537355385`*^9, 
   3.9433690498361454`*^9, {3.943369097716297*^9, 3.9433691157514877`*^9}, {
   3.9433691779950886`*^9, 3.9433691920949574`*^9}, {3.943369408544922*^9, 
   3.943369419957775*^9}, {3.9433694534026623`*^9, 3.9433694610976887`*^9}, {
   3.9433718095535316`*^9, 3.9433718209741173`*^9}, {3.943371942155674*^9, 
   3.943371948822159*^9}, {3.943372132182953*^9, 3.9433721356424065`*^9}, {
   3.9433723369107685`*^9, 3.9433723433940105`*^9}, {3.9433725200260067`*^9, 
   3.943372539188036*^9}, 3.9433729214440956`*^9, 3.946134979625437*^9, {
   3.946135028668358*^9, 3.9461350308236866`*^9}, {3.946380295211197*^9, 
   3.946380296539772*^9}, {3.94640043978706*^9, 3.946400483226412*^9}, 
   3.9464023612987766`*^9, {3.9464025415333214`*^9, 3.9464025643481045`*^9}, {
   3.9464031878470516`*^9, 3.946403191088213*^9}, {3.9464034240072136`*^9, 
   3.9464034490416183`*^9}, 3.94734240899786*^9, {3.947342456115858*^9, 
   3.9473425048120995`*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"24e808de-ed6a-4146-a49a-28e49cf93adc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"Lagrangian\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{
      SuperscriptBox["betaE", "t"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "alpha"}], " ", 
         RowBox[{"Log", "[", 
          RowBox[{"ctE", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}], "]"}]}], "+", 
        RowBox[{"Log", "[", 
         RowBox[{"ctE", "[", "t", "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"muE", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "delta"}], ")"}], " ", 
              RowBox[{"kEt", "[", "t", "]"}], " ", 
              RowBox[{"Mt", "[", "t", "]"}], " ", 
              RowBox[{"pit", "[", 
               RowBox[{"1", "+", "t"}], "]"}], " ", 
              RowBox[{"qt", "[", 
               RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"btE", "[", "t", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"lambdaE", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"btE", "[", "t", "]"}]}], "+", 
           RowBox[{"ctE", "[", "t", "]"}], "-", 
           RowBox[{
            RowBox[{"AE", "[", "t", "]"}], " ", 
            SuperscriptBox[
             RowBox[{"kE", "[", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "t"}], "]"}], "alpha"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"LEI", "[", "t", "]"}], "+", 
               RowBox[{"LEP", "[", "t", "]"}]}], ")"}], 
             RowBox[{"1", "-", "alpha"}]]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "delta"}], ")"}], " ", 
            RowBox[{"kEt", "[", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
            RowBox[{"qt", "[", "t", "]"}]}], "+", 
           RowBox[{
            RowBox[{"kEt", "[", "t", "]"}], " ", 
            RowBox[{"qt", "[", "t", "]"}]}], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"btE", "[", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rtE", "[", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "t"}], "]"}]}], ")"}]}], 
            RowBox[{"pit", "[", "t", "]"}]], "+", 
           RowBox[{
            RowBox[{"kEt", "[", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xi1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"uEt", "[", "t", "]"}]}], ")"}]}], "+", 
              RowBox[{
               FractionBox["1", "2"], " ", "xi2", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"uEt", "[", "t", "]"}]}], ")"}], "2"]}]}], ")"}]}], 
           "+", 
           RowBox[{
            RowBox[{"LEI", "[", "t", "]"}], " ", 
            RowBox[{"wip", "[", "t", "]"}]}], "+", 
           RowBox[{
            RowBox[{"LEP", "[", "t", "]"}], " ", 
            RowBox[{"wpt", "[", "t", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["betaE", 
       RowBox[{"1", "+", "t"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "alpha"}], " ", 
         RowBox[{"Log", "[", 
          RowBox[{"ctE", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"Log", "[", 
         RowBox[{"ctE", "[", 
          RowBox[{"1", "+", "t"}], "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"muE", "[", 
          RowBox[{"1", "+", "t"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "delta"}], ")"}], " ", 
              RowBox[{"kEt", "[", 
               RowBox[{"1", "+", "t"}], "]"}], " ", 
              RowBox[{"Mt", "[", 
               RowBox[{"1", "+", "t"}], "]"}], " ", 
              RowBox[{"pit", "[", 
               RowBox[{"2", "+", "t"}], "]"}], " ", 
              RowBox[{"qt", "[", 
               RowBox[{"2", "+", "t"}], "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"btE", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rtE", "[", 
               RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"lambdaE", "[", 
          RowBox[{"1", "+", "t"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"btE", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], "+", 
           RowBox[{"ctE", "[", 
            RowBox[{"1", "+", "t"}], "]"}], "-", 
           RowBox[{
            RowBox[{"AE", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"kE", "[", "t", "]"}], "alpha"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"LEI", "[", 
                RowBox[{"1", "+", "t"}], "]"}], "+", 
               RowBox[{"LEP", "[", 
                RowBox[{"1", "+", "t"}], "]"}]}], ")"}], 
             RowBox[{"1", "-", "alpha"}]]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "delta"}], ")"}], " ", 
            RowBox[{"kEt", "[", "t", "]"}], " ", 
            RowBox[{"qt", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"kEt", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"qt", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"btE", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}], 
            RowBox[{"pit", "[", 
             RowBox[{"1", "+", "t"}], "]"}]], "+", 
           RowBox[{
            RowBox[{"kEt", "[", "t", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xi1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"uEt", "[", 
                  RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
              RowBox[{
               FractionBox["1", "2"], " ", "xi2", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"uEt", "[", 
                   RowBox[{"1", "+", "t"}], "]"}]}], ")"}], "2"]}]}], ")"}]}],
            "+", 
           RowBox[{
            RowBox[{"LEI", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"wip", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"LEP", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"wpt", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{"\<\"First-Order Conditions\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\<\"FOC wrt ctE[t]\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"alpha", " ", 
            SuperscriptBox["betaE", 
             RowBox[{"1", "+", "t"}]]}], 
           RowBox[{"ctE", "[", "t", "]"}]]}], "+", 
         RowBox[{
          SuperscriptBox["betaE", "t"], " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"ctE", "[", "t", "]"}]], "+", 
            RowBox[{"lambdaE", "[", "t", "]"}]}], ")"}]}]}], "\[Equal]", 
        "0"}]}], ",", 
      RowBox[{"\<\"FOC wrt kEt[t]\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox["betaE", "t"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"lambdaE", "[", "t", "]"}], " ", 
             RowBox[{"qt", "[", "t", "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "delta"}], ")"}], " ", 
             RowBox[{"Mt", "[", "t", "]"}], " ", 
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"pit", "[", 
              RowBox[{"1", "+", "t"}], "]"}], " ", 
             RowBox[{"qt", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["betaE", 
           RowBox[{"1", "+", "t"}]], " ", 
          RowBox[{"lambdaE", "[", 
           RowBox[{"1", "+", "t"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "delta"}], ")"}], " ", 
               RowBox[{"qt", "[", 
                RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
            RowBox[{"xi1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"uEt", "[", 
                RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             FractionBox["1", "2"], " ", "xi2", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"uEt", "[", 
                 RowBox[{"1", "+", "t"}], "]"}]}], ")"}], "2"]}]}], ")"}]}]}],
         "\[Equal]", "0"}]}], ",", 
      RowBox[{"\<\"FOC wrt btE[t]\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox["betaE", 
            RowBox[{"1", "+", "t"}]], " ", 
           RowBox[{"lambdaE", "[", 
            RowBox[{"1", "+", "t"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}], 
          RowBox[{"pit", "[", 
           RowBox[{"1", "+", "t"}], "]"}]], "+", 
         RowBox[{
          SuperscriptBox["betaE", "t"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"lambdaE", "[", "t", "]"}]}], "+", 
            RowBox[{
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}], "\[Equal]",
         "0"}]}], ",", 
      RowBox[{"\<\"FOC wrt uEt[t]\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{
         SuperscriptBox["betaE", "t"], " ", 
         RowBox[{"kEt", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
         RowBox[{"lambdaE", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"xi1", "+", 
           RowBox[{"xi2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"uEt", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], "\[Equal]",
         "0"}]}]}], "}"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.9495784710406704`*^9},
 CellLabel->
  "Out[119]=",ExpressionUUID->"32923660-840a-4b4d-a40a-87b153dac6e3"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9464031981481724`*^9, 
  3.9464032115819416`*^9}},ExpressionUUID->"4129f409-7408-7d45-9299-\
8b83db08acfc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Definisikan", " ", "FOC", " ", "wrt", " ", 
    RowBox[{"c_t", "^", "E"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"eq1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"alpha", " ", 
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}]}], ")"}], "/", 
          RowBox[{"ctE", "[", "t", "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"betaE", "^", "t"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"ctE", "[", "t", "]"}]}], "+", 
          RowBox[{"lambdaE", "[", "t", "]"}]}], ")"}]}]}], "==", "0"}]}], 
    ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"1", ")"}], " ", "Pecahkan", " ", "eq1", " ", "untuk", " ", 
     RowBox[{"lambdaE", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solLambda", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"eq1", ",", 
       RowBox[{"lambdaE", "[", "t", "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Hasilnya", " ", "memberi", " ", 
      RowBox[{"lambdaE", "[", "t", "]"}], " ", "dalam", " ", "fungsi", " ", 
      "alpha"}], ",", "betaE", ",", 
     RowBox[{"dan", " ", 
      RowBox[{"ctE", "[", "t", "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Misal", " ", "Anda", " ", "punya", " ", "FOC"}], "-", 
     RowBox[{
     "FOC", " ", "lain", " ", "sebagai", " ", "daftar", " ", "persamaan", " ", 
      RowBox[{"(", 
       RowBox[{"sesuaikan", " ", "sendiri"}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focSystem", "=", 
     RowBox[{"{", 
      RowBox[{"(*", 
       RowBox[{"FOC", " ", "wrt", " ", 
        RowBox[{"kE", "[", "t", "]"}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"lambdaE", "[", "t", "]"}], " ", 
             RowBox[{"qt", "[", "t", "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "delta"}], ")"}], " ", 
             RowBox[{"Mt", "[", "t", "]"}], " ", 
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"pit", "[", 
              RowBox[{"1", "+", "t"}], "]"}], " ", 
             RowBox[{"qt", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"betaE", "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "t"}], ")"}]}], " ", 
          RowBox[{"lambdaE", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "delta"}], ")"}], " ", 
               RowBox[{"qt", "[", 
                RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}], "+", 
            RowBox[{"xi1", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"uEt", "[", 
                RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], " ", "xi2", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"uEt", "[", 
                 RowBox[{"t", "+", "1"}], "]"}]}], ")"}], "^", "2"}]}]}], 
           ")"}]}]}], "==", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"bE", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}], " ", 
            RowBox[{"lambdaE", "[", 
             RowBox[{"t", "+", "1"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"pit", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"lambdaE", "[", "t", "]"}]}], "+", 
            RowBox[{
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}], "==", 
        "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"uE", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"betaE", "^", "t"}], " ", 
         RowBox[{"kEt", "[", 
          RowBox[{"t", "-", "1"}], "]"}], " ", 
         RowBox[{"lambdaE", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"xi1", "+", 
           RowBox[{"xi2", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"uEt", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], "==", 
        "0"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"2", ")"}], " ", "Gunakan", " ", "identitas", " ", "waktu"}], ",", 
     RowBox[{
      RowBox[{"misal", " ", 
       RowBox[{"lambdaE", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], "=", 
      RowBox[{
       RowBox[{"lambdaE", "[", 
        RowBox[{"t", "+", "1"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"didapat", " ", "dengan", " ", "mengganti", " ", "t"}], "->", 
          RowBox[{"t", "+", 
           RowBox[{"1", " ", "di", " ", "solLambda"}]}]}], ",", 
         RowBox[{"dsb", "."}]}], ")"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lambdaNext", "=", 
     RowBox[{"solLambda", "/.", " ", 
      RowBox[{"t", "->", 
       RowBox[{"t", "+", "1"}]}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"3", ")"}], " ", "Substitusikan", " ", "solusi", " ", "ke", " ", 
     "sistem", " ", "FOC"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focSystemSub", "=", 
     RowBox[{
      RowBox[{"focSystem", "/.", " ", 
       RowBox[{"solLambda", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "/.", " ", 
      RowBox[{"lambdaNext", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Selanjutnya", ",", 
     RowBox[{
     "Anda", " ", "bisa", " ", "gunakan", " ", "Solve", " ", "atau", " ", 
      "NSolve", " ", "untuk", " ", "menyelesaikan", " ", "sistem", " ", 
      "lengkap"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"focSystemSub", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"lambdaE", "[", "t", "]"}], ",", 
         RowBox[{"muE", "[", "t", "]"}]}], 
        RowBox[{"(*", 
         RowBox[{
         "variabel", " ", "lain", " ", "yang", " ", "ingin", " ", 
          "dipecahkan"}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{"dsb", "."}], "*)"}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Definisikan", " ", "FOC", " ", "wrt", " ", 
     RowBox[{"c_t", "^", "E"}]}], "*)"}], 
   RowBox[{
    RowBox[{"eq1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"alpha", " ", 
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}]}], ")"}], "/", 
          RowBox[{"ctE", "[", "t", "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"betaE", "^", "t"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"ctE", "[", "t", "]"}]}], "+", 
          RowBox[{"lambdaE", "[", "t", "]"}]}], ")"}]}]}], "==", "0"}]}], 
    ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"1", ")"}], " ", "Pecahkan", " ", "eq1", " ", "untuk", " ", 
     RowBox[{"lambdaE", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solLambda", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"eq1", ",", 
       RowBox[{"lambdaE", "[", "t", "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Hasilnya", " ", "memberi", " ", 
      RowBox[{"lambdaE", "[", "t", "]"}], " ", "dalam", " ", "fungsi", " ", 
      "alpha"}], ",", "betaE", ",", 
     RowBox[{"dan", " ", 
      RowBox[{"ctE", "[", "t", "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Misal", " ", "Anda", " ", "punya", " ", "FOC"}], "-", 
     RowBox[{
     "FOC", " ", "lain", " ", "sebagai", " ", "daftar", " ", "persamaan", " ", 
      RowBox[{"(", 
       RowBox[{"sesuaikan", " ", "sendiri"}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focSystem", "=", 
     RowBox[{"{", 
      RowBox[{"(*", 
       RowBox[{"FOC", " ", "wrt", " ", 
        RowBox[{"kE", "[", "t", "]"}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"lambdaE", "[", "t", "]"}], " ", 
             RowBox[{"qt", "[", "t", "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "delta"}], ")"}], " ", 
             RowBox[{"Mt", "[", "t", "]"}], " ", 
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"pit", "[", 
              RowBox[{"1", "+", "t"}], "]"}], " ", 
             RowBox[{"qt", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"betaE", "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "t"}], ")"}]}], " ", 
          RowBox[{"lambdaE", "[", 
           RowBox[{"t", "+", "1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "delta"}], ")"}], " ", 
               RowBox[{"qt", "[", 
                RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}], "+", 
            RowBox[{"xi1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"uEt", "[", 
                RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], " ", "xi2", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"uEt", "[", 
                 RowBox[{"t", "+", "1"}], "]"}]}], ")"}], "^", "2"}]}]}], 
           ")"}]}]}], "==", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"bE", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}], " ", 
            RowBox[{"lambdaE", "[", 
             RowBox[{"t", "+", "1"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"pit", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"lambdaE", "[", "t", "]"}]}], "+", 
            RowBox[{
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}], "==", 
        "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"FOC", " ", "wrt", " ", 
         RowBox[{"uE", "[", "t", "]"}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"betaE", "^", "t"}], " ", 
         RowBox[{"kEt", "[", 
          RowBox[{"t", "-", "1"}], "]"}], " ", 
         RowBox[{"lambdaE", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"xi1", "+", 
           RowBox[{"xi2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"uEt", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], "==", 
        "0"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"2", ")"}], " ", "Gunakan", " ", "identitas", " ", "waktu"}], ",", 
     RowBox[{
      RowBox[{"misal", " ", 
       RowBox[{"lambdaE", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], "=", 
      RowBox[{
       RowBox[{"lambdaE", "[", 
        RowBox[{"t", "+", "1"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"didapat", " ", "dengan", " ", "mengganti", " ", "t"}], "->", 
          RowBox[{"t", "+", 
           RowBox[{"1", " ", "di", " ", "solLambda"}]}]}], ",", 
         RowBox[{"dsb", "."}]}], ")"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lambdaNext", "=", 
     RowBox[{"solLambda", "/.", " ", 
      RowBox[{"t", "->", 
       RowBox[{"t", "+", "1"}]}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"3", ")"}], " ", "Substitusikan", " ", "solusi", " ", "ke", " ", 
     "sistem", " ", "FOC"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"focSystemSub", "=", 
     RowBox[{
      RowBox[{"focSystem", "/.", " ", 
       RowBox[{"solLambda", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "/.", " ", 
      RowBox[{"lambdaNext", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Cetak", " ", "sistem", " ", "persamaan", " ", "yang", " ", "baru"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Sistem persamaan setelah substitusi: \>\"", ",", 
      "focSystemSub"}], "]"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Selanjutnya", ",", 
     RowBox[{
     "Anda", " ", "bisa", " ", "gunakan", " ", "Solve", " ", "atau", " ", 
      "NSolve", " ", "untuk", " ", "menyelesaikan", " ", "sistem", " ", 
      "lengkap"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"focSystemSub", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"lambdaE", "[", "t", "]"}], ",", 
         RowBox[{"muE", "[", "t", "]"}]}], 
        RowBox[{"(*", 
         RowBox[{
         "variabel", " ", "lain", " ", "yang", " ", "ingin", " ", 
          "dipecahkan"}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{"dsb", "."}], "*)"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]",
    "lambdaNext", "\n", "solLambda", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.946139816861929*^9, 3.9461398521181507`*^9, {3.946140256790245*^9, 
   3.9461402839309597`*^9}, {3.9461405343897038`*^9, 3.9461405627286797`*^9}, 
   3.9488954161556416`*^9, {3.9488955403604584`*^9, 3.948895543585516*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"e52c92a4-2eb6-c645-94b2-60c371363739"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{
  3.942511329185976*^9, 3.942511423550762*^9, 3.942591573184946*^9, {
   3.9425916035900593`*^9, 3.942591633542879*^9}, {3.9425918643458405`*^9, 
   3.9425918709932823`*^9}, 3.9430982526884403`*^9, {3.943106042988516*^9, 
   3.943106076844755*^9}, {3.943108704823662*^9, 3.9431087103972626`*^9}, {
   3.943358560356596*^9, 3.943358583894329*^9}, 3.943358615914463*^9, 
   3.9433587817943974`*^9, 3.943368571775612*^9, {3.9433686889968395`*^9, 
   3.943368716318613*^9}, 
   3.943368758918228*^9},ExpressionUUID->"f19b7f51-99bd-4547-9650-\
5ff8e4c33086"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Sistem", " ", "persamaan", " ", "setelah", " ", "substitusi"}], 
   "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"focSystemSub", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
               RowBox[{"qt", "[", "t", "]"}]}], ")"}], "/", 
             RowBox[{"ctE", "[", "t", "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "delta"}], ")"}], " ", 
             RowBox[{"Mt", "[", "t", "]"}], " ", 
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"pit", "[", 
              RowBox[{"1", "+", "t"}], "]"}], " ", 
             RowBox[{"qt", "[", 
              RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "delta"}], ")"}], " ", 
                 RowBox[{"qt", "[", 
                  RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
              RowBox[{"xi1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"uEt", "[", 
                  RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"1", "/", "2"}], " ", "xi2", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"uEt", "[", 
                   RowBox[{"1", "+", "t"}], "]"}]}], ")"}], "^", "2"}]}]}], 
             ")"}]}], ")"}], "/", 
          RowBox[{"ctE", "[", 
           RowBox[{"1", "+", "t"}], "]"}]}]}], "==", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betaE", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "t"}], ")"}]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ctE", "[", 
             RowBox[{"1", "+", "t"}], "]"}], " ", 
            RowBox[{"pit", "[", 
             RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"betaE", "^", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"alpha", " ", "betaE"}]}], ")"}], "/", 
               RowBox[{"ctE", "[", "t", "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"muE", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"rtE", "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}], "==", 
        "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"betaE", "^", "t"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"alpha", " ", "betaE"}]}], ")"}], " ", 
           RowBox[{"kEt", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"xi1", "+", 
             RowBox[{"xi2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"uEt", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
         RowBox[{"ctE", "[", "t", "]"}]}], "==", "0"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Pecahkan", " ", "persamaan", " ", "kedua", " ", "untuk", " ", 
     RowBox[{"muE", "[", "t", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"muESolution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"focSystemSub", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"muE", "[", "t", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Substitusikan", " ", "hasil", " ", 
     RowBox[{"muE", "[", "t", "]"}], " ", "ke", " ", "persamaan", " ", 
     "pertama"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq1Sub", "=", 
     RowBox[{
      RowBox[{"focSystemSub", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/.", " ", 
      RowBox[{"muESolution", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Tambahkan", " ", "persamaan", " ", "ketiga", " ", "ke", " ", "output"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq3", "=", 
     RowBox[{"focSystemSub", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Cetak", " ", "hasil"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Persamaan pertama setelah eliminasi muE[t]: \>\"", ",", 
      "eq1Sub"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Persamaan ketiga tetap: \>\"", ",", "eq3"}], "]"}], ";"}], "\n",
    "solLambda", "\n", "lambdaNext", "\n", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.942508348357641*^9, 3.9425083483586407`*^9}, 
   3.9425104770787735`*^9, 3.946140941609421*^9, {3.9461411946531467`*^9, 
   3.9461412087808075`*^9}, {3.948895005448641*^9, 3.94889500683679*^9}, 
   3.948895068023226*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"e2c58ebf-4fbc-3d4b-ac91-cf15352134a5"],

Cell[BoxData[""], "Input",ExpressionUUID->"b88ee315-af2d-ad44-b33b-38496d3a52d4"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.942508439620474*^9, 3.942508439622467*^9}, 
   3.947343144267002*^9},ExpressionUUID->"4126ecf3-b2bc-c34e-b9ce-\
ab3dbe467b58"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", 
   RowBox[{"1.", " ", "Clear", " ", "all", " ", "symbols"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "betaE", ",", "alpha", ",", "delta", ",", "xi1", ",", "xi2", ",", "t", ",",
       "cET", ",", "qT", ",", "MT", ",", "rET", ",", "cET1", ",", "qT1", ",", 
      "pitT1", ",", "uET1", ",", "cETBar", ",", "qBar", ",", "MBar", ",", 
      "rEBar", ",", "cETBar1", ",", "qBar1", ",", "pitBar1", ",", "uEBar1", ",",
       "cEhatT", ",", "qHatT", ",", "MhatT", ",", "rEhatT", ",", "cEhatT1", ",",
       "qHatT1", ",", "pitHatT1", ",", "uEhatT1", ",", "cEhat", ",", "qHat", ",",
       "Mhat", ",", "rEhat", ",", "pitHat", ",", "uEhat"}], "]"}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "2.", " ", "Define", " ", "the", " ", "equation", " ", "function", " ", 
      "F", " ", "cET"}], ",", "qT", ",", "MT", ",", 
     RowBox[{"rET", " ", "represent", " ", 
      RowBox[{"cE", "[", "t", "]"}]}], ",", 
     RowBox[{"q", "[", "t", "]"}], ",", 
     RowBox[{"M", "[", "t", "]"}], ",", 
     RowBox[{
      RowBox[{"rE", "[", "t", "]"}], ";", "\[IndentingNewLine]", "cET1"}], ",",
      "qT1", ",", "pitT1", ",", 
     RowBox[{"uET1", " ", "represent", " ", 
      RowBox[{"cE", "[", 
       RowBox[{"1", "+", "t"}], "]"}]}], ",", 
     RowBox[{"q", "[", 
      RowBox[{"1", "+", "t"}], "]"}], ",", 
     RowBox[{"pit", "[", 
      RowBox[{"1", "+", "t"}], "]"}], ",", 
     RowBox[{
      RowBox[{"uE", "[", 
       RowBox[{"1", "+", "t"}], "]"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{
      "cET_", ",", "qT_", ",", "MT_", ",", "rET_", ",", "cET1_", ",", "qT1_", 
       ",", "pitT1_", ",", "uET1_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"betaE", "^", "t"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"alpha", "*", "betaE"}]}], ")"}], "*", "qT"}], ")"}], "/",
           "cET"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"alpha", "*", "betaE"}]}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"1", "-", "delta"}], ")"}], "*", "MT", "*", "qT1", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"betaE", "*", "cET"}], "-", 
               RowBox[{"cET1", "*", "pitT1"}], "+", 
               RowBox[{"betaE", "*", "cET", "*", "rET"}]}], ")"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"cET", "*", "cET1", "*", 
             RowBox[{"(", 
              RowBox[{"1", "+", "rET"}], ")"}]}], ")"}]}], ")"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"betaE", "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "t"}], ")"}]}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"alpha", "*", "betaE"}]}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "delta"}], ")"}], "*", "qT1"}], ")"}]}], "+", 
           RowBox[{"xi1", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "uET1"}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"1", "/", "2"}], "*", "xi2", "*", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "uET1"}], ")"}], "^", "2"}]}]}], 
          ")"}]}], ")"}], "/", "cET1"}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "List", " ", "variables", " ", "for", " ", "differentiation"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{
      "cET", ",", "qT", ",", "MT", ",", "rET", ",", "cET1", ",", "qT1", ",", 
       "pitT1", ",", "uET1"}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "4.", " ", "Compute", " ", "partial", " ", "derivatives", " ", "of", " ", 
     "F", " ", "at", " ", "the", " ", "steady", " ", "state"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"cET", "->", "cETBar"}], ",", 
          RowBox[{"qT", "->", "qBar"}], ",", 
          RowBox[{"MT", "->", "MBar"}], ",", 
          RowBox[{"rET", "->", "rEBar"}], ",", 
          RowBox[{"cET1", "->", "cETBar1"}], ",", 
          RowBox[{"qT1", "->", "qBar1"}], ",", 
          RowBox[{"pitT1", "->", "pitBar1"}], ",", 
          RowBox[{"uET1", "->", "uEBar1"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"5.", " ", "Define", " ", "symbols", " ", "for", " ", "log"}], "-",
      "deviations"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"These", " ", "represent", " ", "the", " ", "deviations", " ", 
     RowBox[{"(", 
      RowBox[{"d", " ", "ln", 
       RowBox[{"(", "variable", ")"}]}], ")"}], " ", "from", " ", "steady", " ",
      "state"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"For", " ", "time", " ", "t", " ", 
     RowBox[{"variables", ":"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"cEhatT", ",", "qHatT", ",", "MhatT", ",", "rEhatT"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"For", " ", "time", " ", "t"}], "+", 
     RowBox[{"1", " ", 
      RowBox[{"variables", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"cEhatT1", ",", "qHatT1", ",", "pitHatT1", ",", "uEhatT1"}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"6.", " ", "Form", " ", "the", " ", "linearized", " ", 
     RowBox[{"equation", ":", 
      RowBox[{
      "multiply", " ", "each", " ", "derivative", " ", "by", " ", "steady", " ",
        "state", "*", "hat"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", "cETBar", "*", "cEhatT"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", "qBar", "*", "qHatT"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "*", "MBar", "*", "MhatT"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "*", "rEBar", "*", "rEhatT"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "*", "cETBar1", "*", "cEhatT1"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "6", "]"}], "]"}], "*", "qBar1", "*", "qHatT1"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "7", "]"}], "]"}], "*", "pitBar1", "*", "pitHatT1"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "8", "]"}], "]"}], "*", "uEBar1", "*", "uEhatT1"}]}]}], 
    ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "7.", " ", "Simplify", " ", "and", " ", "set", " ", "steady", " ", 
     "state", " ", "values", " ", "equal", " ", "to", " ", "1", " ", 
     RowBox[{"(", "optional", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEqNoBar", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEq", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cETBar", "->", "1"}], ",", 
         RowBox[{"qBar", "->", "1"}], ",", 
         RowBox[{"MBar", "->", "1"}], ",", 
         RowBox[{"rEBar", "->", "1"}], ",", 
         RowBox[{"cETBar1", "->", "1"}], ",", 
         RowBox[{"qBar1", "->", "1"}], ",", 
         RowBox[{"pitBar1", "->", "1"}], ",", 
         RowBox[{"uEBar1", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "8.", " ", "Reintroduce", " ", "time", " ", "indices", " ", "and", " ", 
     "adjust", " ", "exponents", " ", "on", " ", "betaE"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"timeSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cEhatT", "->", 
        RowBox[{"cEhat", "[", "t", "]"}]}], ",", 
       RowBox[{"qHatT", "->", 
        RowBox[{"qHat", "[", "t", "]"}]}], ",", 
       RowBox[{"MhatT", "->", 
        RowBox[{"Mhat", "[", "t", "]"}]}], ",", 
       RowBox[{"rEhatT", "->", 
        RowBox[{"rEhat", "[", "t", "]"}]}], ",", 
       RowBox[{"cEhatT1", "->", 
        RowBox[{"cEhat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"qHatT1", "->", 
        RowBox[{"qHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"pitHatT1", "->", 
        RowBox[{"pitHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"uEhatT1", "->", 
        RowBox[{"uEhat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"betaE", "^", 
         RowBox[{"(", 
          RowBox[{"1", "+", "t"}], ")"}]}], "->", 
        RowBox[{"betaE", "^", 
         RowBox[{"(", 
          RowBox[{"t", "+", "1"}], ")"}]}]}]}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqTimeIndexed", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Output", " ", "the", " ", "final", " ", "linearized", " ", "equations"}],
     "*)"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"final", "=", 
    RowBox[{"FullSimplify", "[", "eqTimeIndexed", "]"}]}], "\n", "final", 
   "\n", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.942508439620474*^9, 3.942508439622467*^9}, 
   3.947343144267002*^9, 3.947343225841057*^9, 3.9476921206255417`*^9, 
   3.9476925659858646`*^9, {3.9476929256355705`*^9, 3.9476929420413055`*^9}, {
   3.947693156454401*^9, 3.947693171855715*^9}, {3.947693208884466*^9, 
   3.947693262539545*^9}, 3.9476933214529095`*^9, {3.947951709971283*^9, 
   3.947951764419405*^9}, {3.9489897158642616`*^9, 3.9489897394031467`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"e455865f-d51a-c546-92e4-fe2425237d2b"],

Cell[CellGroupData[{

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{{3.9497706593053455`*^9, 3.9497706593053455`*^9}, {
  3.9497709221557274`*^9, 
  3.949770939730934*^9}},ExpressionUUID->"36afece9-c926-264b-a26f-\
39f47d59542e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"Lagrangian\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{"muE", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "delta"}], ")"}], " ", "kEt", " ", "mEt", " ", 
           "pit", " ", "qt"}], ")"}]}], "+", 
        RowBox[{"btE", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "rtE"}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{"lambdaE", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "btE"}], "+", "ctE", "-", 
        RowBox[{"AE", " ", 
         SuperscriptBox["kEt", "alpha"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"LEI", "+", "LEP"}], ")"}], 
          RowBox[{"1", "-", "alpha"}]]}], "+", 
        RowBox[{"kEt", " ", "qt"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "delta"}], ")"}], " ", "kEt", " ", "qt"}], "+", 
        FractionBox[
         RowBox[{"btE", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "rtE"}], ")"}]}], "pit"], "+", 
        RowBox[{"LEI", " ", "wip"}], "+", 
        RowBox[{"LEP", " ", "wpt"}], "+", 
        RowBox[{"kEt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "uEt"}], ")"}], " ", "xi1"}], "+", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "uEt"}], ")"}], "2"], " ", "xi2"}]}], 
          ")"}]}]}], ")"}]}], "+", 
     RowBox[{"Log", "[", "ctE", "]"}]}]}], ",", 
   RowBox[{"\<\"First-Order Conditions\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\<\"FOC wrt ctE\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{
         FractionBox["1", "ctE"], "+", "lambdaE"}], "\[Equal]", "0"}]}], ",", 
      RowBox[{"\<\"FOC wrt kEt\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "delta"}], ")"}], " ", "mEt", " ", "muE", " ", 
            "pit", " ", "qt"}], ")"}]}], "+", 
         RowBox[{"lambdaE", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "AE"}], " ", "alpha", " ", 
             SuperscriptBox["kEt", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "alpha"}]], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"LEI", "+", "LEP"}], ")"}], 
              RowBox[{"1", "-", "alpha"}]]}], "+", "qt", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "delta"}], ")"}], " ", "qt"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "uEt"}], ")"}], " ", "xi1"}], "+", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "uEt"}], ")"}], "2"], " ", "xi2"}]}],
            ")"}]}]}], "\[Equal]", "0"}]}], ",", 
      RowBox[{"\<\"FOC wrt btE\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"muE", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "rtE"}], ")"}]}], "+", 
         RowBox[{"lambdaE", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            FractionBox[
             RowBox[{"1", "+", "rtE"}], "pit"]}], ")"}]}]}], "\[Equal]", 
        "0"}]}], ",", 
      RowBox[{"\<\"FOC wrt uEt\"\>", "\[Rule]", 
       RowBox[{
        RowBox[{"kEt", " ", "lambdaE", " ", 
         RowBox[{"(", 
          RowBox[{"xi1", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "uEt"}], ")"}], " ", "xi2"}]}], 
          ")"}]}], "\[Equal]", "0"}]}]}], "}"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.9497706675837574`*^9},
 CellLabel->
  "Out[166]=",ExpressionUUID->"ac571d23-c186-944e-833e-c2c84de86d8f"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.9476933821967697`*^9, 3.9476933997913017`*^9}, {
  3.9479516911854343`*^9, 
  3.9479517038352757`*^9}},ExpressionUUID->"2dd959b2-176f-8a4f-80e4-\
1ab403b9ba23"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9476933821967697`*^9, 
  3.9476933997913017`*^9}},ExpressionUUID->"7e7eb5ba-8e84-5b42-acd7-\
29c01026fa12"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"1.", " ", "Clear", " ", "all", " ", "symbols"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "betaE", ",", "alpha", ",", "xi1", ",", "xi2", ",", "t", ",", "kEtT", ",",
       "ctET", ",", "uEtT", ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "variables", " ", "in", " ", "F", " ", "corresponding", " ", "to", " ", 
         RowBox[{"kEt", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ",", 
        RowBox[{"ctE", "[", "t", "]"}], ",", 
        RowBox[{"uEt", "[", "t", "]"}]}], "*)"}], "kEBar", ",", "ctEBar", ",",
       "uEBar", ",", 
      RowBox[{"(*", 
       RowBox[{"steady", " ", "state", " ", "values"}], "*)"}], "kEhatT", ",",
       "ctEhatT", ",", "uEhatT", ",", 
      RowBox[{"(*", 
       RowBox[{"log", "-", "deviations"}], "*)"}], "kEhat", ",", "ctEhat", ",",
       "uEhat"}], "       ", 
     RowBox[{"(*", 
      RowBox[{"time", "-", 
       RowBox[{"indexed", " ", "log", " ", "deviations"}]}], "*)"}], "]"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "2.", " ", "Define", " ", "the", " ", "original", " ", "equation", " ", 
       "as", " ", "F", 
       RowBox[{"(", "...", ")"}]}], "==", 
      RowBox[{"0.", " ", "Here"}]}], ",", 
     RowBox[{"kEtT", " ", "represents", " ", 
      RowBox[{"kEt", "[", 
       RowBox[{"t", "-", "1"}], "]"}]}], ",", 
     RowBox[{"ctET", " ", "represents", " ", 
      RowBox[{"ctE", "[", "t", "]"}]}], ",", 
     RowBox[{"and", " ", "uEtT", " ", "represents", " ", 
      RowBox[{
       RowBox[{"uEt", "[", "t", "]"}], "."}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{"kEtT_", ",", "ctET_", ",", "uEtT_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"betaE", "^", "t"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"alpha", "*", "betaE"}]}], ")"}], "*", "kEtT", "*", 
        RowBox[{"(", 
         RowBox[{"xi1", "+", 
          RowBox[{"xi2", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "uEtT"}], ")"}]}]}], ")"}]}], ")"}], "/",
       "ctET"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "List", " ", "the", " ", "variables", " ", "for", " ", 
     "differentiation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{"kEtT", ",", "ctET", ",", "uEtT"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "4.", " ", "Compute", " ", "partial", " ", "derivatives", " ", "of", " ", 
     "F", " ", "at", " ", "the", " ", "steady", " ", "state"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"kEtT", "->", "kEBar"}], ",", 
          RowBox[{"ctET", "->", "ctEBar"}], ",", 
          RowBox[{"uEtT", "->", "uEBar"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"5.", " ", "Define", " ", "symbols", " ", "for", " ", "log"}], "-", 
     RowBox[{"deviations", " ", 
      RowBox[{"(", 
       RowBox[{"d", " ", "ln", 
        RowBox[{"(", "variable", ")"}]}], ")"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"kEhatT", " ", "corresponds", " ", "to", " ", 
       RowBox[{"kEt", "'"}], "s", " ", "log", " ", "deviation", " ", "at", " ",
        "time", " ", "t"}], "-", "1"}], ",", 
     RowBox[{"etc", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"kEhatT", ",", "ctEhatT", ",", "uEhatT"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "6.", " ", "Form", " ", "the", " ", "linearized", " ", "equation", " ", 
      "by", " ", "multiplying", " ", "each", " ", "derivative", " ", "by", " ",
       "the", " ", "corresponding", " ", "steady", " ", "state", " ", "and", " ",
       "log"}], "-", "deviation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", "kEBar", "*", "kEhatT"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", "ctEBar", "*", "ctEhatT"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "*", "uEBar", "*", "uEhatT"}]}]}], 
    ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "7.", " ", "Simplify", " ", "and", " ", "optionally", " ", "normalize", " ",
      "steady", " ", "state", " ", "values", " ", "to", " ", "1"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEqNoBar", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEq", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"kEBar", "->", "1"}], ",", 
         RowBox[{"ctEBar", "->", "1"}], ",", 
         RowBox[{"uEBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"8.", " ", "Reintroduce", " ", "time", " ", 
       RowBox[{"indices", ":", "kEhatT"}]}], "->", 
      RowBox[{
       RowBox[{"kEhat", "[", 
        RowBox[{"t", "-", "1"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"since", " ", "kEtT", " ", "represents", " ", 
         RowBox[{"kEt", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ")"}]}]}], ",", 
     RowBox[{"ctEhatT", "->", 
      RowBox[{"ctEhat", "[", "t", "]"}]}], ",", 
     RowBox[{"uEhatT", "->", 
      RowBox[{"uEhat", "[", "t", "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"timeSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"kEhatT", "->", 
        RowBox[{"kEhat", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], ",", 
       RowBox[{"ctEhatT", "->", 
        RowBox[{"ctEhat", "[", "t", "]"}]}], ",", 
       RowBox[{"uEhatT", "->", 
        RowBox[{"uEhat", "[", "t", "]"}]}]}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqTimeIndexed", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Output", " ", "the", " ", "final", " ", "linearized", " ", "equations"}],
     "*)"}], "\[IndentingNewLine]", "logLinEqNoBar", "\n", "eqTimeIndexed", 
   "\n", "\[IndentingNewLine]", "\n"}]}]], "Input",
 CellChangeTimes->{{3.946985315020729*^9, 3.9469853498544445`*^9}, {
   3.9469855371680393`*^9, 3.9469855426712666`*^9}, {3.946986379214081*^9, 
   3.946986384157078*^9}, 3.9469868520171394`*^9, {3.946987699902313*^9, 
   3.9469877303491592`*^9}, 3.9469881338402653`*^9, {3.946988164224745*^9, 
   3.9469881780090294`*^9}, {3.947004166869732*^9, 3.947004204956812*^9}, {
   3.947178139271166*^9, 3.9471781409626083`*^9}, {3.9473433951528263`*^9, 
   3.947343404765833*^9}, 3.9476921024180756`*^9, {3.947693597434248*^9, 
   3.947693625683399*^9}, {3.947694955148752*^9, 3.9476949754949703`*^9}},
 CellLabel->
  "In[206]:=",ExpressionUUID->"0ee05957-9f4b-5148-9577-73fb4d317e3e"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.946985315020729*^9, 3.9469853498544445`*^9}, {
   3.9469855371680393`*^9, 3.9469855426712666`*^9}, {3.946986379214081*^9, 
   3.946986384157078*^9}, 3.9469868520171394`*^9, {3.946987699902313*^9, 
   3.9469877303491592`*^9}, 3.9469881338402653`*^9, {3.946988164224745*^9, 
   3.9469881780090294`*^9}, {3.947004166869732*^9, 3.947004204956812*^9}, {
   3.947178139271166*^9, 3.9471781409626083`*^9}, 3.9473433951528263`*^9, {
   3.947774463264351*^9, 3.947774582804943*^9}, {3.9477746544935417`*^9, 
   3.9477746704503098`*^9}, {3.9488891389506054`*^9, 
   3.9488891511059494`*^9}},ExpressionUUID->"d50ef5dd-7d10-9347-8ed7-\
e6a9098ab778"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9477832974356384`*^9, 3.947783320320606*^9}, 
   3.9488891654065704`*^9},ExpressionUUID->"63b0b1fd-2390-274b-9686-\
decf9bf4215f"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9477832974356384`*^9, 3.9477833320736427`*^9}, {
   3.947783444542406*^9, 3.9477834917791805`*^9}, {3.9477835283245945`*^9, 
   3.9477835684462967`*^9}, 
   3.9477836422302113`*^9},ExpressionUUID->"71ece0e5-c6b3-3242-9291-\
2dce22eed9c9"],

Cell[BoxData[
 RowBox[{"\n", "\[IndentingNewLine]", "\n", "\n", "\n"}]], "Input",
 CellChangeTimes->{{3.9477765584922104`*^9, 3.9477765996736145`*^9}, {
   3.9477766523289223`*^9, 3.9477766537406273`*^9}, {3.947777218009754*^9, 
   3.9477772629500523`*^9}, {3.9477773108772793`*^9, 3.947777314516247*^9}, {
   3.9477774559547176`*^9, 3.94777747338566*^9}, 3.947778172717783*^9, 
   3.9477782078892593`*^9, 3.9477782395551414`*^9, {3.9477796378394737`*^9, 
   3.947779650137188*^9}, {3.9477827329496593`*^9, 3.947782752283697*^9}, {
   3.94778280092708*^9, 3.947782853216881*^9}, {3.948377858154047*^9, 
   3.9483781494883423`*^9}, {3.948889182108549*^9, 
   3.9488891970021114`*^9}},ExpressionUUID->"2c594bee-dfa3-0445-a3c2-\
f168b0935ff6"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9488892088131886`*^9, 
  3.9488892088153896`*^9}},ExpressionUUID->"e7592208-471d-8b47-8fcd-\
f3187cd3bdcd"],

Cell[BoxData[""], "Input",ExpressionUUID->"dcfcb1a1-4b7e-0b43-9670-8664b3289327"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{
  3.9427542379518967`*^9, {3.9427544965523434`*^9, 3.9427545632885056`*^9}, {
   3.946568422636217*^9, 3.9465684433856716`*^9}, 3.9465684783490505`*^9, 
   3.946568532208021*^9, {3.946568632693981*^9, 3.946568653514969*^9}, {
   3.946569857761751*^9, 3.9465698651066914`*^9}, 3.9465723397106075`*^9, 
   3.94665877743454*^9, {3.9466588743666687`*^9, 3.946658879360529*^9}, {
   3.946658937645237*^9, 3.9466589592356358`*^9}, {3.94666007926388*^9, 
   3.946660096683794*^9}, {3.946660162254713*^9, 3.946660179652712*^9}, {
   3.9466603112136536`*^9, 3.9466603652698765`*^9}, 3.9466606586495495`*^9, 
   3.946660721591772*^9, {3.9466614892396374`*^9, 3.946661517609167*^9}, {
   3.9466615581775208`*^9, 3.94666162347818*^9}, 3.9466620995132637`*^9, 
   3.946662154477379*^9, 3.946662259309641*^9, 3.946662304670412*^9, 
   3.9466641153553944`*^9, 3.9477757023255024`*^9, {3.9477757356890717`*^9, 
   3.9477757536725636`*^9}, {3.9477761576092434`*^9, 3.9477761750114326`*^9}},
 CellLabel->"",ExpressionUUID->"a5650fd1-18d4-1d4e-89f1-7b4f1f908005"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.947784073489916*^9, 3.947784073489916*^9}, {
   3.9479524236628036`*^9, 3.947952454649807*^9}, {3.947952601062275*^9, 
   3.947952641709175*^9}, 
   3.948889236198662*^9},ExpressionUUID->"e2dbdcc9-c66d-4441-907d-\
edfe421a4271"],

Cell[BoxData[""], "Input",
 CellLabel->"In[92]:=",ExpressionUUID->"39487013-ded2-0e45-9fd8-d526c979fc41"],

Cell[BoxData[""], "Input",ExpressionUUID->"ad54bf90-5079-e447-887e-2c9f31b492f1"],

Cell[BoxData[
 RowBox[{"\n", "\n"}]], "Input",
 CellChangeTimes->{
  3.948378689768938*^9, {3.9488892704537334`*^9, 
   3.9488892816550026`*^9}},ExpressionUUID->"25e88d48-476a-5a46-a379-\
8531149d9a08"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{{3.94698950101556*^9, 3.9469895031470222`*^9}, {
  3.946989691328703*^9, 
  3.946989705939865*^9}},ExpressionUUID->"90347a46-5dbd-b54f-8f1e-\
a6938e1fe31a"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{3.946989910123577*^9, 
  3.9477748578081017`*^9},ExpressionUUID->"d48f496e-7176-4c4a-84fa-\
2b0987060b46"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9469965989965515`*^9, 3.946996631543125*^9}, {
   3.946996679326996*^9, 3.946996680746643*^9}, {3.9469967383488903`*^9, 
   3.9469967415651703`*^9}, 3.947000760794897*^9, 
   3.947774826414343*^9},ExpressionUUID->"16a53433-1cc7-e74a-b3e2-\
121a43b05c36"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{{3.9469966392186947`*^9, 3.9469966392196903`*^9}, 
   3.9469967613630085`*^9},
 CellLabel->
  "In[110]:=",ExpressionUUID->"0d88e268-8e18-e44d-b2d8-cdf7e7401492"],

Cell[BoxData[
 RowBox[{"\n", "\n", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.946997714031584*^9, {3.946997818668518*^9, 3.946997840825136*^9}, {
   3.9469981410677166`*^9, 3.9469981620450706`*^9}, {3.9469984739662876`*^9, 
   3.9469984868744564`*^9}, {3.9470004652612762`*^9, 
   3.9470004746943607`*^9}, {3.947000923688463*^9, 3.9470009573882008`*^9}, {
   3.9470011983600025`*^9, 3.947001200512789*^9}, {3.9470014349401226`*^9, 
   3.947001442098938*^9}, 
   3.9477748041658745`*^9},ExpressionUUID->"040b9176-9fb1-6c42-b2d6-\
b57a6d9f6770"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9469965989965515`*^9, 
  3.946996631543125*^9}},ExpressionUUID->"415c207e-69ac-8e4e-b60e-\
cce02daeab93"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.947087114500244*^9, 3.9470871163989105`*^9}, {
   3.9470871676026287`*^9, 3.9470871922291965`*^9}, {3.947087223790371*^9, 
   3.9470873702921944`*^9}, {3.9470874023732185`*^9, 3.947087413339325*^9}, {
   3.9470913294324627`*^9, 3.9470913359381046`*^9}, {3.94709139935532*^9, 
   3.9470914606802616`*^9}, {3.9470915357667885`*^9, 3.947091559078287*^9}, {
   3.9470916095928574`*^9, 3.947091637500084*^9}, {3.9473460120193176`*^9, 
   3.947346041941885*^9}, {3.947346107088167*^9, 3.9473461398450375`*^9}, {
   3.948990694389536*^9, 3.9489907262754*^9}, 3.949058697599327*^9, 
   3.9495757030521927`*^9},ExpressionUUID->"fa04d5b8-3a30-3845-b5fc-\
decb17933490"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"goods", " ", "retailers"}], "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Contoh", " ", "pemecahan", " ", "fungsi", " ", "profit", " ", 
    "retailerstart"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Parameter", " ", "contoh"}], "*)"}], 
  RowBox[{
   RowBox[{"params", "=", 
    RowBox[{"{", 
     RowBox[{"betaR", ",", "kappaP", ",", "iota", ",", "piStar", ",", 
      RowBox[{"epsilonU", "[", "t", "]"}], ",", 
      RowBox[{"Pt", "[", "t", "]"}], ",", 
      RowBox[{"Pw", "[", "t", "]"}], ",", 
      RowBox[{"Y", "[", "t", "]"}], ",", 
      RowBox[{"Pi", "[", "t", "]"}], ",", 
      RowBox[{"Pj", "[", "t", "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"1.", " ", "Bagian", " ", "pendapatan"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"revenue", "[", "t_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Pj", "[", "t", "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Pj", "[", "t", "]"}], "/", 
         RowBox[{"Pt", "[", "t", "]"}]}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"-", 
         RowBox[{"epsilonU", "[", "t", "]"}]}], ")"}]}], ")"}], "*", 
     RowBox[{"Y", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"2.", " ", "Bagian", " ", "biaya", " ", "wholesale"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"costWholesale", "[", "t_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Pw", "[", "t", "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Pj", "[", "t", "]"}], "/", 
         RowBox[{"Pt", "[", "t", "]"}]}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"-", 
         RowBox[{"epsilonU", "[", "t", "]"}]}], ")"}]}], ")"}], "*", 
     RowBox[{"Y", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "3.", " ", "Bagian", " ", "quadratic", " ", "adjustment", " ", "cost"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"adjCost", "[", "t_", "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"kappaP", "/", "2"}], ")"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Pj", "[", "t", "]"}], "/", 
          RowBox[{"Pj", "[", 
           RowBox[{"t", "-", "1"}], "]"}]}], ")"}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"Pi", "[", 
           RowBox[{"t", "-", "1"}], "]"}], "^", "iota"}], "*", 
         RowBox[{"piStar", "^", 
          RowBox[{"(", 
           RowBox[{"1", "-", "iota"}], ")"}]}]}]}], ")"}], "^", "2"}], "*", 
     RowBox[{"Pj", "[", "t", "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Pj", "[", "t", "]"}], "/", 
         RowBox[{"Pt", "[", "t", "]"}]}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"-", 
         RowBox[{"epsilonU", "[", "t", "]"}]}], ")"}]}], ")"}], "*", 
     RowBox[{"Y", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "4.", " ", "Fungsi", " ", "profit", " ", "total", " ", "periode", " ", 
    "t"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"profitRetail", "[", "t_", "]"}], ":=", 
    RowBox[{
     RowBox[{"revenue", "[", "t", "]"}], "-", 
     RowBox[{"costWholesale", "[", "t", "]"}], "-", 
     RowBox[{"adjCost", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"Tambahan", ":", 
      RowBox[{"Definisi", " ", 
       RowBox[{"SDF", "[", "t", "]"}]}]}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dProfitRetail", "[", 
        RowBox[{"t", "+", "1"}], "]"}], "/", 
       RowBox[{"dPj", "[", "t", "]"}]}], "/", 
      RowBox[{"dProfitRetail", "[", "t", "]"}]}], "/", 
     RowBox[{
      RowBox[{"dPj", "[", "t", "]"}], "--"}]}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sdf", "[", "t_", "]"}], ":=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"profitRetail", "[", 
        RowBox[{"t", "+", "1"}], "]"}], ",", 
       RowBox[{"Pj", "[", "t", "]"}]}], "]"}], "/", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"profitRetail", "[", "t", "]"}], ",", 
       RowBox[{"Pj", "[", "t", "]"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "5.", " ", "Contoh", " ", "fungsi", " ", "objektif", " ", "dua", " ", 
    "periode", " ", "dengan", " ", 
    RowBox[{"SDF", "[", "t", "]"}]}], "*)"}]}], "\n", 
 RowBox[{"obj", "=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"revenue", "[", "t", "]"}], "-", 
    RowBox[{"costWholesale", "[", "t", "]"}], "-", 
    RowBox[{"adjCost", "[", "t", "]"}]}], ")"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"+", 
    RowBox[{"betaR", "^", 
     RowBox[{"(", 
      RowBox[{"t", "+", "1"}], ")"}]}]}], "*", 
   RowBox[{"sdf", "[", "t", "]"}], "*", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"revenue", "[", 
      RowBox[{"t", "+", "1"}], "]"}], "-", 
     RowBox[{"costWholesale", "[", 
      RowBox[{"t", "+", "1"}], "]"}], "-", 
     RowBox[{"adjCost", "[", 
      RowBox[{"t", "+", "1"}], "]"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"6.", " ", "First"}], "-", 
    RowBox[{"order", " ", "condition", " ", "wrt", " ", 
     RowBox[{"Pj", "[", "t", "]"}]}]}], "*)"}], 
  RowBox[{
   RowBox[{"focPjt", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"obj", ",", 
       RowBox[{"Pj", "[", "t", "]"}]}], "]"}], "==", "0"}]}], ";"}]}], "\n", 
 RowBox[{
  RowBox[{"fiul", "=", 
   RowBox[{"FullSimplify", "[", "focPjt", "]"}]}], ";"}], "\n", "5", "\[IndentingNewLine]", 
 RowBox[{"focPjt", "\n"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.948990784621073*^9, 3.9490587149937515`*^9, 3.9490588209595146`*^9, {
   3.9490601859770145`*^9, 3.9490602059949303`*^9}, {3.9490603001104393`*^9, 
   3.949060303477806*^9}, {3.949416913439928*^9, 3.949416919322603*^9}, {
   3.9495132256066513`*^9, 3.9495132279911957`*^9}, {3.949575483712454*^9, 
   3.949575505946844*^9}, {3.949575556964756*^9, 3.94957555847365*^9}, {
   3.9495757187829437`*^9, 3.94957579527203*^9}, {3.9495766264864006`*^9, 
   3.949576649652191*^9}, 3.9495768077102947`*^9, {3.949576842721739*^9, 
   3.949576846706112*^9}, {3.9495778787948666`*^9, 3.9495778978648014`*^9}, {
   3.9495782206362915`*^9, 3.949578239020588*^9}, 3.9495782955702114`*^9, {
   3.949578344308897*^9, 3.949578385973671*^9}, {3.949578672307455*^9, 
   3.949578700062748*^9}, {3.949578757591608*^9, 3.9495787675603943`*^9}, {
   3.9495788526952324`*^9, 3.9495789187073097`*^9}, {3.9495790065344944`*^9, 
   3.949579010646*^9}, {3.949579213140497*^9, 3.949579222446415*^9}, {
   3.9495792607795753`*^9, 3.9495792721928806`*^9}, {3.9495793613146553`*^9, 
   3.949579365756941*^9}, {3.9495799993750553`*^9, 3.949580021268612*^9}, 
   3.949580152260338*^9, {3.9495803301675854`*^9, 3.949580339349781*^9}, {
   3.9495803877309704`*^9, 3.94958042670409*^9}, {3.9495807157365246`*^9, 
   3.949580718630356*^9}},
 CellLabel->
  "In[263]:=",ExpressionUUID->"a4784151-fd95-5549-b874-48705f8102dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Pj", "[", "t", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox[
      RowBox[{"Pj", "[", "t", "]"}], 
      RowBox[{"Pt", "[", "t", "]"}]], ")"}], 
    RowBox[{"-", 
     RowBox[{"epsilonU", "[", "t", "]"}]}]], " ", 
   RowBox[{"Y", "[", "t", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "kappaP", " ", 
   RowBox[{"Pj", "[", "t", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["piStar", 
         RowBox[{"1", "-", "iota"}]]}], " ", 
       SuperscriptBox[
        RowBox[{"\[Pi]", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}], "iota"]}], "+", 
      FractionBox[
       RowBox[{"Pj", "[", "t", "]"}], 
       RowBox[{"Pj", "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "t"}], "]"}]]}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox[
      RowBox[{"Pj", "[", "t", "]"}], 
      RowBox[{"Pt", "[", "t", "]"}]], ")"}], 
    RowBox[{"-", 
     RowBox[{"epsilonU", "[", "t", "]"}]}]], " ", 
   RowBox[{"Y", "[", "t", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox[
      RowBox[{"Pj", "[", "t", "]"}], 
      RowBox[{"Pt", "[", "t", "]"}]], ")"}], 
    RowBox[{"-", 
     RowBox[{"epsilonU", "[", "t", "]"}]}]], " ", 
   RowBox[{"Pw", "[", "t", "]"}], " ", 
   RowBox[{"Y", "[", "t", "]"}]}]}]], "Output",
 CellChangeTimes->{3.949579374940029*^9, 3.9495800390336056`*^9, 
  3.9495803986136646`*^9, 3.9495804345694523`*^9, 3.9495807322547398`*^9},
 CellLabel->
  "Out[270]=",ExpressionUUID->"eb7179b5-add7-ac4a-a5fb-41ee267a0bdc"],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{3.949579374940029*^9, 3.9495800390336056`*^9, 
  3.9495803986136646`*^9, 3.9495804345694523`*^9, 3.9495807322593155`*^9},
 CellLabel->
  "Out[274]=",ExpressionUUID->"64926b0d-9995-f942-b8cc-f99c9d616b3f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox[
       RowBox[{"Pj", "[", "t", "]"}], 
       RowBox[{"Pt", "[", "t", "]"}]], ")"}], 
     RowBox[{"-", 
      RowBox[{"epsilonU", "[", "t", "]"}]}]], " ", 
    RowBox[{"Y", "[", "t", "]"}]}], "-", 
   FractionBox[
    RowBox[{"kappaP", " ", 
     RowBox[{"Pj", "[", "t", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["piStar", 
          RowBox[{"1", "-", "iota"}]]}], " ", 
        SuperscriptBox[
         RowBox[{"\[Pi]", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}], "iota"]}], "+", 
       FractionBox[
        RowBox[{"Pj", "[", "t", "]"}], 
        RowBox[{"Pj", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}]]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        RowBox[{"Pj", "[", "t", "]"}], 
        RowBox[{"Pt", "[", "t", "]"}]], ")"}], 
      RowBox[{"-", 
       RowBox[{"epsilonU", "[", "t", "]"}]}]], " ", 
     RowBox[{"Y", "[", "t", "]"}]}], 
    RowBox[{"Pj", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "t"}], "]"}]], "-", 
   RowBox[{
    FractionBox["1", "2"], " ", "kappaP", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["piStar", 
          RowBox[{"1", "-", "iota"}]]}], " ", 
        SuperscriptBox[
         RowBox[{"\[Pi]", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}], "iota"]}], "+", 
       FractionBox[
        RowBox[{"Pj", "[", "t", "]"}], 
        RowBox[{"Pj", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}]]}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox[
       RowBox[{"Pj", "[", "t", "]"}], 
       RowBox[{"Pt", "[", "t", "]"}]], ")"}], 
     RowBox[{"-", 
      RowBox[{"epsilonU", "[", "t", "]"}]}]], " ", 
    RowBox[{"Y", "[", "t", "]"}]}], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"epsilonU", "[", "t", "]"}], " ", 
     RowBox[{"Pj", "[", "t", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        RowBox[{"Pj", "[", "t", "]"}], 
        RowBox[{"Pt", "[", "t", "]"}]], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "-", 
       RowBox[{"epsilonU", "[", "t", "]"}]}]], " ", 
     RowBox[{"Y", "[", "t", "]"}]}], 
    RowBox[{"Pt", "[", "t", "]"}]], "+", 
   FractionBox[
    RowBox[{"kappaP", " ", 
     RowBox[{"epsilonU", "[", "t", "]"}], " ", 
     RowBox[{"Pj", "[", "t", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["piStar", 
           RowBox[{"1", "-", "iota"}]]}], " ", 
         SuperscriptBox[
          RowBox[{"\[Pi]", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}], "iota"]}], "+", 
        FractionBox[
         RowBox[{"Pj", "[", "t", "]"}], 
         RowBox[{"Pj", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}]]}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        RowBox[{"Pj", "[", "t", "]"}], 
        RowBox[{"Pt", "[", "t", "]"}]], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "-", 
       RowBox[{"epsilonU", "[", "t", "]"}]}]], " ", 
     RowBox[{"Y", "[", "t", "]"}]}], 
    RowBox[{"2", " ", 
     RowBox[{"Pt", "[", "t", "]"}]}]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"epsilonU", "[", "t", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        RowBox[{"Pj", "[", "t", "]"}], 
        RowBox[{"Pt", "[", "t", "]"}]], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "-", 
       RowBox[{"epsilonU", "[", "t", "]"}]}]], " ", 
     RowBox[{"Pw", "[", "t", "]"}], " ", 
     RowBox[{"Y", "[", "t", "]"}]}], 
    RowBox[{"Pt", "[", "t", "]"}]]}], "\[Equal]", "0"}]], "Output",
 CellChangeTimes->{3.949579374940029*^9, 3.9495800390336056`*^9, 
  3.9495803986136646`*^9, 3.9495804345694523`*^9, 3.949580732265377*^9},
 CellLabel->
  "Out[275]=",ExpressionUUID->"cad3c2a6-2584-6d4d-a1b9-63356a260414"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"1.", " ", "Clear", " ", "all", " ", "symbols"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "Pj", ",", "Pt", ",", "Y", ",", "epsU", ",", "Pw", ",", "PjFut", ",", 
      "PtFut", ",", "YFut", ",", "epsUFut", ",", "PjLag", ",", "PiLag", ",", 
      "piVar", ",", "beta", ",", "LambdaE", ",", "kappaP", ",", "piStar", ",",
       "iota", ",", "betaR", ",", "t", ",", "PjBar", ",", "PtBar", ",", 
      "YBar", ",", "epsUBar", ",", "PwBar", ",", "PjFutBar", ",", "PtFutBar", 
      ",", "YFutBar", ",", "epsUFutBar", ",", "PjLagBar", ",", "PiLagBar", ",",
       "piVarBar", ",", "PjHat", ",", "PtHat", ",", "YHat", ",", "epsUHat", ",",
       "PwHat", ",", "PjFutHat", ",", "PtFutHat", ",", "YFutHat", ",", 
      "epsUFutHat", ",", "PjLagHat", ",", "PiLagHat", ",", "piVarHat"}], 
     "]"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "2.", " ", "Define", " ", "the", " ", "original", " ", "nonlinear", " ",
        "equation", " ", "F"}], "==", "0"}], ",", 
     RowBox[{
     "now", " ", "including", " ", "all", " ", "variables", " ", "for", " ", 
      RowBox[{"consistency", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{
      "Pj_", ",", "Pt_", ",", "Y_", ",", "epsU_", ",", "Pw_", ",", "PjFut_", ",",
        "PtFut_", ",", "YFut_", ",", "epsUFut_", ",", "PjLag_", ",", "PiLag_",
        ",", "piVar_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"PjLag", " ", "Pj"}], ")"}]}], ")"}], "*", 
      RowBox[{"piStar", "^", 
       RowBox[{"-", "iota"}]}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Pj", "/", "Pt"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"-", "epsU"}], ")"}]}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "kappaP", " ", 
         RowBox[{"piStar", "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "iota"}], ")"}]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "epsU"}], ")"}], " ", 
         RowBox[{"PiLag", "^", "iota"}], " ", "PjLag", " ", 
         RowBox[{"Pj", "^", "2"}]}], "-", 
        RowBox[{"kappaP", " ", 
         RowBox[{"piStar", "^", 
          RowBox[{"(", 
           RowBox[{"2", " ", "iota"}], ")"}]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "+", "epsU"}], ")"}], " ", 
         RowBox[{"Pj", "^", "3"}]}], "+", 
        RowBox[{
         RowBox[{"PjLag", "^", "2"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "epsU"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{"piStar", "^", 
                RowBox[{"(", 
                 RowBox[{"2", " ", "iota"}], ")"}]}]}], "-", 
              RowBox[{"kappaP", " ", 
               RowBox[{"piStar", "^", "2"}], " ", 
               RowBox[{"PiLag", "^", 
                RowBox[{"(", 
                 RowBox[{"2", " ", "iota"}], ")"}]}]}]}], ")"}], " ", "Pj"}], 
           "-", 
           RowBox[{"2", " ", 
            RowBox[{"piStar", "^", 
             RowBox[{"(", 
              RowBox[{"2", " ", "iota"}], ")"}]}], " ", "epsU", " ", "Pw"}]}],
           ")"}]}]}], ")"}], "*", "Y"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "List", " ", "all", " ", "variables", " ", "for", " ", 
     "differentiation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{
      "Pj", ",", "Pt", ",", "Y", ",", "epsU", ",", "Pw", ",", "PjFut", ",", 
       "PtFut", ",", "YFut", ",", "epsUFut", ",", "PjLag", ",", "PiLag", ",", 
       "piVar"}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Corresponding", " ", "log"}], "-", 
     RowBox[{"deviation", " ", "symbols"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logDevs", "=", 
     RowBox[{"{", 
      RowBox[{
      "PjHat", ",", "PtHat", ",", "YHat", ",", "epsUHat", ",", "PwHat", ",", 
       "PjFutHat", ",", "PtFutHat", ",", "YFutHat", ",", "epsUFutHat", ",", 
       "PjLagHat", ",", "PiLagHat", ",", "piVarHat"}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "4.", " ", "Compute", " ", "partial", " ", "derivatives", " ", "of", " ", 
     "F", " ", "with", " ", "respect", " ", "to", " ", "each", " ", 
     "variable", " ", "at", " ", "the", " ", "steady", " ", "state"}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"steadyStateSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Pj", "->", "PjBar"}], ",", 
       RowBox[{"Pt", "->", "PtBar"}], ",", 
       RowBox[{"Y", "->", "YBar"}], ",", 
       RowBox[{"epsU", "->", "epsUBar"}], ",", 
       RowBox[{"Pw", "->", "PwBar"}], ",", 
       RowBox[{"PjFut", "->", "PjFutBar"}], ",", 
       RowBox[{"PtFut", "->", "PtFutBar"}], ",", 
       RowBox[{"YFut", "->", "YFutBar"}], ",", 
       RowBox[{"epsUFut", "->", "epsUFutBar"}], ",", 
       RowBox[{"PjLag", "->", "PjLagBar"}], ",", 
       RowBox[{"PiLag", "->", "PiLagBar"}], ",", 
       RowBox[{"piVar", "->", "piVarBar"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        "steadyStateSubs"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "5.", " ", "Form", " ", "the", " ", "linearized", " ", "equation", " ", 
      "as", " ", "the", " ", "sum", " ", "of", " ", "each", " ", "derivative",
       " ", "times", " ", "its", " ", "corresponding", " ", "steady"}], "-", 
     RowBox[{"state", " ", "value", " ", "times", " ", "the", " ", "log"}], "-",
      "deviation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", "PjBar", "*", "PjHat"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", "PtBar", "*", "PtHat"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "*", "YBar", "*", "YHat"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "*", "epsUBar", "*", "epsUHat"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "*", "PwBar", "*", "PwHat"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "6", "]"}], "]"}], "*", "PjFutBar", "*", "PjFutHat"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "7", "]"}], "]"}], "*", "PtFutBar", "*", "PtFutHat"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "8", "]"}], "]"}], "*", "YFutBar", "*", "YFutHat"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "9", "]"}], "]"}], "*", "epsUFutBar", "*", 
       "epsUFutHat"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "10", "]"}], "]"}], "*", "PjLagBar", "*", "PjLagHat"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "11", "]"}], "]"}], "*", "PiLagBar", "*", "PiLagHat"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "12", "]"}], "]"}], "*", "piVarBar", "*", 
       "piVarHat"}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "6.", " ", "Simplify", " ", "and", " ", "normalize", " ", "steady"}], "-", 
     RowBox[{"state", " ", "values", " ", "to", " ", "1"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEqNoBar", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEq", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PjBar", "->", "1"}], ",", 
         RowBox[{"PtBar", "->", "1"}], ",", 
         RowBox[{"YBar", "->", "1"}], ",", 
         RowBox[{"epsUBar", "->", "1"}], ",", 
         RowBox[{"PwBar", "->", "1"}], ",", 
         RowBox[{"PjFutBar", "->", "1"}], ",", 
         RowBox[{"PtFutBar", "->", "1"}], ",", 
         RowBox[{"YFutBar", "->", "1"}], ",", 
         RowBox[{"epsUFutBar", "->", "1"}], ",", 
         RowBox[{"PjLagBar", "->", "1"}], ",", 
         RowBox[{"PiLagBar", "->", "1"}], ",", 
         RowBox[{"piVarBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "7.", " ", "Reintroduce", " ", "time", " ", "indices", " ", "for", " ", 
      "the", " ", "log", " ", 
      RowBox[{"deviations", ":", 
       RowBox[{"-", "Pj"}]}]}], ",", "Pt", ",", "Y", ",", "epsU", ",", "Pw", ",", 
     RowBox[{
      RowBox[{"piVar", " ", "are", " ", "current", " ", 
       RowBox[{"(", "t", ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"-", "PjFut"}]}], ",", "PtFut", ",", "YFut", ",", 
     RowBox[{
      RowBox[{"epsUFut", " ", "are", " ", "leads", " ", 
       RowBox[{"(", 
        RowBox[{"t", "+", "1"}], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"-", "PjLag"}]}], ",", 
     RowBox[{"PiLag", " ", "are", " ", "lags", " ", 
      RowBox[{"(", 
       RowBox[{"t", "-", "1"}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"timeSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PjHat", "->", 
        RowBox[{"PjHat", "[", "t", "]"}]}], ",", 
       RowBox[{"PtHat", "->", 
        RowBox[{"PtHat", "[", "t", "]"}]}], ",", 
       RowBox[{"YHat", "->", 
        RowBox[{"YHat", "[", "t", "]"}]}], ",", 
       RowBox[{"epsUHat", "->", 
        RowBox[{"epsUHat", "[", "t", "]"}]}], ",", 
       RowBox[{"PwHat", "->", 
        RowBox[{"PwHat", "[", "t", "]"}]}], ",", 
       RowBox[{"PjFutHat", "->", 
        RowBox[{"PjHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"PtFutHat", "->", 
        RowBox[{"PtHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"YFutHat", "->", 
        RowBox[{"YHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"epsUFutHat", "->", 
        RowBox[{"epsUHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"PjLagHat", "->", 
        RowBox[{"PjHat", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], ",", 
       RowBox[{"PiLagHat", "->", 
        RowBox[{"PiHat", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], ",", 
       RowBox[{"piVarHat", "->", 
        RowBox[{"piVarHat", "[", "t", "]"}]}]}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqTimeIndexed", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "8.", " ", "Output", " ", "the", " ", "final", " ", "linearized", " ", 
     "equation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", "eqTimeIndexed", "}"}], "\n", "\[IndentingNewLine]", "\n", 
   "\n"}]}]], "Input",
 CellChangeTimes->{
  3.9424252827947807`*^9, 3.9424879659349766`*^9, {3.9473471907510777`*^9, 
   3.947347191898058*^9}, 3.947784779983919*^9, 3.947784987716772*^9, {
   3.9489903079272823`*^9, 3.9489903243434563`*^9}, {3.948990848866911*^9, 
   3.9489909081112175`*^9}, 3.949060587099819*^9, 3.9490606225196743`*^9, 
   3.9490611373178616`*^9, {3.949061176404995*^9, 3.9490611796429768`*^9}, {
   3.9490612340961494`*^9, 3.949061235260706*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"52999333-fe05-e84a-acf1-fc22be5bf2ea"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.942508401042242*^9, 
  3.942508401044237*^9}},ExpressionUUID->"e44d3794-52ef-d540-95ab-\
731b5a7762cd"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"retail", " ", "banking"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{
  3.942425871529419*^9, 3.942426101584881*^9, 3.9424261402649555`*^9, 
   3.9473466087112083`*^9, {3.947346779662201*^9, 3.947346796649639*^9}, 
   3.947346964656801*^9, {3.9473470205344906`*^9, 3.9473470595561905`*^9}, 
   3.9473471027397194`*^9, {3.9477846114062653`*^9, 3.947784628251028*^9}, {
   3.947954466290764*^9, 3.947954468666727*^9}, {3.9479545001509304`*^9, 
   3.9479545383854084`*^9}},ExpressionUUID->"28629b7d-e028-5846-af8b-\
9f2b85a1dc47"],

Cell[BoxData[""], "Input",ExpressionUUID->"dd97dce5-0f5a-5548-85d4-2d3b84c46059"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Clear", " ", "relevant", " ", "symbols"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "\[Kappa]d", ",", "\[CurlyEpsilon]d", ",", "\[Mu]D", ",", "d", ",", "dj",
       ",", "rD", ",", "rDj", ",", "rT"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"1", ")"}], " ", "Define", " ", "the", " ", "Rotemberg", " ", 
     "adjustment", " ", "cost", " ", "function"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Example", ":", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Kappa]d", "/", "2"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rDj", "/", "rD"}], "-", "1"}], ")"}], "^", "2"}], ")"}], "*",
       "rD", "*", "dj"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AdjCost", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Kappa]d", "/", "2"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rDj", "/", "rD"}], "-", "1"}], ")"}], "^", "2"}], ")"}], "*",
       "rD", "*", "dj"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"2", ")"}], " ", "Write", " ", "the", " ", 
        RowBox[{"bank", "'"}], "s", " ", "one"}], "-", 
       RowBox[{"period", " ", "profit", " ", 
        RowBox[{"(", "static", ")"}]}]}], ":", "Profit"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"rT", "*", "dj"}], "-", 
       RowBox[{"rDj", "*", "dj"}], "-", 
       RowBox[{
       "AdjCost", " ", "subject", " ", "to", " ", "the", " ", "deposit", " ", 
        RowBox[{"demand", ":", "dj"}]}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"rDj", "/", "rD"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"-", "\[CurlyEpsilon]d"}], ")"}]}], "*", "d"}]}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"3", ")"}], " ", "Form", " ", "the", " ", 
      RowBox[{"Lagrangian", ":", "L"}]}], "=", 
     RowBox[{
      RowBox[{"[", 
       RowBox[{
        RowBox[{"rT", "*", "dj"}], "-", 
        RowBox[{"rDj", "*", "dj"}], "-", "AdjCost"}], "]"}], "+", 
      RowBox[{"\[Mu]D", "*", 
       RowBox[{"[", 
        RowBox[{"dj", "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"rDj", "/", "rD"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"-", "\[CurlyEpsilon]d"}], ")"}]}], "*", "d"}]}], 
        "]"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Lagrangian", "=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"rT", "*", "dj"}], "-", 
      RowBox[{"rDj", "*", "dj"}], "-", "AdjCost"}], ")"}]}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"+", "\[Mu]D"}], "*", 
     RowBox[{"(", 
      RowBox[{"dj", "-", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"rDj", "/", "rD"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"-", "\[CurlyEpsilon]d"}], ")"}]}], "*", "d"}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"4", ")"}], " ", "Take", " ", "first"}], "-", 
     RowBox[{
     "order", " ", "conditions", " ", "wrt", " ", "dj", " ", "and", " ", 
      "rDj"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"FOCdj", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"Lagrangian", ",", "dj"}], "]"}], "==", "0"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"FOCrDj", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"Lagrangian", ",", "rDj"}], "]"}], "==", "0"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"5", ")"}], " ", "Solve", " ", "the", " ", "system", " ", "for", 
     " ", "dj", " ", "and", " ", "rDj", " ", "in", " ", "terms", " ", "of", " ",
      "the", " ", "parameters"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"solution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"FOCdj", ",", "FOCrDj"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dj", ",", "rDj"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Display", " ", "the", " ", "solution"}], "*)"}], "\n", 
   "solution", "\n"}]}]], "Input",
 CellChangeTimes->{{3.950092656613249*^9, 3.950092681770752*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"50cbb85b-ef5a-214e-b4ad-571c43e9c839"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "dj"}], " ", "rDj"}], "+", 
  RowBox[{"dj", " ", "rT"}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "dj", " ", "rD", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      FractionBox["rDj", "rD"]}], ")"}], "2"], " ", "\[Kappa]d"}]}]], "Output",
 CellChangeTimes->{3.95009268821994*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"ba9c6190-3889-1544-a4e6-fd4742f29bbf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dj", "\[Rule]", "0"}], ",", 
     RowBox[{"rDj", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "rD"}], "+", 
        RowBox[{"rD", " ", "\[Kappa]d"}], "-", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["rD", "2"], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["rD", "2"], " ", "\[Kappa]d"}], "+", 
          RowBox[{"2", " ", "rD", " ", "rT", " ", "\[Kappa]d"}]}]]}], 
       "\[Kappa]d"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dj", "\[Rule]", "0"}], ",", 
     RowBox[{"rDj", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "rD"}], "+", 
        RowBox[{"rD", " ", "\[Kappa]d"}], "+", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["rD", "2"], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["rD", "2"], " ", "\[Kappa]d"}], "+", 
          RowBox[{"2", " ", "rD", " ", "rT", " ", "\[Kappa]d"}]}]]}], 
       "\[Kappa]d"]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.9500926882269573`*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"d3ed06ee-b8ff-294e-b91e-7c9f954290f7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\n", "\[IndentingNewLine]", "\n", "\n", "\n", "\[IndentingNewLine]",
   "\n", "\n"}]], "Input",
 CellChangeTimes->{
  3.9490687074669514`*^9, {3.949068754841463*^9, 3.949068756088009*^9}, {
   3.9490687910101223`*^9, 3.9490688132811527`*^9}, {3.94906888461211*^9, 
   3.9490689272287006`*^9}, {3.949068960412428*^9, 3.949069041337929*^9}, {
   3.949069086418791*^9, 3.949069167821823*^9}, {3.949069200770897*^9, 
   3.949069202041834*^9}, {3.9490692516573524`*^9, 3.9490692527366753`*^9}, {
   3.9490697657280025`*^9, 3.949069780665613*^9}, {3.9490700076472836`*^9, 
   3.949070033644764*^9}, {3.949070099642252*^9, 3.9490701034060173`*^9}, {
   3.9490709872374725`*^9, 3.9490709995323486`*^9}, {3.9490727711307964`*^9, 
   3.9490728062286434`*^9}, {3.9490747667031612`*^9, 
   3.9490747907226295`*^9}, {3.9490748560217476`*^9, 3.949074857912815*^9}, {
   3.949074892676176*^9, 3.9490748943268585`*^9}, 3.949075283245247*^9, 
   3.9490755041517677`*^9, {3.9490755973720856`*^9, 3.9490756110217266`*^9}, {
   3.9491483521069202`*^9, 3.94914837157139*^9}, 3.949148418114006*^9, 
   3.949148473105919*^9, {3.949148527629196*^9, 3.9491485562413616`*^9}, {
   3.9491488517219257`*^9, 3.949148853639353*^9}, {3.9491507260546207`*^9, 
   3.9491507453534584`*^9}},ExpressionUUID->"ddbf74b7-28ae-e646-950d-\
853adb6de2be"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.948211170519268*^9},ExpressionUUID->"4b97082b-f52c-d940-8b60-\
cf5f1725bfda"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{{3.948211170519268*^9, 3.9482111876671753`*^9}, {
   3.9482112794644413`*^9, 3.9482112948257694`*^9}, {3.9482756884700985`*^9, 
   3.9482757018341217`*^9}, 3.9482761056397743`*^9, 3.9482784758201923`*^9, 
   3.948278957803278*^9, {3.94897400115378*^9, 3.948974115359949*^9}, {
   3.9489766614298*^9, 3.9489766736456013`*^9}, {3.948976913824997*^9, 
   3.94897693385376*^9}, {3.9489771231243935`*^9, 3.9489771250207157`*^9}, 
   3.9489771676231384`*^9, 
   3.9489888952604027`*^9},ExpressionUUID->"5dd43024-de83-cb41-a7b3-\
b837d316dc18"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.94820885691658*^9},
 CellLabel->"",ExpressionUUID->"dfc70790-c88c-054d-8485-03f8062fbf9d"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.9482109068747272`*^9, 3.9482109437608814`*^9, 
  3.9482110261963253`*^9, 
  3.9482111329284325`*^9},ExpressionUUID->"87f03399-2a49-8741-8bdb-\
0504f8780838"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9482792941288185`*^9, 3.9482793172546787`*^9}, 
   3.94897700525461*^9, {3.9489772194163303`*^9, 
   3.9489772319667683`*^9}},ExpressionUUID->"7f8fbad5-21e7-284d-8454-\
d537c7ac8fad"],

Cell[BoxData[""], "Input",ExpressionUUID->"22c9a5ff-e8ca-da4a-bea9-0829d17500f1"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.9482172029295044`*^9, {3.9482172767034664`*^9, 3.948217329190628*^9}, 
   3.948217605001524*^9, {3.948218357118347*^9, 3.948218401248472*^9}, {
   3.9482184816585445`*^9, 3.948218554252701*^9}, {3.948218584625622*^9, 
   3.9482186765515785`*^9}, {3.948218792408987*^9, 3.9482188281772537`*^9}, 
   3.9482192330981655`*^9, {3.94821929869018*^9, 3.9482193203191605`*^9}, {
   3.9482757633364906`*^9, 3.948275779501955*^9}, {3.9482758564138184`*^9, 
   3.948275882938244*^9}, 
   3.9482780949387245`*^9},ExpressionUUID->"6b2be15b-ddfc-2e4b-8670-\
7e87cade0d44"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", "equation2", "*)"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"1.", " ", "Clear", " ", "all", " ", "symbols"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "rd", ",", "rdLag", ",", "rdNext", ",", "Rt", ",", "dt", ",", "dtNext", ",",
       "cpTm1", ",", "cpT", ",", "cpTp1", ",", "cpTp2", ",", "epsd", ",", 
      "kappaD", ",", "beta", ",", "a", ",", "xiP", ",", "betaP", ",", "t", ",",
       "rdBar", ",", "rdLagBar", ",", "rdNextBar", ",", "RtBar", ",", "dtBar",
       ",", "dtNextBar", ",", "cpTm1Bar", ",", "cpTBar", ",", "cpTp1Bar", ",",
       "cpTp2Bar", ",", "rdHat", ",", "rdLagHat", ",", "rdNextHat", ",", 
      "RtHat", ",", "dtHat", ",", "dtNextHat", ",", "cpTm1Hat", ",", "cpTHat",
       ",", "cpTp1Hat", ",", "cpTp2Hat", ",", "cpHat"}], "]"}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "2.", " ", "Define", " ", "the", " ", "original", " ", "nonlinear", " ", 
      "equation", " ", "F"}], "==", "0"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{
      "rd_", ",", "rdLag_", ",", "rdNext_", ",", "Rt_", ",", "dt_", ",", 
       "dtNext_", ",", "cpTm1_", ",", "cpT_", ",", "cpTp1_", ",", "cpTp2_"}], 
      "]"}], ":=", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "epsd", "-", 
      RowBox[{"(", 
       RowBox[{"epsd", "*", 
        RowBox[{"Rt", "/", "rd"}]}], ")"}], "-", 
      RowBox[{"kappaD", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"rd", "/", "rdLag"}], ")"}], "-", "1"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"rd", "/", "Rt"}], ")"}]}], "+", 
      RowBox[{"beta", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "a"}], ")"}], "*", "xiP", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "a"}], "*", "cpT"}], "+", "cpTp1"}], ")"}]}], 
               "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"a", "*", 
                  RowBox[{"betaP", "^", 
                   RowBox[{"(", 
                    RowBox[{"2", "+", "t"}], ")"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"a", "*", "cpTp1"}], "-", "cpTp2"}], ")"}]}]}], 
              ")"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "a"}], ")"}], "*", "xiP", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "a"}], "*", "cpTm1"}], "+", "cpT"}], ")"}]}], 
               "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"a", "*", 
                  RowBox[{"betaP", "^", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", "t"}], ")"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"a", "*", "cpT"}], "-", "cpTp1"}], ")"}]}]}], 
              ")"}]}], ")"}]}], ")"}], "*", "kappaD", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"rdNext", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"epsd", "/", 
                 RowBox[{"(", 
                  RowBox[{"epsd", "-", "1"}], ")"}]}], ")"}], "*", "Rt"}], 
              ")"}]}], ")"}], "-", "1"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"rdNext", "/", "Rt"}], ")"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"rdNext", "/", "rd"}], ")"}], "^", "2"}], "*", 
         RowBox[{"(", 
          RowBox[{"dtNext", "/", "dt"}], ")"}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "3.", " ", "Set", " ", "up", " ", "steady", " ", "state", " ", 
      "substitutions"}], ",", 
     RowBox[{"variable", " ", "lists"}], ",", 
     RowBox[{
      RowBox[{"and", " ", "corresponding", " ", "log"}], "-", 
      "deviations"}]}], "*)"}], 
   RowBox[{
    RowBox[{"steadySubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rd", "->", "rdBar"}], ",", 
       RowBox[{"rdLag", "->", "rdLagBar"}], ",", 
       RowBox[{"rdNext", "->", "rdNextBar"}], ",", 
       RowBox[{"Rt", "->", "RtBar"}], ",", 
       RowBox[{"dt", "->", "dtBar"}], ",", 
       RowBox[{"dtNext", "->", "dtNextBar"}], ",", 
       RowBox[{"cpTm1", "->", "cpTm1Bar"}], ",", 
       RowBox[{"cpT", "->", "cpTBar"}], ",", 
       RowBox[{"cpTp1", "->", "cpTp1Bar"}], ",", 
       RowBox[{"cpTp2", "->", "cpTp2Bar"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{
      "rd", ",", "rdLag", ",", "rdNext", ",", "Rt", ",", "dt", ",", "dtNext", 
       ",", "cpTm1", ",", "cpT", ",", "cpTp1", ",", "cpTp2"}], "}"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logDevs", "=", 
     RowBox[{"{", 
      RowBox[{
      "rdHat", ",", "rdLagHat", ",", "rdNextHat", ",", "RtHat", ",", "dtHat", 
       ",", "dtNextHat", ",", "cpTm1Hat", ",", "cpTHat", ",", "cpTp1Hat", ",",
        "cpTp2Hat"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "4.", " ", "Compute", " ", "partial", " ", "derivatives", " ", "with", " ",
      "respect", " ", "to", " ", "each", " ", "variable", " ", "at", " ", 
     "the", " ", "steady", " ", "state"}], "*)"}], 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "@@", "vars"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", "steadySubs"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "5.", " ", "Form", " ", "the", " ", "linearized", " ", "equation", " ", 
      "by", " ", "multiplying", " ", "each", " ", "derivative", " ", "by", " ",
       "the", " ", "corresponding", " ", "steady", " ", "state", " ", "and", " ",
       "log"}], "-", "deviation"}], "*)"}], 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", "rdBar", "*", "rdHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", "rdLagBar", "*", "rdLagHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", "rdNextBar", "*", "rdNextHat"}],
        "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "*", "RtBar", "*", "RtHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "*", "dtBar", "*", "dtHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "*", "dtNextBar", "*", "dtNextHat"}],
        "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "7", "]"}], "]"}], "*", "cpTm1Bar", "*", "cpTm1Hat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "8", "]"}], "]"}], "*", "cpTBar", "*", "cpTHat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "9", "]"}], "]"}], "*", "cpTp1Bar", "*", "cpTp1Hat"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "10", "]"}], "]"}], "*", "cpTp2Bar", "*", 
        "cpTp2Hat"}]}], " ", "==", "0"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "6.", " ", "Simplify", " ", "and", " ", "normalize", " ", "steady", " ", 
     "state", " ", "values", " ", "to", " ", "1"}], "*)"}], 
   RowBox[{
    RowBox[{"logLinEqNoBar", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEq", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rdBar", "->", "1"}], ",", 
         RowBox[{"rdLagBar", "->", "1"}], ",", 
         RowBox[{"rdNextBar", "->", "1"}], ",", 
         RowBox[{"RtBar", "->", "1"}], ",", 
         RowBox[{"dtBar", "->", "1"}], ",", 
         RowBox[{"dtNextBar", "->", "1"}], ",", 
         RowBox[{"cpTm1Bar", "->", "1"}], ",", 
         RowBox[{"cpTBar", "->", "1"}], ",", 
         RowBox[{"cpTp1Bar", "->", "1"}], ",", 
         RowBox[{"cpTp2Bar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "7.", " ", "Reintroduce", " ", "time", " ", "indices", " ", "using", " ", 
     "a", " ", "single", " ", "log", " ", "deviation", " ", "symbol", " ", 
     "for", " ", "consumption", " ", 
     RowBox[{"(", "cpHat", ")"}]}], "*)"}], 
   RowBox[{
    RowBox[{"timeSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rdHat", "->", 
        RowBox[{"rdHat", "[", "t", "]"}]}], ",", 
       RowBox[{"rdLagHat", "->", 
        RowBox[{"rdHat", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], ",", 
       RowBox[{"rdNextHat", "->", 
        RowBox[{"rdHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"RtHat", "->", 
        RowBox[{"RtHat", "[", "t", "]"}]}], ",", 
       RowBox[{"dtHat", "->", 
        RowBox[{"dtHat", "[", "t", "]"}]}], ",", 
       RowBox[{"dtNextHat", "->", 
        RowBox[{"dtHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"cpTm1Hat", "->", 
        RowBox[{"cpHat", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], ",", 
       RowBox[{"cpTHat", "->", 
        RowBox[{"cpHat", "[", "t", "]"}]}], ",", 
       RowBox[{"cpTp1Hat", "->", 
        RowBox[{"cpHat", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", 
       RowBox[{"cpTp2Hat", "->", 
        RowBox[{"cpHat", "[", 
         RowBox[{"t", "+", "2"}], "]"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqTimeIndexed", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "8.", " ", "Output", " ", "the", " ", "final", " ", "linearized", " ", 
     "equations"}], "*)"}], 
   RowBox[{"{", 
    RowBox[{"logLinEqNoBar", ",", "eqTimeIndexed"}], "}"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n"}]}]], "Input",
 CellChangeTimes->{
  3.9482172029295044`*^9, {3.9482172767034664`*^9, 3.948217329190628*^9}, 
   3.948217605001524*^9, {3.948218357118347*^9, 3.948218401248472*^9}, {
   3.9482184816585445`*^9, 3.948218554252701*^9}, {3.948218584625622*^9, 
   3.9482186765515785`*^9}, {3.948218792408987*^9, 3.9482188281772537`*^9}, 
   3.9482192330981655`*^9, {3.94821929869018*^9, 3.9482193203191605`*^9}, {
   3.9482757633364906`*^9, 3.948275779501955*^9}, {3.9482758564138184`*^9, 
   3.948275882938244*^9}, 3.9482780949387245`*^9, {3.948978039301388*^9, 
   3.9489780614751873`*^9}, {3.94897813577087*^9, 3.948978184816408*^9}, {
   3.9489782151446056`*^9, 3.9489782350011406`*^9}, {3.948978265102497*^9, 
   3.9489782672387295`*^9}, {3.9489878968216286`*^9, 
   3.9489879510043163`*^9}, {3.948988023691309*^9, 3.9489881130165176`*^9}, {
   3.948988688444702*^9, 3.948988723817602*^9}, {3.948989421971798*^9, 
   3.9489894308176804`*^9}, 3.948989469978512*^9, {3.949062856610857*^9, 
   3.949062858448099*^9}, 
   3.949062889994978*^9},ExpressionUUID->"60263157-24c5-8d40-91d8-\
a0bfe38a098a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", 
   RowBox[{"Clear", " ", "all", " ", "relevant", " ", "symbols"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "\[Kappa]d", ",", "\[CurlyEpsilon]d", ",", "\[Mu]D", ",", "d", ",", "dj",
       ",", "rD", ",", "rDj", ",", "rT"}], "]"}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"1", ")"}], " ", "Define", " ", "the", " ", "Rotemberg", " ", 
     "adjustment", " ", "cost", " ", "for", " ", "deposits"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AdjCost", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Kappa]d", "/", "2"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rDj", "/", "rD"}], "-", "1"}], ")"}], "^", "2"}], ")"}], "*",
       "rD", "*", "dj"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"2", ")"}], " ", "Define", " ", "the", " ", 
     RowBox[{"bank", "'"}], "s", " ", "static", " ", "profit", " ", 
     "function", " ", 
     RowBox[{"(", 
      RowBox[{"no", " ", "constraint", " ", "yet"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"profit", "=", 
     RowBox[{
      RowBox[{"rT", "*", "dj"}], "-", 
      RowBox[{"rDj", "*", "dj"}], "-", "AdjCost"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"3", ")"}], " ", "Deposit"}], "-", 
      RowBox[{"demand", " ", 
       RowBox[{"constraint", ":", "dj"}]}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"rDj", "/", "rD"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"-", "\[CurlyEpsilon]d"}], ")"}]}], "*", "d", " ", 
      RowBox[{"We", "'"}], "ll", " ", "add", " ", "this", " ", "to", " ", 
      "the", " ", "Lagrangian", " ", "via", " ", "the", " ", "multiplier", " ", 
      RowBox[{"\[Mu]D", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Lagrangian", "=", "profit"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"+", "\[Mu]D"}], "*", 
     RowBox[{"(", 
      RowBox[{"dj", "-", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"rDj", "/", "rD"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"-", "\[CurlyEpsilon]d"}], ")"}]}], "*", "d"}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"4", ")"}], " ", "Label", " ", "each", " ", "first"}], "-", 
     RowBox[{"order", " ", "condition", " ", "explicitly"}]}], "*)"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "dj", " ", 
     RowBox[{"(", 
      RowBox[{"deposit", " ", "volume"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FOCdj", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"Lagrangian", ",", "dj"}], "]"}], "==", "0"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"FOC", " ", "wrt", " ", "rDj", " ", 
     RowBox[{"(", 
      RowBox[{"deposit", " ", "rate"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FOCrDj", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"Lagrangian", ",", "rDj"}], "]"}], "==", "0"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"5", ")"}], " ", "Solve", " ", "the", " ", "system", " ", "for", 
     " ", 
     RowBox[{"{", 
      RowBox[{"dj", ",", "rDj"}], "}"}], " ", "in", " ", "terms", " ", "of", " ",
      "parameters"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solution", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"FOCdj", ",", "FOCrDj"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dj", ",", "rDj"}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"6", ")"}], " ", "Optionally"}], ",", 
     RowBox[{"simplify", " ", "the", " ", "solution"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solutionSimplified", "=", 
     RowBox[{"FullSimplify", "[", "solution", "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"7", ")"}], " ", "Display", " ", "the", " ", "simplified", " ", 
     "solution"}], "*)"}], "\[IndentingNewLine]", "solutionSimplified", 
   "\n"}]}]], "Input",
 CellChangeTimes->{
  3.9482761909525433`*^9, {3.948277591011326*^9, 3.9482776045391216`*^9}, {
   3.9489774692270775`*^9, 3.948977477896446*^9}, {3.948977618269253*^9, 
   3.9489777223346996`*^9}, {3.948977756008646*^9, 3.948977759945881*^9}, 
   3.9489778093769207`*^9, {3.948978000729273*^9, 3.948978015332199*^9}, {
   3.9500922721349106`*^9, 3.950092279818041*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"540827f2-e3ff-e24a-a159-4c33fa9eb206"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "dj"}], " ", "rDj"}], "+", 
  RowBox[{"dj", " ", "rT"}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "dj", " ", "rD", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      FractionBox["rDj", "rD"]}], ")"}], "2"], " ", "\[Kappa]d"}]}]], "Output",
 CellChangeTimes->{3.9500924350577583`*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"e93d444f-4bdb-cb44-a85c-59c6d307d81b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dj", "\[Rule]", "0"}], ",", 
     RowBox[{"rDj", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"rD", "-", 
         RowBox[{"rD", " ", "\[Kappa]d"}], "+", 
         SqrtBox[
          RowBox[{"rD", " ", 
           RowBox[{"(", 
            RowBox[{"rD", "-", 
             RowBox[{"2", " ", "rD", " ", "\[Kappa]d"}], "+", 
             RowBox[{"2", " ", "rT", " ", "\[Kappa]d"}]}], ")"}]}]]}], 
        "\[Kappa]d"]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dj", "\[Rule]", "0"}], ",", 
     RowBox[{"rDj", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"rD", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Kappa]d"}], ")"}]}], "+", 
        SqrtBox[
         RowBox[{"rD", " ", 
          RowBox[{"(", 
           RowBox[{"rD", "-", 
            RowBox[{"2", " ", "rD", " ", "\[Kappa]d"}], "+", 
            RowBox[{"2", " ", "rT", " ", "\[Kappa]d"}]}], ")"}]}]]}], 
       "\[Kappa]d"]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.950092435309202*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"6c6f9bb5-a604-ca4c-b028-7d67f6d69e9e"]
}, Open  ]],

Cell[BoxData[""], "Input",ExpressionUUID->"6e1aa942-3024-de42-8538-e83358f2155a"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\n"}]], "Input",
 CellChangeTimes->{
  3.9482780305935287`*^9, {3.94898954372686*^9, 
   3.9489895578695507`*^9}},ExpressionUUID->"e37bc72f-5857-5947-a697-\
98458db7a9ed"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.948281184816969*^9},ExpressionUUID->"833b7c30-e8c4-9243-8c0c-\
bcc486ee4cf1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "jb", ",", "rbHH", ",", "bH", ",", "rbE", ",", "bE", ",", "rd", ",", "d", 
     ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb", ",", "AdjB", ",", 
     "vars", ",", "partials", ",", "logLinEq", ",", "logLinEqNoBar", ",", 
     "timeSubs", ",", "logLinEqTime", ",", "final"}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "1.", " ", "Define", " ", "the", " ", "original", " ", "nonlinear", " ", 
     "equation", " ", "F"}], "==", "0"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{
     "jb_", ",", "rbHH_", ",", "bH_", ",", "rbE_", ",", "bE_", ",", "rd_", ",",
       "d_", ",", "Kb_", ",", "Bt_", ",", "nu_", ",", "kappaKb_", ",", 
      "AdjB_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"rbHH", "*", "bH"}], "+", 
     RowBox[{"rbE", "*", "bE"}], "-", 
     RowBox[{"rd", "*", "d"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"kappaKb", "/", "2"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Kb", "/", "Bt"}], "-", "nu"}], ")"}], "^", "2"}], ")"}], "*",
       "Kb"}], "-", "AdjB"}]}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "2.", " ", "List", " ", "the", " ", "variables", " ", "for", " ", 
    "differentiation"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vars", "=", 
    RowBox[{"{", 
     RowBox[{
     "rbHH", ",", "bH", ",", "rbE", ",", "bE", ",", "rd", ",", "d", ",", "Kb",
       ",", "Bt", ",", "nu", ",", "kappaKb", ",", "AdjB"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "3.", " ", "Compute", " ", "partial", " ", "derivatives", " ", "at", " ", 
    "the", " ", "steady", " ", "state"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"partials", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{
          "jb", ",", "rbHH", ",", "bH", ",", "rbE", ",", "bE", ",", "rd", ",",
            "d", ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb", ",", 
           "AdjB"}], "]"}], ",", 
         RowBox[{"vars", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rbHH", "->", "rbHHBar"}], ",", 
         RowBox[{"bH", "->", "bHBar"}], ",", 
         RowBox[{"rbE", "->", "rbEBar"}], ",", 
         RowBox[{"bE", "->", "bEBar"}], ",", 
         RowBox[{"rd", "->", "rdBar"}], ",", 
         RowBox[{"d", "->", "dBar"}], ",", 
         RowBox[{"Kb", "->", "KbBar"}], ",", 
         RowBox[{"Bt", "->", "BtBar"}], ",", 
         RowBox[{"nu", "->", "nuBar"}], ",", 
         RowBox[{"kappaKb", "->", "kappaKbBar"}], ",", 
         RowBox[{"AdjB", "->", "AdjBBar"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"4.", " ", "Define", " ", "log"}], "-", 
    RowBox[{"deviation", " ", "variables"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "rbHH", ",", "bH", ",", "rbE", ",", "bE", ",", "rd", ",", "d", ",", "Kb", 
     ",", "Bt", ",", "nu", ",", "kappaKb", ",", "AdjB"}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "5.", " ", "Multiply", " ", "each", " ", "derivative", " ", "by", " ", 
    "steady", " ", "state", " ", "and", " ", "corresponding", " ", 
    "deviation"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEq", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", "rbHHBar", "*", "rbHH"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", "bHBar", "*", "bH"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "*", "rbEBar", "*", "rbE"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "*", "bEBar", "*", "bE"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "*", "rdBar", "*", "rd"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "6", "]"}], "]"}], "*", "dBar", "*", "d"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "7", "]"}], "]"}], "*", "KbBar", "*", "Kb"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "8", "]"}], "]"}], "*", "BtBar", "*", "Bt"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "9", "]"}], "]"}], "*", "nuBar", "*", "nu"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "10", "]"}], "]"}], "*", "kappaKbBar", "*", "kappaKb"}], 
      "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "11", "]"}], "]"}], "*", "AdjBBar", "*", "AdjB"}]}], "==",
      "0"}]}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "6.", " ", "Simplify", " ", "and", " ", "normalize", " ", "by", " ", 
    "setting", " ", "steady", " ", "states", " ", "to", " ", "1"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEqNoBar", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"logLinEq", "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rbHHBar", "->", "1"}], ",", 
        RowBox[{"bHBar", "->", "1"}], ",", 
        RowBox[{"rbEBar", "->", "1"}], ",", 
        RowBox[{"bEBar", "->", "1"}], ",", 
        RowBox[{"rdBar", "->", "1"}], ",", 
        RowBox[{"dBar", "->", "1"}], ",", 
        RowBox[{"KbBar", "->", "1"}], ",", 
        RowBox[{"BtBar", "->", "1"}], ",", 
        RowBox[{"nuBar", "->", "1"}], ",", 
        RowBox[{"kappaKbBar", "->", "1"}], ",", 
        RowBox[{"AdjBBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "7.", " ", "Reintroduce", " ", "the", " ", "original", " ", "time", " ", 
    "indices"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"timeSubs", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"rbHH", "->", 
       RowBox[{"rbHH", "[", "t", "]"}]}], ",", 
      RowBox[{"bH", "->", 
       RowBox[{"bH", "[", "t", "]"}]}], ",", 
      RowBox[{"rbE", "->", 
       RowBox[{"rbE", "[", "t", "]"}]}], ",", 
      RowBox[{"bE", "->", 
       RowBox[{"bE", "[", "t", "]"}]}], ",", 
      RowBox[{"rd", "->", 
       RowBox[{"rd", "[", "t", "]"}]}], ",", 
      RowBox[{"d", "->", 
       RowBox[{"d", "[", "t", "]"}]}], ",", 
      RowBox[{"Kb", "->", 
       RowBox[{"Kb", "[", "t", "]"}]}], ",", 
      RowBox[{"Bt", "->", 
       RowBox[{"Bt", "[", "t", "]"}]}], ",", 
      RowBox[{"nu", "->", 
       RowBox[{"nu", "[", "t", "]"}]}], ",", 
      RowBox[{"kappaKb", "->", 
       RowBox[{"kappaKb", "[", "t", "]"}]}], ",", 
      RowBox[{"AdjB", "->", 
       RowBox[{"AdjB", "[", "t", "]"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEqTime", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "8.", " ", "FullSimplify", " ", "the", " ", "final", " ", "linear", " ", 
    "equation"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"final", "=", 
    RowBox[{"FullSimplify", "[", "logLinEqTime", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"9.", " ", "Show", " ", "the", " ", "result"}], 
   "*)"}]}], "\[IndentingNewLine]", "final", "\n"}], "Input",
 CellChangeTimes->{3.948281214895033*^9},
 CellLabel->"In[84]:=",ExpressionUUID->"a82bb35f-23d4-1148-92be-97a819c647e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"whole", " ", "branch"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "Rb", ",", "rt", ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb", ",", 
      "vars", ",", "partials", ",", "logLinEq", ",", "logLinEqNoBar", ",", 
      "timeSubs", ",", "logLinEqTime", ",", "final"}], "]"}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "1.", " ", "Define", " ", "the", " ", "original", " ", "nonlinear", " ", 
      "equation", " ", "F"}], "==", "0"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{
      "Rb_", ",", "rt_", ",", "Kb_", ",", "Bt_", ",", "nu_", ",", 
       "kappaKb_"}], "]"}], ":=", 
     RowBox[{"Rb", "-", "rt", "-", 
      RowBox[{"kappaKb", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Kb", "/", "Bt"}], "-", "nu"}], ")"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Kb", "/", "Bt"}], ")"}], "^", "2"}]}], ")"}]}]}]}], ";"}],
    "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "2.", " ", "List", " ", "the", " ", "variables", " ", "for", " ", 
     "differentiation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{
      "Rb", ",", "rt", ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb"}], 
      "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "Compute", " ", "partial", " ", "derivatives", " ", "at", " ", 
     "the", " ", "steady", " ", "state"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "[", 
           RowBox[{
           "Rb", ",", "rt", ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb"}],
            "]"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Rb", "->", "RbBar"}], ",", 
          RowBox[{"rt", "->", "rtBar"}], ",", 
          RowBox[{"Kb", "->", "KbBar"}], ",", 
          RowBox[{"Bt", "->", "BtBar"}], ",", 
          RowBox[{"nu", "->", "nuBar"}], ",", 
          RowBox[{"kappaKb", "->", "kappaKbBar"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"4.", " ", "Define", " ", "log"}], "-", 
     RowBox[{"deviation", " ", "variables"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "Rb", ",", "rt", ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb"}], 
     "]"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "5.", " ", "Multiply", " ", "each", " ", "derivative", " ", "by", " ", 
     "steady", " ", "state", " ", "and", " ", "corresponding", " ", 
     "deviation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", "RbBar", "*", "Rb"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", "rtBar", "*", "rt"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", "KbBar", "*", "Kb"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "*", "BtBar", "*", "Bt"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "*", "nuBar", "*", "nu"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "*", "kappaKbBar", "*", 
        "kappaKb"}]}], "==", "0"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "6.", " ", "Simplify", " ", "and", " ", "normalize", " ", "by", " ", 
     "setting", " ", "steady", " ", "states", " ", "to", " ", "1"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEqNoBar", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEq", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RbBar", "->", "1"}], ",", 
         RowBox[{"rtBar", "->", "1"}], ",", 
         RowBox[{"KbBar", "->", "1"}], ",", 
         RowBox[{"BtBar", "->", "1"}], ",", 
         RowBox[{"nuBar", "->", "1"}], ",", 
         RowBox[{"kappaKbBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "7.", " ", "Reintroduce", " ", "the", " ", "original", " ", "time", " ", 
     "indices"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"timeSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Rb", "->", 
        RowBox[{"Rb", "[", "t", "]"}]}], ",", 
       RowBox[{"rt", "->", 
        RowBox[{"rt", "[", "t", "]"}]}], ",", 
       RowBox[{"Kb", "->", 
        RowBox[{"Kb", "[", "t", "]"}]}], ",", 
       RowBox[{"Bt", "->", 
        RowBox[{"Bt", "[", "t", "]"}]}], ",", 
       RowBox[{"nu", "->", 
        RowBox[{"nu", "[", "t", "]"}]}], ",", 
       RowBox[{"kappaKb", "->", 
        RowBox[{"kappaKb", "[", "t", "]"}]}]}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEqTime", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "8.", " ", "FullSimplify", " ", "the", " ", "final", " ", "linear", " ", 
     "equation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"final", "=", 
     RowBox[{"FullSimplify", "[", "logLinEqTime", "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"9.", " ", "Show", " ", "the", " ", "result"}], "*)"}], "\[IndentingNewLine]",
    "final", "\n"}]}]], "Input",
 CellChangeTimes->{{3.948282608006546*^9, 3.9482826444877167`*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"a56cb576-82c8-7c48-8c63-0ad7fd764497"],

Cell[BoxData[""], "Input",ExpressionUUID->"9061a5ee-35fe-5741-ba37-38de218add33"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "Rb", ",", "rt", ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb", ",", 
     "vars", ",", "partials", ",", "logLinEq", ",", "logLinEqNoBar", ",", 
     "timeSubs", ",", "logLinEqTime", ",", "final"}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "1.", " ", "Define", " ", "the", " ", "original", " ", "nonlinear", " ", 
     "equation", " ", "F"}], "==", "0"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{
     "Rb_", ",", "rt_", ",", "Kb_", ",", "Bt_", ",", "nu_", ",", "kappaKb_"}],
      "]"}], ":=", 
    RowBox[{"Rb", "-", "rt", "+", 
     RowBox[{"kappaKb", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Kb", "/", "Bt"}], "-", "nu"}], ")"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Kb", "/", "Bt"}], ")"}], "^", "2"}]}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "2.", " ", "List", " ", "the", " ", "variables", " ", "for", " ", 
    "differentiation"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vars", "=", 
    RowBox[{"{", 
     RowBox[{
     "Rb", ",", "rt", ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb"}], 
     "}"}]}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "3.", " ", "Compute", " ", "partial", " ", "derivatives", " ", "at", " ", 
    "the", " ", "steady", " ", "state"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"partials", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{
          "Rb", ",", "rt", ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb"}], 
          "]"}], ",", 
         RowBox[{"vars", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Rb", "->", "RbBar"}], ",", 
         RowBox[{"rt", "->", "rtBar"}], ",", 
         RowBox[{"Kb", "->", "KbBar"}], ",", 
         RowBox[{"Bt", "->", "BtBar"}], ",", 
         RowBox[{"nu", "->", "nuBar"}], ",", 
         RowBox[{"kappaKb", "->", "kappaKbBar"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"4.", " ", "Define", " ", "log"}], "-", 
    RowBox[{"deviation", " ", "variables"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "Rb", ",", "rt", ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb"}], "]"}],
    ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "5.", " ", "Multiply", " ", "each", " ", "derivative", " ", "by", " ", 
    "steady", " ", "state", " ", "and", " ", "corresponding", " ", 
    "deviation"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEq", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", "RbBar", "*", "Rb"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", "rtBar", "*", "rt"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "*", "KbBar", "*", "Kb"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "*", "BtBar", "*", "Bt"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "*", "nuBar", "*", "nu"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "6", "]"}], "]"}], "*", "kappaKbBar", "*", "kappaKb"}]}],
      "==", "0"}]}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "6.", " ", "Simplify", " ", "and", " ", "normalize", " ", "by", " ", 
    "setting", " ", "steady", " ", "states", " ", "to", " ", "1"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEqNoBar", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"logLinEq", "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RbBar", "->", "1"}], ",", 
        RowBox[{"rtBar", "->", "1"}], ",", 
        RowBox[{"KbBar", "->", "1"}], ",", 
        RowBox[{"BtBar", "->", "1"}], ",", 
        RowBox[{"nuBar", "->", "1"}], ",", 
        RowBox[{"kappaKbBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "7.", " ", "Reintroduce", " ", "the", " ", "original", " ", "time", " ", 
    "indices"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"timeSubs", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Rb", "->", 
       RowBox[{"Rb", "[", "t", "]"}]}], ",", 
      RowBox[{"rt", "->", 
       RowBox[{"rt", "[", "t", "]"}]}], ",", 
      RowBox[{"Kb", "->", 
       RowBox[{"Kb", "[", "t", "]"}]}], ",", 
      RowBox[{"Bt", "->", 
       RowBox[{"Bt", "[", "t", "]"}]}], ",", 
      RowBox[{"nu", "->", 
       RowBox[{"nu", "[", "t", "]"}]}], ",", 
      RowBox[{"kappaKb", "->", 
       RowBox[{"kappaKb", "[", "t", "]"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEqTime", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "8.", " ", "FullSimplify", " ", "the", " ", "final", " ", "linear", " ", 
    "equation"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"final", "=", 
    RowBox[{"FullSimplify", "[", "logLinEqTime", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"9.", " ", "Show", " ", "the", " ", "result"}], 
   "*)"}]}], "\[IndentingNewLine]", "final", "\n"}], "Input",
 CellChangeTimes->{3.948283056384369*^9},
 CellLabel->
  "In[106]:=",ExpressionUUID->"ff208aaa-6375-2b49-b93f-5d5062c77685"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "Rb", ",", "rt", ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb", ",", 
     "vars", ",", "partials", ",", "logLinEq", ",", "logLinEqNoBar", ",", 
     "timeSubs", ",", "logLinEqTime", ",", "final"}], "]"}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "1.", " ", "Define", " ", "the", " ", "original", " ", "nonlinear", " ", 
     "equation", " ", "F"}], "==", "0"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{
     "Rb_", ",", "rt_", ",", "Kb_", ",", "Bt_", ",", "nu_", ",", "kappaKb_"}],
      "]"}], ":=", 
    RowBox[{"Rb", "-", "rt", "+", 
     RowBox[{"kappaKb", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Kb", "/", "Bt"}], "-", "nu"}], ")"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Kb", "/", "Bt"}], ")"}], "^", "2"}]}], ")"}]}]}]}], ";"}], 
  "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "2.", " ", "List", " ", "the", " ", "variables", " ", "for", " ", 
    "differentiation"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vars", "=", 
    RowBox[{"{", 
     RowBox[{
     "Rb", ",", "rt", ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb"}], 
     "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "3.", " ", "Compute", " ", "partial", " ", "derivatives", " ", "at", " ", 
    "the", " ", "steady", " ", "state"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"partials", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{
          "Rb", ",", "rt", ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb"}], 
          "]"}], ",", 
         RowBox[{"vars", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Rb", "->", "RbBar"}], ",", 
         RowBox[{"rt", "->", "rtBar"}], ",", 
         RowBox[{"Kb", "->", "KbBar"}], ",", 
         RowBox[{"Bt", "->", "BtBar"}], ",", 
         RowBox[{"nu", "->", "nuBar"}], ",", 
         RowBox[{"kappaKb", "->", "kappaKbBar"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], "\n",
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"4.", " ", "Define", " ", "log"}], "-", 
    RowBox[{"deviation", " ", "variables"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "Rb", ",", "rt", ",", "Kb", ",", "Bt", ",", "nu", ",", "kappaKb"}], "]"}],
    ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "5.", " ", "Multiply", " ", "each", " ", "derivative", " ", "by", " ", 
    "steady", " ", "state", " ", "and", " ", "corresponding", " ", 
    "deviation"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEq", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", "RbBar", "*", "Rb"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", "rtBar", "*", "rt"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "*", "KbBar", "*", "Kb"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "*", "BtBar", "*", "Bt"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "*", "nuBar", "*", "nu"}], "+", 
      RowBox[{
       RowBox[{"partials", "[", 
        RowBox[{"[", "6", "]"}], "]"}], "*", "kappaKbBar", "*", "kappaKb"}]}],
      "==", "0"}]}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "6.", " ", "Simplify", " ", "and", " ", "normalize", " ", "by", " ", 
    "setting", " ", "steady", " ", "states", " ", "to", " ", "1"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEqNoBar", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"logLinEq", "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RbBar", "->", "1"}], ",", 
        RowBox[{"rtBar", "->", "1"}], ",", 
        RowBox[{"KbBar", "->", "1"}], ",", 
        RowBox[{"BtBar", "->", "1"}], ",", 
        RowBox[{"nuBar", "->", "1"}], ",", 
        RowBox[{"kappaKbBar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "7.", " ", "Reintroduce", " ", "the", " ", "original", " ", "time", " ", 
    "indices"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"timeSubs", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Rb", "->", 
       RowBox[{"Rb", "[", "t", "]"}]}], ",", 
      RowBox[{"rt", "->", 
       RowBox[{"rt", "[", "t", "]"}]}], ",", 
      RowBox[{"Kb", "->", 
       RowBox[{"Kb", "[", "t", "]"}]}], ",", 
      RowBox[{"Bt", "->", 
       RowBox[{"Bt", "[", "t", "]"}]}], ",", 
      RowBox[{"nu", "->", 
       RowBox[{"nu", "[", "t", "]"}]}], ",", 
      RowBox[{"kappaKb", "->", 
       RowBox[{"kappaKb", "[", "t", "]"}]}]}], "}"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logLinEqTime", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "8.", " ", "FullSimplify", " ", "the", " ", "final", " ", "linear", " ", 
    "equation"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"final", "=", 
    RowBox[{"FullSimplify", "[", "logLinEqTime", "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"9.", " ", "Show", " ", "the", " ", "result"}], 
   "*)"}]}], "\[IndentingNewLine]", "final", "\n"}], "Input",
 CellChangeTimes->{3.94828331388431*^9},
 CellLabel->
  "In[117]:=",ExpressionUUID->"d8e75efd-76ab-8a46-9fc3-e125253aba0d"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.9482840089863453`*^9, 3.948284027505615*^9}, 
   3.948822339260597*^9},ExpressionUUID->"3b72adb7-506f-a242-9ce8-\
568a43db7148"],

Cell[BoxData[""], "Input",ExpressionUUID->"2c909075-ae9a-1e46-bacf-b4aff58794cf"],

Cell[BoxData[
 RowBox[{"\n", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.948290165256489*^9, 3.9482902270903816`*^9, {3.9483006378467236`*^9, 
   3.9483006804550667`*^9}, 
   3.9488221135338364`*^9},ExpressionUUID->"67d8674f-acfb-3043-9b8d-\
8ee7033e485e"],

Cell[BoxData[""], "Input",ExpressionUUID->"c5f2b5fd-741a-8049-a956-ffe3b238359b"],

Cell[BoxData[""], "Input",ExpressionUUID->"ab316537-3e7d-3446-8567-ba591898cdf1"],

Cell[BoxData[""], "Input",ExpressionUUID->"997334ee-ab42-4643-8d15-288531846b9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"interest", " ", "rates"}], " ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "rt", ",", "rtprev", ",", "r", ",", "deltaR", ",", "pit", ",", "pi", ",",
       "phipi", ",", "yt", ",", "yt1", ",", "phiy", ",", "epsilont", ",", 
      "vars", ",", "partials", ",", "logLinEq", ",", "logLinEqNoBar", ",", 
      "timeSubs", ",", "logLinEqTime", ",", "final"}], "]"}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "1.", " ", "Define", " ", "the", " ", "original", " ", "nonlinear", " ", 
      "equation", " ", "F"}], "==", "0"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{
      "rt_", ",", "rtprev_", ",", "r_", ",", "deltaR_", ",", "pit_", ",", 
       "pi_", ",", "phipi_", ",", "yt_", ",", "yt1_", ",", "phiy_", ",", 
       "epsilont_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "rt"}], ")"}], "-", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "r"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"1", "-", "deltaR"}], ")"}]}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "rtprev"}], ")"}], "^", "deltaR"}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"pit", "/", "pi"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"phipi", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "deltaR"}], ")"}]}], ")"}]}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"yt", "/", "yt1"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"phiy", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "deltaR"}], ")"}]}], ")"}]}], " ", 
       "epsilont"}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "2.", " ", "List", " ", "the", " ", "variables", " ", "for", " ", 
     "differentiation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{
      "rt", ",", "rtprev", ",", "r", ",", "pit", ",", "pi", ",", "yt", ",", 
       "yt1", ",", "epsilont"}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "3.", " ", "Compute", " ", "partial", " ", "derivatives", " ", "at", " ", 
     "the", " ", "steady", " ", "state"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"partials", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"F", "[", 
           RowBox[{
           "rt", ",", "rtprev", ",", "r", ",", "deltaR", ",", "pit", ",", 
            "pi", ",", "phipi", ",", "yt", ",", "yt1", ",", "phiy", ",", 
            "epsilont"}], "]"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"rt", "->", "rBar"}], ",", 
          RowBox[{"rtprev", "->", "rBar"}], ",", 
          RowBox[{"r", "->", "rBar"}], ",", 
          RowBox[{"pit", "->", "piBar"}], ",", 
          RowBox[{"pi", "->", "piBar"}], ",", 
          RowBox[{"yt", "->", 
           RowBox[{"gamma", "*", "EyEBar"}]}], ",", 
          RowBox[{"yt1", "->", 
           RowBox[{"gamma", "*", "EyEBar"}]}], ",", 
          RowBox[{"epsilont", "->", "epsilonbar"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"4.", " ", "Define", " ", "log"}], "-", 
     RowBox[{"deviation", " ", "variables"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "rt", ",", "rtprev", ",", "r", ",", "pit", ",", "pi", ",", "yt", ",", 
      "yt1", ",", "epsilont"}], "]"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "5.", " ", "Multiply", " ", "each", " ", "derivative", " ", "by", " ", 
     "steady", " ", "state", " ", "and", " ", "corresponding", " ", 
     "deviation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", "rBar", "*", "rt"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", "rBar", "*", "rtprev"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "*", "piBar", "*", "pit"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "*", "piBar", "*", "pi"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "*", "gamma", "*", "EyEBar", "*", 
        "yt"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "7", "]"}], "]"}], "*", "gamma", "*", "EyEBar", "*", 
        "yt1"}], "+", 
       RowBox[{
        RowBox[{"partials", "[", 
         RowBox[{"[", "8", "]"}], "]"}], "*", "epsilont", "*", 
        "epsilonbar"}]}], "==", "0"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "6.", " ", "Simplify", " ", "and", " ", "normalize", " ", "by", " ", 
     "setting", " ", "steady", " ", "states", " ", "to", " ", "1"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEqNoBar", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEq", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rBar", "->", "1"}], ",", 
         RowBox[{"piBar", "->", "1"}], ",", 
         RowBox[{
          RowBox[{"gamma", "*", "EyEBar"}], "->", "1"}], ",", 
         RowBox[{"epsilonbar", "->", "1"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "7.", " ", "Reintroduce", " ", "the", " ", "original", " ", "time", " ", 
     "indices"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"timeSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rt", "->", 
        RowBox[{"r", "[", "t", "]"}]}], ",", 
       RowBox[{"rtprev", "->", 
        RowBox[{"r", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], ",", 
       RowBox[{"r", "->", "r"}], ",", 
       RowBox[{"pit", "->", 
        RowBox[{"pit", "[", "t", "]"}]}], ",", 
       RowBox[{"pi", "->", 
        RowBox[{"pi", "[", "t", "]"}]}], ",", 
       RowBox[{"yt", "->", 
        RowBox[{"gamma", "*", 
         RowBox[{"EyE", "[", "t", "]"}]}]}], ",", 
       RowBox[{"yt1", "->", 
        RowBox[{"gamma", "*", 
         RowBox[{"EyE", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}]}], ",", 
       RowBox[{"epsilont", "->", 
        RowBox[{"epsilont", "[", "t", "]"}]}]}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logLinEqTime", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"logLinEqNoBar", "/.", " ", "timeSubs"}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "8.", " ", "FullSimplify", " ", "the", " ", "final", " ", "linear", " ", 
     "equation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"final", "=", 
     RowBox[{"FullSimplify", "[", "logLinEqTime", "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"9.", " ", "Show", " ", "the", " ", "result"}], "*)"}], "\[IndentingNewLine]",
    "final", "\n", "\n", "\n"}]}]], "Input",
 CellChangeTimes->{
  3.948290797825924*^9, {3.9482908870602665`*^9, 3.9482909038465385`*^9}, {
   3.948291328198168*^9, 3.9482913579914494`*^9}, {3.9482919728943176`*^9, 
   3.9482919752060814`*^9}, 3.948294263133692*^9, {3.948294545288492*^9, 
   3.9482945637916813`*^9}, 3.9482949137900887`*^9, {3.948300224204357*^9, 
   3.94830024748044*^9}, {3.948300432697098*^9, 3.94830046694265*^9}, {
   3.948301726822344*^9, 3.9483017762476215`*^9}, {3.948368617069916*^9, 
   3.948368637847414*^9}, 3.948368670113468*^9, 3.948370868668873*^9, 
   3.9483709421856117`*^9, 3.9483709776544304`*^9, {3.9483720614720592`*^9, 
   3.948372079081949*^9}, {3.948372117270647*^9, 3.9483721547778893`*^9}, 
   3.9483723872874947`*^9, {3.9483724359224377`*^9, 3.9483724949128914`*^9}, 
   3.9483760291753025`*^9, 3.9483760635531807`*^9},
 CellLabel->"In[93]:=",ExpressionUUID->"4d53601a-fd38-8d4f-a5bd-6776aef1197c"],

Cell[BoxData[
 RowBox[{"\n", "\n"}]], "Input",
 CellChangeTimes->{
  3.9482949528246784`*^9, 3.9482950677238617`*^9, 3.948295122942894*^9, 
   3.948295163384453*^9, 3.948295240413183*^9, {3.94829543609647*^9, 
   3.9482954550522633`*^9}, {3.9482956533275127`*^9, 3.948295664961014*^9}, {
   3.94829678226198*^9, 3.9482968005008698`*^9}, 
   3.9483001506649837`*^9},ExpressionUUID->"1e372a0a-d04a-0043-8634-\
a06ae95ac5f2"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9489945600283966`*^9, 3.9489945768175735`*^9}, 
   3.948994652798132*^9, {3.9489951630497417`*^9, 3.9489954439801025`*^9}, {
   3.9489961835008106`*^9, 
   3.948996187438553*^9}},ExpressionUUID->"8620db63-1855-fb4d-8f03-\
43e480652571"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\n"}]], "Input",
 CellChangeTimes->{{3.948992292102009*^9, 3.948992312656969*^9}, 
   3.9489923446774673`*^9, {3.9489923804373207`*^9, 3.9489923833659534`*^9}, {
   3.94899247539674*^9, 3.948992492646641*^9}, 3.948992562946371*^9, 
   3.94899280039859*^9, {3.9489928346182537`*^9, 3.948992836203594*^9}, {
   3.9489928792084503`*^9, 3.9489929105452404`*^9}, {3.9489930457092705`*^9, 
   3.9489930513937454`*^9}},ExpressionUUID->"269dff81-a812-9249-a1f5-\
6e70ad846896"],

Cell[BoxData[""], "Input",ExpressionUUID->"833d72fc-f1ef-2541-b874-706d0c32da9b"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\n", "\n"}]], "Input",
 CellChangeTimes->{{3.9484531036409836`*^9, 3.948453252554985*^9}, {
   3.948453491951372*^9, 3.9484535026756477`*^9}, {3.9484535364761105`*^9, 
   3.948453600848089*^9}, {3.948822157816473*^9, 3.948822171699688*^9}, 
   3.9488222750960217`*^9, 3.9489912779161777`*^9, {3.9489916587065735`*^9, 
   3.9489917421482697`*^9}, 
   3.9489922532462616`*^9},ExpressionUUID->"bf85dff3-cfcf-194f-8172-\
c7888df28bf7"],

Cell[BoxData[")"], "Input",
 CellChangeTimes->{{3.9490547996499767`*^9, 
  3.9490547996508904`*^9}},ExpressionUUID->"1619ea84-a057-f840-b9a9-\
74fb06551168"],

Cell[BoxData[""], "Input",ExpressionUUID->"bbc937ae-faa9-334f-86a3-c07cb38540d6"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\n", "\[IndentingNewLine]", "\n", "\n", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.948902028097927*^9, 3.948902028097927*^9}, {
   3.9489020649795914`*^9, 3.9489021345402603`*^9}, {3.9489021688100224`*^9, 
   3.9489022711608696`*^9}, {3.9489027129443207`*^9, 3.948902719111843*^9}, {
   3.948902749429943*^9, 3.9489027733288803`*^9}, {3.9489036511578445`*^9, 
   3.9489036853736763`*^9}, {3.9489038117008038`*^9, 3.948903829468157*^9}, 
   3.9489041828586197`*^9, 3.948904431542452*^9, {3.9489044770826054`*^9, 
   3.9489044847675667`*^9}, {3.9489046599095173`*^9, 3.9489046807480087`*^9}, 
   3.9489056105456142`*^9, 3.948905649044409*^9, 3.948905797111294*^9, 
   3.94899150006662*^9},ExpressionUUID->"398bba21-27f0-ba4f-8d02-\
b70493bc16d2"]
},
WindowSize->{1380.75, 765.75},
WindowMargins->{{5.25, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"751cc55f-cf6c-1949-a82a-152363b9498d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 10349, 207, 580, "Input",ExpressionUUID->"f9fb2cec-0218-1946-a7a4-614cfc63c79f"],
Cell[10928, 231, 1151, 34, 53, "Output",ExpressionUUID->"89f46449-40bc-454b-bf12-432d0c41fab6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12116, 270, 5045, 138, 713, "Input",ExpressionUUID->"73a5e06e-15c9-2347-9c11-545b67147ef3"],
Cell[17164, 410, 503, 13, 53, "Output",ExpressionUUID->"c1670040-ed74-054f-a4e2-562c369196e7"],
Cell[17670, 425, 1273, 39, 53, "Output",ExpressionUUID->"989a8f9c-9396-624a-b30a-0383185b187d"]
}, Open  ]],
Cell[18958, 467, 130, 3, 28, "Input",ExpressionUUID->"93063096-b854-5642-83fe-da57c1f294a1"],
Cell[CellGroupData[{
Cell[19113, 474, 6107, 179, 465, "Input",ExpressionUUID->"0708fca9-59ce-8847-af89-18fc69779938"],
Cell[25223, 655, 2160, 64, 94, "Output",ExpressionUUID->"331e89ae-d4d3-0148-9d6e-d62837cf9c8a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27420, 724, 883, 13, 28, "Input",ExpressionUUID->"9ace75de-4978-4347-8abf-940e21a736de"],
Cell[CellGroupData[{
Cell[28328, 741, 506, 10, 22, "Print",ExpressionUUID->"3180c1ab-5e0d-ca40-9394-5e86f56408d7"],
Cell[28837, 753, 428, 9, 22, "Print",ExpressionUUID->"cba57453-8210-be49-9e99-e7c7a95b445f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[29314, 768, 1968, 52, 184, "Input",ExpressionUUID->"6cbdf14f-fcad-b24a-9b64-6f911cd48fed"],
Cell[31285, 822, 963, 31, 52, "Output",ExpressionUUID->"7c3554d3-4946-fd4b-bc7b-7e9e3ebaec7b"],
Cell[32251, 855, 961, 31, 52, "Output",ExpressionUUID->"0c1908c2-3a31-d14e-ab3a-e4b82587ec48"]
}, Open  ]],
Cell[33227, 889, 305, 5, 47, "Input",ExpressionUUID->"4978f1f1-0572-b84b-b184-a61a2eb98030"],
Cell[CellGroupData[{
Cell[33557, 898, 326, 5, 28, "Input",ExpressionUUID->"45d14f52-30e0-da46-9903-bc98c6f0cfcd"],
Cell[CellGroupData[{
Cell[33908, 907, 402, 8, 22, "Print",ExpressionUUID->"3b40c5c1-cbf0-244a-912a-65c58f9ab2e4"],
Cell[34313, 917, 356, 8, 22, "Print",ExpressionUUID->"3dd3e17b-7b29-3d40-970d-7f04b4476b62"]
}, Open  ]]
}, Open  ]],
Cell[34696, 929, 163, 3, 33, "Text",ExpressionUUID->"a69b7710-0a9d-1846-91aa-7a4298560cda"],
Cell[34862, 934, 5955, 169, 427, "Input",ExpressionUUID->"42a8e955-c96a-7241-b392-ab997b076293"],
Cell[40820, 1105, 142, 3, 33, "Text",ExpressionUUID->"b6a1118c-8d19-934d-bab1-26bb44974ff4"],
Cell[40965, 1110, 156, 3, 47, "Input",ExpressionUUID->"aec07186-9953-eb4b-a898-e758c5d4aabf"],
Cell[41124, 1115, 439, 7, 180, "Input",ExpressionUUID->"665ccb08-e918-c74f-86bd-79b899402612"],
Cell[41566, 1124, 813, 12, 28, "Input",ExpressionUUID->"dc40e394-a162-e344-af1c-469b5ff19c55"],
Cell[42382, 1138, 81, 0, 28, "Input",ExpressionUUID->"7a834a5d-16f4-cc45-8b91-2c83acb7bfcf"],
Cell[42466, 1140, 20576, 592, 903, "Input",ExpressionUUID->"04b06094-e411-2340-ae40-ed548ed14b86"],
Cell[63045, 1734, 899, 14, 104, "Input",ExpressionUUID->"f0fa445f-5834-f94c-9a80-dd8f95a8acc3"],
Cell[63947, 1750, 335, 5, 28, "Input",ExpressionUUID->"5a156fc5-2eb4-7e48-b51d-4ec8fa2678b1"],
Cell[64285, 1757, 81, 0, 28, "Input",ExpressionUUID->"67031162-bd98-8f49-8550-4b19913fb9a6"],
Cell[64369, 1759, 20807, 591, 922, "Input",ExpressionUUID->"1d324b32-3e60-a146-b5b4-6a3a4bd7b1e8"],
Cell[CellGroupData[{
Cell[85201, 2354, 6358, 168, 694, "Input",ExpressionUUID->"6a3f6837-2a54-ef44-8052-e1074d73f7c7"],
Cell[91562, 2524, 2143, 62, 89, "Output",ExpressionUUID->"cd2aad40-24c0-b249-8758-41ac6cf0420c"]
}, Open  ]],
Cell[93720, 2589, 81, 0, 28, "Input",ExpressionUUID->"d402585a-a83e-ca41-9920-45e9264735da"],
Cell[CellGroupData[{
Cell[93826, 2593, 5009, 147, 389, "Input",ExpressionUUID->"0410ec8e-d993-c04a-ab33-5e62699db74b"],
Cell[98838, 2742, 450, 14, 49, "Output",ExpressionUUID->"6a9f7868-2426-1848-b619-07a43b89e409"]
}, Open  ]],
Cell[99303, 2759, 139, 2, 28, "Input",ExpressionUUID->"9e0d05d0-5fdf-944e-97f6-884be9bc4fd5"],
Cell[99445, 2763, 139, 2, 28, "Input",ExpressionUUID->"1d5db560-18c8-3845-bae1-e95058242b47"],
Cell[99587, 2767, 228, 5, 28, "Input",ExpressionUUID->"483b27fc-4b8e-9c46-8db4-040fdf9ca070"],
Cell[99818, 2774, 10145, 243, 541, "Input",ExpressionUUID->"94fcf45b-6f21-634c-b1d5-7d0ae8a5c58d"],
Cell[109966, 3019, 81, 0, 28, "Input",ExpressionUUID->"b9ef39e2-d105-c74c-ae1b-589fe4deab77"],
Cell[110050, 3021, 379, 7, 104, "Input",ExpressionUUID->"8880107c-6260-f84b-9c38-4d69438e0d38"],
Cell[110432, 3030, 10110, 240, 789, "Input",ExpressionUUID->"b0b5f86b-cc2e-e04d-b2ed-4360d9e5fb4f"],
Cell[120545, 3272, 2380, 33, 28, "Input",ExpressionUUID->"5b2a032a-505e-c740-a415-a5a50f903e5d"],
Cell[122928, 3307, 25934, 685, 1017, "Input",ExpressionUUID->"0e074e25-5497-e244-8216-c9871e946f7c"],
Cell[148865, 3994, 18133, 520, 865, "Input",ExpressionUUID->"fb2f931c-bc15-f341-bf84-64962e1f5fe1"],
Cell[167001, 4516, 8542, 196, 675, "Input",ExpressionUUID->"a67f113d-d41d-d24a-8f3f-b4722fe41f74"],
Cell[175546, 4714, 4294, 121, 193, "Input",ExpressionUUID->"9b5be767-603c-0b4d-b011-d7ba65064b4b"],
Cell[CellGroupData[{
Cell[179865, 4839, 4956, 141, 370, "Input",ExpressionUUID->"701e4a68-645d-5947-9384-1c5f4e49b6a5"],
Cell[184824, 4982, 1950, 63, 58, "Output",ExpressionUUID->"9ead36bb-5963-aa40-8fe7-c50aeb708fcd"]
}, Open  ]],
Cell[186789, 5048, 181, 3, 28, "Input",ExpressionUUID->"58b14532-419e-124a-a555-ae1c8fa742c0"],
Cell[186973, 5053, 5860, 170, 580, "Input",ExpressionUUID->"6bdb1088-4e1c-f54b-9a0b-13f60053de22"],
Cell[CellGroupData[{
Cell[192858, 5227, 11165, 278, 732, "Input",ExpressionUUID->"24e808de-ed6a-4146-a49a-28e49cf93adc"],
Cell[204026, 5507, 11720, 322, 383, "Output",ExpressionUUID->"32923660-840a-4b4d-a40a-87b153dac6e3"]
}, Open  ]],
Cell[215761, 5832, 156, 3, 28, "Input",ExpressionUUID->"4129f409-7408-7d45-9299-8b83db08acfc"],
Cell[215920, 5837, 15743, 431, 1036, "Input",ExpressionUUID->"e52c92a4-2eb6-c645-94b2-60c371363739"],
Cell[231666, 6270, 602, 10, 47, "Input",ExpressionUUID->"f19b7f51-99bd-4547-9650-5ff8e4c33086"],
Cell[232271, 6282, 6480, 175, 446, "Input",ExpressionUUID->"e2c58ebf-4fbc-3d4b-ac91-cf15352134a5"],
Cell[238754, 6459, 81, 0, 28, "Input",ExpressionUUID->"b88ee315-af2d-ad44-b33b-38496d3a52d4"],
Cell[238838, 6461, 175, 3, 28, "Input",ExpressionUUID->"4126ecf3-b2bc-c34e-b9ce-ab3dbe467b58"],
Cell[239016, 6466, 10936, 274, 827, "Input",ExpressionUUID->"e455865f-d51a-c546-92e4-fe2425237d2b"],
Cell[CellGroupData[{
Cell[249977, 6744, 209, 4, 47, "Input",ExpressionUUID->"36afece9-c926-264b-a26f-39f47d59542e"],
Cell[250189, 6750, 4178, 119, 153, "Output",ExpressionUUID->"ac571d23-c186-944e-833e-c2c84de86d8f"]
}, Open  ]],
Cell[254382, 6872, 228, 4, 47, "Input",ExpressionUUID->"2dd959b2-176f-8a4f-80e4-1ab403b9ba23"],
Cell[254613, 6878, 156, 3, 28, "Input",ExpressionUUID->"7e7eb5ba-8e84-5b42-acd7-29c01026fa12"],
Cell[254772, 6883, 7716, 195, 656, "Input",ExpressionUUID->"0ee05957-9f4b-5148-9577-73fb4d317e3e"],
Cell[262491, 7080, 687, 10, 28, "Input",ExpressionUUID->"d50ef5dd-7d10-9347-8ed7-e6a9098ab778"],
Cell[263181, 7092, 179, 3, 28, "Input",ExpressionUUID->"63b0b1fd-2390-274b-9686-decf9bf4215f"],
Cell[263363, 7097, 287, 5, 28, "Input",ExpressionUUID->"71ece0e5-c6b3-3242-9291-2dce22eed9c9"],
Cell[263653, 7104, 740, 11, 123, "Input",ExpressionUUID->"2c594bee-dfa3-0445-a3c2-f168b0935ff6"],
Cell[264396, 7117, 156, 3, 28, "Input",ExpressionUUID->"e7592208-471d-8b47-8fcd-f3187cd3bdcd"],
Cell[264555, 7122, 81, 0, 28, "Input",ExpressionUUID->"dcfcb1a1-4b7e-0b43-9670-8664b3289327"],
Cell[264639, 7124, 1093, 15, 47, "Input",ExpressionUUID->"a5650fd1-18d4-1d4e-89f1-7b4f1f908005"],
Cell[265735, 7141, 277, 5, 28, "Input",ExpressionUUID->"e2dbdcc9-c66d-4441-907d-edfe421a4271"],
Cell[266015, 7148, 105, 1, 28, "Input",ExpressionUUID->"39487013-ded2-0e45-9fd8-d526c979fc41"],
Cell[266123, 7151, 81, 0, 28, "Input",ExpressionUUID->"ad54bf90-5079-e447-887e-2c9f31b492f1"],
Cell[266207, 7153, 202, 5, 66, "Input",ExpressionUUID->"25e88d48-476a-5a46-a379-8531149d9a08"],
Cell[266412, 7160, 204, 4, 47, "Input",ExpressionUUID->"90347a46-5dbd-b54f-8f1e-a6938e1fe31a"],
Cell[266619, 7166, 154, 3, 47, "Input",ExpressionUUID->"d48f496e-7176-4c4a-84fa-2b0987060b46"],
Cell[266776, 7171, 303, 5, 28, "Input",ExpressionUUID->"16a53433-1cc7-e74a-b3e2-121a43b05c36"],
Cell[267082, 7178, 209, 4, 47, "Input",ExpressionUUID->"0d88e268-8e18-e44d-b2d8-cdf7e7401492"],
Cell[267294, 7184, 559, 10, 85, "Input",ExpressionUUID->"040b9176-9fb1-6c42-b2d6-b57a6d9f6770"],
Cell[267856, 7196, 154, 3, 28, "Input",ExpressionUUID->"415c207e-69ac-8e4e-b60e-cce02daeab93"],
Cell[268013, 7201, 762, 11, 66, "Input",ExpressionUUID->"fa04d5b8-3a30-3845-b5fc-decb17933490"],
Cell[CellGroupData[{
Cell[268800, 7216, 7467, 204, 560, "Input",ExpressionUUID->"a4784151-fd95-5549-b874-48705f8102dd"],
Cell[276270, 7422, 1678, 52, 49, "Output",ExpressionUUID->"eb7179b5-add7-ac4a-a5fb-41ee267a0bdc"],
Cell[277951, 7476, 252, 4, 32, "Output",ExpressionUUID->"64926b0d-9995-f942-b8cc-f99c9d616b3f"],
Cell[278206, 7482, 4161, 129, 115, "Output",ExpressionUUID->"cad3c2a6-2584-6d4d-a1b9-63356a260414"]
}, Open  ]],
Cell[282382, 7614, 12115, 295, 903, "Input",ExpressionUUID->"52999333-fe05-e84a-acf1-fc22be5bf2ea"],
Cell[294500, 7911, 152, 3, 28, "Input",ExpressionUUID->"e44d3794-52ef-d540-95ab-731b5a7762cd"],
Cell[294655, 7916, 605, 11, 47, "Input",ExpressionUUID->"28629b7d-e028-5846-af8b-9f2b85a1dc47"],
Cell[295263, 7929, 81, 0, 28, "Input",ExpressionUUID->"dd97dce5-0f5a-5548-85d4-2d3b84c46059"],
Cell[CellGroupData[{
Cell[295369, 7933, 4670, 134, 465, "Input",ExpressionUUID->"50cbb85b-ef5a-214e-b4ad-571c43e9c839"],
Cell[300042, 8069, 461, 13, 46, "Output",ExpressionUUID->"ba9c6190-3889-1544-a4e6-fd4742f29bbf"],
Cell[300506, 8084, 1182, 34, 95, "Output",ExpressionUUID->"d3ed06ee-b8ff-294e-b91e-7c9f954290f7"]
}, Open  ]],
Cell[301703, 8121, 1337, 20, 180, "Input",ExpressionUUID->"ddbf74b7-28ae-e646-950d-853adb6de2be"],
Cell[303043, 8143, 128, 3, 28, "Input",ExpressionUUID->"4b97082b-f52c-d940-8b60-cf5f1725bfda"],
Cell[303174, 8148, 585, 9, 47, "Input",ExpressionUUID->"5dd43024-de83-cb41-a7b3-b837d316dc18"],
Cell[303762, 8159, 138, 2, 28, "Input",ExpressionUUID->"dfc70790-c88c-054d-8485-03f8062fbf9d"],
Cell[303903, 8163, 205, 4, 28, "Input",ExpressionUUID->"87f03399-2a49-8741-8bdb-0504f8780838"],
Cell[304111, 8169, 232, 4, 28, "Input",ExpressionUUID->"7f8fbad5-21e7-284d-8454-d537c7ac8fad"],
Cell[304346, 8175, 81, 0, 28, "Input",ExpressionUUID->"22c9a5ff-e8ca-da4a-bea9-0829d17500f1"],
Cell[304430, 8177, 609, 10, 28, "Input",ExpressionUUID->"6b2be15b-ddfc-2e4b-8670-7e87cade0d44"],
Cell[305042, 8189, 11931, 294, 580, "Input",ExpressionUUID->"60263157-24c5-8d40-91d8-a0bfe38a098a"],
Cell[CellGroupData[{
Cell[316998, 8487, 4889, 130, 580, "Input",ExpressionUUID->"540827f2-e3ff-e24a-a159-4c33fa9eb206"],
Cell[321890, 8619, 463, 13, 46, "Output",ExpressionUUID->"e93d444f-4bdb-cb44-a85c-59c6d307d81b"],
Cell[322356, 8634, 1225, 36, 94, "Output",ExpressionUUID->"6c6f9bb5-a604-ca4c-b028-7d67f6d69e9e"]
}, Open  ]],
Cell[323596, 8673, 81, 0, 28, "Input",ExpressionUUID->"6e1aa942-3024-de42-8538-e83358f2155a"],
Cell[323680, 8675, 218, 5, 66, "Input",ExpressionUUID->"e37bc72f-5857-5947-a697-98458db7a9ed"],
Cell[323901, 8682, 147, 3, 47, "Input",ExpressionUUID->"833b7c30-e8c4-9243-8c0c-bcc486ee4cf1"],
Cell[324051, 8687, 7996, 215, 656, "Input",ExpressionUUID->"a82bb35f-23d4-1148-92be-97a819c647e0"],
Cell[332050, 8904, 6258, 164, 618, "Input",ExpressionUUID->"a56cb576-82c8-7c48-8c63-0ad7fd764497"],
Cell[338311, 9070, 81, 0, 28, "Input",ExpressionUUID->"9061a5ee-35fe-5741-ba37-38de218add33"],
Cell[338395, 9072, 6088, 173, 599, "Input",ExpressionUUID->"ff208aaa-6375-2b49-b93f-5d5062c77685"],
Cell[344486, 9247, 6084, 172, 599, "Input",ExpressionUUID->"d8e75efd-76ab-8a46-9fc3-e125253aba0d"],
Cell[350573, 9421, 196, 3, 47, "Input",ExpressionUUID->"3b72adb7-506f-a242-9ce8-568a43db7148"],
Cell[350772, 9426, 81, 0, 28, "Input",ExpressionUUID->"2c909075-ae9a-1e46-bacf-b4aff58794cf"],
Cell[350856, 9428, 271, 6, 66, "Input",ExpressionUUID->"67d8674f-acfb-3043-9b8d-8ee7033e485e"],
Cell[351130, 9436, 81, 0, 28, "Input",ExpressionUUID->"c5f2b5fd-741a-8049-a956-ffe3b238359b"],
Cell[351214, 9438, 81, 0, 28, "Input",ExpressionUUID->"ab316537-3e7d-3446-8567-ba591898cdf1"],
Cell[351298, 9440, 81, 0, 28, "Input",ExpressionUUID->"997334ee-ab42-4643-8d15-288531846b9e"],
Cell[351382, 9442, 8381, 209, 732, "Input",ExpressionUUID->"4d53601a-fd38-8d4f-a5bd-6776aef1197c"],
Cell[359766, 9653, 422, 8, 66, "Input",ExpressionUUID->"1e372a0a-d04a-0043-8634-a06ae95ac5f2"],
Cell[360191, 9663, 285, 5, 28, "Input",ExpressionUUID->"8620db63-1855-fb4d-8f03-43e480652571"],
Cell[360479, 9670, 516, 8, 66, "Input",ExpressionUUID->"269dff81-a812-9249-a1f5-6e70ad846896"],
Cell[360998, 9680, 81, 0, 28, "Input",ExpressionUUID->"833d72fc-f1ef-2541-b874-706d0c32da9b"],
Cell[361082, 9682, 478, 8, 85, "Input",ExpressionUUID->"bf85dff3-cfcf-194f-8172-c7888df28bf7"],
Cell[361563, 9692, 157, 3, 28, "Input",ExpressionUUID->"1619ea84-a057-f840-b9a9-74fb06551168"],
Cell[361723, 9697, 81, 0, 28, "Input",ExpressionUUID->"bbc937ae-faa9-334f-86a3-c07cb38540d6"],
Cell[361807, 9699, 831, 12, 161, "Input",ExpressionUUID->"398bba21-27f0-ba4f-8d02-b70493bc16d2"]
}
]
*)

(* End of internal cache information *)

